(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{185:function(e,t,c){"use strict";c.r(t),c.d(t,"SiteModule",(function(){return si}));var n=c(0),i=c(3),s=c(9),a=c(4),o=c(333),l=c(18),r=c(56),d=c(44),u=c(330),p=c(43),h=c(99),g=c(21),m=c(182),f=c(183),b=c(184),k=c(5),v=c(8);const j="pk.eyJ1IjoidGVycmFmcmFtZSIsImEiOiJjanZxNTFnaTYyZ2RuNDlxcmNnejNtNjN6In0.-kmlS8Tgb2fNc1NPb5rJEQ";class T{constructor(e){this.http=e,m.accessToken=j}features(){let e=new v.g;return this.http.get(acp+"/project/features",{params:e}).toPromise()}mbForwardGeocode(e){let t=new v.g,c="https://api.mapbox.com/geocoding/v5/mapbox.places/"+e+".json?proximity=-74.70850,40.78375&access_token="+j;return this.http.get(c,{params:t}).toPromise()}}function y(e,t){1&e&&(n.kc(0,"span"),n.gc(1,"i",13),n.jc())}function C(e,t){1&e&&(n.kc(0,"span"),n.gc(1,"i",14),n.jc())}function M(e,t){if(1&e&&(n.kc(0,"span"),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Vc(" ",e.label," / ")}}function w(e,t){if(1&e&&(n.Rc(0,y,2,0,"span",11),n.Rc(1,C,2,0,"span",11),n.kc(2,"span"),n.Rc(3,M,2,1,"span",12),n.jc(),n.kc(4,"b"),n.Tc(5),n.jc()),2&e){const e=t.match;n.Ac("ngIf",null==e.item.filename),n.Tb(1),n.Ac("ngIf",null!=e.item.filename),n.Tb(2),n.Ac("ngForOf",e.item.hierarchy),n.Tb(2),n.Uc(e.item.label)}}T.ɵfac=function(e){return new(e||T)(n.oc(v.c))},T.ɵprov=n.bc({token:T,factory:T.ɵfac});const O=function(){return{standalone:!0}};class S{constructor(e){this.mapService=e,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.center=new m.LngLat(-78.880453,42.897852),this.zoom=2,this.coordinate={longitude:null,latitude:null},this.search="",this.dataSource=k.a.create(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const c=t.features;let n=[];c.forEach(e=>{let t={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};n.push(t)}),e.next(n)})})}ngOnInit(){this.refreshCoordinateFromMap()}ngAfterViewInit(){let e={container:"map-attribute-div",style:"mapbox://styles/mapbox/outdoors-v11",zoom:this.zoom,center:this.center};null!=this.site.geometry&&(e.center=this.site.geometry.coordinates),this.map=new m.Map(e),this.map.on("load",()=>{this.initMap()})}ngOnDestroy(){this.map.remove()}initMap(){let e=f.modes;e.static=b,this.draw=new f({modes:e,displayControlsDefault:!1,controls:{static:!0}}),this.map.addControl(this.draw),this.map.addControl(new m.NavigationControl),this.map.on("draw.update",e=>{this.onDrawUpdate(e)}),this.map.on("draw.create",e=>{this.onDrawCreate(e)}),this.map.on("draw.modechange",e=>{this.onDrawUpdate(e)}),this.map.on("style.load",()=>{this.addLayers()}),this.addLayers()}addLayers(){if(null!=this.site.geometry){let e={id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry};this.draw.add(e),this.draw.changeMode("simple_select",{featureIds:[e.id]})}else this.draw.changeMode("draw_point",{});this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}})}onDrawUpdate(e){"move"===e.action&&null!=e.features&&e.features.length>0&&this.updateGeometry(e.features[0])}onDrawCreate(e){if(null!=e.features&&e.features.length>0){let t=e.features[0];t.id=this.site.id,this.updateGeometry(t)}}updateGeometry(e){this.site.geometry=e.geometry,this.refreshCoordinateFromMap()}refreshCoordinateFromMap(){null!=this.site&&null!=this.site.geometry&&(this.coordinate.longitude=this.site.geometry.coordinates[0],this.coordinate.latitude=this.site.geometry.coordinates[1])}refreshCoordinateFromInput(){if(null!=this.coordinate.longitude&&null!=this.coordinate.latitude){console.log(this.site.geometry),null==this.site.geometry&&(this.site.geometry={type:"Point"}),this.site.geometry.coordinates=[this.coordinate.longitude,this.coordinate.latitude];var e=this.draw.set({type:"FeatureCollection",features:[{id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry}]});this.draw.changeMode("simple_select",{featureIds:e})}}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}handleClick(e){let t=e.item;t.center&&this.map.flyTo({center:t.center,zoom:9})}}S.ɵfac=function(e){return new(e||S)(n.fc(T))},S.ɵcmp=n.Zb({type:S,selectors:[["map-attribute"]],inputs:{site:"site",center:"center",zoom:"zoom"},decls:23,vars:9,consts:[[1,"row-holder"],[1,"label-holder"],[1,"holder"],[1,"modal-body"],["id","search-container",2,"position","absolute","z-index","999","padding","15px","width","35%"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],["id","map-attribute-div",1,"map-view-port",2,"height","300px"],[1,"modal-body","text-left"],["name","longitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["name","latitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["bsItemTemplate",""],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(n.kc(0,"div",0),n.gc(1,"div",1),n.kc(2,"div",2),n.kc(3,"div",3),n.kc(4,"div",4),n.kc(5,"input",5),n.sc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),n.jc(),n.jc(),n.gc(6,"div",6),n.jc(),n.jc(),n.jc(),n.kc(7,"div",0),n.kc(8,"div",1),n.kc(9,"label"),n.Tc(10,"Longitude"),n.jc(),n.jc(),n.kc(11,"div",2),n.kc(12,"div",7),n.kc(13,"input",8),n.sc("ngModelChange",(function(e){return t.coordinate.longitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(14,"div",0),n.kc(15,"div",1),n.kc(16,"label"),n.Tc(17,"Latitude"),n.jc(),n.jc(),n.kc(18,"div",2),n.kc(19,"div",7),n.kc(20,"input",9),n.sc("ngModelChange",(function(e){return t.coordinate.latitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),n.jc(),n.jc(),n.jc(),n.jc(),n.Rc(21,w,6,4,"ng-template",null,10,n.Sc)),2&e){const e=n.Jc(22);n.Tb(5),n.Ac("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",n.Dc(8,O)),n.Tb(8),n.Ac("ngModel",t.coordinate.longitude),n.Tb(7),n.Ac("ngModel",t.coordinate.latitude)}},directives:[a.a,a.h,a.k,r.a,a.m,a.o,i.k,i.j],encapsulation:2});var I=c(39),A=c(124),x=c(123),R=c(335),P=c(338),F=c(336),L=c(151),N=c(26),U=c(22);class E{constructor(e,t,c,n){this.http=e,this.noErrorHttpClient=t,this.eventService=c,this.authService=n}getChildren(e){let t=new v.g;return t=t.set("id",e),this.http.get(acp+"/project/get-children",{params:t}).toPromise()}getObjects(e,t,c,n){let i=new v.g;return i=i.set("id",e),null!=t&&(i=i.set("key",t)),null!=c&&(i=i.set("pageNumber",c.toString())),null!=n&&(i=i.set("pageSize",n.toString())),this.http.get(acp+"/project/objects",{params:i}).toPromise()}view(e){let t=new v.g;return t=t.set("id",e),this.http.get(acp+"/project/view",{params:t}).toPromise()}getItems(e,t){let c=new v.g;return c=c.set("id",e),null!=t&&(c=c.set("key",t)),this.http.get(acp+"/project/items",{params:c}).toPromise()}roots(e,t){let c=new v.g;return null!=e&&(c=c.set("id",e)),null!=t&&(c=c.set("bounds",JSON.stringify(t))),this.http.get(acp+"/project/roots",{params:c}).toPromise()}edit(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/edit",JSON.stringify({id:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}setExclude(e,t){let c=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/set-exclude",JSON.stringify({id:e,exclude:t}),{headers:c}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}runOrtho(e){let t=new v.f({"Content-Type":"application/json"});return this.http.post(acp+"/project/run-ortho",JSON.stringify({id:e}),{headers:t}).pipe(Object(x.a)(()=>{})).toPromise()}update(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/update",JSON.stringify({entity:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}newChild(e,t){let c="/project/new-default-child",n=new v.f({"Content-Type":"application/json"}),i={};return null!=e&&(i.parentId=e),t&&(i.type=t,c="/project/new-child"),this.eventService.start(),this.http.post(acp+c,JSON.stringify(i),{headers:n}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}applyWithParent(e,t){let c=new v.f({"Content-Type":"application/json"}),n={entity:e};return null!=t&&(n.parentId=t),this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/apply-with-parent",JSON.stringify(n),{headers:c}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}getCurrentUser(){return this.authService.getUserName()}remove(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}removeObject(e,t){let c=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/removeObject",JSON.stringify({id:e,key:t}),{headers:c}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}removeTask(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove-task",JSON.stringify({uploadId:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}upload(e,t,c){this.eventService.start();const n=new FormData;return n.append("file",c),n.append("id",e),n.append("folder",t),this.http.post(acp+"/project/upload",n).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}tasks(e,t,c,n){let i=new v.g;return i=i.set("statuses",JSON.stringify(e)),i=i.set("pageSize",t.toString()),i=i.set("pageNumber",c.toString()),i=i.set("token",n.toString()),this.http.get(acp+"/project/tasks",{params:i}).toPromise()}task(e){let t=new v.g;return t=t.set("id",e),this.http.get(acp+"/project/task",{params:t}).toPromise()}getMissingMetadata(e,t){let c=new v.g;return c=c.set("pageSize",e.toString()),c=c.set("pageNumber",t.toString()),this.http.get(acp+"/project/missing-metadata",{params:c}).toPromise()}download(e,t,c){let n=new v.g;return n=n.set("id",e),n=n.set("key",t),c&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download",{params:n,responseType:"blob"}).pipe(Object(x.a)(()=>{c&&this.eventService.complete()}))}downloadAll(e,t,c){let n=new v.g;return n=n.set("id",e),n=n.set("key",t),c&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download-all",{params:n,responseType:"blob"}).pipe(Object(x.a)(()=>{c&&this.eventService.complete()}))}search(e){return e.pipe(Object(R.a)(400)).pipe(Object(P.a)()).pipe(Object(F.a)(e=>this.searchEntries(e)))}searchEntries(e){let t=new v.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t})}searchEntites(e){let t=new v.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t}).toPromise()}submitCollectionMetadata(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/submit-metadata",JSON.stringify({json:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}pushToEros(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/eros/push",JSON.stringify({collectionId:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}getMetadataOptions(e){let t=new v.g;return null!=e&&(t=t.set("id",e)),this.noErrorHttpClient.get(acp+"/project/metadata-options",{params:t}).toPromise()}evaluate(e,t){return null!=e&&"eq"===e.type?t[e.name]===e.value:null!=e&&"admin"===e.type&&this.authService.isAdmin()}}E.ɵfac=function(e){return new(e||E)(n.oc(v.c),n.oc(L.a),n.oc(N.a),n.oc(U.a))},E.ɵprov=n.bc({token:E,factory:E.ɵfac});var D=c(12),$=c(86);function _(e,t){if(1&e&&(n.kc(0,"div",7),n.kc(1,"div",8),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",9),n.kc(5,"div"),n.kc(6,"p",10),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(7),n.Uc(e.message)}}function G(e,t){1&e&&(n.kc(0,"p",11),n.Tc(1,"Loading image..."),n.jc())}function z(e,t){if(1&e&&(n.gc(0,"img",12),n.vc(1,"safeHtml")),2&e){const e=n.uc();n.Ac("src",n.wc(1,1,e.imageToShow),n.Nc)}}class V{constructor(e,t){this.service=e,this.bsModalRef=t,this.message=null,this.open=!0,this.loading=!0}init(e,t){this.component=e,this.key=t,this.getImage(this.component,this.key)}createImageFromBlob(e){let t=new FileReader;t.addEventListener("load",()=>{this.imageToShow=t.result},!1),e&&t.readAsDataURL(e)}getImage(e,t){this.loading=!0,this.service.download(e,t,!1).subscribe(e=>{this.createImageFromBlob(e),this.loading=!1},e=>{this.loading=!1,this.error(e)})}close(){this.open=!1}error(e){this.message=A.b.getMessageFromError(e)}}V.ɵfac=function(e){return new(e||V)(n.fc(E),n.fc(D.a))},V.ɵcmp=n.Zb({type:V,selectors:[["image-preview-modal"]],decls:7,vars:3,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"image-preview-container"],[1,"fa","fa-times","btn","btn-close",2,"min-width","0",3,"click"],[1,"image-container"],["style","text-align: left;",4,"ngIf"],["class","image-preview img-responsive center-block","alt","Image",3,"src",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[2,"text-align","left"],["alt","Image",1,"image-preview","img-responsive","center-block",3,"src"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.Rc(1,_,8,1,"div",1),n.kc(2,"div",2),n.kc(3,"i",3),n.sc("click",(function(){return t.bsModalRef.hide()})),n.jc(),n.kc(4,"div",4),n.Rc(5,G,2,0,"p",5),n.Rc(6,z,2,3,"img",6),n.jc(),n.jc(),n.jc()),2&e&&(n.Tb(1),n.Ac("ngIf",null!=t.message),n.Tb(4),n.Ac("ngIf",t.loading),n.Tb(1),n.Ac("ngIf",!t.loading))},directives:[i.k],pipes:[$.a],encapsulation:2});var q=c(25);class B{}const H=["Natural Color RGB","Thermal","Red Edge","Near Infra Red","LiDAR","Other"];class J{constructor(e){this.el=e}onKeyDown(e){let t=e;if(this.OnlyNumber){if(-1!==[46,8,9,27,13,110,190].indexOf(t.keyCode)||65==t.keyCode&&!0===t.ctrlKey||67==t.keyCode&&!0===t.ctrlKey||88==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39)return;(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}}}J.ɵfac=function(e){return new(e||J)(n.fc(n.r))},J.ɵdir=n.ac({type:J,selectors:[["","OnlyNumber",""]],hostBindings:function(e,t){1&e&&n.sc("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{OnlyNumber:"OnlyNumber"}});var W=c(69);function Z(e,t){if(1&e&&(n.kc(0,"div",50),n.kc(1,"div",51),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",52),n.kc(5,"div"),n.kc(6,"p",53),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(7),n.Uc(e.message)}}function K(e,t){if(1&e&&(n.kc(0,"option",54),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.oid),n.Tb(1),n.Uc(e.displayLabel)}}function Y(e,t){if(1&e){const e=n.lc();n.kc(0,"div",10),n.kc(1,"label",19),n.Tc(2,"Other name"),n.jc(),n.kc(3,"input",55),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().metaObject.platform.otherName=t})),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(3),n.Ac("ngModel",e.metaObject.platform.otherName)}}function Q(e,t){if(1&e&&(n.kc(0,"option",54),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.oid),n.Tb(1),n.Uc(e.displayLabel)}}function X(e,t){if(1&e){const e=n.lc();n.kc(0,"div",10),n.kc(1,"label",56),n.Tc(2,"Other name"),n.jc(),n.kc(3,"input",57),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().metaObject.sensor.otherName=t})),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(3),n.Ac("ngModel",e.metaObject.sensor.otherName)}}function ee(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"boolean-field",58),n.sc("valueChange",(function(c){n.Lc(e);const i=t.$implicit;return n.uc().updateSelectedWaveLength(i,c)})),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=n.uc();n.Tb(1),n.Ac("value",c.metaObject.sensor.wavelength&&-1!==c.metaObject.sensor.wavelength.indexOf(e))("label",e)("disabled",c.metaObject.sensor.name!==c.otherSensorId)}}class te{constructor(e,t){this.bsModalRef=e,this.service=t,this.message=null,this.disabled=!1,this.metaObject={collectionId:"",pointOfContact:{name:"",email:""},platform:{name:"",otherName:"",class:"",type:"",serialNumber:"",faaIdNumber:""},sensor:{name:"",otherName:"",type:"",model:"",wavelength:[],sensorWidth:"",sensorWidthUnits:"mm",sensorHeight:"",sensorHeightUnits:"mm",pixelSizeWidth:"",pixelSizeHeight:""},upload:{dataType:"raw"}},this.sensors=[],this.platforms=[],this.wavelengths=H,this.otherSensorId="",this.otherPlatformId=""}init(e){this.collectionId=e,this.onMetadataChange=new q.b,this.service.getMetadataOptions(this.collectionId).then(e=>{this.sensors=e.sensors,this.platforms=e.platforms,this.metaObject.pointOfContact.name=e.name,this.metaObject.pointOfContact.email=e.email,this.metaObject.sensor.name=e.sensor,this.metaObject.platform.name=e.platform,this.sensors.forEach(e=>{"OTHER"===e.name&&(this.otherSensorId=e.oid)}),this.platforms.forEach(e=>{"OTHER"===e.name&&(this.otherPlatformId=e.oid)}),this.handleSensorSelect(),this.handlePlatformSelect()}).catch(e=>{this.error(e)})}handleSensorSelect(){if(null!=this.metaObject.sensor.name&&""!==this.metaObject.sensor.name&&this.metaObject.sensor.name!==this.otherSensorId){const e=this.getSelectedSensor();this.metaObject.sensor.type=e.sensorType,this.metaObject.sensor.model=e.model,this.metaObject.sensor.wavelength=[...e.waveLength],console.log(this.metaObject.sensor)}}handlePlatformSelect(){if(null!=this.metaObject.platform.name&&""!==this.metaObject.platform.name&&this.metaObject.platform.name!==this.otherPlatformId){const e=this.getSelectedPlatform();this.metaObject.platform.type=e.platformType}}getSelectedSensor(){var e=this.sensors.findIndex(e=>e.oid===this.metaObject.sensor.name);return this.sensors[e]}getSelectedPlatform(){var e=this.platforms.findIndex(e=>e.oid===this.metaObject.platform.name);return this.platforms[e]}updateSelectedWaveLength(e,t){const c=this.metaObject.sensor.wavelength.indexOf(e);t?c<0&&this.metaObject.sensor.wavelength.push(e):c>-1&&this.metaObject.sensor.wavelength.splice(c,1)}handleSubmit(){this.metaObject.collectionId=this.collectionId,this.service.submitCollectionMetadata(this.metaObject).then(()=>{this.bsModalRef.hide(),this.onMetadataChange.next(this.collectionId)}).catch(e=>{this.error(e)})}error(e){this.message=A.b.getMessageFromError(e)}}te.ɵfac=function(e){return new(e||te)(n.fc(D.a),n.fc(E))},te.ɵcmp=n.Zb({type:te,selectors:[["metadata-modal"]],decls:110,vars:52,consts:[[1,"modal-header","text-center"],[1,"row"],[1,"col-md-12"],[1,"modal-form"],["ngForm","ngForm"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"form-group"],["for","pointOfContact.name"],["type","text","name","pointOfContact.name",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","pointOfContact.email"],["type","text","name","pointOfContact.email",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","platform.name"],["name","platform.name","type","input","required","",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["for","platform.class"],["type","text","name","platform.class","required","",3,"ngModel","maxlength","disabled","ngModelChange"],["for","platform.type"],["name","platform.type","type","input","required","",1,"",3,"ngModel","disabled","ngModelChange"],["for","platform.serialNumber"],["type","text","name","platform.serialNumber",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","platform.faaIdNumber"],["type","text","name","platform.faaIdNumber",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","sensor.name"],["name","sensor.name","type","input","required","",3,"ngModel","ngModelChange","change"],["for","sensor.type"],["type","text","name","sensor.type",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","sensor.model"],["type","text","name","sensor.model",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","sensor.wavelength"],[4,"ngFor","ngForOf"],["for","sensor.sensorWidth"],["type","number","name","sensor.sensorWidth","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],["name","sensor.sensorWidthUnits","type","input","required","","disabled","",3,"ngModel","ngModelChange"],["value","mm","selected",""],["for","sensor.sensorHeight"],["type","number","name","sensor.sensorHeight","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],["name","sensor.sensorHeightUnits","type","input","required","","disabled","",3,"ngModel","ngModelChange"],["for","sensor.pixelSizeWidth"],["type","number","name","sensor.pixelSizeWidth","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],["for","sensor.pixelSizeHeight"],["type","number","name","sensor.pixelSizeHeight","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],["type","text","name","platform.otherName","maxlength","20","required","",3,"ngModel","ngModelChange"],["for","sensor.class"],["type","text","name","sensor.otherName","maxlength","20","required","",3,"ngModel","ngModelChange"],[3,"value","label","disabled","valueChange"]],template:function(e,t){if(1&e&&(n.kc(0,"div",0),n.kc(1,"h2"),n.Tc(2,"Collection Metadata"),n.jc(),n.jc(),n.kc(3,"div",1),n.kc(4,"div",2),n.kc(5,"form",3,4),n.kc(7,"div",5),n.Rc(8,Z,8,1,"div",6),n.kc(9,"div",7),n.kc(10,"div",8),n.Tc(11,"Point Of Contact"),n.jc(),n.kc(12,"div",9),n.kc(13,"div",10),n.kc(14,"label",11),n.Tc(15,"Name"),n.jc(),n.kc(16,"input",12),n.sc("ngModelChange",(function(e){return t.metaObject.pointOfContact.name=e})),n.jc(),n.jc(),n.kc(17,"div",10),n.kc(18,"label",13),n.Tc(19,"Email"),n.jc(),n.kc(20,"input",14),n.sc("ngModelChange",(function(e){return t.metaObject.pointOfContact.email=e})),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(21,"div",7),n.kc(22,"div",8),n.Tc(23,"Platform"),n.jc(),n.kc(24,"div",9),n.kc(25,"div",10),n.kc(26,"label",15),n.Tc(27,"Name"),n.jc(),n.kc(28,"select",16),n.sc("ngModelChange",(function(e){return t.metaObject.platform.name=e}))("change",(function(){return t.handlePlatformSelect()})),n.gc(29,"option"),n.Rc(30,K,2,2,"option",17),n.jc(),n.jc(),n.Rc(31,Y,4,1,"div",18),n.kc(32,"div",10),n.kc(33,"label",19),n.Tc(34,"Class"),n.jc(),n.kc(35,"input",20),n.sc("ngModelChange",(function(e){return t.metaObject.platform.class=e})),n.jc(),n.jc(),n.kc(36,"div",10),n.kc(37,"label",21),n.Tc(38,"Type"),n.jc(),n.kc(39,"select",22),n.sc("ngModelChange",(function(e){return t.metaObject.platform.type=e})),n.gc(40,"option"),n.kc(41,"option"),n.Tc(42,"Fixed Wing"),n.jc(),n.kc(43,"option"),n.Tc(44,"Hybrid"),n.jc(),n.jc(),n.jc(),n.kc(45,"div",10),n.kc(46,"label",23),n.Tc(47,"Serial Number"),n.jc(),n.kc(48,"input",24),n.sc("ngModelChange",(function(e){return t.metaObject.platform.serialNumber=e})),n.jc(),n.jc(),n.kc(49,"div",10),n.kc(50,"label",25),n.Tc(51,"FAA Id Number"),n.jc(),n.kc(52,"input",26),n.sc("ngModelChange",(function(e){return t.metaObject.platform.faaIdNumber=e})),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(53,"div",7),n.kc(54,"div",8),n.Tc(55,"Sensor"),n.jc(),n.kc(56,"div",9),n.kc(57,"div",10),n.kc(58,"label",27),n.Tc(59,"Name"),n.jc(),n.kc(60,"select",28),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.name=e}))("change",(function(){return t.handleSensorSelect()})),n.gc(61,"option"),n.Rc(62,Q,2,2,"option",17),n.jc(),n.jc(),n.Rc(63,X,4,1,"div",18),n.kc(64,"div",10),n.kc(65,"label",29),n.Tc(66,"Type"),n.jc(),n.kc(67,"input",30),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.type=e})),n.jc(),n.jc(),n.kc(68,"div",10),n.kc(69,"label",31),n.Tc(70,"Model"),n.jc(),n.kc(71,"input",32),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.model=e})),n.jc(),n.jc(),n.kc(72,"div",10),n.kc(73,"label",33),n.Tc(74,"Wave Length"),n.jc(),n.Rc(75,ee,2,3,"div",34),n.jc(),n.kc(76,"div",10),n.kc(77,"label",35),n.Tc(78,"Sensor Width"),n.jc(),n.kc(79,"input",36),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.sensorWidth=e})),n.jc(),n.jc(),n.kc(80,"div",10),n.kc(81,"label",35),n.Tc(82,"Sensor Width Units"),n.jc(),n.kc(83,"select",37),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.sensorWidthUnits=e})),n.kc(84,"option",38),n.Tc(85,"Millimeters"),n.jc(),n.jc(),n.jc(),n.kc(86,"div",10),n.kc(87,"label",39),n.Tc(88,"Sensor Height"),n.jc(),n.kc(89,"input",40),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.sensorHeight=e})),n.jc(),n.jc(),n.kc(90,"div",10),n.kc(91,"label",35),n.Tc(92,"Sensor Height Units"),n.jc(),n.kc(93,"select",41),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.sensorHeightUnits=e})),n.kc(94,"option",38),n.Tc(95,"Millimeters"),n.jc(),n.jc(),n.jc(),n.kc(96,"div",10),n.kc(97,"label",42),n.Tc(98,"Pixel Size Width"),n.jc(),n.kc(99,"input",43),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.pixelSizeWidth=e})),n.jc(),n.jc(),n.kc(100,"div",10),n.kc(101,"label",44),n.Tc(102,"Pixel Size Height"),n.jc(),n.kc(103,"input",45),n.sc("ngModelChange",(function(e){return t.metaObject.sensor.pixelSizeHeight=e})),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(104,"div",46),n.kc(105,"button",47),n.sc("click",(function(){return t.bsModalRef.hide()})),n.Tc(106,"Cancel"),n.jc(),n.kc(107,"button",48),n.sc("click",(function(){return t.handleSubmit()})),n.gc(108,"i",49),n.Tc(109," Submit "),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.Jc(6);n.Tb(8),n.Ac("ngIf",null!=t.message),n.Tb(8),n.Ac("ngModel",t.metaObject.pointOfContact.name)("maxlength",100)("required",!1)("disabled",!1),n.Tb(4),n.Ac("ngModel",t.metaObject.pointOfContact.email)("maxlength",255)("required",!1)("disabled",!1),n.Tb(8),n.Ac("ngModel",t.metaObject.platform.name),n.Tb(2),n.Ac("ngForOf",t.platforms),n.Tb(1),n.Ac("ngIf",t.metaObject.platform.name===t.otherPlatformId),n.Tb(4),n.Ac("ngModel",t.metaObject.platform.class)("maxlength",20)("disabled",!1),n.Tb(4),n.Ac("ngModel",t.metaObject.platform.type)("disabled",t.metaObject.platform.name!==t.otherPlatformId),n.Tb(9),n.Ac("ngModel",t.metaObject.platform.serialNumber)("maxlength",50)("required",!0)("disabled",!1),n.Tb(4),n.Ac("ngModel",t.metaObject.platform.faaIdNumber)("maxlength",30)("required",!0)("disabled",!1),n.Tb(8),n.Ac("ngModel",t.metaObject.sensor.name),n.Tb(2),n.Ac("ngForOf",t.sensors),n.Tb(1),n.Ac("ngIf",t.metaObject.sensor.name===t.otherSensorId),n.Tb(4),n.Ac("ngModel",t.metaObject.sensor.type)("maxlength",20)("required",!0)("disabled",t.metaObject.sensor.name!==t.otherSensorId),n.Tb(4),n.Ac("ngModel",t.metaObject.sensor.model)("maxlength",20)("required",!0)("disabled",t.metaObject.sensor.name!==t.otherSensorId),n.Tb(4),n.Ac("ngForOf",t.wavelengths),n.Tb(4),n.Ac("ngModel",t.metaObject.sensor.sensorWidth)("required",!0)("disabled",!1),n.Tb(4),n.Ac("ngModel",t.metaObject.sensor.sensorWidthUnits),n.Tb(6),n.Ac("ngModel",t.metaObject.sensor.sensorHeight)("required",!0)("disabled",!1),n.Tb(4),n.Ac("ngModel",t.metaObject.sensor.sensorHeightUnits),n.Tb(6),n.Ac("ngModel",t.metaObject.sensor.pixelSizeWidth)("required",!0)("disabled",!1),n.Tb(4),n.Ac("ngModel",t.metaObject.sensor.pixelSizeHeight)("required",!0)("disabled",!1),n.Tb(4),n.Ac("disabled",!e.valid)}},directives:[a.r,a.i,a.j,i.k,a.a,a.h,a.k,a.d,a.o,a.p,a.l,a.q,i.j,a.m,J,W.a],encapsulation:2});var ce=c(85);class ne{constructor(e,t,c,n,i,s,a){this.root=e,this.leaf=t,this.drillable=c,this.expandable=n,this.uploadable=i,this.processable=s,this.childLabel=a}}class ie{constructor(){this.cache={},this.cache.Site=new ne(!0,!1,!0,!1,!1,!1,"Projects"),this.cache.Project=new ne(!1,!1,!0,!1,!1,!1,"Missions"),this.cache.Mission=new ne(!1,!1,!1,!0,!1,!1,"Collections"),this.cache.Collection=new ne(!1,!0,!1,!1,!1,!0,"Images"),this.cache.folder=new ne(!1,!0,!1,!1,!0,!1,""),this.cache.raw=new ne(!1,!1,!1,!1,!0,!1,""),this.cache.accessible=new ne(!1,!1,!1,!1,!0,!1,"")}getMetadata(e){return this.cache[e.type]}getTypeContainsFolders(e){return"Collection"===e.type}isUploadable(e){return null!=this.cache[e]&&this.cache[e].uploadable}hasExtraField(e,t){return"Collection"===e&&("platform"===t||"sensor"===t)}isProcessable(e){return null!=this.cache[e]&&this.cache[e].processable}getUploadTarget(e){return"Imagery"===e?"imagery":"raw"}getHierarchy(){return["Site","Project","Mission","Collection"]}}function se(e,t){if(1&e&&(n.kc(0,"div",3),n.kc(1,"div",4),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",5),n.kc(5,"div"),n.kc(6,"p",6),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(7),n.Uc(e.message)}}function ae(e,t){1&e&&n.gc(0,"span",25)}function oe(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.Tc(2),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(2),n.Vc(" ",e.name,"")}}function le(e,t){if(1&e&&(n.kc(0,"li",34),n.kc(1,"a",35),n.gc(2,"img",36),n.kc(3,"div",37),n.kc(4,"h4",38),n.Tc(5),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=t.$implicit,c=n.uc(4);n.Tb(2),n.Ac("src",c.context+"/net/geoprism/images/thumbnail-default.png",n.Nc),n.Tb(3),n.Uc(e.name)}}function re(e,t){if(1&e&&(n.kc(0,"div",31),n.kc(1,"ul",32),n.Rc(2,le,6,2,"li",33),n.jc(),n.jc()),2&e){const e=n.uc(3);n.Tb(2),n.Ac("ngForOf",e.page.results)}}function de(e,t){if(1&e&&(n.kc(0,"li",34),n.kc(1,"a",35),n.gc(2,"img",36),n.vc(3,"safeHtml"),n.kc(4,"div",37),n.kc(5,"h4",38),n.Tc(6),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=t.$implicit,c=n.uc(4);n.Tb(2),n.Ac("src",null!=c.thumbnails[e.key]?n.wc(3,2,c.thumbnails[e.key]):c.context+"/net/geoprism/images/thumbnail-default.png",n.Nc),n.Tb(4),n.Uc(e.name)}}function ue(e,t){if(1&e&&(n.kc(0,"div",31),n.kc(1,"ul",32),n.Rc(2,de,7,4,"li",33),n.jc(),n.jc()),2&e){const e=n.uc(3);n.Tb(2),n.Ac("ngForOf",e.page.results)}}function pe(e,t){if(1&e){const e=n.lc();n.kc(0,"input",42),n.sc("change",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc(4).toggleExcludeImage(t,c)})),n.jc()}if(2&e){const e=n.uc().$implicit;n.Ac("checked",e.exclude)}}ie.ɵfac=function(e){return new(e||ie)},ie.ɵprov=n.bc({token:ie,factory:ie.ɵfac});const he=function(e,t){return{"card-disabled":e,"non-clickable":t}},ge=function(e){return{"img-disabled":e}};function me(e,t){if(1&e){const e=n.lc();n.kc(0,"li",34),n.kc(1,"a",39),n.Rc(2,pe,1,1,"input",40),n.kc(3,"img",41),n.sc("click",(function(c){n.Lc(e);const i=t.$implicit,s=n.uc(4);return!!s.enableSelectableImages&&s.toggleExcludeImage(c,i)})),n.vc(4,"safeHtml"),n.jc(),n.kc(5,"div",37),n.kc(6,"h4",38),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=n.uc(4);n.Tb(1),n.Ac("ngClass",n.Fc(7,he,e.exclude,!c.enableSelectableImages)),n.Tb(1),n.Ac("ngIf",c.enableSelectableImages),n.Tb(1),n.Ac("ngClass",n.Ec(10,ge,e.exclude))("src",null!=c.thumbnails[e.key]?n.wc(4,5,c.thumbnails[e.key]):c.context+"/net/geoprism/images/thumbnail-default.png",n.Nc),n.Tb(4),n.Vc(" ",e.name," ")}}const fe=function(e,t,c){return{itemsPerPage:e,currentPage:t,totalItems:c}};function be(e,t){if(1&e&&(n.kc(0,"div",31),n.kc(1,"ul",32),n.Rc(2,me,8,12,"li",33),n.vc(3,"paginate"),n.jc(),n.jc()),2&e){const e=n.uc(3);n.Tb(2),n.Ac("ngForOf",n.xc(3,1,e.page.results,n.Gc(4,fe,e.page.pageSize,e.page.pageNumber,e.page.count)))}}function ke(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"div",7),n.gc(2,"div",43),n.kc(3,"div",44),n.kc(4,"h3"),n.Tc(5),n.kc(6,"a",45),n.sc("click",(function(){n.Lc(e);const t=n.uc(4);return t.handleDownloadVideo(t.video.src)})),n.gc(7,"i",46),n.jc(),n.kc(8,"a",47),n.sc("click",(function(){return n.Lc(e),n.uc(4).closeVideo()})),n.gc(9,"i",48),n.jc(),n.jc(),n.jc(),n.gc(10,"div",43),n.jc(),n.kc(11,"div",7),n.gc(12,"div",43),n.kc(13,"div",44),n.kc(14,"video",49),n.gc(15,"source",50),n.Tc(16," Browser not supported "),n.jc(),n.jc(),n.gc(17,"div",43),n.jc(),n.jc()}if(2&e){const e=n.uc(4);n.Tb(5),n.Vc(" ",e.video.name," "),n.Tb(10),n.Ac("src",e.video.src,n.Nc)}}function ve(e,t){if(1&e){const e=n.lc();n.kc(0,"li",34),n.kc(1,"a",51),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(4).showVideo(c)})),n.gc(2,"img",52),n.kc(3,"div",37),n.kc(4,"h4",38),n.Tc(5),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=n.uc(4);n.Tb(2),n.Ac("src",c.context+"/net/geoprism/images/thumbnail-video.png",n.Nc),n.Tb(3),n.Uc(e.name)}}function je(e,t){if(1&e&&(n.kc(0,"div"),n.Rc(1,ke,18,2,"div",2),n.kc(2,"div",31),n.kc(3,"ul",32),n.Rc(4,ve,6,2,"li",33),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(3);n.Tb(1),n.Ac("ngIf",null!==e.video.src),n.Tb(3),n.Ac("ngForOf",e.page.results)}}function Te(e,t){if(1&e){const e=n.lc();n.kc(0,"tab",26),n.sc("selectTab",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).onSelect(c)})),n.kc(1,"div",27),n.Rc(2,re,3,1,"div",28),n.Rc(3,ue,3,1,"div",29),n.Rc(4,be,4,8,"div",29),n.Rc(5,je,5,2,"div",30),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Ac("heading",e.name),n.Tb(1),n.Ac("ngSwitch",e.name),n.Tb(2),n.Ac("ngSwitchCase","ortho"),n.Tb(1),n.Ac("ngSwitchCase","raw"),n.Tb(1),n.Ac("ngSwitchCase","video")}}function ye(e,t){if(1&e){const e=n.lc();n.kc(0,"pagination-controls",53),n.sc("pageChange",(function(t){return n.Lc(e),n.uc(2).onPageChange(t)})),n.jc()}}function Ce(e,t){if(1&e&&(n.kc(0,"div",54),n.kc(1,"p"),n.Tc(2),n.jc(),n.kc(3,"p"),n.Tc(4,"See this process on "),n.kc(5,"a",55),n.Tc(6,"your tasks page"),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(2),n.Uc(e.statusMessage)}}function Me(e,t){if(1&e){const e=n.lc();n.kc(0,"button",56),n.sc("click",(function(){return n.Lc(e),n.uc(2).handleSetMetadata()})),n.gc(1,"i",57),n.Tc(2," Add metadata "),n.jc()}if(2&e){const e=n.uc(2);n.Ac("disabled",e.processRunning)}}function we(e,t){if(1&e){const e=n.lc();n.kc(0,"button",58),n.sc("click",(function(){return n.Lc(e),n.uc(2).handleDownload()})),n.Tc(1," Download all "),n.jc()}if(2&e){const e=n.uc(2);n.Ac("disabled",e.processRunning)}}const Oe=function(e){return{"fa-spin":e}};function Se(e,t){if(1&e){const e=n.lc();n.kc(0,"button",59),n.sc("click",(function(){return n.Lc(e),n.uc(2).handleRunOrtho()})),n.Tc(1," Reprocess imagery "),n.gc(2,"i",60),n.jc()}if(2&e){const e=n.uc(2);n.Ac("disabled",e.processRunning),n.Tb(2),n.Ac("ngClass",n.Ec(2,Oe,e.processRunning))}}function Ie(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"div",7),n.kc(2,"div",8),n.kc(3,"h2"),n.Tc(4),n.Rc(5,ae,1,0,"span",9),n.jc(),n.jc(),n.jc(),n.kc(6,"div",7),n.kc(7,"div",8),n.kc(8,"ul",10),n.Rc(9,oe,3,1,"li",11),n.jc(),n.jc(),n.jc(),n.kc(10,"div",7),n.kc(11,"div",12),n.kc(12,"tabset",13),n.Rc(13,Te,6,5,"tab",14),n.jc(),n.jc(),n.jc(),n.kc(14,"div",7),n.kc(15,"div",15),n.Rc(16,ye,1,0,"pagination-controls",16),n.Rc(17,Ce,7,1,"div",17),n.kc(18,"div",18),n.kc(19,"div",7),n.kc(20,"div",19),n.Rc(21,Me,3,1,"button",20),n.jc(),n.kc(22,"div",21),n.kc(23,"button",22),n.sc("click",(function(){return n.Lc(e),n.uc().bsModalRef.hide()})),n.Tc(24,"Close"),n.jc(),n.Rc(25,we,2,1,"button",23),n.Rc(26,Se,3,4,"button",24),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(4),n.Vc("",e.entity.name," "),n.Tb(1),n.Ac("ngIf",!e.entity.metadataUploaded),n.Tb(4),n.Ac("ngForOf",e.previous),n.Tb(4),n.Ac("ngForOf",e.folders),n.Tb(3),n.Ac("ngIf","raw"===e.folder.name),n.Tb(1),n.Ac("ngIf",e.showOrthoRerunMessage),n.Tb(4),n.Ac("ngIf",!e.entity.metadataUploaded),n.Tb(4),n.Ac("ngIf",e.processable),n.Tb(1),n.Ac("ngIf",e.processable&&e.enableSelectableImages)}}class Ae{constructor(e,t,c,n){this.service=e,this.metadataService=t,this.modalService=c,this.bsModalRef=n,this.previous=[],this.folders=[],this.thumbnails={},this.processRunning=!1,this.processable=!1,this.enableSelectableImages=!1,this.showOrthoRerunMessage=!1,this.constPageSize=50,this.page=new B,this.video={src:null,name:null},this.context=acp}set initData(e){this.init(e.entity,e.folders,e.previous)}ngOnInit(){this.onNodeChange=new q.b,this.page.count=0,this.page.pageNumber=1,this.page.pageSize=this.constPageSize,this.page.results=[]}init(e,t,c){this.entity=e,this.folders=t,this.previous=[...c],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.folders.length>0&&this.onSelect(this.folders[0]),this.processable=this.metadataService.isProcessable(e.type)}createImageFromBlob(e,t){let c=new FileReader;c.addEventListener("load",()=>{this.thumbnails[t.key]=c.result},!1),e&&c.readAsDataURL(e)}getThumbnail(e){if(null!=e){let t=e.key.substr(0,e.key.lastIndexOf("/")),c=/[^/]*$/.exec(e.key)[0];const n=c.lastIndexOf("."),i=t+"/thumbnails/"+c.substr(0,n)+".png";this.service.download(e.component,i,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}onPageChange(e){this.getData(this.folder.component,this.folder.name,e,this.page.pageSize)}onSelect(e){this.page.results=[],"raw"===e.name?this.enableSelectableImages=!0:this.enableSelectableImages=!1;let t=null,c=null;"raw"===e.name&&(t=null==this.page.pageNumber?1:this.page.pageNumber,c=this.constPageSize),this.folder=e,this.video.src=null,this.video.name=null,this.getData(e.component,e.name,t,c)}getData(e,t,c,n){this.service.getObjects(e,t,c,n).then(e=>{this.page=e;for(let e=0;e<this.page.results.length;++e){let t=this.page.results[e];this.isImage(t)&&this.getThumbnail(t)}})}isImage(e){return-1!==e.name.toLowerCase().indexOf(".png")||-1!==e.name.toLowerCase().indexOf(".jpg")||-1!==e.name.toLowerCase().indexOf(".jpeg")||-1!==e.name.toLowerCase().indexOf(".tif")||-1!==e.name.toLowerCase().indexOf(".tiff")}previewImage(e,t){}toggleExcludeImage(e,t){this.service.setExclude(t.id,!t.exclude).then(e=>{t.exclude=e.exclude})}isProcessable(e){return this.metadataService.isProcessable(e.type)}handleErosPush(){this.processRunning=!0,this.service.pushToEros(this.entity.id).then(e=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})}handleRunOrtho(){event.stopPropagation(),this.confirmModalRef=this.modalService.show(A.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"confirmation-modal"}),this.confirmModalRef.content.message="Running this process will replace all output products for this "+this.entity.type+". Are you sure you want to re-process this data?",this.confirmModalRef.content.type="DANGER",this.confirmModalRef.content.submitText="Run Process",this.confirmModalRef.content.onConfirm.subscribe(e=>{this.processRunning=!0,this.showOrthoRerunMessage=!0,this.service.runOrtho(this.entity.id).then(e=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.folder.component+"&key="+this.folder.name}handleDownloadVideo(e){window.location.href=e}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.folder.component+"&key="+e.key}handleSetMetadata(){let e=this.modalService.show(te,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"});e.content.init(this.entity.id),e.content.onMetadataChange.subscribe(()=>{this.entity.metadataUploaded=!0})}showVideo(e){this.video.name=null,this.video.src=null,setTimeout(()=>{this.video.name=e.name,this.video.src=acp+"/project/download?id="+this.folder.component+"&key="+e.key},200)}closeVideo(){this.video.name=null,this.video.src=null}error(e){this.message=A.b.getMessageFromError(e)}}Ae.ɵfac=function(e){return new(e||Ae)(n.fc(E),n.fc(ie),n.fc(D.b),n.fc(D.a))},Ae.ɵcmp=n.Zb({type:Ae,selectors:[["leaf-modal"]],inputs:{initData:"initData"},features:[n.Sb([A.a])],decls:4,vars:3,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],["class","dot pending","style","margin-left: 0;margin-bottom: 5px;",4,"ngIf"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"col-sm-12",2,"padding","0"],[1,"nav-full-width"],[3,"heading","selectTab",4,"ngFor","ngForOf"],[1,"col-sm-12"],[3,"pageChange",4,"ngIf"],["style","text-align:right;padding-right:20px;",4,"ngIf"],[1,"btn-holder",2,"margin","20px 20px 10px 20px"],[1,"col-sm-2"],["type","button","class","btn btn-warning",3,"disabled","click",4,"ngIf"],[1,"col-md-10",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","button","class","btn btn-secondary","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],["class","btn btn-primary","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],[1,"dot","pending",2,"margin-left","0","margin-bottom","5px"],[3,"heading","selectTab"],[3,"ngSwitch"],["class","image-list-container",4,"ngSwitchDefault"],["class","image-list-container",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3",4,"ngFor","ngForOf"],[1,"list-group-item","col-xs-3"],[1,"thumbnail","non-clickable"],["alt","Image",3,"src"],[1,"caption"],[1,"media-heading"],[1,"thumbnail",3,"ngClass"],["type","checkbox","class","x-box",3,"checked","change",4,"ngIf"],["alt","Image",2,"max-height","150px",3,"ngClass","src","click"],["type","checkbox",1,"x-box",3,"checked","change"],[1,"col-md-1"],[1,"col-md-10"],[3,"click"],[1,"fas","fa-download"],[1,"pull-right",3,"click"],["aria-hidden","true",1,"fa","fa-times"],["controls","",2,"width","100%"],["type","video/mp4",3,"src"],[1,"thumbnail",3,"click"],["alt","Video",3,"src"],[3,"pageChange"],[2,"text-align","right","padding-right","20px"],["routerlink","/site/tasks","routerlinkactive","active","href","#/site/tasks"],["type","button",1,"btn","btn-warning",3,"disabled","click"],[1,"fa","fa-plus",2,"color","white"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"disabled","click"],[1,"btn","btn-primary",2,"margin-left","5px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-sync-alt",2,"color","white","vertical-align","middle","margin-left","10px",3,"ngClass"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.kc(1,"div"),n.Rc(2,se,8,1,"div",1),n.Rc(3,Ie,27,9,"div",2),n.jc(),n.jc()),2&e&&(n.Ac("@fadeInOnEnter",void 0),n.Tb(2),n.Ac("ngIf",null!=t.message),n.Tb(1),n.Ac("ngIf",null!=t.entity))},directives:[i.k,i.j,u.c,u.a,i.l,i.n,i.m,i.i,h.c],pipes:[$.a,h.b],encapsulation:2,data:{animation:[Object(ce.c)(),Object(ce.d)(),Object(ce.e)(),Object(ce.f)()]}});class xe{constructor(e,t){this.http=e,this.eventService=t}getProducts(e){let t=new v.g;return t=t.set("id",e),this.http.get(acp+"/product/get-all",{params:t}).toPromise()}getDetail(e,t,c){let n=new v.g;return n=n.set("id",e),n=n.set("pageNumber",t.toString()),n=n.set("pageSize",c.toString()),this.eventService.start(),this.http.get(acp+"/product/detail",{params:n}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}togglePublish(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/toggle-publish",JSON.stringify({id:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}}function Re(e,t){if(1&e&&(n.kc(0,"div",5),n.kc(1,"div",6),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",7),n.kc(5,"div"),n.kc(6,"p",8),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(7),n.Uc(e.message)}}function Pe(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.Tc(2),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(2),n.Vc(" ",e.name,"")}}function Fe(e,t){if(1&e){const e=n.lc();n.kc(0,"div",23),n.kc(1,"a",24),n.kc(2,"img",25),n.sc("error",(function(t){return n.Lc(e),n.uc(3).getDefaultImgURL(t)})),n.vc(3,"safeHtml"),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc(3);n.Tb(2),n.Ac("src",n.wc(3,1,e.thumbnails[e.product.id]),n.Nc)}}function Le(e,t){if(1&e){const e=n.lc();n.kc(0,"div",23),n.kc(1,"a",27),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc(3).previewImage(t)})),n.kc(2,"img",28),n.sc("error",(function(t){return n.Lc(e),n.uc(4).getDefaultImgURL(t)})),n.vc(3,"safeHtml"),n.jc(),n.kc(4,"div",29),n.kc(5,"h4",30),n.Tc(6),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc().$implicit,t=n.uc(3);n.Tb(2),n.Ac("src",n.wc(3,2,t.thumbnails[e.id]),n.Nc),n.Tb(4),n.Uc(e.name)}}function Ne(e,t){if(1&e&&(n.kc(0,"li",26),n.Rc(1,Le,7,4,"div",13),n.jc()),2&e){const e=t.$implicit,c=n.uc(3);n.Tb(1),n.Ac("ngIf",null!=c.thumbnails[e.id])}}xe.ɵfac=function(e){return new(e||xe)(n.oc(v.c),n.oc(N.a))},xe.ɵprov=n.bc({token:xe,factory:xe.ɵfac});const Ue=function(e,t,c){return{itemsPerPage:e,currentPage:t,totalItems:c}};function Ee(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"div",9),n.kc(2,"div",10),n.kc(3,"h2"),n.Tc(4),n.jc(),n.jc(),n.jc(),n.kc(5,"div",9),n.kc(6,"div",10),n.kc(7,"ul",11),n.Rc(8,Pe,3,1,"li",12),n.jc(),n.jc(),n.jc(),n.kc(9,"div",9),n.kc(10,"div",10),n.Rc(11,Fe,4,3,"div",13),n.jc(),n.jc(),n.kc(12,"div",9),n.kc(13,"div",10),n.kc(14,"label"),n.Tc(15,"Pilot Name: "),n.jc(),n.Tc(16),n.jc(),n.jc(),n.kc(17,"div",9),n.kc(18,"div",10),n.kc(19,"label"),n.Tc(20,"Date/Time: "),n.jc(),n.Tc(21),n.jc(),n.jc(),n.kc(22,"div",9),n.kc(23,"div",10),n.kc(24,"label"),n.Tc(25,"Sensor Information:"),n.jc(),n.Tc(26),n.jc(),n.jc(),n.kc(27,"div",14),n.kc(28,"div",10),n.kc(29,"div",15),n.kc(30,"h3"),n.Tc(31,"Raw Images"),n.jc(),n.kc(32,"ul",16),n.Rc(33,Ne,2,1,"li",17),n.vc(34,"paginate"),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(35,"div",9),n.kc(36,"pagination-controls",18),n.sc("pageChange",(function(t){return n.Lc(e),n.uc(2).onPageChange(t)})),n.jc(),n.jc(),n.kc(37,"div",14),n.kc(38,"div",19),n.kc(39,"button",20),n.sc("click",(function(){return n.Lc(e),n.uc(2).bsModalRef.hide()})),n.Tc(40,"Close"),n.jc(),n.kc(41,"button",21),n.sc("click",(function(){return n.Lc(e),n.uc(2).handleDownload()})),n.Tc(42,"Download ODM Files"),n.jc(),n.kc(43,"button",22),n.sc("click",(function(){return n.Lc(e),n.uc(2).handleGoto()})),n.Tc(44," Collection Details "),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc(2);n.Tb(4),n.Uc(e.product.name),n.Tb(4),n.Ac("ngForOf",e.product.entities),n.Tb(3),n.Ac("ngIf",null!=e.thumbnails[e.product.id]),n.Tb(5),n.Vc("   ",e.product.pilotName," "),n.Tb(5),n.Vc("   ",e.product.dateTime," "),n.Tb(5),n.Vc("   ",e.product.sensor," "),n.Tb(7),n.Ac("ngForOf",n.xc(34,7,e.product.page.resultSet,n.Gc(10,Ue,e.product.page.pageSize,e.product.page.pageNumber,e.product.page.count)))}}function De(e,t){if(1&e&&(n.kc(0,"div",2),n.kc(1,"div"),n.Rc(2,Re,8,1,"div",3),n.Rc(3,Ee,45,14,"div",4),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(2),n.Ac("ngIf",null!=e.message),n.Tb(1),n.Ac("ngIf",null!=e.product)}}function $e(e,t){if(1&e&&n.gc(0,"leaf-modal",31),2&e){const e=n.uc();n.Ac("initData",e.initData)}}class _e{constructor(e,t,c,n){this.pService=e,this.service=t,this.bsModalRef=c,this.modalService=n,this.thumbnails={},this.items=[],this.showSite=!1}ngOnInit(){}init(e){this.product=e,this.product.imageKey&&this.getThumbnail(this.product.id,this.product.imageKey),this.product.page.resultSet.forEach(e=>{this.getThumbnail(e.id,e.key)})}createImageFromBlob(e,t){let c=new FileReader;c.addEventListener("load",()=>{this.thumbnails[t]=c.result},!1),e&&c.readAsDataURL(e)}getThumbnail(e,t){const c=this.product.entities[this.product.entities.length-1].id,n=t.substr(0,t.lastIndexOf("/")),i=/[^/]*$/.exec(t)[0],s=i.lastIndexOf("."),a=n+"/thumbnails/"+i.substr(0,s)+".png";this.service.download(c,a,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}onPageChange(e){this.pService.getDetail(this.product.id,e,20).then(e=>{this.init(e)})}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleGoto(){const e=this.product.entities[this.product.entities.length-1],t=this.product.entities;this.service.getItems(e.id,null).then(c=>{this.initData={entity:e,folders:c,previous:t},this.showSite=!0})}previewImage(e){this.rawImagePreviewModal=this.modalService.show(V,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.rawImagePreviewModal.content.init(e.component,e.key)}handleDownload(){window.location.href=acp+"/product/get-odm-all?id="+this.product.id}error(e){this.message=A.b.getMessageFromError(e)}}function Ge(e,t){1&e&&(n.kc(0,"div",3),n.kc(1,"h4"),n.Tc(2,"No data found"),n.jc(),n.jc()),2&e&&n.Ac("@fadeInOnEnter",void 0)}function ze(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.Tc(2),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(2),n.Vc(" ",e.name," ")}}function Ve(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"a",21),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc().previewImage(t)})),n.kc(2,"img",22),n.sc("error",(function(t){return n.Lc(e),n.uc(2).getDefaultImgURL(t)})),n.vc(3,"safeHtml"),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc().$implicit,t=n.uc();n.Tb(2),n.Ac("src",n.wc(3,1,t.thumbnails[e.id]),n.Nc)}}function qe(e,t){1&e&&n.gc(0,"i",23),2&e&&n.Ac("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function Be(e,t){if(1&e){const e=n.lc();n.kc(0,"li",14),n.kc(1,"a",24),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc().handleTogglePublish(t)})),n.Tc(2,"Unpublish"),n.jc(),n.jc()}}function He(e,t){if(1&e){const e=n.lc();n.kc(0,"li",14),n.kc(1,"a",25),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc().handleTogglePublish(t)})),n.Tc(2,"Publish"),n.jc(),n.jc()}}_e.ɵfac=function(e){return new(e||_e)(n.fc(xe),n.fc(E),n.fc(D.a),n.fc(D.b))},_e.ɵcmp=n.Zb({type:_e,selectors:[["product-modal"]],features:[n.Sb([Ae])],decls:2,vars:2,consts:[["class","modal-body","style","padding-bottom: 0;",4,"ngIf"],[3,"initData",4,"ngIf"],[1,"modal-body",2,"padding-bottom","0"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],["class","",4,"ngIf"],[1,"row",2,"background-color","#ececec"],["id","image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3","style","background:none;",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 20px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[1,""],[1,"thumbnail","non-clickable"],["alt","Image",1,"",3,"src","error"],[1,"list-group-item","col-xs-3",2,"background","none"],[1,"thumbnail",3,"click"],["alt","Image",3,"src","error"],[1,"caption"],[1,"media-heading"],[3,"initData"]],template:function(e,t){1&e&&(n.Rc(0,De,4,2,"div",0),n.Rc(1,$e,1,1,"leaf-modal",1)),2&e&&(n.Ac("ngIf",!t.showSite),n.Tb(1),n.Ac("ngIf",t.showSite))},directives:[i.k,i.j,h.c,Ae],pipes:[h.b,$.a],encapsulation:2,data:{animation:[Object(ce.c)(),Object(ce.d)(),Object(ce.a)()]}});const Je=function(e){return{active:e}},We=function(){return{active:!1}};function Ze(e,t){if(1&e){const e=n.lc();n.kc(0,"div",4),n.kc(1,"div",5),n.kc(2,"div",6),n.kc(3,"h5",7),n.Tc(4),n.jc(),n.kc(5,"ul",8),n.Rc(6,ze,3,1,"li",9),n.jc(),n.kc(7,"div",10),n.Rc(8,Ve,4,3,"div",11),n.jc(),n.kc(9,"div",12),n.kc(10,"ul",13),n.kc(11,"li",14),n.kc(12,"a",15),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().handleMapIt(c)})),n.Tc(13,"Map It"),n.jc(),n.Rc(14,qe,1,2,"i",16),n.jc(),n.kc(15,"li",14),n.kc(16,"a",17),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().handlePointcloud(c)})),n.Tc(17,"3D"),n.jc(),n.jc(),n.kc(18,"li",14),n.kc(19,"a",18),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().handleGetInfo(c)})),n.Tc(20,"Get Info"),n.jc(),n.jc(),n.kc(21,"li",14),n.kc(22,"a",19),n.sc("click",(function(c){n.Lc(e);const i=t.$implicit;return n.uc().handleDelete(i,c)})),n.Tc(23,"Delete"),n.jc(),n.jc(),n.Rc(24,Be,3,0,"li",20),n.Rc(25,He,3,0,"li",20),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=n.uc();n.Tb(1),n.Ac("@fadeInOnEnter",void 0)("@fadeOutOnLeave",void 0),n.Tb(3),n.Vc(" ",e.name," "),n.Tb(2),n.Ac("ngForOf",e.entities),n.Tb(2),n.Ac("ngIf",null!=c.thumbnails[e.id]),n.Tb(4),n.Ac("ngClass",n.Ec(10,Je,e.orthoMapped)),n.Tb(2),n.Ac("ngIf",e.orthoMapped),n.Tb(2),n.Ac("ngClass",n.Dc(12,We)),n.Tb(8),n.Ac("ngIf",e.published),n.Tb(1),n.Ac("ngIf",!e.published)}}class Ke{constructor(e,t,c){this.pService=e,this.mService=t,this.modalService=c,this.toggleMapImage=new n.t,this.products=[],this.thumbnails={}}ngOnChanges(e){this.refreshProducts(e.id.currentValue)}refreshProducts(e){this.products=[],this.thumbnails={},this.pService.getProducts(e).then(e=>{this.products=e,this.products.forEach(e=>{this.getThumbnail(e)})})}createImageFromBlob(e,t){let c=new FileReader;c.addEventListener("load",()=>{this.thumbnails[t.id]=c.result},!1),e&&c.readAsDataURL(e)}getThumbnail(e){if(e.imageKey){const t=e.entities[e.entities.length-1].id,c=e.imageKey.substr(0,e.imageKey.lastIndexOf("/")),n=/[^/]*$/.exec(e.imageKey)[0],i=n.lastIndexOf("."),s=c+"/thumbnails/"+n.substr(0,i)+".png";this.mService.download(t,s,!1).subscribe(t=>{this.createImageFromBlob(t,e)},t=>{console.log(t),this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"})}else this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleMapIt(e){this.toggleMapImage.emit(e)}handlePointcloud(e){let t=e.entities[e.entities.length-1].id;window.open(acp+"/pointcloud/"+t+"/potree")}handleDelete(e,t){t.stopPropagation(),this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.pService.remove(e.id).then(t=>{this.products=this.products.filter(t=>t.id!==e.id)})}previewImage(e){const t=e.entities[e.entities.length-1].id;this.bsModalRef=this.modalService.show(V,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.bsModalRef.content.init(t,e.imageKey)}handleGetInfo(e){this.pService.getDetail(e.id,1,20).then(e=>{this.bsModalRef=this.modalService.show(_e,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}),this.bsModalRef.content.init(e)})}handleTogglePublish(e){this.pService.togglePublish(e.id).then(t=>{const c=e.orthoMapped;c&&this.toggleMapImage.emit(e),e.workspace=t.workspace,e.mapKey=t.mapKey,e.published=t.published,c&&this.toggleMapImage.emit(e)})}}function Ye(e,t){if(1&e&&(n.kc(0,"div",10),n.kc(1,"div",11),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",12),n.kc(5,"div"),n.kc(6,"p",13),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(7),n.Uc(e.message)}}function Qe(e,t){if(1&e&&(n.kc(0,"div",14),n.kc(1,"h3"),n.Tc(2),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(2),n.Vc("Add new ",e.entity.type,"")}}function Xe(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"label"),n.Tc(2),n.jc(),n.kc(3,"input",17),n.sc("ngModelChange",(function(t){n.Lc(e);const c=n.uc(2).$implicit;return n.uc(2).entity[c.name]=t})),n.jc(),n.jc()}if(2&e){const e=n.uc(2).$implicit,t=n.uc(2);n.Tb(2),n.Uc(e.label),n.Tb(1),n.Ac("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("placeholder",e.label)("required",e.required)}}function et(e,t){if(1&e&&(n.kc(0,"option",20),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.value),n.Tb(1),n.Uc(e.label)}}function tt(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"label"),n.Tc(2),n.jc(),n.kc(3,"select",18),n.sc("ngModelChange",(function(t){n.Lc(e);const c=n.uc(2).$implicit;return n.uc(2).entity[c.name]=t})),n.gc(4,"option"),n.Rc(5,et,2,2,"option",19),n.jc(),n.jc()}if(2&e){const e=n.uc(2).$implicit,t=n.uc(2);n.Tb(2),n.Uc(e.label),n.Tb(1),n.Ac("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required),n.Tb(2),n.Ac("ngForOf",e.options)}}function ct(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"label"),n.Tc(2),n.jc(),n.kc(3,"textarea",21),n.sc("ngModelChange",(function(t){n.Lc(e);const c=n.uc(2).$implicit;return n.uc(2).entity[c.name]=t})),n.Tc(4,"          "),n.jc(),n.jc()}if(2&e){const e=n.uc(2).$implicit,t=n.uc(2);n.Tb(2),n.Uc(e.label),n.Tb(1),n.Ac("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required)}}function nt(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"map-attribute",22),n.sc("siteChange",(function(t){return n.Lc(e),n.uc(4).entity=t})),n.jc(),n.jc()}if(2&e){const e=n.uc(4);n.Tb(1),n.Ac("site",e.entity)("center",e.center)("zoom",e.zoom)}}function it(e,t){if(1&e&&(n.kc(0,"div",15),n.Rc(1,Xe,4,6,"div",16),n.Rc(2,tt,6,6,"div",16),n.Rc(3,ct,5,5,"div",16),n.Rc(4,nt,2,3,"div",16),n.jc()),2&e){const e=n.uc().$implicit;n.Tb(1),n.Ac("ngIf","text"===e.type),n.Tb(1),n.Ac("ngIf","list"===e.type),n.Tb(1),n.Ac("ngIf","text-area"===e.type),n.Tb(1),n.Ac("ngIf","point"===e.type)}}function st(e,t){if(1&e&&(n.kc(0,"div"),n.Rc(1,it,5,4,"div",6),n.jc()),2&e){const e=t.$implicit,c=n.uc(2);n.Tb(1),n.Ac("ngIf",c.evaluate(e))}}function at(e,t){if(1&e){const e=n.lc();n.kc(0,"div",15),n.kc(1,"label"),n.Tc(2,"Privilege "),n.jc(),n.kc(3,"select",23),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc(2).entity.privilegeType=t})),n.kc(4,"option",24),n.Tc(5,"Owner"),n.jc(),n.kc(6,"option",25),n.Tc(7,"Agency"),n.jc(),n.kc(8,"option",26),n.Tc(9,"Public"),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc(2);n.Tb(3),n.Ac("ngModel",e.entity.privilegeType)("required",!0)("disabled",!1===e.admin||e.entity.ownerName!==e.userName)}}function ot(e,t){if(1&e){const e=n.lc();n.kc(0,"div",1),n.Rc(1,Ye,8,1,"div",2),n.Rc(2,Qe,3,1,"div",3),n.kc(3,"form",null,4),n.Rc(5,st,2,1,"div",5),n.Rc(6,at,10,3,"div",6),n.kc(7,"div",7),n.kc(8,"button",8),n.sc("click",(function(){return n.Lc(e),n.uc().bsModalRef.hide()})),n.Tc(9,"Cancel"),n.jc(),n.kc(10,"button",9),n.sc("click",(function(){return n.Lc(e),n.uc().handleOnSubmit()})),n.Tc(11,"Apply"),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.Jc(4),t=n.uc();n.Tb(1),n.Ac("ngIf",null!=t.message),n.Tb(1),n.Ac("ngIf",t.newInstance),n.Tb(3),n.Ac("ngForOf",t.attributes),n.Tb(1),n.Ac("ngIf","Collection"===t.entity.type&&!t.newInstance),n.Tb(4),n.Ac("disabled",!e.valid)}}Ke.ɵfac=function(e){return new(e||Ke)(n.fc(xe),n.fc(E),n.fc(D.b))},Ke.ɵcmp=n.Zb({type:Ke,selectors:[["product-panel"]],inputs:{id:"id"},outputs:{toggleMapImage:"toggleMapImage"},features:[n.Rb],decls:3,vars:2,consts:[[1,"list-group"],["style","padding: 10px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],[2,"padding","10px","text-align","center","color","grey"],[1,"list-group-item"],[1,"card","card-default"],[1,"card-body","card-8-4"],[1,"card-title",2,"color","#a0a0a0"],[1,"breadcrumb",2,"margin","5px 0 5px 0"],[4,"ngFor","ngForOf"],[1,"card-left"],[4,"ngIf"],[1,"card-right"],[2,"list-style","none","padding","0"],[2,"padding","3px 0 3px 0"],["title","Show on map",1,"fa","fa-globe",3,"ngClass","click"],["class","fas fa-check","style","color: #007276;float: right;vertical-align: middle;line-height: 20px;",4,"ngIf"],["title","3D",1,"fa","fa-globe",3,"ngClass","click"],["title","See details",1,"fa","fa-info-circle",3,"click"],["title","Delete",1,"fa","fa-trash-alt",3,"click"],["style","padding: 3px 0 3px 0;",4,"ngIf"],[1,"thumbnail",3,"click"],["alt","Image",1,"",3,"src","error"],[1,"fas","fa-check",2,"color","#007276","float","right","vertical-align","middle","line-height","20px"],["title","Unpublish",1,"fa","fa-arrow-alt-circle-down",3,"click"],["title","Publish",1,"fa","fa-arrow-alt-circle-up",3,"click"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.Rc(1,Ge,3,1,"div",1),n.Rc(2,Ze,26,13,"div",2),n.jc()),2&e&&(n.Tb(1),n.Ac("ngIf",t.products.length<1),n.Tb(1),n.Ac("ngForOf",t.products))},directives:[i.k,i.j,i.i],pipes:[$.a],encapsulation:2,data:{animation:[Object(ce.c)(),Object(ce.d)(),Object(ce.a)(),Object(ce.b)()]}});class lt{constructor(e,t){this.service=e,this.bsModalRef=t,this.userName="",this.admin=!1,this.newInstance=!1,this.message=null,this.center=null,this.zoom=null}ngOnInit(){this.onNodeChange=new q.b}init(e,t,c,n,i,s,a){this.newInstance=e,this.userName=t,this.admin=c,this.entity=n,this.attributes=i,this.center=s,this.zoom=a}handleOnSubmit(){this.message=null,"Site"!==this.entity.type||null!=this.entity.geometry?this.newInstance?this.service.applyWithParent(this.entity,this.parentId).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{this.error(e)}):this.service.update(this.entity).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{console.log(e),this.error(e)}):this.message="Sites require a location"}evaluate(e){return(!this.newInstance||!e.readonly)&&(null==e.condition||this.service.evaluate(e.condition,this.entity))}error(e){this.message=A.b.getMessageFromError(e)}}lt.ɵfac=function(e){return new(e||lt)(n.fc(E),n.fc(D.a))},lt.ɵcmp=n.Zb({type:lt,selectors:[["entity-modal"]],decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],["class","modal-title-container",4,"ngIf"],["ngForm","ngForm"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[1,"btn-holder",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"modal-title-container"],[1,"form-group"],[4,"ngIf"],["type","input",1,"form-control",3,"ngModel","name","disabled","placeholder","required","ngModelChange"],["type","input",3,"ngModel","name","disabled","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],[3,"site","center","zoom","siteChange"],["name","collection-privilege","type","input",2,"padding","6px 10px","font-size","14px",3,"ngModel","required","disabled","ngModelChange"],["value","OWNER"],["value","AGENCY"],["value","PUBLIC"]],template:function(e,t){1&e&&n.Rc(0,ot,12,5,"div",0),2&e&&n.Ac("ngIf",null!=t.entity)},directives:[i.k,a.r,a.i,a.j,i.j,a.a,a.h,a.k,a.o,a.p,a.l,a.q,S],encapsulation:2});var rt=c(339),dt=c(34),ut=c(332),pt=c(92);const ht=["uploader"];function gt(e,t){if(1&e&&(n.kc(0,"div",22),n.gc(1,"div",4),n.kc(2,"div",5),n.kc(3,"div",23),n.kc(4,"strong",24),n.Tc(5,"Error"),n.jc(),n.jc(),n.kc(6,"div",25),n.kc(7,"div"),n.kc(8,"p",26),n.Tc(9),n.jc(),n.jc(),n.jc(),n.jc(),n.gc(10,"div",4),n.jc()),2&e){const e=n.uc();n.Tb(9),n.Uc(e.message)}}function mt(e,t){if(1&e&&(n.kc(0,"div",15),n.gc(1,"div",4),n.kc(2,"div",5),n.kc(3,"ol",27),n.gc(4,"modal-step-indicator",28),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(4),n.Ac("stepConfig",e.modalStepConfig)}}function ft(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.Tc(2),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Ac("@fadeInOnEnter",void 0),n.Tb(2),n.Vc(" ",e,"")}}function bt(e,t){if(1&e&&(n.kc(0,"div",15),n.gc(1,"div",4),n.kc(2,"div",5),n.kc(3,"ul",29),n.Rc(4,ft,3,2,"li",30),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(4),n.Ac("ngForOf",e.labels)}}function kt(e,t){if(1&e&&(n.kc(0,"option",37),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.id),n.Tb(1),n.Uc(e.name)}}function vt(e,t){if(1&e){const e=n.lc();n.kc(0,"button",38),n.sc("click",(function(){return n.Lc(e),n.uc(3).setIsNew(!0)})),n.Tc(1," Add "),n.jc()}}function jt(e,t){if(1&e){const e=n.lc();n.kc(0,"div",15),n.kc(1,"div",5),n.kc(2,"select",34),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc(2).page.selection.value=t})),n.gc(3,"option"),n.Rc(4,kt,2,2,"option",35),n.jc(),n.jc(),n.kc(5,"div",4),n.Rc(6,vt,2,0,"button",36),n.jc(),n.jc()}if(2&e){const e=n.uc(2);n.Tb(2),n.Ac("name",e.page.selection.type)("ngModel",e.page.selection.value)("disabled",e.page.selection.isNew),n.Tb(2),n.Ac("ngForOf",e.page.options),n.Tb(2),n.Ac("ngIf",!e.page.selection.isNew)}}function Tt(e,t){if(1&e&&(n.kc(0,"option",37),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.oid),n.Tb(1),n.Uc(e.displayLabel)}}function yt(e,t){if(1&e){const e=n.lc();n.kc(0,"div",15),n.kc(1,"div",5),n.kc(2,"label",40),n.Tc(3,"Platform:"),n.jc(),n.kc(4,"select",41),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc(3).page.selection.platform=t})),n.gc(5,"option"),n.Rc(6,Tt,2,2,"option",35),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc(3);n.Ac("@fadeInOnEnter",void 0),n.Tb(4),n.Ac("ngModel",e.page.selection.platform),n.Tb(2),n.Ac("ngForOf",e.platforms)}}function Ct(e,t){if(1&e&&(n.kc(0,"option",37),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.oid),n.Tb(1),n.Uc(e.displayLabel)}}function Mt(e,t){if(1&e){const e=n.lc();n.kc(0,"div",15),n.kc(1,"div",5),n.kc(2,"label",42),n.Tc(3,"Sensor:"),n.jc(),n.kc(4,"select",43),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc(3).page.selection.sensor=t})),n.gc(5,"option"),n.Rc(6,Ct,2,2,"option",35),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc(3);n.Ac("@fadeInOnEnter",void 0),n.Tb(4),n.Ac("ngModel",e.page.selection.sensor),n.Tb(2),n.Ac("ngForOf",e.sensors)}}function wt(e,t){if(1&e){const e=n.lc();n.kc(0,"div",31),n.kc(1,"div",15),n.kc(2,"div",5),n.kc(3,"input",39),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc(2).page.selection.label=t})),n.jc(),n.jc(),n.kc(4,"div",4),n.kc(5,"button",38),n.sc("click",(function(){return n.Lc(e),n.uc(2).setIsNew(!1)})),n.Tc(6," Cancel "),n.jc(),n.jc(),n.jc(),n.Rc(7,yt,7,3,"div",2),n.Rc(8,Mt,7,3,"div",2),n.jc()}if(2&e){const e=n.uc(2);n.Ac("@fadeInOnEnter",void 0),n.Tb(3),n.Ac("ngModel",e.page.selection.label)("placeholder",e.page.selection.type+" name..."),n.Tb(4),n.Ac("ngIf",e.hasField("platform")),n.Tb(1),n.Ac("ngIf",e.hasField("sensor"))}}function Ot(e,t){if(1&e&&(n.kc(0,"div",15),n.gc(1,"div",4),n.kc(2,"div",5),n.kc(3,"div",31),n.kc(4,"label",32),n.Tc(5),n.jc(),n.Rc(6,jt,7,5,"div",2),n.jc(),n.Rc(7,wt,9,5,"div",33),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(4),n.Ac("for",e.page.selection.type),n.Tb(1),n.Vc("",e.page.selection.type,":"),n.Tb(1),n.Ac("ngIf",!e.page.selection.isNew),n.Tb(1),n.Ac("ngIf",e.page.selection.isNew)}}function St(e,t){if(1&e){const e=n.lc();n.kc(0,"div",31),n.kc(1,"label",32),n.Tc(2),n.jc(),n.kc(3,"input",48),n.sc("ngModelChange",(function(c){return n.Lc(e),t.$implicit.label=c})),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(1),n.Ac("for",e.type),n.Tb(1),n.Vc("",e.type,":"),n.Tb(1),n.Ac("ngModel",e.label)("name",e.type)}}function It(e,t){if(1&e){const e=n.lc();n.kc(0,"div",15),n.gc(1,"div",4),n.kc(2,"div",5),n.Rc(3,St,4,4,"div",44),n.kc(4,"div",31),n.kc(5,"label",45),n.Tc(6,"Output Product Name Prefix"),n.jc(),n.kc(7,"input",46),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().values.outFileName=t})),n.jc(),n.jc(),n.kc(8,"div",31),n.kc(9,"boolean-field",47),n.sc("valueChange",(function(t){return n.Lc(e),n.uc().updateProcessUpload(t)})),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Ac("@fadeInOnEnter",void 0),n.Tb(3),n.Ac("ngForOf",e.selections),n.Tb(4),n.Ac("ngModel",e.values.outFileName),n.Tb(2),n.Ac("value",e.processUpload)}}function At(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"div",49),n.kc(2,"div",50),n.Tc(3,"Partial Upload Detected"),n.jc(),n.kc(4,"div",51),n.kc(5,"h4"),n.Tc(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),n.jc(),n.kc(7,"h4"),n.kc(8,"b"),n.Tc(9,"To continue an upload"),n.jc(),n.Tc(10," please re-upload your file and we will try our best to continue where you left off. "),n.jc(),n.gc(11,"hr"),n.kc(12,"button",52),n.sc("click",(function(t){return n.Lc(e),n.uc().removeUpload(t)})),n.gc(13,"i",53),n.Tc(14," Cancel Upload "),n.jc(),n.jc(),n.jc(),n.jc()}}function xt(e,t){if(1&e){const e=n.lc();n.kc(0,"div",54),n.kc(1,"div",50),n.Tc(2," Upload Details "),n.kc(3,"i",55),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().closeTaskFinishedNotification(c.id)})),n.jc(),n.jc(),n.kc(4,"div",51),n.kc(5,"h4"),n.Tc(6," Status: "),n.kc(7,"b"),n.Tc(8," Upload successfully completed "),n.jc(),n.jc(),n.kc(9,"h4"),n.Tc(10," Message: "),n.kc(11,"b"),n.Tc(12),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(12),n.Vc(" ",e.message," ")}}function Rt(e,t){if(1&e&&(n.kc(0,"div",49),n.kc(1,"div",50),n.Tc(2,"Upload Details"),n.jc(),n.kc(3,"div",51),n.kc(4,"h4"),n.Tc(5," Status: "),n.kc(6,"b"),n.Tc(7),n.jc(),n.jc(),n.kc(8,"h4"),n.Tc(9," Message: "),n.kc(10,"b"),n.Tc(11),n.jc(),n.jc(),n.kc(12,"h4"),n.Tc(13," Upload Started On: "),n.kc(14,"b"),n.Tc(15),n.jc(),n.jc(),n.kc(16,"h4"),n.Tc(17," Last Updated: "),n.kc(18,"b"),n.Tc(19),n.jc(),n.jc(),n.kc(20,"h4"),n.Tc(21," Elapsed Time: "),n.kc(22,"b"),n.Tc(23),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(7),n.Vc(" ",e.currentTask.status," "),n.Tb(4),n.Vc(" ",e.currentTask.message," "),n.Tb(4),n.Vc(" ",e.currentTask.createDate," "),n.Tb(4),n.Vc(" ",e.currentTask.lastUpdatedDate," "),n.Tb(4),n.Vc(" ",e.uploadCounter," ")}}function Pt(e,t){if(1&e){const e=n.lc();n.kc(0,"button",56),n.sc("click",(function(){return n.Lc(e),n.uc().handleBackPage()})),n.gc(1,"i",53),n.Tc(2," Back "),n.jc()}if(2&e){const e=n.uc();n.Ac("disabled",e.disabled)}}function Ft(e,t){if(1&e){const e=n.lc();n.kc(0,"button",57),n.sc("click",(function(){return n.Lc(e),n.uc().handleNextPage()})),n.gc(1,"i",53),n.Tc(2," Next "),n.jc()}if(2&e){const e=n.uc();n.Ac("disabled",!e.isPageValid(e.page)||e.disabled)}}function Lt(e,t){if(1&e){const e=n.lc();n.kc(0,"button",57),n.sc("click",(function(){return n.Lc(e),n.uc().handleUpload()})),n.gc(1,"i",53),n.Tc(2," Upload "),n.jc()}if(2&e){const e=n.uc();n.Ac("disabled",!e.isPageValid(e.page)||e.disabled)}}class Nt{constructor(e,t,c,n,i){this.service=e,this.metadataService=t,this.modalService=c,this.bsModalRef=n,this.objectKeys=Object.keys,this.importedValues=!1,this.message="",this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.finishedTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.processUpload=!0,this.hierarchy=[],this.selections=[],this.labels=[],this.pages=[{index:0,selection:null,options:[],type:"FILE"}],this.hierarchyChange=!1,this.page=this.pages[0],this.sensors=[],this.platforms=[],this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]},this.differ=i.find([]).create()}set content(e){const t=this;if(null!=e&&null==this.uploader){let c={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,c){t.disabled=!0,this.finishedTask=null,t.countUpload(t),t.message&&t.message.length>0&&(t.message="")},onProgress:function(e,t,c,n){},onUploadChunk:function(e,t,c){},onUploadChunkSuccess:function(e,c,n,i){n.message&&n.message.currentTask&&!t.currentTask&&(t.currentTask=n.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(rt.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(dt.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,c,n,i){if(t.disabled=!1,t.finishedTask=t.currentTask,t.currentTask=null,t.existingTask=!1,!t.hierarchyChange)for(let e=0;e<t.selections.length;e++)t.selections[e].isNew&&(t.hierarchyChange=!0);t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),n.success&&t.bsModalRef.hide(),t.onUploadComplete.next()},onCancel:function(e,c){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.existingTask&&(t.page=t.pages[0]),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,c,n){t.error({error:{message:n}})}}};this.uploader=new ut.FineUploader(c)}}ngAfterViewInit(){}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}ngOnInit(){this.onUploadComplete=new q.b,this.onHierarchyChange=new q.b,this.service.getMetadataOptions(null).then(e=>{this.sensors=e.sensors,this.platforms=e.platforms}).catch(e=>{this.error(e)})}init(e){this.hierarchy=this.metadataService.getHierarchy(),this.selections=[],this.pages=[];for(let t=0;t<this.hierarchy.length;t++){const c=this.hierarchy[t],n=e.findIndex(e=>e.type===c);if(-1!==n){const t=e[n];this.selections.push({type:c,isNew:!1,value:t.id,label:t.name})}else this.selections.push({type:c,isNew:!1,value:null,label:""});t>0&&this.pages.push({index:this.pages.length,selection:this.selections[t],options:[],type:"CATEGORY"})}this.labels.push(this.selections[0].label),this.pages.push({index:this.pages.length,selection:null,options:[],type:"SUMMARY"}),this.page=this.pages[0],this.service.getChildren(this.selections[0].value).then(e=>{this.pages[0].options=e.filter(e=>e.type===this.pages[0].selection.type)}).catch(e=>{this.error(e)}),this.existingTask&&(this.page=this.pages[this.pages.length-1])}close(){this.hierarchyChange&&this.onHierarchyChange.next(!0),this.bsModalRef.hide()}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0)}isPageValid(e){if("CATEGORY"===e.type){if(null!=e.selection)return null!=e.selection.value&&e.selection.value.length>0||null!=e.selection.label&&e.selection.label.length>0&&((!this.hasField("platform")||null!=e.selection.platform&&0!==e.selection.platform.length)&&(!this.hasField("sensor")||null!=e.selection.sensor&&0!==e.selection.sensor.length))}else if("FILE"===e.type){if(null!=this.uploader){const e=this.uploader.getUploads();return null!=e&&e.length>0}}else if("SUMMARY"===e.type)return null==this.currentTask;return!0}updateCurrentPageLabel(){this.page.options.forEach(e=>{e.id===this.page.selection.value&&(this.page.selection.label=e.name)})}setIsNew(e){this.page.selection.isNew=e,e?this.page.selection.value=null:this.page.selection.label=null}handleAddMetadata(e){this.modalService.show(te,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(e.collection)}handleNextPage(){if(this.page.index+1<this.pages.length){const e=this.pages[this.page.index+1];"CATEGORY"===this.page.type&&(this.updateCurrentPageLabel(),this.labels.push(this.page.selection.label)),"CATEGORY"===e.type?"FILE"===this.page.type?this.page=e:!this.page.selection.isNew&&null!=this.page.selection.value&&this.page.selection.value.length>0?this.service.getChildren(this.page.selection.value).then(t=>{e.options=t.filter(t=>t.type===e.selection.type),this.page=e}).catch(e=>{this.error(e)}):this.page=e:(this.page=e,this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!1},{label:"Final",active:!0,enabled:!0}]})}}handleBackPage(){if(this.page.index>0){const e=this.pages[this.page.index-1];"CATEGORY"===e.type&&(this.labels.splice(this.labels.length-1,1),this.modalStepConfig.steps.forEach(e=>{"category"===e.label.toLowerCase()&&!1===e.enabled&&(this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]})})),this.page=e}}handleUpload(){if(this.existingTask)this.uploader.uploadStoredFiles();else{const e=this.selections[this.selections.length-1];this.values.selections=JSON.stringify(this.selections),this.values.uploadTarget=this.metadataService.getUploadTarget(e.type),this.values.processUpload=this.processUpload,this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()}}hasField(e){return this.metadataService.hasExtraField(this.page.selection.type,e)}removeUpload(e){let t=this;this.bsModalRef=this.modalService.show(A.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Cancel Upload",this.bsModalRef.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),t.existingTask=!1,this.page=this.pages[0]}).catch(e=>{this.error(e)})})}updateProcessUpload(e){this.processUpload=e}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let c=Math.floor(t/3600),n=Math.floor(t%3600/60),i=Math.floor(t%60),s=n<10?"0"+c:c,a=n<10?"0"+n:n,o=i<10?"0"+i:i;e.uploadCounter=s+":"+a+":"+o}),1e3)}error(e){this.message=A.b.getMessageFromError(e)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}}function Ut(e,t){if(1&e&&(n.kc(0,"div",3),n.kc(1,"div",4),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",5),n.kc(5,"div"),n.kc(6,"p",6),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc();n.Tb(7),n.Uc(e.message)}}function Et(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.Tc(2),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(2),n.Vc(" ",e.name,"")}}function Dt(e,t){if(1&e){const e=n.lc();n.kc(0,"tr"),n.kc(1,"td",25),n.kc(2,"a",26),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(3).handleDownloadFile(c)})),n.jc(),n.kc(3,"a",27),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(3).handleDelete(c)})),n.jc(),n.jc(),n.kc(4,"td"),n.Tc(5),n.jc(),n.kc(6,"td"),n.Tc(7),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(5),n.Uc(e.name),n.Tb(2),n.Uc(e.lastModified)}}function $t(e,t){1&e&&(n.Tc(0," Drag & Drop File "),n.kc(1,"button",28),n.sc("click",(function(){return(0,t.openFileSelector)()})),n.Tc(2,"Browse Files"),n.jc())}Nt.ɵfac=function(e){return new(e||Nt)(n.fc(E),n.fc(ie),n.fc(D.b),n.fc(D.a),n.fc(n.E))},Nt.ɵcmp=n.Zb({type:Nt,selectors:[["upload-modal"]],viewQuery:function(e,t){var c;(1&e&&n.Xc(ht,!0),2&e)&&(n.Ic(c=n.tc())&&(t.content=c.first))},hostBindings:function(e,t){1&e&&n.sc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,n.Kc)},decls:62,vars:16,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[1,"row",3,"hidden"],[1,"col-md-2"],[1,"col-md-8"],[4,"ngIf"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],[1,"",3,"hidden"],[1,"well"],[1,"table"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"row","error-container"],[1,"label-holder"],[2,"color","#8c0000"],[1,"holder"],[1,"error-message"],[1,"list-group","list-group-horizontal"],[3,"stepConfig"],[1,"breadcrumb"],[4,"ngFor","ngForOf"],[1,"form-group"],[3,"for"],["class","form-group",4,"ngIf"],["required","",3,"name","ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button btn btn-primary","class","btn btn-primary",3,"click",4,"ngIf"],[3,"value"],["type","button btn btn-primary",1,"btn","btn-primary",3,"click"],["autofocus","","name","label","type","input","required","",1,"form-control",3,"ngModel","placeholder","ngModelChange"],["for","platform",2,"margin-top","10px"],["name","platform","type","input","required","",3,"ngModel","ngModelChange"],["for","sensor",2,"margin-top","10px"],["name","sensor","type","input","required","",3,"ngModel","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],["label","Generate products from raw images",3,"value","valueChange"],["type","input","disabled","","required","",1,"form-control",3,"ngModel","name","ngModelChange"],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],["type","button",1,"btn","btn-danger",2,"margin-top","20px",3,"click"],[1,"icon-upload","icon-white"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],["type","button btn btn-primary",1,"btn","btn-secondary",3,"disabled","click"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(n.kc(0,"div"),n.kc(1,"div",0),n.Rc(2,gt,11,1,"div",1),n.Rc(3,mt,5,1,"div",2),n.Rc(4,bt,5,1,"div",2),n.Rc(5,Ot,8,4,"div",2),n.Rc(6,It,10,4,"div",2),n.kc(7,"div",3),n.gc(8,"div",4),n.kc(9,"div",5),n.Rc(10,At,15,0,"div",6),n.Rc(11,xt,13,1,"div",7),n.kc(12,"div",8),n.kc(13,"div",9),n.kc(14,"h4"),n.Tc(15,"All files uploaded through the upload wizard must"),n.jc(),n.kc(16,"ul"),n.kc(17,"li"),n.Tc(18,"be compressed into a .zip format "),n.jc(),n.kc(19,"li"),n.Tc(20,"not contain any directories within the .zip file"),n.jc(),n.kc(21,"li"),n.Tc(22,"not contain spaces or special characters such as <, >, -, +, =, !, @, #, $, %, ^, &, *, ?,/,\\ or apostrophes in any file name"),n.jc(),n.jc(),n.kc(23,"h4"),n.Tc(24," Supported File Formats "),n.jc(),n.kc(25,"table",10),n.kc(26,"thead"),n.kc(27,"tr"),n.kc(28,"th"),n.Tc(29,"Type"),n.jc(),n.kc(30,"th"),n.Tc(31,"Formats"),n.jc(),n.jc(),n.jc(),n.kc(32,"tbody"),n.kc(33,"tr"),n.kc(34,"td"),n.Tc(35,"RGB Image Data"),n.jc(),n.kc(36,"td"),n.Tc(37,"jpg, jpeg, png"),n.jc(),n.jc(),n.kc(38,"tr"),n.kc(39,"td"),n.Tc(40,"Multispectral Image Data"),n.jc(),n.kc(41,"td"),n.Tc(42,"tif"),n.jc(),n.jc(),n.kc(43,"tr"),n.kc(44,"td"),n.Tc(45,"Video"),n.jc(),n.kc(46,"td"),n.Tc(47,"mp4"),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.Rc(48,Rt,24,5,"div",11),n.gc(49,"div",12,13),n.jc(),n.jc(),n.gc(51,"div",4),n.jc(),n.jc(),n.kc(52,"div",14),n.kc(53,"div",15),n.kc(54,"div",16),n.kc(55,"div",17),n.kc(56,"button",18),n.sc("click",(function(){return t.close()})),n.kc(57,"span",19),n.Tc(58,"Close"),n.jc(),n.jc(),n.Rc(59,Pt,3,1,"button",20),n.Rc(60,Ft,3,1,"button",21),n.Rc(61,Lt,3,1,"button",21),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()),2&e&&(n.Tb(2),n.Ac("ngIf",null!=t.message&&t.message.length>0),n.Tb(1),n.Ac("ngIf",!t.existingTask),n.Tb(1),n.Ac("ngIf",!t.existingTask&&t.labels.length>0),n.Tb(1),n.Ac("ngIf","CATEGORY"===t.page.type),n.Tb(1),n.Ac("ngIf","SUMMARY"===t.page.type&&!t.existingTask&&null==t.currentTask),n.Tb(1),n.Ac("@fadeInOnEnter",void 0)("hidden","FILE"!==t.page.type&&"SUMMARY"!==t.page.type),n.Tb(3),n.Ac("ngIf",t.existingTask&&!t.currentTask),n.Tb(1),n.Ac("ngForOf",t.taskFinishedNotifications),n.Tb(1),n.Ac("hidden",!t.uploadVisible),n.Tb(36),n.Ac("ngIf",t.currentTask),n.Tb(8),n.Ac("disabled",t.disabled)("disabled",t.disabled),n.Tb(3),n.Ac("ngIf",!t.existingTask&&t.page.index>0),n.Tb(1),n.Ac("ngIf",!t.existingTask&&t.page.index<t.pages.length-1),n.Tb(1),n.Ac("ngIf",t.page.index===t.pages.length-1))},directives:[i.k,i.j,pt.a,a.p,a.o,a.h,a.k,a.l,a.q,a.a,W.a],styles:[".list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tdisplay: inline-block;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tmargin-bottom: 0;\n\tmargin-left: -4px;\n\tmargin-right: 0;\n\tborder-right-width: 0;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child {\n\tborder-top-right-radius: 0;\n\tborder-bottom-left-radius: 4px;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child {\n\tborder-top-right-radius: 4px;\n\tborder-bottom-left-radius: 0;\n\tborder-right-width: 1px;\n}\n\n.list-group-item-success[_ngcontent-%COMP%] {\n\tcolor: #155724;\n\tbackground-color: #c3e6cb;\n}"],data:{animation:[Object(ce.c)(),Object(ce.d)()]}});const _t=function(e,t,c){return{itemsPerPage:e,currentPage:t,totalItems:c}};function Gt(e,t){if(1&e){const e=n.lc();n.kc(0,"tab",17),n.sc("selectTab",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).onSelect(c)})),n.kc(1,"div",18),n.kc(2,"div",19),n.kc(3,"table",20),n.kc(4,"thead"),n.kc(5,"tr"),n.gc(6,"th",21),n.kc(7,"th",21),n.Tc(8,"Name"),n.jc(),n.kc(9,"th",21),n.Tc(10,"Date uploaded"),n.jc(),n.jc(),n.jc(),n.kc(11,"tbody",22),n.Rc(12,Dt,8,2,"tr",10),n.vc(13,"paginate"),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(14,"div",7),n.kc(15,"div",19),n.kc(16,"ngx-file-drop",23),n.sc("onFileDrop",(function(t){return n.Lc(e),n.uc(2).dropped(t)})),n.Rc(17,$t,3,0,"ng-template",24),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=n.uc(2);n.Ac("heading",e.name),n.Tb(12),n.Ac("ngForOf",n.xc(13,2,c.page.results,n.Gc(5,_t,c.page.pageSize,c.page.pageNumber,c.page.count)))}}function zt(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"div",7),n.kc(2,"div",8),n.kc(3,"h2"),n.Tc(4),n.jc(),n.jc(),n.jc(),n.kc(5,"div",7),n.kc(6,"div",8),n.kc(7,"ul",9),n.Rc(8,Et,3,1,"li",10),n.jc(),n.jc(),n.jc(),n.kc(9,"div",7),n.kc(10,"tabset",11),n.Rc(11,Gt,18,9,"tab",12),n.jc(),n.jc(),n.kc(12,"div",7),n.kc(13,"pagination-controls",13),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc(),n.jc(),n.kc(14,"div",7),n.kc(15,"div",14),n.kc(16,"button",15),n.sc("click",(function(){return n.Lc(e),n.uc().bsModalRef.hide()})),n.Tc(17,"Close"),n.jc(),n.kc(18,"button",16),n.sc("click",(function(){return n.Lc(e),n.uc().handleDownload()})),n.Tc(19,"Download all"),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(4),n.Uc(e.entity.name),n.Tb(4),n.Ac("ngForOf",e.previous),n.Tb(3),n.Ac("ngForOf",e.folders)}}class Vt{constructor(e,t,c){this.service=e,this.modalService=t,this.bsModalRef=c,this.previous=[],this.folders=[],this.page=new B}ngOnInit(){this.page.count=0,this.page.pageNumber=1,this.page.pageSize=10,this.page.results=[]}init(e,t,c){this.entity=e,this.folders=t,this.previous=[...c],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.folders.length>0&&this.onSelect(this.folders[0])}onPageChange(e){this.getData(this.folder.component,this.folder.name,e,this.page.pageSize)}onSelect(e){this.page.results=[],this.folder=e,this.getData(e.component,e.name,1,this.page.pageSize)}refresh(){this.page.results=[],this.getData(this.folder.component,this.folder.name,this.page.pageNumber,this.page.pageSize)}getData(e,t,c,n){this.service.getObjects(e,t,c,n).then(e=>{this.page=e})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.folder.component+"&key="+this.folder.name}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.folder.component+"&key="+e.key}dropped(e){for(const t of e)if(t.fileEntry.isFile){t.fileEntry.file(e=>{this.service.upload(this.folder.component,this.folder.name,e).then(()=>{this.refresh()})})}else{const e=t.fileEntry;console.log(t.relativePath,e)}}handleDelete(e){let t=this.modalService.show(A.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.message="Are you sure you want to delete the file ["+e.name+"]?",t.content.type="DANGER",t.content.submitText="Delete",t.content.onConfirm.subscribe(()=>{this.remove(e)})}remove(e){this.service.removeObject(e.component,e.key).then(()=>{this.refresh()})}error(e){this.message=A.b.getMessageFromError(e)}}Vt.ɵfac=function(e){return new(e||Vt)(n.fc(E),n.fc(D.b),n.fc(D.a))},Vt.ɵcmp=n.Zb({type:Vt,selectors:[["accessible-support-modal"]],decls:4,vars:2,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"nav-full-width"],[3,"heading","selectTab",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 10px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"click"],[3,"heading","selectTab"],[1,"row","image-list-container"],[1,"col-sm-12"],[1,"table","table-striped"],["scope","col"],[1,"upload-name-style"],["dropZoneLabel","Drop files here",3,"onFileDrop"],["ngx-file-drop-content-tmp",""],[1,"button-column"],["title","Download",1,"fa","fa-download",3,"click"],["title","Remove",1,"fa","fa-trash-alt","ico-remove",2,"margin-left","5px",3,"click"],["type","button",3,"click"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.kc(1,"div"),n.Rc(2,Ut,8,1,"div",1),n.Rc(3,zt,20,3,"div",2),n.jc(),n.jc()),2&e&&(n.Tb(2),n.Ac("ngIf",null!=t.message),n.Tb(1),n.Ac("ngIf",null!=t.entity))},directives:[i.k,i.j,u.c,h.c,u.a,o.a,o.c],pipes:[h.b],encapsulation:2});var qt=c(340),Bt=c(49);const Ht=["staticTabs"],Jt=["confirmTemplate"];function Wt(e,t){1&e&&(n.kc(0,"div",3),n.kc(1,"div",30),n.kc(2,"h3"),n.Tc(3,"IDM Sites"),n.jc(),n.jc(),n.jc())}function Zt(e,t){if(1&e){const e=n.lc();n.kc(0,"a",34),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc(2).back(t)})),n.Tc(1),n.jc()}if(2&e){const e=n.uc().$implicit;n.Tb(1),n.Vc(" ",e.name,"")}}function Kt(e,t){if(1&e&&(n.kc(0,"span"),n.kc(1,"b"),n.Tc(2),n.jc(),n.jc()),2&e){const e=n.uc().$implicit;n.Tb(2),n.Uc(e.name)}}const Yt=function(e){return{active:e}};function Qt(e,t){if(1&e&&(n.kc(0,"li",36),n.Rc(1,Zt,2,1,"a",37),n.Rc(2,Kt,3,1,"span",26),n.jc()),2&e){const e=t.last;n.Ac("ngClass",n.Ec(3,Yt,e)),n.Tb(1),n.Ac("ngIf",!e),n.Tb(1),n.Ac("ngIf",e)}}function Xt(e,t){if(1&e){const e=n.lc();n.kc(0,"div",3),n.kc(1,"div",31),n.kc(2,"ul",32),n.kc(3,"li"),n.gc(4,"i",33),n.kc(5,"a",34),n.sc("click",(function(){return n.Lc(e),n.uc().back(null)})),n.Tc(6,"IDM Sites"),n.jc(),n.jc(),n.Rc(7,Qt,3,5,"li",35),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(7),n.Ac("ngForOf",e.breadcrumbs)}}function ec(e,t){1&e&&(n.kc(0,"div",38),n.kc(1,"h4"),n.Tc(2,"No Sites in this area."),n.jc(),n.kc(3,"p"),n.Tc(4," Zoom out to find sites in other areas of the map. "),n.jc(),n.jc()),2&e&&n.Ac("@fadeInOnEnter",void 0)}function tc(e,t){1&e&&(n.kc(0,"div",38),n.kc(1,"h4"),n.Tc(2,"No data at this level."),n.jc(),n.kc(3,"p"),n.Tc(4," Create data containers as part of the upload process. "),n.jc(),n.jc()),2&e&&n.Ac("@fadeInOnEnter",void 0)}function cc(e,t){if(1&e){const e=n.lc();n.kc(0,"span",49),n.kc(1,"a",50),n.sc("click",(function(t){n.Lc(e);const c=n.uc(2).$implicit;return n.uc().handleEdit(c,t)})),n.jc(),n.kc(2,"a",51),n.sc("click",(function(t){n.Lc(e);const c=n.uc(2).$implicit;return n.uc().handleDelete(c,t)})),n.jc(),n.jc()}}function nc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",42),n.sc("click",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc().select(c,null,t)}))("mouseenter",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc().onListEntityHover(t,c)}))("mouseleave",(function(){return n.Lc(e),n.uc(2).onListEntityHoverOff()})),n.kc(1,"div",43),n.kc(2,"div",44),n.gc(3,"i",45),n.jc(),n.kc(4,"div",46),n.kc(5,"h4",47),n.Tc(6),n.jc(),n.Rc(7,cc,3,0,"span",48),n.kc(8,"p"),n.kc(9,"b"),n.Tc(10),n.jc(),n.Tc(11),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc().$implicit,t=n.uc();n.Ac("@fadeInOnEnter",void 0)("ngClass",n.Ec(6,Yt,t.hoverFeatureId===e.id)),n.Tb(6),n.Vc(" ",e.name," "),n.Tb(1),n.Ac("ngIf","folder"!==e.type),n.Tb(3),n.Uc(e.numberOfChildren),n.Tb(1),n.Vc(" ",t.getMetadata(e).childLabel,"")}}function ic(e,t){if(1&e){const e=n.lc();n.kc(0,"span",59),n.kc(1,"a",50),n.sc("click",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc(3).handleEdit(c,t)})),n.jc(),n.kc(2,"a",51),n.sc("click",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc(3).handleDelete(c,t)})),n.jc(),n.jc()}}function sc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",57),n.sc("click",(function(c){n.Lc(e);const i=t.$implicit,s=n.uc(2).$implicit;return n.uc().select(i,s,c)})),n.Tc(1),n.Rc(2,ic,3,0,"span",58),n.jc()}if(2&e){const e=t.$implicit;n.Tb(1),n.Vc(" ",e.name," "),n.Tb(1),n.Ac("ngIf","folder"!==e.type)}}const ac=function(e){return{"fa-rotate-270":e}};function oc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",52),n.sc("click",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc().select(c,null,t)})),n.kc(1,"div",53),n.kc(2,"i",54),n.sc("click",(function(t){n.Lc(e);const c=n.uc().$implicit;return n.uc().handleExpand(c,t)})),n.jc(),n.kc(3,"h4",47),n.Tc(4),n.jc(),n.kc(5,"p"),n.kc(6,"b"),n.Tc(7),n.jc(),n.Tc(8),n.jc(),n.kc(9,"div",55),n.Rc(10,sc,3,2,"div",56),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc().$implicit,t=n.uc();n.Ac("@fadeInOnEnter",void 0),n.Tb(2),n.Ac("ngClass",n.Ec(7,ac,e.active)),n.Tb(2),n.Uc(e.name),n.Tb(3),n.Uc(e.numberOfChildren),n.Tb(1),n.Vc(" ",t.getMetadata(e).childLabel,""),n.Tb(1),n.Ac("collapse",!e.active),n.Tb(1),n.Ac("ngForOf",e.children)}}function lc(e,t){if(1&e&&(n.kc(0,"div",39),n.Rc(1,nc,12,8,"div",40),n.Rc(2,oc,11,9,"div",41),n.jc()),2&e){const e=t.$implicit,c=n.uc();n.Ac("@fadeInOnEnter",void 0),n.Tb(1),n.Ac("ngIf",c.getMetadata(e).root),n.Tb(1),n.Ac("ngIf",!c.getMetadata(e).root)}}function rc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",39),n.kc(1,"div",60),n.kc(2,"div",53),n.kc(3,"h4",47),n.Tc(4,"Supporting Data"),n.jc(),n.kc(5,"div",14),n.kc(6,"div",61),n.kc(7,"a",62),n.sc("click",(function(c){n.Lc(e);const i=t.$implicit;return n.uc().select(i,null,c)})),n.Tc(8),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(1),n.Ac("@fadeInOnEnter",void 0),n.Tb(7),n.Vc(" ",e.name," ")}}function dc(e,t){if(1&e){const e=n.lc();n.kc(0,"tab",63),n.kc(1,"div",13),n.kc(2,"product-panel",64),n.sc("toggleMapImage",(function(t){return n.Lc(e),n.uc().handleMapImage(t)})),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(2),n.Ac("id",e.current.id)}}function uc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",65),n.kc(1,"div",66),n.kc(2,"button",67),n.sc("click",(function(){return n.Lc(e),n.uc().handleUploadFile()})),n.Tc(3,"Upload"),n.jc(),n.jc(),n.jc()}}function pc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",65),n.kc(1,"div",66),n.kc(2,"button",67),n.sc("click",(function(){return n.Lc(e),n.uc().handleCreate(null,null)})),n.Tc(3,"Add new site"),n.jc(),n.jc(),n.jc()}}function hc(e,t){if(1&e){const e=n.lc();n.kc(0,"alert",73),n.sc("onClosed",(function(){n.Lc(e);const t=n.uc().index;return n.uc().handleCloseToast(t)})),n.kc(1,"strong"),n.Tc(2),n.jc(),n.Tc(3),n.kc(4,"a",62),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc().handleViewSite(t.collection)})),n.Tc(5,"Goto the collection view"),n.jc(),n.jc()}if(2&e){const e=n.uc().$implicit;n.Ac("dismissible",!0),n.Tb(2),n.Vc("Upload ",e.status,""),n.Tb(1),n.Vc(" for ",e.collectionLabel,". ")}}function gc(e,t){if(1&e){const e=n.lc();n.kc(0,"alert",74),n.sc("onClosed",(function(){n.Lc(e);const t=n.uc().index;return n.uc().handleCloseToast(t)})),n.kc(1,"strong"),n.Tc(2),n.jc(),n.Tc(3),n.kc(4,"a",75),n.Tc(5,"task page"),n.jc(),n.Tc(6," for more details. "),n.jc()}if(2&e){const e=n.uc().$implicit;n.Ac("dismissible",!0),n.Tb(2),n.Vc("Upload ",e.status,""),n.Tb(1),n.Vc(" for ",e.collectionLabel,". Task completed with warnings. See the ")}}function mc(e,t){if(1&e){const e=n.lc();n.kc(0,"alert",76),n.sc("onClosed",(function(){n.Lc(e);const t=n.uc().index;return n.uc().handleCloseToast(t)})),n.kc(1,"strong"),n.Tc(2),n.jc(),n.Tc(3),n.kc(4,"a",75),n.Tc(5,"task page"),n.jc(),n.Tc(6," for more details. "),n.jc()}if(2&e){const e=n.uc().$implicit;n.Ac("dismissible",!0),n.Tb(2),n.Vc("Upload ",e.status,""),n.Tb(1),n.Vc(" for ",e.collectionLabel,". Task completed with errors. See the ")}}function fc(e,t){if(1&e){const e=n.lc();n.kc(0,"alert",77),n.sc("onClosed",(function(){n.Lc(e);const t=n.uc().index;return n.uc().handleCloseToast(t)})),n.kc(1,"strong"),n.Tc(2),n.jc(),n.Tc(3),n.jc()}if(2&e){const e=n.uc().$implicit;n.Ac("dismissible",!0),n.Tb(2),n.Vc("Upload ",e.status,""),n.Tb(1),n.Vc(" for ",e.collectionLabel,". ")}}function bc(e,t){if(1&e&&(n.kc(0,"div",68),n.Rc(1,hc,6,3,"alert",69),n.Rc(2,gc,7,3,"alert",70),n.Rc(3,mc,7,3,"alert",71),n.Rc(4,fc,4,3,"alert",72),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Ac("ngIf","Complete"===e.status&&0===e.actions.length),n.Tb(1),n.Ac("ngIf","Complete"===e.status&&0!==e.actions.length),n.Tb(1),n.Ac("ngIf","Failed"===e.status),n.Tb(1),n.Ac("ngIf","Failed"!==e.status&&"Complete"!==e.status)}}function kc(e,t){1&e&&n.gc(0,"i",78)}function vc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",80),n.kc(1,"input",81),n.sc("change",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleStyle(c)})),n.jc(),n.kc(2,"label",82),n.Tc(3),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(1),n.Ac("value",e.id)("checked",e.selected),n.Tb(2),n.Uc(e.label)}}function jc(e,t){if(1&e&&(n.kc(0,"div"),n.Rc(1,vc,4,3,"div",79),n.jc()),2&e){const e=n.uc();n.Tb(1),n.Ac("ngForOf",e.baseLayers)}}function Tc(e,t){1&e&&(n.kc(0,"span"),n.gc(1,"i",84),n.jc())}function yc(e,t){1&e&&(n.kc(0,"span"),n.gc(1,"i",85),n.jc())}function Cc(e,t){if(1&e&&(n.kc(0,"span"),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Vc(" ",e.label," / ")}}function Mc(e,t){if(1&e&&(n.Rc(0,Tc,2,0,"span",26),n.Rc(1,yc,2,0,"span",26),n.kc(2,"span"),n.Rc(3,Cc,2,1,"span",83),n.jc(),n.kc(4,"b"),n.Tc(5),n.jc()),2&e){const e=t.match;n.Ac("ngIf",null==e.item.filename),n.Tb(1),n.Ac("ngIf",null!=e.item.filename),n.Tb(2),n.Ac("ngForOf",e.item.hierarchy),n.Tb(2),n.Uc(e.item.label)}}const wc=function(){return{standalone:!0}};class Oc{constructor(e,t,c,n,i){this.service=e,this.authService=t,this.mapService=c,this.modalService=n,this.metadataService=i,this.userName="",this.search="",this.nodes=[],this.supportingData=[],this.breadcrumbs=[],this.admin=!1,this.worker=!1,this.active=!1,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.layers=[],this.baselayerIconHover=!1,this.tasks=[],this.subject=new q.b,this.subject.pipe(Object(R.a)(300),Object(P.a)()).subscribe(e=>this.handleExtentChange(e)),this.dataSource=k.a.create(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const c=t.features;this.service.searchEntites(this.search).then(t=>{c.forEach(e=>{let c={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};t.push(c)}),e.next(t)})})})}ngOnInit(){this.admin=this.authService.isAdmin(),this.worker=this.authService.isWorker(),this.userName=this.service.getCurrentUser();let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(qt.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"UPLOAD_JOB_CHANGE"===e.type&&this.tasks.push(e.content)})}ngOnDestroy(){this.map.remove(),this.notifier.complete()}ngAfterViewInit(){this.map=new m.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v11",zoom:2,attributionControl:!1,center:[-78.880453,42.897852]}),this.map.on("load",()=>{this.initMap()})}initMap(){this.map.on("style.load",()=>{this.addLayers(),this.refresh(!1)}),this.addLayers(),this.refresh(!0),this.map.addControl(new m.NavigationControl),this.map.addControl(new m.AttributionControl({compact:!0}),"bottom-left"),this.map.on("mousemove",e=>{let t=e.lngLat.wrap(),c="Lat: "+t.lat+" Long: "+t.lng;document.getElementById("mousemove-panel").textContent=c;let n=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(null==this.current)if(n.length>0){let e=n[0].properties.oid;this.map.setFilter("hover-points",["all",["==","oid",e]]),this.highlightListItem(e)}else this.map.setFilter("hover-points",["all",["==","oid","NONE"]]),this.clearHighlightListItem()}),this.map.on("zoomend",e=>{this.subject.next(e)}),this.map.on("moveend",e=>{this.subject.next(e)}),this.map.on("dblclick",e=>{let t=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(t.length>0){let e=t[0].properties.oid;this.handleViewSite(e)}}),document.getElementById("navigator-left-sidebar").addEventListener("mouseenter",(function(){document.getElementById("mousemove-panel").textContent=""}))}addLayers(){this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"points",type:"circle",source:"sites",paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}}),this.map.addLayer({id:"hover-points",type:"circle",source:"sites",paint:{"circle-radius":13,"circle-color":"#cf0000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["==","id","NONE"]]}),this.map.addLayer({id:"points-label",source:"sites",type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":"{name}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}}),this.layers.forEach(e=>{this.addImageLayer(e.workspace,e.mapKey)})}handleExtentChange(e){if(null==this.current){const e=this.map.getBounds();this.isValidBounds(e)&&this.service.roots(null,e).then(e=>{this.nodes=e})}}isValidBounds(e){const t=e.getNorthEast(),c=e.getSouthWest();return!(Math.abs(t.lng)>180||Math.abs(c.lng)>180)&&!(Math.abs(t.lat)>90||Math.abs(c.lat)>90)}refresh(e){this.mapService.features().then(t=>{if(this.map.getSource("sites").setData(t.features),e){let e=new m.LngLatBounds([t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]);this.map.fitBounds(e,{padding:50})}})}isData(e){return"Site"!==e.data.type&&("Project"!==e.data.type&&("Mission"!==e.data.type&&("Collection"!==e.data.type&&"Imagery"!==e.data.type)))}handleOnUpdateData(){}handleCloseToast(e){this.tasks.splice(e,1)}handleUploadFile(){this.bsModalRef=this.modalService.show(Nt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(this.breadcrumbs),this.bsModalRef.content.onUploadComplete.subscribe(e=>{this.service.getItems(this.current.id,null).then(e=>{this.setNodes(e)})})}handleCreate(e,t){let c=null!=e?e.id:null;this.service.newChild(c,t).then(t=>{this.bsModalRef=this.modalService.show(lt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(!0,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),null!=e&&(this.bsModalRef.content.parentId=e.id),this.bsModalRef.content.onNodeChange.subscribe(t=>{null!=e||(0==this.breadcrumbs.length&&this.nodes.push(t),this.refresh(!1))})})}zoomToFeature(e){null!=e.geometry&&this.map.flyTo({center:e.geometry.coordinates})}handleEdit(e,t){t.stopPropagation(),this.service.edit(e.id).then(t=>{this.bsModalRef=this.modalService.show(lt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"edit-modal"}),this.bsModalRef.content.init(!1,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),this.bsModalRef.content.onNodeChange.subscribe(t=>{t.children=e.children,t.active=e.active,this.refreshEntity(t,this.nodes),this.refreshEntity(t,this.breadcrumbs),this.nodes.forEach(e=>{this.refreshEntity(t,e.children)}),this.metadataService.getMetadata(t).root&&this.refresh(!1)})})}refreshEntity(e,t){if(null!=t){let c=t.findIndex(t=>t.id===e.id);-1!==c&&(t[c]=e)}}handleDownloadAll(e){window.location.href=acp+"/project/download-all?id="+e.component+"&key="+e.name}handleDelete(e,t){t.stopPropagation();let c="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files in Collections and Accessible Support";"Collection"===e.type&&(c="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files."),c+=" This can <b>NOT</b> be undone",this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.subText=c,this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.service.remove(e.id).then(()=>{this.nodes=this.nodes.filter(t=>t.id!==e.id),this.nodes.forEach(t=>{null!=t.children&&(t.children=t.children.filter(t=>t.id!==e.id),t.numberOfChildren=t.children.length)}),"Site"===e.type&&this.refresh(!1)})}handleDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleImageDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}highlightMapFeature(e){this.map.setFilter("hover-points",["all",["==","oid",e]])}clearHighlightMapFeature(){this.map.setFilter("hover-points",["all",["==","oid","NONE"]])}onListEntityHover(e,t){null==this.current&&this.highlightMapFeature(t.id)}onListEntityHoverOff(){this.clearHighlightMapFeature()}highlightListItem(e){this.nodes.forEach(t=>{t.id===e&&(this.hoverFeatureId=e)})}clearHighlightListItem(){this.hoverFeatureId&&this.nodes.forEach(e=>{e.id===this.hoverFeatureId&&(this.hoverFeatureId=null)})}handleClick(e){let t=e.item;if(t.center)this.map.flyTo({center:t.center,zoom:18});else{const e=t.hierarchy.length-1,c=t.hierarchy[e];this.handleViewSite(c.id)}}handleViewSite(e){this.service.view(e).then(e=>{const t=e.item,c=e.breadcrumbs;if(this.getMetadata(t).leaf)this.breadcrumbs=c,this.current=c[c.length-1],this.nodes=this.current.children,this.select(t,null,null);else{const e=c.length>0?c[c.length-1]:null;this.breadcrumbs=c,this.select(t,e,null)}})}handleMapImage(e){const t=e.mapKey;if(null!=t)if(null!=this.map.getLayer(t)){this.map.removeLayer(t),this.map.removeSource(t);var c=this.layers.findIndex(e=>e.mapKey===t);-1!==c&&this.layers.splice(c,1),e.orthoMapped=!1}else if(this.addImageLayer(e.workspace,t),this.layers.push({workspace:e.workspace,mapKey:t}),e.orthoMapped=!0,null!=e.boundingBox){let t=e.boundingBox,c=new m.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(c,{padding:50})}}addImageLayer(e,t){const c=encodeURI(e),n=encodeURI(c+":"+t);this.map.addLayer({id:t,type:"raster",source:{type:"raster",tiles:["/geoserver/"+c+"/wms?layers="+n+"&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&srs=EPSG:3857&transparent=true&width=256&height=256"],tileSize:256},paint:{}},"points")}handleGoto(){var e=new m.LngLatBounds([-111.12439336274211,39.32066259372583,-111.12342302258116,39.32107716199166]);this.map.fitBounds(e)}getMetadata(e){return this.metadataService.getMetadata(e)}select(e,t,c){if(null!=c&&c.stopPropagation(),this.metadataService.getMetadata(e).leaf){const c=[...this.breadcrumbs];null!=t&&c.push(t),this.metadataService.getTypeContainsFolders(e)?this.service.getItems(e.id,null).then(t=>{this.showLeafModal(e,t,c)}):this.showLeafModal(this.current,[e],c)}else"object"===e.type||this.service.getItems(e.id,null).then(c=>{this.current=e,null!=t&&this.addBreadcrumb(t),this.addBreadcrumb(e),this.setNodes(c)})}addBreadcrumb(e){0!=this.breadcrumbs.length&&this.breadcrumbs[this.breadcrumbs.length-1].id===e.id||this.breadcrumbs.push(e)}handleExpand(e,t){null!=t&&t.stopPropagation(),null==e.children||0==e.children.length?this.service.getItems(e.id,null).then(t=>{e.children=t,this.expand(e)}):(e.children=[],e.active=!1)}handleGotoSite(e){const t=e.entities[e.entities.length-1],c=e.entities;this.service.getItems(t.id,null).then(e=>{this.showLeafModal(t,e,c)})}back(e){null!=e?this.service.getItems(e.id,null).then(t=>{var c=this.breadcrumbs.findIndex(t=>t.id===e.id);this.current=e,this.breadcrumbs.splice(c+1),this.setNodes(t)}):this.breadcrumbs.length>0&&this.service.roots(null,this.map.getBounds()).then(e=>{this.current=null,this.breadcrumbs=[],this.setNodes(e),this.staticTabs.tabs[0].active=!0})}expand(e){e.active=!0,this.current=e}setNodes(e){this.nodes=[],this.supportingData=[],e.forEach(e=>{"folder"===e.type?this.supportingData.push(e):this.nodes.push(e)})}showLeafModal(e,t,c){"Mission"===e.type?(this.bsModalRef=this.modalService.show(Vt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,c)):(this.bsModalRef=this.modalService.show(Ae,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,c))}}Oc.ɵfac=function(e){return new(e||Oc)(n.fc(E),n.fc(U.a),n.fc(T),n.fc(D.b),n.fc(ie))},Oc.ɵcmp=n.Zb({type:Oc,selectors:[["projects"]],viewQuery:function(e,t){var c;(1&e&&(n.Xc(Ht,!0),n.Xc(Jt,!0)),2&e)&&(n.Ic(c=n.tc())&&(t.staticTabs=c.first),n.Ic(c=n.tc())&&(t.confirmTemplate=c.first))},decls:40,vars:20,consts:[["id","navigator-header-container"],[3,"title"],["id","app-container",1,"container-fluid",2,"background","#f7f7f7"],[1,"row"],["id","navigator-left-sidebar",1,"col-md-3","lw-inner-col"],[1,"col-md-12"],["class","row",4,"ngIf"],[1,"location-management-widget-section"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[1,"col-md-12",2,"background","#f7f7f7","padding","0","height","100%"],[1,"nav-full-width"],["staticTabs",""],["heading","Data"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container",2,"height","calc(100vh - 290px)","overflow-y","auto"],[1,"list-group"],["style","padding: 20px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["heading","Products",4,"ngIf"],[1,"sidebar-footer"],["class","row","style","background:white;",4,"ngIf"],["id","site-explorer-map",1,"col-md-9"],[2,"position","absolute","z-index","5","margin-left","100px","margin-top","10px"],["class","idm-toast",4,"ngFor","ngForOf"],[1,"base-layer-panel"],[1,"layer-toggle",2,"cursor","pointer","background","#fff","padding","8px","border-radius","4px",3,"mouseenter","mouseleave"],["class","fas fa-layer-group","style","vertical-align:middle; font-size: 18px;",4,"ngIf"],[4,"ngIf"],["id","mousemove-panel",1,"mapboxgl-ctrl-bottom-right",2,"background","rgba(255, 255, 255, .5)","right","0","padding","0 5px 0 5px","bottom","15px"],["id","map",1,"map-view-port"],["bsItemTemplate",""],[1,"col-md-6",2,"height","56px"],[1,"col-md-12",2,"height","56px","overflow","scroll"],[1,"breadcrumb",2,"background-color","white"],["aria-hidden","true",1,"fa","fa-angle-left","breadcrumb-back-ico"],[2,"color","#007276",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["style","color: #007276;",3,"click",4,"ngIf"],[2,"padding","20px","text-align","center","color","grey"],[1,"list-group-item"],["style","border-left: solid 15px;","class","card card-default clickable",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","card card-default clickable",3,"click",4,"ngIf"],[1,"card","card-default","clickable",2,"border-left","solid 15px",3,"ngClass","click","mouseenter","mouseleave"],[1,"card-body","card-5-7"],[1,"card-left"],[1,"fas","fa-map-marker-alt",2,"font-size","50px"],[1,"card-right"],[2,"word-break","break-all"],["class","pull-right button-column floating","style","top: 0;position: absolute;right: 0;",4,"ngIf"],[1,"pull-right","button-column","floating",2,"top","0","position","absolute","right","0"],["title","Edit",1,"fa","fa-pencil-alt","ico-edit",3,"click"],["title","Delete",1,"fa","fa-trash-alt","ico-remove",3,"click"],[1,"card","card-default","clickable",3,"click"],[1,"card-body"],["aria-hidden","true",1,"fa","fa-caret-left","expand-arrow-ico","pull-right",2,"font-size","25px","padding","0 5px",3,"ngClass","click"],[1,"list-group",2,"margin-bottom","0",3,"collapse"],["class","list-group-item","style","background-color: #ececec;border: solid 1px lightgrey;border-radius: 0;",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0",3,"click"],["class","pull-right button-column",4,"ngIf"],[1,"pull-right","button-column"],[1,"card","card-default"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0"],[3,"click"],["heading","Products"],[3,"id","toggleMapImage"],[1,"row",2,"background","white"],[1,"col-md-12",2,"text-align","center","padding","10px","border-top","1px solid lightgrey"],[1,"btn","btn-primary",3,"click"],[1,"idm-toast"],["type","success",3,"dismissible","onClosed",4,"ngIf"],["type","warning",3,"dismissible","onClosed",4,"ngIf"],["type","danger",3,"dismissible","onClosed",4,"ngIf"],["type","info",3,"dismissible","onClosed",4,"ngIf"],["type","success",3,"dismissible","onClosed"],["type","warning",3,"dismissible","onClosed"],["routerLink","/site/tasks"],["type","danger",3,"dismissible","onClosed"],["type","info",3,"dismissible","onClosed"],[1,"fas","fa-layer-group",2,"vertical-align","middle","font-size","18px"],["class","row-form",4,"ngFor","ngForOf"],[1,"row-form"],["type","radio","name","rtoggle",1,"layer-toggle-input",3,"value","checked","change"],[1,"layer-toggle-label"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(n.kc(0,"div",0),n.gc(1,"uasdm-header",1),n.jc(),n.kc(2,"div",2),n.kc(3,"div",3),n.kc(4,"div",4),n.kc(5,"div",3),n.kc(6,"div",5),n.Rc(7,Wt,4,0,"div",6),n.Rc(8,Xt,8,1,"div",6),n.kc(9,"div",3),n.kc(10,"div",5),n.kc(11,"div",7),n.kc(12,"input",8),n.sc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(13,"div",3),n.kc(14,"div",9),n.kc(15,"tabset",10,11),n.kc(17,"tab",12),n.kc(18,"div",13),n.kc(19,"div",14),n.Rc(20,ec,5,1,"div",15),n.Rc(21,tc,5,1,"div",15),n.Rc(22,lc,3,3,"div",16),n.Rc(23,rc,9,2,"div",16),n.jc(),n.jc(),n.jc(),n.Rc(24,dc,3,1,"tab",17),n.jc(),n.jc(),n.jc(),n.kc(25,"footer",18),n.Rc(26,uc,4,0,"div",19),n.Rc(27,pc,4,0,"div",19),n.jc(),n.jc(),n.kc(28,"div",20),n.kc(29,"div",3),n.kc(30,"article",21),n.Rc(31,bc,5,4,"div",22),n.jc(),n.kc(32,"article",23),n.kc(33,"div",24),n.sc("mouseenter",(function(){return t.baselayerIconHover=!0}))("mouseleave",(function(){return t.baselayerIconHover=!1})),n.Rc(34,kc,1,0,"i",25),n.Rc(35,jc,2,1,"div",26),n.jc(),n.jc(),n.gc(36,"div",27),n.gc(37,"div",28),n.jc(),n.jc(),n.jc(),n.jc(),n.Rc(38,Mc,6,4,"ng-template",null,29,n.Sc)),2&e){const e=n.Jc(39);n.Tb(1),n.Ac("title","Site Viewer"),n.Tb(6),n.Ac("ngIf",!t.current),n.Tb(1),n.Ac("ngIf",t.current),n.Tb(4),n.Ac("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",n.Dc(19,wc)),n.Tb(8),n.Ac("ngIf",t.nodes.length<1&&0===t.breadcrumbs.length),n.Tb(1),n.Ac("ngIf",t.nodes.length<1&&t.breadcrumbs.length>0),n.Tb(1),n.Ac("ngForOf",t.nodes),n.Tb(1),n.Ac("ngForOf",t.supportingData),n.Tb(1),n.Ac("ngIf",null!=t.current),n.Tb(2),n.Ac("ngIf",null!=t.current),n.Tb(1),n.Ac("ngIf",null==t.current),n.Tb(4),n.Ac("ngForOf",t.tasks),n.Tb(3),n.Ac("ngIf",!t.baselayerIconHover),n.Tb(1),n.Ac("ngIf",t.baselayerIconHover)}},directives:[Bt.a,i.k,a.a,a.h,a.k,r.a,u.c,u.a,i.j,i.i,g.a,Ke,p.a,s.d],styles:["./projects.css"],data:{animation:[Object(ce.c)(),Object(ce.d)()]}});var Sc=c(41);const Ic=["uploader"];function Ac(e,t){1&e&&(n.kc(0,"div",3),n.gc(1,"div",4),n.kc(2,"div",5),n.kc(3,"h4",6),n.Tc(4," There are no Sites added to the system. Add a Site, Project, Mission, and Collection using the "),n.kc(5,"a",7),n.Tc(6,"Site Viewer"),n.jc(),n.Tc(7," before uploading data to. "),n.jc(),n.jc(),n.gc(8,"div",4),n.jc())}function xc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",17),n.kc(1,"div",18),n.kc(2,"div",19),n.Tc(3,"Partial Upload Detected"),n.jc(),n.kc(4,"div",20),n.kc(5,"h4"),n.Tc(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),n.jc(),n.kc(7,"h4"),n.kc(8,"b"),n.Tc(9,"To continue an upload"),n.jc(),n.Tc(10," please click the Continue Upload button and re-upload your file and we will try our best to continue where you left off. "),n.jc(),n.gc(11,"hr"),n.kc(12,"button",21),n.sc("click",(function(t){return n.Lc(e),n.uc(2).removeUpload(t)})),n.gc(13,"i",16),n.Tc(14," Cancel Upload "),n.jc(),n.kc(15,"button",22),n.sc("click",(function(){return n.Lc(e),n.uc(2).showUploadPanel()})),n.gc(16,"i",16),n.Tc(17," Continue Upload "),n.jc(),n.jc(),n.jc(),n.jc()}}function Rc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",23),n.kc(1,"div",19),n.Tc(2," Upload Details "),n.kc(3,"i",24),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).closeTaskFinishedNotification(c.id)})),n.jc(),n.jc(),n.kc(4,"div",20),n.kc(5,"h4"),n.Tc(6," Status: "),n.kc(7,"b"),n.Tc(8," Upload successfully completed "),n.jc(),n.jc(),n.kc(9,"h4"),n.Tc(10," Message: "),n.kc(11,"b"),n.Tc(12," Your uploaded data is being processed into final image products. "),n.jc(),n.jc(),n.jc(),n.jc()}}function Pc(e,t){if(1&e&&(n.kc(0,"option",38),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.id),n.Tb(1),n.Uc(e.name)}}function Fc(e,t){if(1&e&&(n.kc(0,"option",38),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.id),n.Tb(1),n.Uc(e.name)}}function Lc(e,t){if(1&e&&(n.kc(0,"option",38),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.id),n.Tb(1),n.Uc(e.name)}}function Nc(e,t){if(1&e&&(n.kc(0,"option",38),n.Tc(1),n.jc()),2&e){const e=t.$implicit;n.Ac("value",e.id),n.Tb(1),n.Vc("",e.name," ")}}function Uc(e,t){if(1&e){const e=n.lc();n.kc(0,"div",25),n.kc(1,"div",26),n.kc(2,"label",27),n.Tc(3,"Site:"),n.jc(),n.kc(4,"select",28),n.sc("change",(function(t){return n.Lc(e),n.uc(2).onSiteSelect(t.target.value)}))("ngModelChange",(function(t){return n.Lc(e),n.uc(2).values.site=t})),n.gc(5,"option"),n.Rc(6,Pc,2,2,"option",29),n.jc(),n.jc(),n.kc(7,"div",26),n.kc(8,"label",30),n.Tc(9,"Project:"),n.jc(),n.kc(10,"select",31),n.sc("change",(function(t){return n.Lc(e),n.uc(2).onProjectSelect(t.target.value)}))("ngModelChange",(function(t){return n.Lc(e),n.uc(2).values.project=t})),n.gc(11,"option"),n.Rc(12,Fc,2,2,"option",29),n.jc(),n.jc(),n.kc(13,"div",26),n.kc(14,"label",32),n.Tc(15,"Mission:"),n.jc(),n.kc(16,"select",33),n.sc("change",(function(t){return n.Lc(e),n.uc(2).onMissionSelect(t.target.value)}))("ngModelChange",(function(t){return n.Lc(e),n.uc(2).values.mission=t})),n.gc(17,"option"),n.Rc(18,Lc,2,2,"option",29),n.jc(),n.jc(),n.kc(19,"div",26),n.kc(20,"label",34),n.Tc(21,"Collection:"),n.jc(),n.kc(22,"select",35),n.sc("change",(function(t){return n.Lc(e),n.uc(2).onCollectionSelect(t.target.value)}))("ngModelChange",(function(t){return n.Lc(e),n.uc(2).values.collection=t})),n.gc(23,"option"),n.Rc(24,Nc,2,2,"option",29),n.jc(),n.jc(),n.kc(25,"div",26),n.kc(26,"label",36),n.Tc(27,"Output Product Name Prefix"),n.jc(),n.kc(28,"input",37),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc(2).values.outFileName=t})),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc(2);n.Tb(4),n.Ac("ngModel",e.values.site),n.Tb(2),n.Ac("ngForOf",e.sites),n.Tb(4),n.Ac("ngModel",e.values.project),n.Ub("disabled",null==e.values.site?"":null),n.Tb(2),n.Ac("ngForOf",e.projects),n.Tb(4),n.Ac("ngModel",e.values.mission),n.Ub("disabled",null==e.values.project?"":null),n.Tb(2),n.Ac("ngForOf",e.missions),n.Tb(4),n.Ac("ngModel",e.values.collection),n.Ub("disabled",null==e.values.mission?"":null),n.Tb(2),n.Ac("ngForOf",e.collections),n.Tb(4),n.Ac("ngModel",e.values.outFileName)}}function Ec(e,t){if(1&e&&(n.kc(0,"div",18),n.kc(1,"div",19),n.Tc(2,"Upload Details"),n.jc(),n.kc(3,"div",20),n.kc(4,"h4"),n.Tc(5," Status: "),n.kc(6,"b"),n.Tc(7),n.jc(),n.jc(),n.kc(8,"h4"),n.Tc(9," Message: "),n.kc(10,"b"),n.Tc(11),n.jc(),n.jc(),n.kc(12,"h4"),n.Tc(13," Upload Started On: "),n.kc(14,"b"),n.Tc(15),n.jc(),n.jc(),n.kc(16,"h4"),n.Tc(17," Last Updated: "),n.kc(18,"b"),n.Tc(19),n.jc(),n.jc(),n.kc(20,"h4"),n.Tc(21," Elapsed Time: "),n.kc(22,"b"),n.Tc(23),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(7),n.Vc(" ",e.currentTask.status," "),n.Tb(4),n.Vc(" ",e.currentTask.message," "),n.Tb(4),n.Vc(" ",e.currentTask.createDate," "),n.Tb(4),n.Vc(" ",e.currentTask.lastUpdatedDate," "),n.Tb(4),n.Vc(" ",e.uploadCounter," ")}}function Dc(e,t){1&e&&n.gc(0,"div",39,40)}function $c(e,t){if(1&e){const e=n.lc();n.kc(0,"div",3),n.gc(1,"div",4),n.kc(2,"div",5),n.kc(3,"form",null,8),n.Rc(5,xc,18,0,"div",9),n.Rc(6,Rc,13,0,"div",10),n.Rc(7,Uc,29,12,"div",11),n.kc(8,"div",12),n.Rc(9,Ec,24,5,"div",13),n.Rc(10,Dc,2,0,"div",14),n.kc(11,"button",15),n.sc("click",(function(){return n.Lc(e),n.uc().handleUpload()})),n.gc(12,"i",16),n.Tc(13," Upload "),n.jc(),n.jc(),n.jc(),n.jc(),n.gc(14,"div",4),n.jc()}if(2&e){const e=n.Jc(4),t=n.uc();n.Tb(5),n.Ac("ngIf",t.existingTask&&!t.currentTask),n.Tb(1),n.Ac("ngForOf",t.taskFinishedNotifications),n.Tb(1),n.Ac("ngIf",!t.disabled&&!t.existingTask),n.Tb(1),n.Ac("hidden",!t.uploadVisible),n.Tb(1),n.Ac("ngIf",t.currentTask),n.Tb(1),n.Ac("ngIf",t.showFileSelectPanel),n.Tb(1),n.Ac("disabled",!e.valid||t.disabled)}}class _c{constructor(e,t,c){this.service=e,this.modalService=t,this.sites=[],this.projects=[],this.missions=[],this.collections=[],this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.differ=c.find([]).create()}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}set content(e){const t=this;if(null!=e&&null==this.uploader){let c={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,c){t.disabled=!0,t.countUpload(t)},onProgress:function(e,t,c,n){},onUploadChunk:function(e,t,c){},onUploadChunkSuccess:function(e,c,n,i){n.message&&n.message.currentTask&&!t.currentTask&&(t.currentTask=n.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(rt.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(dt.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,c,n,i){t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),t.taskFinishedNotifications.push({id:e})},onCancel:function(e,c){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,c,n){t.error(n)}}};this.uploader=new ut.FineUploader(c)}}ngAfterViewInit(){}ngOnInit(){this.service.roots(null,null).then(e=>{this.sites=e})}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0,this.selectedContinue||this.hideUploadPanel())}onSiteSelect(e){this.values.site=e,null!=e&&e.length>0&&(this.projects=[],this.missions=[],this.collections=[],this.values.project=null,this.values.mission=null,this.values.collection=null,this.service.getChildren(this.values.site).then(e=>{this.projects=e}))}onProjectSelect(e){this.values.project=e,this.missions=[],this.collections=[],this.values.mission=null,this.values.collection=null,null!=e&&e.length>0&&this.service.getChildren(this.values.project).then(e=>{this.missions=e.filter(e=>"Mission"===e.type)})}onMissionSelect(e){this.values.mission=e,this.collections=[],this.values.collection=null,this.values.name=null,null!=e&&e.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}handleChange(){this.collections=[],this.values.collection=null,this.values.name=null,null!=this.values.mission&&this.values.mission.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}onCollectionSelect(e){this.values.collection=e,this.values.uasComponentOid=e,e&&e.trim().length>0?this.showFileSelectPanel=!0:this.showFileSelectPanel=!1}handleUpload(){this.values.create||null!=this.values.collection||this.existingTask?!this.values.create||null!=this.values.mission&&null!=this.values.name&&0!=this.values.name.length||this.existingTask?(this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()):(this.bsModalRef=this.modalService.show(Sc.a,{backdrop:!0}),this.bsModalRef.content.message="Name is required"):(this.bsModalRef=this.modalService.show(Sc.a,{backdrop:!0}),this.bsModalRef.content.message="A collection must first be selected before the file can be uploaded")}removeUpload(e){let t=this;this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Cancel Upload",this.bsModalRef.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),t.existingTask=!1,t.showUploadPanel()})})}hideUploadPanel(){this.uploadVisible=!1}showUploadPanel(){this.uploadVisible=!0,this.selectedContinue=!0}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let c=Math.floor(t/3600),n=Math.floor(t%3600/60),i=Math.floor(t%60),s=n<10?"0"+c:c,a=n<10?"0"+n:n,o=i<10?"0"+i:i;e.uploadCounter=s+":"+a+":"+o}),1e3)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}error(e){null!==e&&(this.bsModalRef=this.modalService.show(Sc.a,{backdrop:!0}),this.bsModalRef.content.message=e)}}function Gc(e,t){if(1&e){const e=n.lc();n.kc(0,"button",19),n.sc("click",(function(){n.Lc(e);const t=n.uc(2).$implicit;return t.showError=!t.showError})),n.Tc(1),n.jc()}if(2&e){const e=n.uc(2).$implicit;n.Tb(1),n.Vc("",e.showError?"Hide":"Show"," Messages")}}_c.ɵfac=function(e){return new(e||_c)(n.fc(E),n.fc(D.b),n.fc(n.E))},_c.ɵcmp=n.Zb({type:_c,selectors:[["upload"]],viewQuery:function(e,t){var c;(1&e&&n.Xc(Ic,!0),2&e)&&(n.Ic(c=n.tc())&&(t.content=c.first))},hostBindings:function(e,t){1&e&&n.sc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,n.Kc)},decls:4,vars:3,consts:[[3,"title"],["id","app-container",1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-2"],[1,"col-md-8"],[2,"margin-top","50px"],["routerlink","/viewer","routerlinkactive","active","href","#/viewer"],["ngForm","ngForm"],["class","",4,"ngIf"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],["style","margin-top: 30px;","class","",4,"ngIf"],[1,"",3,"hidden"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],["class","uploader-container","style","margin-top: 20px;",4,"ngIf"],["type","button btn btn-primary",1,"btn","btn-primary",2,"margin-top","20px",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,""],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],["type","button",1,"btn","btn-danger",2,"margin-top","20px",3,"click"],["type","button",1,"btn","btn-primary",2,"margin-top","20px",3,"click"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],[1,"",2,"margin-top","30px"],[1,"form-group"],["for","site"],["name","site","required","",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","project"],["name","project","required","",3,"ngModel","change","ngModelChange"],["for","mission"],["name","mission","required","",3,"ngModel","change","ngModelChange"],["for","collection"],["name","collection","required","",3,"ngModel","change","ngModelChange"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""]],template:function(e,t){1&e&&(n.gc(0,"uasdm-header",0),n.kc(1,"div",1),n.Rc(2,Ac,9,0,"div",2),n.Rc(3,$c,15,7,"div",2),n.jc()),2&e&&(n.Ac("title","Data Upload"),n.Tb(2),n.Ac("ngIf",0===t.sites.length),n.Tb(1),n.Ac("ngIf",t.sites.length>0))},directives:[Bt.a,i.k,a.r,a.i,a.j,i.j,a.p,a.o,a.h,a.k,a.l,a.q,a.a],encapsulation:2});const zc=function(e,t,c){return{success:e,pending:t,fail:c}};function Vc(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"ul",12),n.kc(2,"li"),n.Tc(3,"Status: "),n.kc(4,"b",6),n.Tc(5),n.jc(),n.jc(),n.kc(6,"li"),n.Tc(7,"Created on: "),n.kc(8,"b"),n.Tc(9),n.jc(),n.jc(),n.kc(10,"li"),n.Tc(11,"Last update: "),n.kc(12,"b"),n.Tc(13),n.jc(),n.jc(),n.kc(14,"li",13),n.Tc(15,"Message: "),n.kc(16,"b"),n.Tc(17),n.jc(),n.jc(),n.jc(),n.kc(18,"div",14),n.kc(19,"div",15),n.kc(20,"div",16),n.Rc(21,Gc,2,1,"button",17),n.kc(22,"button",18),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc().removeTask(t)})),n.Tc(23,"Delete Task"),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc().$implicit;n.Tb(4),n.Ac("ngClass",n.Gc(6,zc,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),n.Tb(1),n.Uc(e.status),n.Tb(4),n.Uc(e.createDate),n.Tb(4),n.Uc(e.lastUpdatedDate),n.Tb(4),n.Uc(e.message),n.Tb(4),n.Ac("ngIf",e.actions.length>0)}}function qc(e,t){if(1&e){const e=n.lc();n.kc(0,"button",19),n.sc("click",(function(){n.Lc(e);const t=n.uc(2).$implicit;return t.showError=!t.showError})),n.Tc(1),n.jc()}if(2&e){const e=n.uc(2).$implicit;n.Tb(1),n.Vc("",e.showError?"Hide":"Show"," Messages")}}function Bc(e,t){if(1&e){const e=n.lc();n.kc(0,"button",19),n.sc("click",(function(){n.Lc(e);const t=n.uc(3);return t.showODMOutput=!t.showODMOutput})),n.Tc(1,"Show Detailed Log Output"),n.jc()}}function Hc(e,t){if(1&e&&(n.kc(0,"div",14),n.kc(1,"div",15),n.kc(2,"h4"),n.Tc(3,"Output:"),n.jc(),n.gc(4,"textarea",20),n.jc(),n.jc()),2&e){const e=n.uc(2).$implicit;n.Tb(4),n.Ac("innerHTML",e.odmOutput,n.Mc)}}function Jc(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"ul",12),n.kc(2,"li"),n.Tc(3,"Status: "),n.kc(4,"b",6),n.Tc(5),n.jc(),n.jc(),n.kc(6,"li"),n.Tc(7,"Message: "),n.kc(8,"b"),n.Tc(9),n.jc(),n.jc(),n.kc(10,"li"),n.Tc(11,"Created on: "),n.kc(12,"b"),n.Tc(13),n.jc(),n.jc(),n.kc(14,"li"),n.Tc(15,"Last update: "),n.kc(16,"b"),n.Tc(17),n.jc(),n.jc(),n.jc(),n.kc(18,"div",14),n.kc(19,"div",15),n.kc(20,"div",16),n.Rc(21,qc,2,1,"button",17),n.Rc(22,Bc,2,0,"button",17),n.kc(23,"button",18),n.sc("click",(function(){n.Lc(e);const t=n.uc().$implicit;return n.uc().removeTask(t)})),n.Tc(24,"Delete Task"),n.jc(),n.jc(),n.jc(),n.jc(),n.Rc(25,Hc,5,1,"div",11),n.jc()}if(2&e){const e=n.uc().$implicit,t=n.uc();n.Tb(4),n.Ac("ngClass",n.Gc(8,zc,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),n.Tb(1),n.Vc(" ","Complete"===e.status&&e.actions.length>0?"Complete With Messages":e.status," "),n.Tb(4),n.Uc(e.message),n.Tb(4),n.Uc(e.createDate),n.Tb(4),n.Uc(e.lastUpdatedDate),n.Tb(4),n.Ac("ngIf",e.actions.length>0),n.Tb(1),n.Ac("ngIf",e.odmOutput),n.Tb(3),n.Ac("ngIf",e.odmOutput&&t.showODMOutput)}}function Wc(e,t){1&e&&(n.kc(0,"h4",23),n.Tc(1,"There are no actions for this task."),n.jc())}function Zc(e,t){if(1&e&&(n.kc(0,"tr"),n.kc(1,"th",26),n.Tc(2),n.jc(),n.kc(3,"td"),n.Tc(4),n.jc(),n.kc(5,"td"),n.Tc(6),n.jc(),n.kc(7,"td"),n.Tc(8),n.jc(),n.jc()),2&e){const e=t.$implicit,c=t.index;n.Tb(2),n.Uc(c+1),n.Tb(2),n.Uc(e.description),n.Tb(2),n.Uc(e.createDate),n.Tb(2),n.Uc(e.lastUpdatedDate)}}function Kc(e,t){if(1&e&&(n.kc(0,"table",24),n.kc(1,"thead"),n.kc(2,"tr"),n.kc(3,"th"),n.Tc(4,"#"),n.jc(),n.kc(5,"th"),n.Tc(6,"Description"),n.jc(),n.kc(7,"th"),n.Tc(8,"Creation Date"),n.jc(),n.kc(9,"th"),n.Tc(10,"Last Updated"),n.jc(),n.jc(),n.jc(),n.kc(11,"tbody"),n.Rc(12,Zc,9,4,"tr",25),n.jc(),n.jc()),2&e){const e=n.uc(2).$implicit;n.Tb(12),n.Ac("ngForOf",e.actions)}}function Yc(e,t){if(1&e&&(n.kc(0,"div",14),n.kc(1,"div",15),n.Rc(2,Wc,2,0,"h4",21),n.Rc(3,Kc,13,1,"table",22),n.jc(),n.jc()),2&e){const e=n.uc().$implicit;n.Tb(2),n.Ac("ngIf",0===e.actions.length),n.Tb(1),n.Ac("ngIf",e.actions.length>0)}}function Qc(e,t){if(1&e&&(n.kc(0,"div",9),n.Rc(1,Vc,24,10,"div",10),n.Rc(2,Jc,26,12,"div",10),n.Rc(3,Yc,4,2,"div",11),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Ac("ngIf","Complete"!==e.status&&"Failed"!==e.status&&"Error"!==e.status),n.Tb(1),n.Ac("ngIf","Complete"===e.status||"Failed"===e.status||"Error"===e.status),n.Tb(1),n.Ac("ngIf",e.showError)}}const Xc=function(e,t,c,n){return{success:e,warning:t,pending:c,fail:n}};class en{constructor(e,t){this.managementService=e,this.modalService=t,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.showODMOutput=!1,this.showError=!1,this.taskGroups=[]}ngOnInit(){if(null!=this.taskGroupType&&null!=this.taskGroupType.tasks)for(var e=0;e<this.taskGroupType.tasks.length;++e){let t=this.taskGroupType.tasks[e];t.actions.length>0&&(t.showError=!0)}}ngOnDestroy(){}removeTask(e){this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let c=0;c<this.taskGroupType.tasks.length;c++){if(this.taskGroupType.tasks[c].uploadId===e.uploadId){t=c;break}}null!==t&&this.taskGroupType.tasks.splice(t,1)})}}function tn(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.kc(2,"b"),n.Tc(3),n.jc(),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(3),n.Uc(e)}}function cn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",20),n.kc(1,"div",21),n.kc(2,"div",2),n.kc(3,"div",16),n.kc(4,"div"),n.gc(5,"span",22),n.Tc(6),n.jc(),n.kc(7,"div",23),n.kc(8,"ul",24),n.Rc(9,tn,4,1,"li",25),n.kc(10,"li",9),n.kc(11,"a",26),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleGoto(c.collectionId)})),n.Tc(12),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(13,"div",27),n.kc(14,"div"),n.kc(15,"button",28),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleGoto(c.collectionId)})),n.Tc(16,"View Collection"),n.jc(),n.kc(17,"button",29),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleMessage(c)})),n.Tc(18,"Add Metadata"),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(6),n.Vc(" ",e.message," "),n.Tb(3),n.Ac("ngForOf",e.ancestors),n.Tb(3),n.Vc(" ",e.collectionName,"")}}en.ɵfac=function(e){return new(e||en)(n.fc(E),n.fc(D.b))},en.ɵcmp=n.Zb({type:en,selectors:[["tasks-panel"]],inputs:{taskGroupType:"taskGroupType",groupTypeId:"groupTypeId",taskCategory:"taskCategory"},decls:13,vars:13,consts:[[1,"panel-group"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","panel-heading-light","clickable",2,"margin-top","20px"],[1,"panel-title"],["data-toggle","collapse",3,"click"],[1,"heading-status-label","pull-right"],[3,"ngClass"],[1,"panel-body",3,"id","isAnimated","collapse"],["class","task-container",4,"ngFor","ngForOf"],[1,"task-container"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"list-unstyled",2,"margin","0"],[2,"word-break","break-all"],[1,"row"],[1,"col-sm-12"],[1,"button-holder",2,"margin-top","30px"],["class","btn btn-default",3,"click",4,"ngIf"],[1,"btn","btn-default","caution",3,"click"],[1,"btn","btn-default",3,"click"],[2,"color","grey","width","500px","height","200px",3,"innerHTML"],["style","color:grey;",4,"ngIf"],["class","table table-bordered",4,"ngIf"],[2,"color","grey"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["scope","row"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.kc(1,"div",1),n.kc(2,"div",2),n.kc(3,"h4",3),n.kc(4,"a",4),n.sc("click",(function(){return t.showProcess=!t.showProcess})),n.kc(5,"h4"),n.Tc(6),n.jc(),n.jc(),n.jc(),n.kc(7,"span",5),n.Tc(8,"Current status: "),n.kc(9,"span",6),n.Tc(10),n.jc(),n.jc(),n.jc(),n.kc(11,"div",7),n.Rc(12,Qc,4,3,"div",8),n.jc(),n.jc(),n.jc()),2&e&&(n.Tb(4),n.Vb("aria-controls","task-group-panel-",t.groupTypeId,""),n.Tb(2),n.Uc(t.taskCategory),n.Tb(3),n.Ac("ngClass",n.Hc(8,Xc,"Complete"===t.taskGroupType.status,"Warning"===t.taskGroupType.status,"Queued"===t.taskGroupType.status||"Processing"===t.taskGroupType.status,"Failed"===t.taskGroupType.status)),n.Tb(1),n.Uc(t.taskGroupType.status),n.Tb(1),n.Cc("id","task-group-panel-",t.groupTypeId,""),n.Ac("isAnimated",!1)("collapse",!t.showProcess),n.Tb(1),n.Ac("ngForOf",t.taskGroupType.tasks))},directives:[i.i,g.a,i.j,i.k],styles:[".button-holder[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\n\tmargin-right: 10px;\n}\n.btn.btn-danger[_ngcontent-%COMP%] {\n    background-color: #d9534f !important;\n    border-color: #d43f3a !important;\n}\n.btn.btn-danger[_ngcontent-%COMP%]:hover {\n    background-color: #d2322d !important;\n    border-color: #ac2925 !important;\n}\n.btn.btn-default.caution[_ngcontent-%COMP%]:hover {\n\tborder-color: #ac2925 !important;\n\tcolor: #ac2925 !important;\n}\n\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%]{\n  background-color: #e9e9e9;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}\n\n\n.dot[_ngcontent-%COMP%] {\n  height: 20px;\n  width: 20px;\n  background-color: #bbb;\n  border-radius: 50%;\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 10px;\n}\n.dot.success[_ngcontent-%COMP%] {\n  background-color: #6CB46F;\n}\n.dot.pending[_ngcontent-%COMP%] {    \n  background-color: #FF8C42;\n}\n.dot.warning[_ngcontent-%COMP%] {\n  background-color: #2C88CB;\n}\n.dot.fail[_ngcontent-%COMP%] {\n  background-color:#BF1E1E;\n}\n.dot.pending.blink[_ngcontent-%COMP%] {\n   animation-duration: 400ms;\n   animation-name: blink;\n   animation-iteration-count: infinite;\n   animation-direction: alternate;\n}\n@keyframes blink {\n   from {\n      opacity: 1;\n   }\n   to {\n      opacity: .5;\n   }\n }"]});const nn=function(e,t,c){return{id:"message-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:c}};function sn(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"h2"),n.Tc(2,"Tasks"),n.jc(),n.kc(3,"div",15),n.kc(4,"div",2),n.kc(5,"h3",16),n.Tc(6,"Issue"),n.jc(),n.kc(7,"h3",17),n.Tc(8,"Actions"),n.jc(),n.jc(),n.Rc(9,cn,19,3,"div",18),n.vc(10,"paginate"),n.kc(11,"div",2),n.kc(12,"pagination-controls",19),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onMessagePageChange(t)})),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(9),n.Ac("ngForOf",n.xc(10,1,e.messages.resultSet,n.Gc(4,nn,e.messages.pageSize,e.messages.pageNumber,e.messages.count)))}}function an(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.kc(2,"b"),n.Tc(3),n.jc(),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(3),n.Uc(e)}}function on(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Upload")}}function ln(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Process")}}function rn(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Store")}}function dn(e,t){if(1&e&&(n.kc(0,"div",42),n.Rc(1,on,2,3,"div",6),n.Rc(2,ln,2,3,"div",6),n.Rc(3,rn,2,3,"div",6),n.jc()),2&e){const e=n.uc(),t=e.index,c=e.$implicit;n.Ac("id","task"+t),n.Tb(1),n.Ac("ngIf","UPLOAD"===c.type),n.Tb(1),n.Ac("ngIf","PROCESS"===c.type),n.Tb(1),n.Ac("ngIf","STORE"===c.type)}}function un(e,t){if(1&e&&(n.kc(0,"div"),n.Rc(1,dn,4,4,"div",41),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Ac("ngIf",e.tasks.length>0)}}const pn=function(e,t,c,n){return{success:e,warning:t,"pending blink":c,fail:n}};function hn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",34),n.kc(1,"div",35),n.kc(2,"h4",36),n.kc(3,"a",37),n.sc("click",(function(){const e=t.$implicit;return e.visible=!e.visible})),n.kc(4,"h4"),n.Tc(5),n.jc(),n.jc(),n.jc(),n.gc(6,"span",38),n.kc(7,"button",39),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleGoto(c.collectionId)})),n.Tc(8,"View Collection"),n.jc(),n.kc(9,"div",23),n.kc(10,"ul",24),n.Rc(11,an,4,1,"li",25),n.kc(12,"li",9),n.Tc(13),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(14,"div",40),n.Rc(15,un,2,1,"div",25),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=t.index;n.Tb(3),n.Ub("aria-expanded",!e.visible)("aria-controls","taskGroup"+c),n.Tb(2),n.Uc(e.label),n.Tb(1),n.Ac("ngClass",n.Hc(9,pn,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),n.Tb(5),n.Ac("ngForOf",e.ancestors),n.Tb(2),n.Vc(" ",e.label," "),n.Tb(1),n.Ac("isAnimated",!1)("collapse",!e.visible),n.Tb(1),n.Ac("ngForOf",e.groups)}}const gn=function(e,t,c){return{id:"tasks-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:c}};function mn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",30),n.kc(1,"div",31),n.Rc(2,hn,16,14,"div",32),n.vc(3,"paginate"),n.kc(4,"pagination-controls",33),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(2),n.Ac("ngForOf",n.xc(3,1,e.collectionGroups,n.Gc(4,gn,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function fn(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.kc(2,"b"),n.Tc(3),n.jc(),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(3),n.Uc(e)}}function bn(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Upload")}}function kn(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Process")}}function vn(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Store")}}function jn(e,t){if(1&e&&(n.kc(0,"div",42),n.Rc(1,bn,2,3,"div",6),n.Rc(2,kn,2,3,"div",6),n.Rc(3,vn,2,3,"div",6),n.jc()),2&e){const e=n.uc(),t=e.index,c=e.$implicit;n.Ac("id","task"+t),n.Tb(1),n.Ac("ngIf","UPLOAD"===c.type),n.Tb(1),n.Ac("ngIf","PROCESS"===c.type),n.Tb(1),n.Ac("ngIf","STORE"===c.type)}}function Tn(e,t){if(1&e&&(n.kc(0,"div"),n.Rc(1,jn,4,4,"div",41),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Ac("ngIf",e.tasks.length>0)}}function yn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",34),n.kc(1,"div",35),n.kc(2,"h4",36),n.kc(3,"a",37),n.sc("click",(function(){const e=t.$implicit;return e.visible=!e.visible})),n.kc(4,"h4"),n.Tc(5),n.jc(),n.jc(),n.jc(),n.gc(6,"span",38),n.kc(7,"button",39),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleGoto(c.collectionId)})),n.Tc(8,"View Collection"),n.jc(),n.kc(9,"div",23),n.kc(10,"ul",24),n.Rc(11,fn,4,1,"li",25),n.kc(12,"li",9),n.Tc(13),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(14,"div",40),n.Rc(15,Tn,2,1,"div",25),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=t.index;n.Tb(3),n.Ub("aria-expanded",!e.visible)("aria-controls","taskGroup"+c),n.Tb(2),n.Uc(e.label),n.Tb(1),n.Ac("ngClass",n.Hc(9,pn,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),n.Tb(5),n.Ac("ngForOf",e.ancestors),n.Tb(2),n.Vc(" ",e.label," "),n.Tb(1),n.Ac("isAnimated",!1)("collapse",!e.visible),n.Tb(1),n.Ac("ngForOf",e.groups)}}function Cn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",44),n.kc(1,"div",31),n.Rc(2,yn,16,14,"div",32),n.vc(3,"paginate"),n.kc(4,"pagination-controls",33),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(2),n.Ac("ngForOf",n.xc(3,1,e.collectionGroups,n.Gc(4,gn,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function Mn(e,t){if(1&e&&(n.kc(0,"li"),n.kc(1,"span"),n.kc(2,"b"),n.Tc(3),n.jc(),n.jc(),n.jc()),2&e){const e=t.$implicit;n.Tb(3),n.Uc(e)}}function wn(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Upload")}}function On(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Process")}}function Sn(e,t){if(1&e&&(n.kc(0,"div"),n.gc(1,"tasks-panel",43),n.jc()),2&e){const e=n.uc(2),t=e.$implicit,c=e.index;n.Tb(1),n.Ac("taskGroupType",t)("groupTypeId",c)("taskCategory","Store")}}function In(e,t){if(1&e&&(n.kc(0,"div",42),n.Rc(1,wn,2,3,"div",6),n.Rc(2,On,2,3,"div",6),n.Rc(3,Sn,2,3,"div",6),n.jc()),2&e){const e=n.uc(),t=e.index,c=e.$implicit;n.Ac("id","task"+t),n.Tb(1),n.Ac("ngIf","UPLOAD"===c.type),n.Tb(1),n.Ac("ngIf","PROCESS"===c.type),n.Tb(1),n.Ac("ngIf","STORE"===c.type)}}function An(e,t){if(1&e&&(n.kc(0,"div"),n.Rc(1,In,4,4,"div",41),n.jc()),2&e){const e=t.$implicit;n.Tb(1),n.Ac("ngIf",e.tasks.length>0)}}function xn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",34),n.kc(1,"div",35),n.kc(2,"h4",36),n.kc(3,"a",37),n.sc("click",(function(){const e=t.$implicit;return e.visible=!e.visible})),n.kc(4,"h4"),n.Tc(5),n.jc(),n.jc(),n.jc(),n.gc(6,"span",38),n.kc(7,"button",39),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc(2).handleGoto(c.collectionId)})),n.Tc(8,"View Collection"),n.jc(),n.kc(9,"div",23),n.kc(10,"ul",24),n.Rc(11,Mn,4,1,"li",25),n.kc(12,"li",9),n.Tc(13),n.jc(),n.jc(),n.jc(),n.jc(),n.kc(14,"div",40),n.Rc(15,An,2,1,"div",25),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=t.index;n.Tb(3),n.Ub("aria-expanded",!e.visible)("aria-controls","taskGroup"+c),n.Tb(2),n.Uc(e.label),n.Tb(1),n.Ac("ngClass",n.Hc(9,pn,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),n.Tb(5),n.Ac("ngForOf",e.ancestors),n.Tb(2),n.Vc(" ",e.label," "),n.Tb(1),n.Ac("isAnimated",!1)("collapse",!e.visible),n.Tb(1),n.Ac("ngForOf",e.groups)}}function Rn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",45),n.kc(1,"div",31),n.Rc(2,xn,16,14,"div",32),n.vc(3,"paginate"),n.kc(4,"pagination-controls",33),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.uc();n.Tb(2),n.Ac("ngForOf",n.xc(3,1,e.collectionGroups,n.Gc(4,gn,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}class Pn{constructor(e,t){this.managementService=e,this.modalService=t,this.userName="",this.totalTaskCount=0,this.activeTab="all",this.showSite=!1,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.taskPage={count:0,pageSize:10,pageNumber:1,resultSet:[]},this.errorStatuses=["Error","Failed","Queued","Processing"],this.completeStatuses=["Complete"],this.statuses=[],this.token=0,this.messages={count:0,pageSize:5,pageNumber:1,resultSet:[]},this.collectionGroups=[]}ngOnInit(){this.userName=this.managementService.getCurrentUser(),this.managementService.tasks([],this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e,!1)}),this.getMissingMetadata();let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(qt.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"JOB_CHANGE"===e.type&&this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{e.token===this.token&&this.updateTaskData(e)})})}ngOnDestroy(){this.notifier.complete()}updatePage(e){this.taskPage.pageNumber=e.pageNumber,this.taskPage.pageSize=e.pageSize,this.taskPage.count=e.count,this.taskPage.resultSet=e.resultSet}onPageChange(e){this.token++,this.managementService.tasks(this.statuses,this.taskPage.pageSize,e,this.token).then(e=>{this.updatePage(e),this.setTaskData(e,!1)})}onTabClick(e,t){if(this.activeTab=t,this.taskPage={count:0,pageSize:20,pageNumber:1,resultSet:[]},this.token++,"success"===t?this.statuses=this.completeStatuses:"action-required"===t?this.statuses=this.errorStatuses:"all"===t&&(this.statuses=[]),this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.updatePage(e),this.setTaskData(e,!1)}),!e.target.parentNode.classList.contains("active")){let t=e.target.parentNode.parentNode.getElementsByTagName("li");for(let e=0;e<t.length;e++){let c=t[e];c.classList.forEach(e=>{"active"===e&&c.classList.remove("active")})}e.target.parentNode.classList.add("active")}}setTaskData(e,t){t||(this.updatePage(e),this.collectionGroups=[]);for(let t=0;t<e.resultSet.length;t++){let c=e.resultSet[t],n=this.collectionGroups.findIndex(e=>c.collection===e.collectionId),i=null;if(-1===n?(i={label:c.collectionLabel,collectionId:c.collection,groups:[],status:c.status,lastUpdatedDate:c.lastUpdatedDate,ancestors:c.ancestors},i.groups.push({tasks:[],status:null,type:"UPLOAD"}),i.groups.push({tasks:[],status:null,type:"PROCESS"}),i.groups.push({tasks:[],status:null,type:"STORE"}),this.collectionGroups.push(i)):i=this.collectionGroups[n],"gov.geoplatform.uasdm.bus.WorkflowTask"===c.type){let e=i.groups.findIndex(e=>"UPLOAD"===e.type);-1===e?i.groups.push({tasks:[c],status:c.status,type:"UPLOAD"}):i.groups[e].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMProcessingTask"===c.type){let e=i.groups.findIndex(e=>"PROCESS"===e.type);-1===e?i.groups.push({tasks:[c],status:c.status,type:"PROCESS"}):i.groups[e].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMUploadTask"===c.type){let e=i.groups.findIndex(e=>"STORE"===e.type);-1===e?i.groups.push({tasks:[c],status:c.status,type:"STORE"}):i.groups[e].tasks.push(c)}}this.setTaskGroupStatuses()}setTaskGroupStatuses(){this.collectionGroups.forEach(e=>{let t=!1,c=!1,n=!1,i=null;e.groups.forEach(e=>{let s=!1;if(e.tasks.length>0){const a=e.tasks.sort((e,t)=>new Date(t.lastUpdatedDate).getTime()-new Date(e.lastUpdatedDate).getTime());e.status=a[0].status;const o=new Date(a[0].lastUpdatedDate);s=null==i||i.getTime()-o.getTime()<=0,s&&(console.log("Updating last task"),i=o,t=!1,c=!1,n=!1),"Complete"===e.status&&a[0].actions.length>0&&(e.status="Warning",s&&(n=!0))}!s||"Error"!==e.status&&"Failed"!==e.status?!s||"Queued"!==e.status&&"Processing"!==e.status&&"Running"!==e.status&&"Pending"!==e.status||(c=!0):t=!0}),e.status=c?"Processing":t?"Failed":n?"Warning":"Complete"})}updateTaskData(e){let t=[];this.totalTaskCount=e.count,e.resultSet.forEach(e=>{let c=!1;this.collectionGroups.forEach(t=>{t.groups.forEach(t=>{t.tasks.forEach(t=>{t.oid===e.oid&&(c=!0,t.label!==e.label&&(t.label=e.label),t.lastUpdateDate!==e.lastUpdateDate&&(t.lastUpdateDate=e.lastUpdateDate),t.lastUpdatedDate!==e.lastUpdatedDate&&(t.lastUpdatedDate=e.lastUpdatedDate),t.message!==e.message&&(t.message=e.message),t.status!==e.status&&(t.status=e.status),t.odmOutput!==e.odmOutput&&(t.odmOutput=e.odmOutput),t.actions=e.actions)})})}),c||t.push(e)}),t&&t.length>0&&this.setTaskData({resultSet:t,count:e.count,pageNumber:this.taskPage.pageNumber,pageSize:this.taskPage.pageSize},!0),this.setTaskGroupStatuses()}handleMessage(e){this.bsModalRef=this.modalService.show(te,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(e.collectionId),this.bsModalRef.content.onMetadataChange.subscribe(e=>{let t=-1;for(let c=0;c<this.messages.resultSet.length;c++){this.messages.resultSet[c].collectionId===e&&(t=c)}t>=0&&this.messages.resultSet.splice(t,1)})}handleGoto(e){this.managementService.view(e).then(t=>{const c=t.item,n=t.breadcrumbs;this.managementService.getItems(e,null).then(e=>{this.bsModalRef=this.modalService.show(Ae,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal"}),this.bsModalRef.content.init(c,e,n)})})}removeTask(e){this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let c=0;c<this.tasks.resultSet.length;c++){if(this.tasks[c].uploadId===e.uploadId){t=c;break}}null!==t&&this.tasks.resultSet.splice(t,1),this.getMissingMetadata(),this.totalTaskCount=this.tasks.count})}getMissingMetadata(){this.onMessagePageChange(this.messages.pageNumber)}onMessagePageChange(e){this.managementService.getMissingMetadata(this.messages.pageSize,e).then(e=>{this.messages=e})}}Pn.ɵfac=function(e){return new(e||Pn)(n.fc(E),n.fc(D.b))},Pn.ɵcmp=n.Zb({type:Pn,selectors:[["tasks"]],decls:25,vars:5,consts:[[3,"title"],["id","app-container",1,"container-fluid",2,"padding-top","20px"],[1,"row"],[1,"col-sm-1"],[1,"col-sm-10"],["id","tasks"],[4,"ngIf"],[1,"row",2,"margin-bottom","40px"],["role","tablist",1,"nav","nav-tabs"],[1,"active"],["role","tab","data-toggle","tab",3,"click"],[1,"tab-content"],["class","tab-pane active","id","action-required",4,"ngIf"],["class","tab-pane active","id","success",4,"ngIf"],["class","tab-pane active","id","all",4,"ngIf"],["id","tasks-container"],[1,"col-sm-9"],[1,"col-sm-3"],["class","panel panel-default",4,"ngFor","ngForOf"],["id","message-pg-ctrl",3,"pageChange"],[1,"panel","panel-default"],[1,"panel-body"],[1,"dot","pending",2,"margin-left","0"],[2,"margin-top","10px","margin-bottom","0","color","grey"],[1,"breadcrumb",2,"color","grey"],[4,"ngFor","ngForOf"],[2,"color","#007276",3,"click"],[1,"col-sm-3",2,"text-align","right"],[1,"btn","btn-default",2,"width","47%",3,"click"],[1,"btn","btn-primary",2,"width","47%","margin-left","10px",3,"click"],["id","action-required",1,"tab-pane","active"],[1,"panel-group"],["class","panel panel-default","style","background: none;border: none;",4,"ngFor","ngForOf"],["id","tasks-pg-ctrl",3,"pageChange"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","clickable",2,"margin-top","20px","background-color","#e9e9e9"],[1,"panel-title",2,"display","inline-block","vertical-align","middle"],["data-toggle","collapse",3,"click"],[1,"dot",3,"ngClass"],[1,"btn","btn-default","pull-right",3,"click"],[1,"panel-body",3,"isAnimated","collapse"],[3,"id",4,"ngIf"],[3,"id"],[3,"taskGroupType","groupTypeId","taskCategory"],["id","success",1,"tab-pane","active"],["id","all",1,"tab-pane","active"]],template:function(e,t){1&e&&(n.gc(0,"uasdm-header",0),n.kc(1,"div",1),n.kc(2,"div",2),n.gc(3,"div",3),n.kc(4,"div",4),n.kc(5,"div",5),n.Rc(6,sn,13,8,"div",6),n.jc(),n.jc(),n.gc(7,"div",3),n.jc(),n.kc(8,"div",7),n.gc(9,"div",3),n.kc(10,"div",4),n.kc(11,"h3"),n.Tc(12,"Processing Jobs"),n.jc(),n.kc(13,"ul",8),n.kc(14,"li",9),n.kc(15,"a",10),n.sc("click",(function(e){return t.onTabClick(e,"all")})),n.Tc(16,"All"),n.jc(),n.jc(),n.kc(17,"li"),n.kc(18,"a",10),n.sc("click",(function(e){return t.onTabClick(e,"action-required")})),n.Tc(19,"Action Required"),n.jc(),n.jc(),n.jc(),n.kc(20,"div",11),n.Rc(21,mn,5,8,"div",12),n.Rc(22,Cn,5,8,"div",13),n.Rc(23,Rn,5,8,"div",14),n.jc(),n.jc(),n.gc(24,"div",3),n.jc(),n.jc()),2&e&&(n.Ac("title","Tasks"),n.Tb(6),n.Ac("ngIf",t.messages&&t.messages.count>0),n.Tb(15),n.Ac("ngIf","action-required"===t.activeTab),n.Tb(1),n.Ac("ngIf","success"===t.activeTab),n.Tb(1),n.Ac("ngIf","all"===t.activeTab))},directives:[Bt.a,i.k,i.j,h.c,i.i,g.a,en],pipes:[h.b],styles:["#app-container[_ngcontent-%COMP%] {\n    background: #f7f7f7;\n}\n\n#tasks-container[_ngcontent-%COMP%] {\n    padding: 20px;\n    background: white;\n    border-radius: 6px;\n}\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%]{\n  background-color: #e9e9e9;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}"]});class Fn{constructor(e,t,c){this.http=e,this.noErrorHttpClient=t,this.eventService=c}page(e){let t=new v.g;return t=t.set("number",e.toString()),this.eventService.start(),this.http.get(acp+"/sensor/page",{params:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}edit(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/lock",JSON.stringify({oid:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/sensor/apply",JSON.stringify({sensor:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}unlock(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/sensor/unlock",JSON.stringify({oid:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}}function Ln(e,t){if(1&e&&(n.kc(0,"div",14),n.kc(1,"div",15),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",16),n.kc(5,"div"),n.kc(6,"p",17),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(7),n.Uc(e.message)}}function Nn(e,t){if(1&e){const e=n.lc();n.kc(0,"div"),n.kc(1,"boolean-field",18),n.sc("valueChange",(function(c){n.Lc(e);const i=t.$implicit;return n.uc(2).updateSelectedWaveLength(i,c)})),n.jc(),n.jc()}if(2&e){const e=t.$implicit,c=n.uc(2);n.Tb(1),n.Ac("value",c.sensor.waveLength&&-1!==c.sensor.waveLength.indexOf(e))("label",e)}}function Un(e,t){if(1&e){const e=n.lc();n.kc(0,"div",1),n.Rc(1,Ln,8,1,"div",2),n.kc(2,"div",3),n.kc(3,"h3"),n.Tc(4,"Sensor"),n.jc(),n.jc(),n.kc(5,"form",null,4),n.kc(7,"div",5),n.kc(8,"label"),n.Tc(9,"Name"),n.jc(),n.kc(10,"input",6),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().sensor.name=t})),n.jc(),n.jc(),n.kc(11,"div",5),n.kc(12,"label"),n.Tc(13,"Label"),n.jc(),n.kc(14,"input",7),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().sensor.displayLabel=t})),n.jc(),n.jc(),n.kc(15,"div",5),n.kc(16,"label"),n.Tc(17,"Type"),n.jc(),n.kc(18,"input",8),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().sensor.sensorType=t})),n.jc(),n.jc(),n.kc(19,"div",5),n.kc(20,"label"),n.Tc(21,"Model"),n.jc(),n.kc(22,"input",9),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().sensor.model=t})),n.jc(),n.jc(),n.kc(23,"div",5),n.kc(24,"label"),n.Tc(25,"Wave Length"),n.jc(),n.Rc(26,Nn,2,2,"div",10),n.jc(),n.kc(27,"div",11),n.kc(28,"button",12),n.sc("click",(function(){return n.Lc(e),n.uc().handleOnCancel()})),n.Tc(29,"Cancel"),n.jc(),n.kc(30,"button",13),n.sc("click",(function(){return n.Lc(e),n.uc().handleOnSubmit()})),n.Tc(31,"Apply"),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.Jc(6),t=n.uc();n.Tb(1),n.Ac("ngIf",null!=t.message),n.Tb(9),n.Ac("ngModel",t.sensor.name)("disabled",!t.newInstance),n.Tb(4),n.Ac("ngModel",t.sensor.displayLabel),n.Tb(4),n.Ac("ngModel",t.sensor.sensorType),n.Tb(4),n.Ac("ngModel",t.sensor.model),n.Tb(4),n.Ac("ngForOf",t.waveLengths),n.Tb(4),n.Ac("disabled",!e.valid)}}Fn.ɵfac=function(e){return new(e||Fn)(n.oc(v.c),n.oc(L.a),n.oc(N.a))},Fn.ɵprov=n.bc({token:Fn,factory:Fn.ɵfac});class En{constructor(e,t){this.service=e,this.bsModalRef=t,this.newInstance=!1,this.message=null,this.waveLengths=H}ngOnInit(){this.onSensorChange=new q.b}handleOnSubmit(){this.message=null,this.service.apply(this.sensor).then(e=>{this.onSensorChange.next(e),this.bsModalRef.hide()}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.newInstance?this.bsModalRef.hide():this.service.unlock(this.sensor.oid).then(e=>{this.bsModalRef.hide()}).catch(e=>{this.error(e)})}updateSelectedWaveLength(e,t){const c=this.sensor.waveLength.indexOf(e);t?c<0&&this.sensor.waveLength.push(e):c>-1&&this.sensor.waveLength.splice(c,1)}error(e){this.message=A.b.getMessageFromError(e)}}En.ɵfac=function(e){return new(e||En)(n.fc(Fn),n.fc(D.a))},En.ɵcmp=n.Zb({type:En,selectors:[["sensor"]],decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","displayLabel","type","input","placeholder","Display Label","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","sensorType","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","model","type","input","placeholder","Model","required","",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],[1,"btn-holder",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value","label","valueChange"]],template:function(e,t){1&e&&n.Rc(0,Un,32,8,"div",0),2&e&&n.Ac("ngIf",null!=t.sensor)},directives:[i.k,a.r,a.i,a.j,a.a,a.o,a.h,a.k,i.j,W.a],encapsulation:2});var Dn=c(60);function $n(e,t){if(1&e){const e=n.lc();n.kc(0,"pagination-controls",9),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc()}}function _n(e,t){if(1&e){const e=n.lc();n.kc(0,"tr",10),n.kc(1,"td",7),n.kc(2,"a",11),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().edit(c)})),n.jc(),n.kc(3,"a",12),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().onClickRemove(c)})),n.jc(),n.jc(),n.kc(4,"td",5),n.Tc(5),n.jc(),n.kc(6,"td",5),n.Tc(7),n.jc(),n.kc(8,"td",5),n.Tc(9),n.jc(),n.kc(10,"td",5),n.Tc(11),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(5),n.Uc(e.name),n.Tb(2),n.Uc(e.displayLabel),n.Tb(2),n.Uc(e.sensorType),n.Tb(2),n.Uc(e.model)}}function Gn(e,t){if(1&e){const e=n.lc();n.kc(0,"pagination-controls",9),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc()}}const zn=function(e,t,c){return{itemsPerPage:e,currentPage:t,totalItems:c}};class Vn{constructor(e,t,c,n){this.router=e,this.service=t,this.modalService=c,this.localizeService=n,this.res={resultSet:[],count:0,pageNumber:1,pageSize:10},this.message=null}ngOnInit(){this.service.page(1).then(e=>{this.res=e})}remove(e){this.service.remove(e.oid).then(t=>{this.res.resultSet=this.res.resultSet.filter(t=>t.oid!==e.oid)})}onClickRemove(e){this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the sensor ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}edit(e){this.service.edit(e.oid).then(e=>{this.showModal(e,!1)})}newInstance(){this.service.newInstance().then(e=>{this.showModal(e,!0)})}showModal(e,t){this.bsModalRef=this.modalService.show(En,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.sensor=e,this.bsModalRef.content.newInstance=t;this.bsModalRef.content.onSensorChange.subscribe(e=>{this.onPageChange(this.res.pageNumber)})}onPageChange(e){this.service.page(e).then(e=>{this.res=e})}}Vn.ɵfac=function(e){return new(e||Vn)(n.fc(s.b),n.fc(Fn),n.fc(D.b),n.fc(Dn.a))},Vn.ɵcmp=n.Zb({type:Vn,selectors:[["sensors"]],decls:26,vars:10,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container"],[3,"pageChange",4,"ngIf"],[1,"list-table-wrapper"],["id","manage-sensors-table",1,"list-table","table","table-bordered","table-striped"],[1,"label-column"],["class","fade-ngRepeat-item",4,"ngFor","ngForOf"],[1,"button-column"],["title","Add new sensor",1,"fa","fa-plus",3,"click"],[3,"pageChange"],[1,"fade-ngRepeat-item"],["title","Edit sensor",1,"fa","fa-pencil-alt","ico-edit",3,"click"],["title","Remove sensor",1,"fa","fa-trash-alt","ico-remove",3,"click"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.gc(1,"uasdm-header"),n.kc(2,"div",1),n.kc(3,"h2"),n.Tc(4,"Sensors"),n.jc(),n.Rc(5,$n,1,0,"pagination-controls",2),n.kc(6,"div",3),n.kc(7,"table",4),n.kc(8,"thead"),n.kc(9,"tr"),n.gc(10,"th"),n.kc(11,"th",5),n.Tc(12,"Name"),n.jc(),n.kc(13,"th",5),n.Tc(14,"Label"),n.jc(),n.kc(15,"th",5),n.Tc(16,"Type"),n.jc(),n.kc(17,"th",5),n.Tc(18,"Model"),n.jc(),n.jc(),n.jc(),n.kc(19,"tbody"),n.Rc(20,_n,12,4,"tr",6),n.vc(21,"paginate"),n.kc(22,"tr"),n.kc(23,"td",7),n.kc(24,"a",8),n.sc("click",(function(){return t.newInstance()})),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.Rc(25,Gn,1,0,"pagination-controls",2),n.jc(),n.jc()),2&e&&(n.Tb(5),n.Ac("ngIf",t.res.resultSet.length>t.res.pageSize),n.Tb(15),n.Ac("ngForOf",n.xc(21,3,t.res.resultSet,n.Gc(6,zn,t.res.pageSize,t.res.pageNumber,t.res.count))),n.Tb(5),n.Ac("ngIf",t.res.resultSet.length>t.res.pageSize))},directives:[Bt.a,i.k,i.j,h.c],pipes:[h.b],styles:["./sensors.css"]});class qn{constructor(e,t,c){this.http=e,this.noErrorHttpClient=t,this.eventService=c}page(e){let t=new v.g;return t=t.set("number",e.toString()),this.eventService.start(),this.http.get(acp+"/platform/page",{params:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}edit(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/lock",JSON.stringify({oid:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/platform/apply",JSON.stringify({platform:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}unlock(e){let t=new v.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/platform/unlock",JSON.stringify({oid:e}),{headers:t}).pipe(Object(x.a)(()=>{this.eventService.complete()})).toPromise()}}function Bn(e,t){if(1&e&&(n.kc(0,"div",12),n.kc(1,"div",13),n.kc(2,"strong"),n.Tc(3,"Error"),n.jc(),n.jc(),n.kc(4,"div",14),n.kc(5,"div"),n.kc(6,"p",15),n.Tc(7),n.jc(),n.jc(),n.jc(),n.jc()),2&e){const e=n.uc(2);n.Tb(7),n.Uc(e.message)}}function Hn(e,t){if(1&e){const e=n.lc();n.kc(0,"div",1),n.Rc(1,Bn,8,1,"div",2),n.kc(2,"div",3),n.kc(3,"h3"),n.Tc(4,"Platform"),n.jc(),n.jc(),n.kc(5,"form",null,4),n.kc(7,"div",5),n.kc(8,"label"),n.Tc(9,"Name"),n.jc(),n.kc(10,"input",6),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().platform.name=t})),n.jc(),n.jc(),n.kc(11,"div",5),n.kc(12,"label"),n.Tc(13,"Label"),n.jc(),n.kc(14,"input",7),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().platform.displayLabel=t})),n.jc(),n.jc(),n.kc(15,"div",5),n.kc(16,"label"),n.Tc(17,"Type"),n.jc(),n.kc(18,"select",8),n.sc("ngModelChange",(function(t){return n.Lc(e),n.uc().platform.platformType=t})),n.gc(19,"option"),n.kc(20,"option"),n.Tc(21,"Fixed Wing"),n.jc(),n.kc(22,"option"),n.Tc(23,"Hybrid"),n.jc(),n.jc(),n.jc(),n.kc(24,"div",9),n.kc(25,"button",10),n.sc("click",(function(){return n.Lc(e),n.uc().handleOnCancel()})),n.Tc(26,"Cancel"),n.jc(),n.kc(27,"button",11),n.sc("click",(function(){return n.Lc(e),n.uc().handleOnSubmit()})),n.Tc(28,"Apply"),n.jc(),n.jc(),n.jc(),n.jc()}if(2&e){const e=n.Jc(6),t=n.uc();n.Tb(1),n.Ac("ngIf",null!=t.message),n.Tb(9),n.Ac("ngModel",t.platform.name)("disabled",!t.newInstance),n.Tb(4),n.Ac("ngModel",t.platform.displayLabel),n.Tb(4),n.Ac("ngModel",t.platform.platformType),n.Tb(9),n.Ac("disabled",!e.valid)}}qn.ɵfac=function(e){return new(e||qn)(n.oc(v.c),n.oc(L.a),n.oc(N.a))},qn.ɵprov=n.bc({token:qn,factory:qn.ɵfac});class Jn{constructor(e,t){this.service=e,this.bsModalRef=t,this.newInstance=!1,this.message=null}ngOnInit(){this.onPlatformChange=new q.b}handleOnSubmit(){this.message=null,this.service.apply(this.platform).then(e=>{this.onPlatformChange.next(e),this.bsModalRef.hide()}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.newInstance?this.bsModalRef.hide():this.service.unlock(this.platform.oid).then(e=>{this.bsModalRef.hide()}).catch(e=>{this.error(e)})}error(e){this.message=A.b.getMessageFromError(e)}}function Wn(e,t){if(1&e){const e=n.lc();n.kc(0,"pagination-controls",9),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc()}}function Zn(e,t){if(1&e){const e=n.lc();n.kc(0,"tr",10),n.kc(1,"td",7),n.kc(2,"a",11),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().edit(c)})),n.jc(),n.kc(3,"a",12),n.sc("click",(function(){n.Lc(e);const c=t.$implicit;return n.uc().onClickRemove(c)})),n.jc(),n.jc(),n.kc(4,"td",5),n.Tc(5),n.jc(),n.kc(6,"td",5),n.Tc(7),n.jc(),n.kc(8,"td",5),n.Tc(9),n.jc(),n.jc()}if(2&e){const e=t.$implicit;n.Tb(5),n.Uc(e.name),n.Tb(2),n.Uc(e.displayLabel),n.Tb(2),n.Uc(e.platformType)}}function Kn(e,t){if(1&e){const e=n.lc();n.kc(0,"pagination-controls",9),n.sc("pageChange",(function(t){return n.Lc(e),n.uc().onPageChange(t)})),n.jc()}}Jn.ɵfac=function(e){return new(e||Jn)(n.fc(qn),n.fc(D.a))},Jn.ɵcmp=n.Zb({type:Jn,selectors:[["platform"]],decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","displayLabel","type","input","placeholder","Display Label","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","platformType","type","input","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn-holder",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"]],template:function(e,t){1&e&&n.Rc(0,Hn,29,6,"div",0),2&e&&n.Ac("ngIf",null!=t.platform)},directives:[i.k,a.r,a.i,a.j,a.a,a.o,a.h,a.k,a.p,a.l,a.q],encapsulation:2});const Yn=function(e,t,c){return{itemsPerPage:e,currentPage:t,totalItems:c}};class Qn{constructor(e,t,c,n){this.router=e,this.service=t,this.modalService=c,this.localizeService=n,this.res={resultSet:[],count:0,pageNumber:1,pageSize:10},this.message=null}ngOnInit(){this.service.page(1).then(e=>{this.res=e})}remove(e){this.service.remove(e.oid).then(t=>{this.res.resultSet=this.res.resultSet.filter(t=>t.oid!==e.oid)})}onClickRemove(e){this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the platform ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}edit(e){this.service.edit(e.oid).then(e=>{this.showModal(e,!1)})}newInstance(){this.service.newInstance().then(e=>{this.showModal(e,!0)})}showModal(e,t){this.bsModalRef=this.modalService.show(Jn,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.platform=e,this.bsModalRef.content.newInstance=t;this.bsModalRef.content.onPlatformChange.subscribe(e=>{this.onPageChange(this.res.pageNumber)})}onPageChange(e){this.service.page(e).then(e=>{this.res=e})}}Qn.ɵfac=function(e){return new(e||Qn)(n.fc(s.b),n.fc(qn),n.fc(D.b),n.fc(Dn.a))},Qn.ɵcmp=n.Zb({type:Qn,selectors:[["platforms"]],decls:24,vars:10,consts:[[1,"new-admin-design-main"],["id","app-container",1,"container"],[3,"pageChange",4,"ngIf"],[1,"list-table-wrapper"],["id","manage-platforms-table",1,"list-table","table","table-bordered","table-striped"],[1,"label-column"],["class","fade-ngRepeat-item",4,"ngFor","ngForOf"],[1,"button-column"],["title","Add new platform",1,"fa","fa-plus",3,"click"],[3,"pageChange"],[1,"fade-ngRepeat-item"],["title","Edit platform",1,"fa","fa-pencil-alt","ico-edit",3,"click"],["title","Remove platform",1,"fa","fa-trash-alt","ico-remove",3,"click"]],template:function(e,t){1&e&&(n.kc(0,"div",0),n.gc(1,"uasdm-header"),n.kc(2,"div",1),n.kc(3,"h2"),n.Tc(4,"Platforms"),n.jc(),n.Rc(5,Wn,1,0,"pagination-controls",2),n.kc(6,"div",3),n.kc(7,"table",4),n.kc(8,"thead"),n.kc(9,"tr"),n.gc(10,"th"),n.kc(11,"th",5),n.Tc(12,"Name"),n.jc(),n.kc(13,"th",5),n.Tc(14,"Label"),n.jc(),n.kc(15,"th",5),n.Tc(16,"Type"),n.jc(),n.jc(),n.jc(),n.kc(17,"tbody"),n.Rc(18,Zn,10,3,"tr",6),n.vc(19,"paginate"),n.kc(20,"tr"),n.kc(21,"td",7),n.kc(22,"a",8),n.sc("click",(function(){return t.newInstance()})),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.jc(),n.Rc(23,Kn,1,0,"pagination-controls",2),n.jc(),n.jc()),2&e&&(n.Tb(5),n.Ac("ngIf",t.res.resultSet.length>t.res.pageSize),n.Tb(13),n.Ac("ngForOf",n.xc(19,3,t.res.resultSet,n.Gc(6,Yn,t.res.pageSize,t.res.pageNumber,t.res.count))),n.Tb(5),n.Ac("ngIf",t.res.resultSet.length>t.res.pageSize))},directives:[Bt.a,i.k,i.j,h.c],pipes:[h.b],styles:["./platforms.css"]});class Xn{validate(e){return(t=new RegExp(/[\W<>\-+=!@#$%^&*?/\\']/gm),e=>t.test(e.value)?{forbiddenName:{value:e.value}}:null)(e);var t}}Xn.ɵfac=function(e){return new(e||Xn)},Xn.ɵdir=n.ac({type:Xn,selectors:[["","forbiddenName",""]],features:[n.Sb([{provide:a.f,useExisting:Xn,multi:!0}])]});class ei{canDeactivate(e){return!e.canDeactivate()||!!confirm("An upload is currently in progress. Are you sure you want to leave?")}}ei.ɵfac=function(e){return new(e||ei)},ei.ɵprov=n.bc({token:ei,factory:ei.ɵfac});var ti=c(125);const ci=[{path:"",canActivate:[ti.b],component:Oc},{path:"viewer",canActivate:[ti.b],component:Oc},{path:"upload",component:_c,canDeactivate:[ei]},{path:"tasks",canActivate:[ti.b],component:Pn},{path:"sensors",canActivate:[ti.a],component:Vn},{path:"platforms",canActivate:[ti.a],component:Qn}];class ni{}ni.ɵmod=n.dc({type:ni}),ni.ɵinj=n.cc({factory:function(e){return new(e||ni)},providers:[{provide:i.h,useClass:i.e}],imports:[[s.e.forChild(ci)],s.e]}),("undefined"==typeof ngJitMode||ngJitMode)&&n.Oc(ni,{imports:[s.e],exports:[s.e]});var ii=c(91);class si{}si.ɵmod=n.dc({type:si}),si.ɵinj=n.cc({factory:function(e){return new(e||si)},providers:[ei,E,xe,T,Fn,qn,ie],imports:[[i.b,s.e,a.c,h.a,p.b,l.c,r.b,d.a,u.b.forRoot(),g.b.forRoot(),ii.a,ni,o.b]]}),("undefined"==typeof ngJitMode||ngJitMode)&&n.Oc(si,{declarations:[S,Ke,lt,te,V,Nt,Ae,Vt,_e,Oc,_c,Pn,Xn,J,En,Vn,Jn,Qn,en],imports:[i.b,s.e,a.c,h.a,p.b,l.c,r.b,d.a,u.b,g.b,ii.a,ni,o.b]})}}]);
//# sourceMappingURL=2.chunk.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{187:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteModule",(function(){return xa}));var c=n(0),i=n(3),o=n(11),a=n(5),s=n(318),l=n(19),r=n(29),d=n(31),p=n(80),m=n(34),h=n(110),u=n(26),g=n(184),b=n(185),f=n(186),v=n(8),y=n(13);const k="pk.eyJ1IjoidGVycmFmcmFtZSIsImEiOiJjanZxNTFnaTYyZ2RuNDlxcmNnejNtNjN6In0.-kmlS8Tgb2fNc1NPb5rJEQ";class x{constructor(e){this.http=e,g.accessToken=k}features(e){let t=new y.g;return null!=e&&(t=t.set("conditions",JSON.stringify(e))),this.http.get(acp+"/project/features",{params:t}).toPromise()}mbForwardGeocode(e){let t=new y.g,n="https://api.mapbox.com/geocoding/v5/mapbox.places/"+e+".json?proximity=-74.70850,40.78375&access_token="+k;return this.http.get(n,{params:t}).toPromise()}}function E(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",13),c.mc())}function C(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",14),c.mc())}function w(e,t){if(1&e&&(c.nc(0,"span"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.label," / ")}}function U(e,t){if(1&e&&(c.Zc(0,E,2,0,"span",11),c.Zc(1,C,2,0,"span",11),c.nc(2,"span"),c.Zc(3,w,2,1,"span",12),c.mc(),c.nc(4,"b"),c.bd(5),c.mc()),2&e){const e=t.match;c.Ec("ngIf",null==e.item.filename),c.Ub(1),c.Ec("ngIf",null!=e.item.filename),c.Ub(2),c.Ec("ngForOf",e.item.hierarchy),c.Ub(2),c.cd(e.item.label)}}x.ɵfac=function(e){return new(e||x)(c.rc(y.c))},x.ɵprov=c.dc({token:x,factory:x.ɵfac});const M=function(){return{standalone:!0}};class I{constructor(e){this.mapService=e,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.center=new g.LngLat(-78.880453,42.897852),this.zoom=2,this.coordinate={longitude:null,latitude:null},this.search="",this.dataSource=v.a.create(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const n=t.features;let c=[];n.forEach(e=>{let t={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};c.push(t)}),e.next(c)})})}ngOnInit(){this.refreshCoordinateFromMap()}ngAfterViewInit(){let e={container:"map-attribute-div",style:"mapbox://styles/mapbox/outdoors-v11",zoom:this.zoom,center:this.center};null!=this.site.geometry&&(e.center=this.site.geometry.coordinates),this.map=new g.Map(e),this.map.on("load",()=>{this.initMap()})}ngOnDestroy(){this.map.remove()}initMap(){let e=b.modes;e.static=f,this.draw=new b({modes:e,displayControlsDefault:!1,controls:{static:!0}}),this.map.addControl(this.draw),this.map.addControl(new g.NavigationControl),this.map.on("draw.update",e=>{this.onDrawUpdate(e)}),this.map.on("draw.create",e=>{this.onDrawCreate(e)}),this.map.on("draw.modechange",e=>{this.onDrawUpdate(e)}),this.map.on("style.load",()=>{this.addLayers()}),this.addLayers()}addLayers(){if(null!=this.site.geometry){let e={id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry};this.draw.add(e),this.draw.changeMode("simple_select",{featureIds:[e.id]})}else this.draw.changeMode("draw_point",{});this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}})}onDrawUpdate(e){"move"===e.action&&null!=e.features&&e.features.length>0&&this.updateGeometry(e.features[0])}onDrawCreate(e){if(null!=e.features&&e.features.length>0){let t=e.features[0];t.id=this.site.id,this.updateGeometry(t)}}updateGeometry(e){this.site.geometry=e.geometry,this.refreshCoordinateFromMap()}refreshCoordinateFromMap(){null!=this.site&&null!=this.site.geometry&&(this.coordinate.longitude=this.site.geometry.coordinates[0],this.coordinate.latitude=this.site.geometry.coordinates[1])}refreshCoordinateFromInput(){if(null!=this.coordinate.longitude&&null!=this.coordinate.latitude){console.log(this.site.geometry),null==this.site.geometry&&(this.site.geometry={type:"Point"}),this.site.geometry.coordinates=[this.coordinate.longitude,this.coordinate.latitude];var e=this.draw.set({type:"FeatureCollection",features:[{id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry}]});this.draw.changeMode("simple_select",{featureIds:e})}}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}handleClick(e){let t=e.item;t.center&&this.map.flyTo({center:t.center,zoom:9})}}I.ɵfac=function(e){return new(e||I)(c.hc(x))},I.ɵcmp=c.bc({type:I,selectors:[["map-attribute"]],inputs:{site:"site",center:"center",zoom:"zoom"},decls:23,vars:9,consts:[[1,"row-holder"],[1,"label-holder"],[1,"holder"],[1,"modal-body"],["id","search-container",2,"position","absolute","z-index","999","padding","15px","width","35%"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],["id","map-attribute-div",1,"map-view-port",2,"height","300px"],[1,"modal-body","text-left"],["name","longitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["name","latitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["bsItemTemplate",""],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(c.nc(0,"div",0),c.ic(1,"div",1),c.nc(2,"div",2),c.nc(3,"div",3),c.nc(4,"div",4),c.nc(5,"input",5),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.ic(6,"div",6),c.mc(),c.mc(),c.mc(),c.nc(7,"div",0),c.nc(8,"div",1),c.nc(9,"label"),c.bd(10,"Longitude"),c.mc(),c.mc(),c.nc(11,"div",2),c.nc(12,"div",7),c.nc(13,"input",8),c.vc("ngModelChange",(function(e){return t.coordinate.longitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",0),c.nc(15,"div",1),c.nc(16,"label"),c.bd(17,"Latitude"),c.mc(),c.mc(),c.nc(18,"div",2),c.nc(19,"div",7),c.nc(20,"input",9),c.vc("ngModelChange",(function(e){return t.coordinate.latitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(21,U,6,4,"ng-template",null,10,c.ad)),2&e){const e=c.Pc(22);c.Ub(5),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",c.Hc(8,M)),c.Ub(8),c.Ec("ngModel",t.coordinate.longitude),c.Ub(7),c.Ec("ngModel",t.coordinate.latitude)}},directives:[a.c,a.k,a.n,r.b,a.q,a.v,i.t,i.s],encapsulation:2});var O=n(53),S=n(82),T=n(132),R=n(324),P=n(328),F=n(325),N=n(155),D=n(33),A=n(25);class Z{constructor(e,t,n,c){this.http=e,this.noErrorHttpClient=t,this.eventService=n,this.authService=c}getChildren(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/get-children",{params:t}).toPromise()}getObjects(e,t,n,c){let i=new y.g;return i=i.set("id",e),null!=t&&(i=i.set("key",t)),null!=n&&(i=i.set("pageNumber",n.toString())),null!=c&&(i=i.set("pageSize",c.toString())),this.http.get(acp+"/project/objects",{params:i}).toPromise()}view(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/view",{params:t}).toPromise()}getItems(e,t){let n=new y.g;return n=n.set("id",e),null!=t&&(n=n.set("key",t)),this.http.get(acp+"/project/items",{params:n}).toPromise()}getArtifacts(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/get-artifacts",{params:t}).toPromise()}removeArtifacts(e,t){let n=new y.f({"Content-Type":"application/json"});const c={id:e,folder:t};return this.eventService.start(),this.http.post(acp+"/project/remove-artifacts",JSON.stringify(c),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}roots(e,t,n){let c=new y.g;return null!=e&&(c=c.set("id",e)),null!=t&&(c=c.set("conditions",JSON.stringify(t))),null!=n&&(c=c.set("sort",n)),this.http.get(acp+"/project/roots",{params:c}).toPromise()}edit(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/edit",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}setExclude(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/set-exclude",JSON.stringify({id:e,exclude:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}runOrtho(e,t,n,c){let i=new y.f({"Content-Type":"application/json"});const o={id:e,processPtcloud:t,processDem:n,processOrtho:c};return this.http.post(acp+"/project/run-ortho",JSON.stringify(o),{headers:i}).pipe(Object(T.a)(()=>{})).toPromise()}update(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/update",JSON.stringify({entity:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newChild(e,t){let n="/project/new-default-child",c=new y.f({"Content-Type":"application/json"}),i={};return null!=e&&(i.parentId=e),t&&(i.type=t,n="/project/new-child"),this.eventService.start(),this.http.post(acp+n,JSON.stringify(i),{headers:c}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}applyWithParent(e,t){let n=new y.f({"Content-Type":"application/json"}),c={entity:e};return null!=t&&(c.parentId=t),this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/apply-with-parent",JSON.stringify(c),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}getCurrentUser(){return this.authService.getUserName()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}removeObject(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/removeObject",JSON.stringify({id:e,key:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}removeTask(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove-task",JSON.stringify({uploadId:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}upload(e,t,n){this.eventService.start();const c=new FormData;return c.append("file",n),c.append("id",e),c.append("folder",t),this.http.post(acp+"/project/upload",c).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}tasks(e,t,n,c){let i=new y.g;return i=i.set("statuses",JSON.stringify(e)),i=i.set("pageSize",t.toString()),i=i.set("pageNumber",n.toString()),i=i.set("token",c.toString()),this.http.get(acp+"/project/tasks",{params:i}).toPromise()}getTasks(e){let t=new y.g;return t=t.set("collectionId",e),this.http.get(acp+"/project/collection-tasks",{params:t}).toPromise()}task(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/task",{params:t}).toPromise()}getUploadTask(e){let t=new y.g;return t=t.set("uploadId",e),this.http.get(acp+"/project/get-upload-task",{params:t}).toPromise()}getMessages(e,t){let n=new y.g;return n=n.set("pageSize",e.toString()),n=n.set("pageNumber",t.toString()),this.http.get(acp+"/project/get-messages",{params:n}).toPromise()}download(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("key",t),n&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download",{params:c,responseType:"blob"}).pipe(Object(T.a)(()=>{n&&this.eventService.complete()}))}downloadAll(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("key",t),n&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download-all",{params:c,responseType:"blob"}).pipe(Object(T.a)(()=>{n&&this.eventService.complete()}))}search(e){return e.pipe(Object(R.a)(400)).pipe(Object(P.a)()).pipe(Object(F.a)(e=>this.searchEntries(e)))}searchEntries(e){let t=new y.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t})}searchEntites(e){let t=new y.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t}).toPromise()}submitCollectionMetadata(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/submit-metadata",JSON.stringify({collectionId:e,json:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}applyMetadata(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/apply-metadata",JSON.stringify({selection:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}createCollection(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/create-collection",JSON.stringify({selections:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}pushToEros(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/eros/push",JSON.stringify({collectionId:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}getMetadataOptions(e){let t=new y.g;return null!=e&&(t=t.set("id",e)),this.noErrorHttpClient.get(acp+"/project/metadata-options",{params:t}).toPromise()}getUAVMetadata(e,t){let n=new y.g;return n=n.set("uavId",e),n=n.set("sensorId",t),this.noErrorHttpClient.get(acp+"/project/uav-metadata",{params:n}).toPromise()}evaluate(e,t){return null!=e&&"eq"===e.type?t[e.name]===e.value:null!=e&&"admin"===e.type&&this.authService.isAdmin()}bureaus(){let e=new y.g;return this.http.get(acp+"/uav/bureaus",{params:e}).toPromise()}}Z.ɵfac=function(e){return new(e||Z)(c.rc(y.c),c.rc(N.a),c.rc(D.a),c.rc(A.a))},Z.ɵprov=c.dc({token:Z,factory:Z.ɵfac});var j=n(15),L=n(98);function _(e,t){if(1&e&&(c.nc(0,"div",7),c.nc(1,"div",8),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",9),c.nc(5,"div"),c.nc(6,"p",10),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function $(e,t){1&e&&(c.nc(0,"p",11),c.bd(1,"Loading image..."),c.mc())}function z(e,t){if(1&e&&(c.ic(0,"img",12),c.yc(1,"safeHtml")),2&e){const e=c.xc();c.Ec("src",c.zc(1,1,e.imageToShow),c.Tc)}}class B{constructor(e,t){this.service=e,this.bsModalRef=t,this.message=null,this.open=!0,this.loading=!0}init(e,t){this.component=e,this.key=t,this.getImage(this.component,this.key)}createImageFromBlob(e){let t=new FileReader;t.addEventListener("load",()=>{this.imageToShow=t.result},!1),e&&t.readAsDataURL(e)}getImage(e,t){this.loading=!0,this.service.download(e,t,!1).subscribe(e=>{this.createImageFromBlob(e),this.loading=!1},e=>{this.loading=!1,this.error(e)})}close(){this.open=!1}error(e){this.message=S.b.getMessageFromError(e)}}B.ɵfac=function(e){return new(e||B)(c.hc(Z),c.hc(j.a))},B.ɵcmp=c.bc({type:B,selectors:[["image-preview-modal"]],decls:7,vars:3,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"image-preview-container"],[1,"fa","fa-times","btn","btn-close",2,"min-width","0",3,"click"],[1,"image-container"],["style","text-align: left;",4,"ngIf"],["class","image-preview img-responsive center-block","alt","Image",3,"src",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[2,"text-align","left"],["alt","Image",1,"image-preview","img-responsive","center-block",3,"src"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.Zc(1,_,8,1,"div",1),c.nc(2,"div",2),c.nc(3,"i",3),c.vc("click",(function(){return t.bsModalRef.hide()})),c.mc(),c.nc(4,"div",4),c.Zc(5,$,2,0,"p",5),c.Zc(6,z,2,3,"img",6),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(1),c.Ec("ngIf",null!=t.message),c.Ub(4),c.Ec("ngIf",t.loading),c.Ub(1),c.Ec("ngIf",!t.loading))},directives:[i.t],pipes:[L.a],encapsulation:2});var G=n(22);class V{}function q(e,t){1&e&&(c.nc(0,"div",11),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",14),c.nc(4,"strong",15),c.bd(5,"Information"),c.mc(),c.mc(),c.nc(6,"div",16),c.nc(7,"div"),c.nc(8,"p",15),c.bd(9,"The metadata was originally submitted in an out of date format and needs to be re-entered"),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",12),c.mc())}function H(e,t){if(1&e&&(c.nc(0,"div",11),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",14),c.nc(4,"strong",17),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",16),c.nc(7,"div"),c.nc(8,"p",18),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",12),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function J(e,t){if(1&e){const e=c.oc();c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",19),c.nc(4,"metadata-page",20),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().page=t})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.Ec("page",e.page)}}class W{constructor(e,t){this.bsModalRef=e,this.service=t,this.message=null,this.disabled=!1,this.isOldFormat=!1,this.page=null}ngOnInit(){this.onMetadataChange=new G.b}ngOnDestroy(){this.onMetadataChange.unsubscribe()}init(e,t){this.collectionId=e,this.service.getMetadataOptions(this.collectionId).then(e=>{this.isOldFormat=null==e.uav||null==e.sensor,this.page={selection:{type:"CATEGORY",isNew:!1,value:this.collectionId,label:t,uav:e.uav.oid,sensor:e.sensor.oid,pointOfContact:{name:e.name,email:e.email}}}}).catch(e=>{this.error(e)})}close(){this.bsModalRef.hide()}handleSubmit(){this.service.applyMetadata(this.page.selection).then(()=>{this.onMetadataChange.next(this.page.selection),this.bsModalRef.hide()}).catch(e=>{this.error(e)})}error(e){this.message=S.b.getMessageFromError(e)}}W.ɵfac=function(e){return new(e||W)(c.hc(j.a),c.hc(Z))},W.ɵcmp=c.bc({type:W,selectors:[["metadata-modal"]],decls:17,vars:5,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,"row","error-container"],[1,"col-md-2"],[1,"col-md-8"],[1,"label-holder"],[2,"color","#c7a717"],[1,"holder"],[2,"color","#8c0000"],[1,"error-message"],[1,"form-group"],[3,"page","pageChange"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h3"),c.bd(2,"Metadata"),c.mc(),c.nc(3,"div",0),c.Zc(4,q,11,0,"div",1),c.Zc(5,H,11,1,"div",1),c.Zc(6,J,5,1,"div",2),c.mc(),c.nc(7,"div",3),c.nc(8,"div",4),c.nc(9,"div",5),c.nc(10,"div",6),c.nc(11,"button",7),c.vc("click",(function(){return t.close()})),c.nc(12,"span",8),c.bd(13,"Close"),c.mc(),c.mc(),c.nc(14,"button",9),c.vc("click",(function(){return t.handleSubmit()})),c.ic(15,"i",10),c.bd(16," Submit "),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(4),c.Ec("ngIf",t.isOldFormat),c.Ub(1),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",null!=t.page),c.Ub(5),c.Ec("disabled",t.disabled),c.Ub(3),c.Ec("disabled",t.disabled))},encapsulation:2});var Y=n(97),X=n(329),K=n(46),Q=n(319);class ee{constructor(e,t,n,c,i,o,a){this.root=e,this.leaf=t,this.drillable=n,this.expandable=c,this.uploadable=i,this.processable=o,this.childLabel=a}}class te{constructor(){this.cache={},this.cache.Site=new ee(!0,!1,!0,!1,!1,!1,"Projects"),this.cache.Project=new ee(!1,!1,!0,!1,!1,!1,"Missions"),this.cache.Mission=new ee(!1,!1,!1,!0,!1,!1,"Collections"),this.cache.Collection=new ee(!1,!0,!1,!1,!1,!0,"Images"),this.cache.folder=new ee(!1,!0,!1,!1,!0,!1,""),this.cache.raw=new ee(!1,!1,!1,!1,!0,!1,""),this.cache.accessible=new ee(!1,!1,!1,!1,!0,!1,"")}getMetadata(e){return this.cache[e.type]}getTypeContainsFolders(e){return"Collection"===e.type}isUploadable(e){return null!=this.cache[e]&&this.cache[e].uploadable}hasExtraField(e,t){return"Collection"===e&&("collectionDate"===t||"sensor"===t||"uav"===t)}isProcessable(e){return null!=this.cache[e]&&this.cache[e].processable}getHierarchy(){return["Site","Project","Mission","Collection"]}}te.ɵfac=function(e){return new(e||te)},te.ɵprov=c.dc({token:te,factory:te.ɵfac});const ne=["uploader"];function ce(e,t){if(1&e&&(c.nc(0,"div",22),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"div",23),c.nc(4,"strong",24),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",25),c.nc(7,"div"),c.nc(8,"p",26),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",5),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function ie(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"ol",27),c.ic(4,"modal-step-indicator",28),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("stepConfig",e.modalStepConfig)}}function oe(e,t){if(1&e){const e=c.oc();c.nc(0,"artifact-page",31),c.vc("onError",(function(t){return c.Rc(e),c.xc(3).error(t)})),c.mc()}if(2&e){const e=c.xc(3);c.Ec("edit",!0)("entity",e.component)("config",e.config)}}function ae(e,t){if(1&e){const e=c.oc();c.nc(0,"div",32),c.nc(1,"label",33),c.bd(2,"Output Product Name Prefix"),c.mc(),c.nc(3,"input",34),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(3).values.outFileName=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ub(3),c.Ec("ngModel",e.values.outFileName)}}function se(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.Zc(3,oe,1,3,"artifact-page",29),c.Zc(4,ae,4,1,"div",30),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngIf",null!=e.component),c.Ub(1),c.Ec("ngIf",e.processUpload)}}function le(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"div",32),c.nc(4,"boolean-field",38),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(3).config.processOrtho=t})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("value",e.config.processOrtho)}}function re(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"div",32),c.nc(4,"boolean-field",39),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(3).config.processDem=t})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("value",e.config.processDem)}}function de(e,t){if(1&e){const e=c.oc();c.lc(0),c.Zc(1,le,5,2,"div",2),c.Zc(2,re,5,2,"div",2),c.nc(3,"div",15),c.ic(4,"div",5),c.nc(5,"div",6),c.nc(6,"div",32),c.nc(7,"label",35),c.bd(8,"Description"),c.mc(),c.nc(9,"input",36),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.description=t})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(10,"div",15),c.ic(11,"div",5),c.nc(12,"div",6),c.nc(13,"div",32),c.nc(14,"label",35),c.bd(15,"Processing Software"),c.mc(),c.nc(16,"input",37),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.tool=t})),c.mc(),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc(2);c.Ub(1),c.Ec("ngIf","ortho"===e.uploadTarget),c.Ub(1),c.Ec("ngIf","dem"===e.uploadTarget),c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(6),c.Ec("ngModel",e.values.description),c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(6),c.Ec("ngModel",e.values.tool)}}function pe(e,t){if(1&e&&(c.lc(0),c.Zc(1,se,5,3,"div",2),c.Zc(2,de,17,6,"ng-container",3),c.kc()),2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf","raw"===e.uploadTarget),c.Ub(1),c.Ec("ngIf","raw"!==e.uploadTarget)}}function me(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",40),c.nc(2,"div",41),c.bd(3,"Partial Upload Detected"),c.mc(),c.nc(4,"div",42),c.nc(5,"h4"),c.bd(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),c.mc(),c.nc(7,"h4"),c.nc(8,"b"),c.bd(9,"To continue an upload"),c.mc(),c.bd(10," please re-upload your file and we will try our best to continue where you left off. "),c.mc(),c.mc(),c.mc(),c.mc())}function he(e,t){if(1&e){const e=c.oc();c.nc(0,"div",43),c.nc(1,"div",41),c.bd(2," Upload Details "),c.nc(3,"i",44),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().closeTaskFinishedNotification(n.id)})),c.mc(),c.mc(),c.nc(4,"div",42),c.nc(5,"h4"),c.bd(6," Status: "),c.nc(7,"b"),c.bd(8," Upload successfully completed "),c.mc(),c.mc(),c.nc(9,"h4"),c.bd(10," Message: "),c.nc(11,"b"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(12),c.dd(" ",e.message," ")}}function ue(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.nc(2,"td"),c.bd(3,"RGB Image Data"),c.mc(),c.nc(4,"td"),c.bd(5,"jpg, jpeg, png"),c.mc(),c.mc(),c.nc(6,"tr"),c.nc(7,"td"),c.bd(8,"Multispectral Image Data"),c.mc(),c.nc(9,"td"),c.bd(10,"tif"),c.mc(),c.mc(),c.nc(11,"tr"),c.nc(12,"td"),c.bd(13,"Video"),c.mc(),c.nc(14,"td"),c.bd(15,"mp4"),c.mc(),c.mc(),c.mc())}function ge(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"laz"),c.mc(),c.mc(),c.mc())}function be(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"tif"),c.mc(),c.mc(),c.mc())}function fe(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"tif, png"),c.mc(),c.mc(),c.mc())}function ve(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"mp4"),c.mc(),c.mc(),c.mc())}function ye(e,t){if(1&e&&(c.nc(0,"div",40),c.nc(1,"div",41),c.bd(2,"Upload Details"),c.mc(),c.nc(3,"div",42),c.nc(4,"h4"),c.bd(5," Status: "),c.nc(6,"b"),c.bd(7),c.mc(),c.mc(),c.nc(8,"h4"),c.bd(9," Message: "),c.nc(10,"b"),c.bd(11),c.mc(),c.mc(),c.nc(12,"h4"),c.bd(13," Upload Started On: "),c.nc(14,"b"),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"h4"),c.bd(18," Last Updated: "),c.nc(19,"b"),c.bd(20),c.yc(21,"idmdate"),c.mc(),c.mc(),c.nc(22,"h4"),c.bd(23," Elapsed Time: "),c.nc(24,"b"),c.bd(25),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.dd(" ",e.currentTask.status," "),c.Ub(4),c.dd(" ",e.currentTask.message," "),c.Ub(4),c.dd(" ",c.zc(16,5,e.currentTask.createDate)," "),c.Ub(5),c.dd(" ",c.zc(21,7,e.currentTask.lastUpdateDate)," "),c.Ub(5),c.dd(" ",e.uploadCounter," ")}}function ke(e,t){if(1&e){const e=c.oc();c.nc(0,"button",45),c.vc("click",(function(){return c.Rc(e),c.xc().removeUpload()})),c.ic(1,"i",46),c.bd(2," Cancel Upload "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",e.disabled)}}function xe(e,t){if(1&e){const e=c.oc();c.nc(0,"button",47),c.vc("click",(function(){return c.Rc(e),c.xc().handleUpload()})),c.ic(1,"i",46),c.bd(2," Upload "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}class Ee{constructor(e,t,n,c,i){this.service=e,this.metadataService=t,this.modalService=n,this.bsModalRef=c,this.objectKeys=Object.keys,this.importedValues=!1,this.message="",this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.finishedTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.processUpload=!0,this.config={processPtcloud:!1,processDem:!1,processOrtho:!1},this.hierarchy=[],this.component=null,this.uploadTarget=null,this.labels=[],this.pages=[{index:0,selection:null,options:[],type:"FILE"}],this.hierarchyChange=!1,this.page=this.pages[0],this.sensors=[],this.platforms=[],this.modalStepConfig={steps:[{label:"Final",active:!0,enabled:!0}]},this.differ=i.find([]).create()}set content(e){const t=this;if(null!=e&&null==this.uploader&&null!=this.uploadTarget){const n=[];"ortho"===this.uploadTarget||"dem"===this.uploadTarget?n.push("tif"):"ptcloud"===this.uploadTarget?n.push("laz"):(n.push("zip"),n.push("tar.gz"));const c={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:n},showMessage:function(e){},callbacks:{onUpload:function(e,n){t.disabled=!0,this.finishedTask=null,t.countUpload(t),t.message&&t.message.length>0&&(t.message="")},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,n,c,i){c.message&&c.message.currentTask&&!t.currentTask&&(t.currentTask=c.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(X.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(K.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,n,c,i){t.disabled=!1,t.finishedTask=t.currentTask,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),c.success&&t.bsModalRef.hide(),t.onUploadComplete.next()},onCancel:function(e,n){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.existingTask&&(t.page=t.pages[0]),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,n,c){t.error({error:{message:c}})}}};this.uploader=new Q.FineUploader(c)}}ngOnInit(){this.onUploadComplete=new G.b,this.onUploadCancel=new G.b}ngOnDestroy(){this.onUploadComplete.unsubscribe(),this.onUploadCancel.unsubscribe()}ngAfterViewInit(){}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}init(e,t){this.component=e,this.uploadTarget=t,this.hierarchy=this.metadataService.getHierarchy(),this.pages=[],this.pages.push({index:this.pages.length,selection:null,options:[],type:"SUMMARY"}),this.page=this.pages[0],this.existingTask&&(this.page=this.pages[this.pages.length-1])}close(){this.bsModalRef.hide()}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0)}isPageValid(e){if("CATEGORY"===e.type){if(null!=e.selection)return null!=e.selection.value&&e.selection.value.length>0||null!=e.selection.label&&e.selection.label.length>0&&((!this.hasField("uav")||null!=e.selection.uav&&0!==e.selection.uav.length)&&((!this.hasField("sensor")||null!=e.selection.sensor&&0!==e.selection.sensor.length)&&(!this.hasField("collectionDate")||null!=e.selection.collectionDate&&0!==e.selection.collectionDate.length)))}else if("FILE"===e.type){if(null!=this.uploader){const e=this.uploader.getUploads();return null!=e&&e.length>0}}else if("SUMMARY"===e.type)return null==this.currentTask;return!0}updateCurrentPageLabel(){this.page.options.forEach(e=>{e.id===this.page.selection.value&&(this.page.selection.label=e.name)})}setIsNew(e){this.page.selection.isNew=e,e?this.page.selection.value=null:this.page.selection.label=null}handleAddMetadata(e){this.modalService.show(W,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(e.collection)}handleNextPage(){if(this.page.index+1<this.pages.length){const e=this.pages[this.page.index+1];"CATEGORY"===this.page.type&&(this.updateCurrentPageLabel(),this.labels.push(this.page.selection.label)),"CATEGORY"===e.type?"FILE"===this.page.type?this.page=e:!this.page.selection.isNew&&null!=this.page.selection.value&&this.page.selection.value.length>0?this.service.getChildren(this.page.selection.value).then(t=>{e.options=t.filter(t=>t.type===e.selection.type),this.page=e}).catch(e=>{this.error(e)}):this.page=e:(this.page=e,this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!1},{label:"Final",active:!0,enabled:!1}]})}}handleBackPage(){if(this.page.index>0){const e=this.pages[this.page.index-1];"CATEGORY"===e.type&&(this.labels.splice(this.labels.length-1,1),this.modalStepConfig.steps.forEach(e=>{"category"===e.label.toLowerCase()&&!1===e.enabled&&(this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]})})),this.page=e}}handleUpload(){if(this.existingTask)this.uploader.uploadStoredFiles();else{(()=>{this.values.uploadTarget=this.uploadTarget,this.values.uasComponentOid=this.component.id,this.values.processUpload=this.processUpload,this.values.processDem=this.config.processDem,this.values.processOrtho=this.config.processOrtho,this.values.processPtcloud=this.config.processPtcloud,this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()})()}}hasField(e){return this.metadataService.hasExtraField(this.page.selection.type,e)}removeUpload(){const e=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});e.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",e.content.type="DANGER",e.content.submitText="Cancel Upload",e.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),this.existingTask=!1,this.page=this.pages[0],this.onUploadCancel.next(),this.bsModalRef.hide()}).catch(e=>{this.error(e)})})}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let n=Math.floor(t/3600),c=Math.floor(t%3600/60),i=Math.floor(t%60),o=c<10?"0"+n:n,a=c<10?"0"+c:c,s=i<10?"0"+i:i;e.uploadCounter=o+":"+a+":"+s}),1e3)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}error(e){this.message=S.b.getMessageFromError(e)}}Ee.ɵfac=function(e){return new(e||Ee)(c.hc(Z),c.hc(te),c.hc(j.b),c.hc(j.a),c.hc(c.E))},Ee.ɵcmp=c.bc({type:Ee,selectors:[["upload-modal"]],viewQuery:function(e,t){var n;(1&e&&c.fd(ne,!0),2&e)&&(c.Oc(n=c.wc())&&(t.content=n.first))},hostBindings:function(e,t){1&e&&c.vc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.Qc)},decls:46,vars:17,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[4,"ngIf"],[1,"row",3,"hidden"],[1,"col-md-2"],[1,"col-md-8"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],[1,"",3,"hidden"],[1,"well"],[1,"table"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-danger",3,"disabled","click",4,"ngIf"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"row","error-container"],[1,"label-holder"],[2,"color","#8c0000"],[1,"holder"],[1,"error-message"],[1,"list-group","list-group-horizontal"],[3,"stepConfig"],[3,"edit","entity","config","onError",4,"ngIf"],["class","form-group",4,"ngIf"],[3,"edit","entity","config","onError"],[1,"form-group"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],["for","description"],["name","description","type","input","placeholder","Description...",1,"form-control",3,"ngModel","ngModelChange"],["name","tool","type","input","placeholder","Software...",1,"form-control",3,"ngModel","ngModelChange"],["label","Generate png from upload",3,"value","valueChange"],["label","Generate hillshade from tif",3,"value","valueChange"],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"icon-upload","icon-white"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,ce,11,1,"div",1),c.Zc(3,ie,5,1,"div",2),c.Zc(4,pe,3,2,"ng-container",3),c.nc(5,"div",4),c.ic(6,"div",5),c.nc(7,"div",6),c.Zc(8,me,11,0,"div",3),c.Zc(9,he,13,1,"div",7),c.nc(10,"div",8),c.nc(11,"div",9),c.nc(12,"h4"),c.bd(13,"All files uploaded through the upload wizard must"),c.mc(),c.nc(14,"ul"),c.nc(15,"li"),c.bd(16,"be compressed into a .zip or .tar.gz format "),c.mc(),c.nc(17,"li"),c.bd(18,"not contain spaces or special characters such as <,>, -, +, =, !, @, #, $, %, ^, &, *, ?,/,\\ or apostrophes in any file name"),c.mc(),c.mc(),c.nc(19,"h4"),c.bd(20," Supported File Formats "),c.mc(),c.nc(21,"table",10),c.nc(22,"thead"),c.nc(23,"tr"),c.nc(24,"th"),c.bd(25,"Type"),c.mc(),c.nc(26,"th"),c.bd(27,"Formats"),c.mc(),c.mc(),c.mc(),c.Zc(28,ue,16,0,"tbody",3),c.Zc(29,ge,5,0,"tbody",3),c.Zc(30,be,5,0,"tbody",3),c.Zc(31,fe,5,0,"tbody",3),c.Zc(32,ve,5,0,"tbody",3),c.mc(),c.mc(),c.Zc(33,ye,26,9,"div",11),c.ic(34,"div",12,13),c.mc(),c.mc(),c.ic(36,"div",5),c.mc(),c.mc(),c.nc(37,"div",14),c.nc(38,"div",15),c.nc(39,"div",16),c.nc(40,"div",17),c.Zc(41,ke,3,1,"button",18),c.nc(42,"button",19),c.vc("click",(function(){return t.close()})),c.nc(43,"span",20),c.bd(44,"Close"),c.mc(),c.mc(),c.Zc(45,xe,3,1,"button",21),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",!t.existingTask),c.Ub(1),c.Ec("ngIf","SUMMARY"===t.page.type&&!t.existingTask&&null==t.currentTask),c.Ub(1),c.Ec("@fadeInOnEnter",void 0)("hidden","FILE"!==t.page.type&&"SUMMARY"!==t.page.type),c.Ub(3),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("ngForOf",t.taskFinishedNotifications),c.Ub(1),c.Ec("hidden",!t.uploadVisible),c.Ub(18),c.Ec("ngIf","row"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","ptcloud"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","dem"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","ortho"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","video"===t.uploadTarget),c.Ub(1),c.Ec("ngIf",t.currentTask),c.Ub(8),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("disabled",t.disabled),c.Ub(3),c.Ec("ngIf",t.page.index===t.pages.length-1))},styles:[".list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tdisplay: inline-block;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tmargin-bottom: 0;\n\tmargin-left: -4px;\n\tmargin-right: 0;\n\tborder-right-width: 0;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child {\n\tborder-top-right-radius: 0;\n\tborder-bottom-left-radius: 4px;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child {\n\tborder-top-right-radius: 4px;\n\tborder-bottom-left-radius: 0;\n\tborder-right-width: 1px;\n}\n\n.list-group-item-success[_ngcontent-%COMP%] {\n\tcolor: #155724;\n\tbackground-color: #c3e6cb;\n}"],data:{animation:[Object(Y.c)(),Object(Y.d)()]}});var Ce=n(331),we=n(79);function Ue(e,t){1&e&&c.ic(0,"i",2)}function Me(e,t){if(1&e){const e=c.oc();c.nc(0,"button",10),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return c.xc(2).handleRemove(t)})),c.bd(1," Remove "),c.mc()}if(2&e){const e=c.xc(4);c.Ec("disabled",e.processRunning)}}function Ie(e,t){if(1&e){const e=c.oc();c.nc(0,"button",11),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return c.xc(2).handleUpload(t.folder)})),c.bd(1," Upload "),c.mc()}if(2&e){const e=c.xc(4);c.Ec("disabled",e.processRunning)}}function Oe(e,t){if(1&e&&(c.nc(0,"td",7),c.Zc(1,Me,2,1,"button",8),c.Zc(2,Ie,2,1,"button",9),c.mc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(1),c.Ec("ngIf",null!=t.artifacts[e.folder]),c.Ub(1),c.Ec("ngIf",null==t.artifacts[e.folder])}}function Se(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(4).config.processPtcloud=t})),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ec("value",t.config.processPtcloud)("label",null!=t.artifacts[e.folder]?"Overwirte":"Generate")}}function Te(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(4).config.processDem=t})),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ec("value",t.config.processDem)("label",null!=t.artifacts[e.folder]?"Overwirte":"Generate")}}function Re(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(4).config.processOrtho=t})),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ec("value",t.config.processOrtho)("label",null!=t.artifacts[e.folder]?"Overwirte":"Generate")}}function Pe(e,t){if(1&e&&(c.nc(0,"td"),c.Zc(1,Se,1,2,"boolean-field",12),c.Zc(2,Te,1,2,"boolean-field",12),c.Zc(3,Re,1,2,"boolean-field",12),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngIf","ptcloud"===e.folder),c.Ub(1),c.Ec("ngIf","dem"===e.folder),c.Ub(1),c.Ec("ngIf","ortho"===e.folder)}}function Fe(e,t){if(1&e&&(c.lc(0),c.nc(1,"tr"),c.nc(2,"td"),c.bd(3),c.mc(),c.nc(4,"td"),c.bd(5),c.mc(),c.nc(6,"td"),c.bd(7),c.mc(),c.nc(8,"td"),c.bd(9),c.mc(),c.nc(10,"td"),c.bd(11),c.mc(),c.Zc(12,Oe,3,2,"td",5),c.Zc(13,Pe,4,3,"td",6),c.mc(),c.kc()),2&e){const e=t.$implicit,n=c.xc(2);c.Ub(3),c.cd(e.label),c.Ub(2),c.cd(null!=n.artifacts[e.folder]?n.artifacts[e.folder].name:""),c.Ub(2),c.cd(null!=n.artifacts[e.folder]?n.artifacts[e.folder].tool:""),c.Ub(2),c.cd(null!=n.artifacts[e.folder]?n.artifacts[e.folder].lastModified:""),c.Ub(2),c.cd(null!=n.artifacts[e.folder]?n.artifacts[e.folder].description:""),c.Ub(1),c.Ec("ngIf",!n.edit),c.Ub(1),c.Ec("ngIf",n.edit)}}function Ne(e,t){if(1&e&&(c.nc(0,"table",3),c.nc(1,"thead"),c.nc(2,"th"),c.bd(3,"Type"),c.mc(),c.nc(4,"th"),c.bd(5,"Name"),c.mc(),c.nc(6,"th"),c.bd(7,"Processing Software"),c.mc(),c.nc(8,"th"),c.bd(9,"Date"),c.mc(),c.nc(10,"th"),c.bd(11,"Description"),c.mc(),c.ic(12,"th"),c.mc(),c.Zc(13,Fe,14,7,"ng-container",4),c.mc()),2&e){const e=c.xc();c.Ub(13),c.Ec("ngForOf",e.sections)}}class De{constructor(e,t){this.service=e,this.modalService=t,this.edit=!1,this.config={processPtcloud:!1,processDem:!1,processOrtho:!1},this.onError=new c.t,this.loading=!1,this.sections=[{label:"Ptcloud",folder:"ptcloud"},{label:"DEM",folder:"dem"},{label:"Ortho",folder:"ortho"}],this.thumbnails={},this.context=acp}ngOnInit(){let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"UPLOAD_JOB_CHANGE"===e.type&&"Complete"===e.content.status&&e.content.collection===this.entity.id&&this.loadArtifacts()}),this.loadArtifacts()}ngOnDestroy(){this.notifier.unsubscribe()}loadArtifacts(){this.loading=!0,this.service.getArtifacts(this.entity.id).then(e=>{this.loading=!1,this.artifacts=e,this.config.processDem=null==this.artifacts.dem,this.config.processOrtho=null==this.artifacts.ortho,this.config.processPtcloud=null==this.artifacts.ptcloud}).catch(e=>{this.error(e)})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.key]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e){if(null!=e){let t=e.key.substr(0,e.key.lastIndexOf("/")),n=/[^/]*$/.exec(e.key)[0];const c=n.lastIndexOf("."),i=t+"/thumbnails/"+n.substr(0,c)+".png";this.service.download(e.component,i,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}isImage(e){return-1!==e.name.toLowerCase().indexOf(".png")||-1!==e.name.toLowerCase().indexOf(".jpg")||-1!==e.name.toLowerCase().indexOf(".jpeg")||-1!==e.name.toLowerCase().indexOf(".tif")||-1!==e.name.toLowerCase().indexOf(".tiff")}previewImage(e,t){}toggleExcludeImage(e,t){this.service.setExclude(t.id,!t.exclude).then(e=>{t.exclude=e.exclude})}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.entity.id+"&key="+e.key}handleUpload(e){this.modalService.show(Ee,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(this.entity,e)}handleRemove(e){const t=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.message="Do you want to delete the ["+e.label+"] products? This action cannot be undone.",t.content.type="DANGER",t.content.submitText="Delete",t.content.onConfirm.subscribe(()=>{this.service.removeArtifacts(this.entity.id,e.folder).then(e=>{this.artifacts=e}).catch(e=>{this.error(e)})})}capitalize(e){return e.replace(/^\w/,e=>e.toUpperCase())}error(e){this.onError.emit(e)}}function Ae(e,t){if(1&e&&(c.nc(0,"div",7),c.nc(1,"div",8),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",9),c.nc(5,"div"),c.nc(6,"p",10),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Ze(e,t){if(1&e){const e=c.oc();c.nc(0,"artifact-page",11),c.vc("onError",(function(t){return c.Rc(e),c.xc().error(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("edit",!0)("entity",e.entity)("config",e.config)}}De.ɵfac=function(e){return new(e||De)(c.hc(Z),c.hc(j.b))},De.ɵcmp=c.bc({type:De,selectors:[["artifact-page"]],inputs:{entity:"entity",processRunning:"processRunning",edit:"edit",config:"config"},outputs:{onError:"onError"},features:[c.Tb([])],decls:3,vars:2,consts:[["class","fa fa-spinner fa-spin","style","margin-left:50%;",4,"ngIf"],["style","width: 100%;",4,"ngIf"],[1,"fa","fa-spinner","fa-spin",2,"margin-left","50%"],[2,"width","100%"],[4,"ngFor","ngForOf"],["style","text-align:right;",4,"ngIf"],[4,"ngIf"],[2,"text-align","right"],["type","button","class","btn btn-warning","style","margin: 5px 0;",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-primary","style","margin: 5px 0;",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-warning",2,"margin","5px 0",3,"disabled","click"],["type","button",1,"btn","btn-primary",2,"margin","5px 0",3,"disabled","click"],[3,"value","label","valueChange",4,"ngIf"],[3,"value","label","valueChange"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.Zc(1,Ue,1,0,"i",0),c.Zc(2,Ne,14,1,"table",1),c.mc()),2&e&&(c.Ub(1),c.Ec("ngIf",t.loading),c.Ub(1),c.Ec("ngIf",null!=t.artifacts))},directives:[i.t,i.s,we.a],encapsulation:2});class je{constructor(e){this.bsModalRef=e,this.message=null,this.entity=null,this.config={processPtcloud:!1,processDem:!1,processOrtho:!1}}init(e){this.entity=e}ngOnInit(){this.onConfirm=new G.b}ngOnDestroy(){this.onConfirm.unsubscribe()}confirm(){this.onConfirm.next(this.config),this.bsModalRef.hide()}error(e){this.message=S.b.getMessageFromError(e)}}je.ɵfac=function(e){return new(e||je)(c.hc(j.a))},je.ɵcmp=c.bc({type:je,selectors:[["run-ortho-modal"]],decls:12,vars:2,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[3,"edit","entity","config","onError",4,"ngIf"],[1,"modal-footer"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],["type","button","role","button","aria-disabled","false",1,"btn","btn-primary",2,"padding","4px 18px",3,"click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"edit","entity","config","onError"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,Ae,8,1,"div",1),c.nc(3,"h3"),c.bd(4,"Run ortho to process the following products: "),c.mc(),c.Zc(5,Ze,1,3,"artifact-page",2),c.mc(),c.nc(6,"div",3),c.nc(7,"div",4),c.nc(8,"button",5),c.vc("click",(function(){return t.bsModalRef.hide()})),c.bd(9,"Cancel"),c.mc(),c.nc(10,"button",6),c.vc("click",(function(){return t.confirm()})),c.bd(11,"Submit"),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(3),c.Ec("ngIf",null!=t.entity))},directives:[i.t,De],encapsulation:2});var Le=n(96);function _e(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",5),c.nc(5,"div"),c.nc(6,"p",6),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function $e(e,t){1&e&&c.ic(0,"span",36)}const ze=function(e){return["/site/sensor",e]};function Be(e,t){if(1&e&&(c.nc(0,"table",37),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",38),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.nc(13,"tr"),c.nc(14,"td"),c.bd(15,"Model"),c.mc(),c.nc(16,"td"),c.bd(17),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(6),c.Ec("routerLink",c.Ic(4,ze,e.entity.sensor.oid)),c.Ub(1),c.cd(e.entity.sensor.name),c.Ub(5),c.dd(" ",e.entity.sensor.sensorType.name,""),c.Ub(5),c.cd(e.entity.sensor.model)}}function Ge(e,t){1&e&&(c.nc(0,"p",39),c.bd(1,"Sensor metadata is not available for this collection."),c.mc())}const Ve=function(e){return["/site/platform",e]};function qe(e,t){if(1&e&&(c.nc(0,"table",37),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",38),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(6),c.Ec("routerLink",c.Ic(3,Ve,e.entity.platform.oid)),c.Ub(1),c.cd(e.entity.platform.name),c.Ub(5),c.dd(" ",e.entity.platform.platformType.name,"")}}function He(e,t){1&e&&(c.nc(0,"p",39),c.bd(1,"Platform metadata is not available for this collection. "),c.mc())}const Je=function(e){return["/site/uav",e]};function We(e,t){if(1&e&&(c.nc(0,"table",37),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Serial Number"),c.mc(),c.nc(5,"td"),c.nc(6,"a",38),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(6),c.Ec("routerLink",c.Ic(3,Je,e.entity.uav.oid)),c.Ub(1),c.cd(e.entity.uav.serialNumber),c.Ub(5),c.dd(" ",e.entity.uav.faaNumber,"")}}function Ye(e,t){1&e&&(c.nc(0,"p",39),c.bd(1,"UAV metadata is not available for this collection."),c.mc())}function Xe(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function Ke(e,t){if(1&e){const e=c.oc();c.nc(0,"input",46),c.vc("change",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(2).toggleExcludeImage(t,n)})),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("checked",e.exclude)}}const Qe=function(e,t){return{"card-disabled":e,"non-clickable":t}},et=function(e){return{"img-disabled":e}};function tt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",40),c.nc(1,"a",41),c.Zc(2,Ke,1,1,"input",42),c.nc(3,"img",43),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit,o=c.xc(2);return!!o.enableSelectableImages&&o.toggleExcludeImage(n,i)})),c.yc(4,"safeHtml"),c.mc(),c.nc(5,"div",44),c.nc(6,"h4",45),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ub(1),c.Ec("ngClass",c.Jc(7,Qe,e.exclude,!n.enableSelectableImages)),c.Ub(1),c.Ec("ngIf",n.enableSelectableImages),c.Ub(1),c.Ec("ngClass",c.Ic(10,et,e.exclude))("src",null!=n.thumbnails[e.key]?c.zc(4,5,n.thumbnails[e.key]):n.context+"/net/geoprism/images/thumbnail-default.png",c.Tc),c.Ub(4),c.dd(" ",e.name," ")}}function nt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.ic(2,"div",47),c.nc(3,"div",48),c.nc(4,"h3"),c.bd(5),c.nc(6,"a",49),c.vc("click",(function(){c.Rc(e);const t=c.xc(2);return t.handleDownloadVideo(t.video.src)})),c.ic(7,"i",50),c.mc(),c.nc(8,"a",51),c.vc("click",(function(){return c.Rc(e),c.xc(2).closeVideo()})),c.ic(9,"i",52),c.mc(),c.mc(),c.mc(),c.ic(10,"div",47),c.mc(),c.nc(11,"div",7),c.ic(12,"div",47),c.nc(13,"div",48),c.nc(14,"video",53),c.ic(15,"source",54),c.bd(16," Browser not supported "),c.mc(),c.mc(),c.ic(17,"div",47),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(5),c.dd(" ",e.video.name," "),c.Ub(10),c.Ec("src",e.video.src,c.Tc)}}function ct(e,t){if(1&e){const e=c.oc();c.nc(0,"li",40),c.nc(1,"a",55),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).showVideo(n)})),c.ic(2,"img",56),c.nc(3,"div",44),c.nc(4,"h4",45),c.bd(5),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ub(2),c.Ec("src",n.context+"/net/geoprism/images/thumbnail-video.png",c.Tc),c.Ub(3),c.cd(e.name)}}function it(e,t){if(1&e){const e=c.oc();c.nc(0,"artifact-page",57),c.vc("onError",(function(t){return c.Rc(e),c.xc(2).error(t)})),c.mc()}if(2&e){const e=c.xc(2);c.Ec("entity",e.entity)("processRunning",e.processRunning)}}function ot(e,t){if(1&e){const e=c.oc();c.nc(0,"pagination-controls",58),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(2).onPageChange(t)})),c.mc()}}function at(e,t){if(1&e&&(c.nc(0,"div",59),c.nc(1,"p"),c.bd(2),c.mc(),c.nc(3,"p"),c.bd(4,"See this process on "),c.nc(5,"a",60),c.bd(6,"your tasks page"),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(2),c.cd(e.statusMessage)}}function st(e,t){if(1&e){const e=c.oc();c.nc(0,"button",61),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleUpload()})),c.bd(1," Upload "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}function lt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",62),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownload()})),c.bd(1," Download All "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}function rt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",63),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownloadOdmAll()})),c.bd(1," Download All Generated Data "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}const dt=function(e){return{"fa-spin":e}};function pt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",64),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleRunOrtho()})),c.bd(1," Reprocess Imagery "),c.ic(2,"i",65),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning),c.Ub(2),c.Ec("ngClass",c.Ic(2,dt,e.processRunning))}}const mt=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function ht(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h2"),c.bd(4),c.Zc(5,$e,1,0,"span",9),c.mc(),c.mc(),c.mc(),c.nc(6,"div",7),c.nc(7,"div",8),c.nc(8,"label"),c.bd(9,"Pilot Name: "),c.mc(),c.bd(10),c.mc(),c.mc(),c.nc(11,"div",7),c.nc(12,"div",8),c.nc(13,"label"),c.bd(14,"Upload Date: "),c.mc(),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"div",7),c.nc(18,"div",8),c.nc(19,"label"),c.bd(20,"Collection Date: "),c.mc(),c.bd(21),c.yc(22,"idmdate"),c.mc(),c.mc(),c.nc(23,"div",7),c.nc(24,"div",10),c.nc(25,"label"),c.bd(26,"Sensor:"),c.mc(),c.Zc(27,Be,18,6,"table",11),c.Zc(28,Ge,2,0,"p",12),c.mc(),c.nc(29,"div",10),c.nc(30,"label"),c.bd(31,"Platform:"),c.mc(),c.Zc(32,qe,13,5,"table",11),c.Zc(33,He,2,0,"p",12),c.mc(),c.mc(),c.nc(34,"div",7),c.nc(35,"div",8),c.nc(36,"label"),c.bd(37,"UAV:"),c.mc(),c.Zc(38,We,13,5,"table",11),c.Zc(39,Ye,2,0,"p",12),c.mc(),c.mc(),c.nc(40,"div",7),c.nc(41,"div",8),c.nc(42,"ul",13),c.Zc(43,Xe,3,1,"li",14),c.mc(),c.mc(),c.mc(),c.nc(44,"div",7),c.nc(45,"div",15),c.nc(46,"tabset",16),c.nc(47,"tab",17),c.vc("selectTab",(function(){return c.Rc(e),c.xc().onSelect("raw")})),c.nc(48,"div",18),c.nc(49,"ul",19),c.Zc(50,tt,8,12,"li",20),c.yc(51,"paginate"),c.mc(),c.mc(),c.mc(),c.nc(52,"tab",21),c.vc("selectTab",(function(){return c.Rc(e),c.xc().onSelect("video")})),c.Zc(53,nt,18,2,"div",2),c.nc(54,"div",18),c.nc(55,"ul",19),c.Zc(56,ct,6,2,"li",20),c.mc(),c.mc(),c.mc(),c.nc(57,"tab",22),c.vc("selectTab",(function(){return c.Rc(e),c.xc().onSelect("artifacts")})),c.Zc(58,it,1,2,"artifact-page",23),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(59,"div",7),c.nc(60,"div",15),c.Zc(61,ot,1,0,"pagination-controls",24),c.Zc(62,at,7,1,"div",25),c.nc(63,"div",26),c.nc(64,"div",7),c.nc(65,"div",27),c.nc(66,"button",28),c.vc("click",(function(){return c.Rc(e),c.xc().handleSetMetadata()})),c.ic(67,"i",29),c.bd(68," Edit Metadata "),c.mc(),c.Zc(69,st,2,1,"button",30),c.mc(),c.nc(70,"div",31),c.nc(71,"button",32),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(72,"Close"),c.mc(),c.Zc(73,lt,2,1,"button",33),c.Zc(74,rt,2,1,"button",34),c.Zc(75,pt,3,4,"button",35),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.dd("",e.entity.name," "),c.Ub(1),c.Ec("ngIf",!e.entity.metadataUploaded),c.Ub(5),c.dd("   ",e.entity.pilotName," "),c.Ub(5),c.dd("   ",c.Ac(16,23,e.entity.dateTime,"MMM dd, yyyy")," "),c.Ub(6),c.dd("   ",c.Ac(22,26,e.entity.collectionDate,"MMM dd, yyyy")," "),c.Ub(6),c.Ec("ngIf",e.entity.sensor),c.Ub(1),c.Ec("ngIf",!e.entity.sensor),c.Ub(4),c.Ec("ngIf",e.entity.platform),c.Ub(1),c.Ec("ngIf",!e.entity.platform),c.Ub(5),c.Ec("ngIf",e.entity.uav),c.Ub(1),c.Ec("ngIf",!e.entity.platform),c.Ub(4),c.Ec("ngForOf",e.previous),c.Ub(7),c.Ec("ngForOf",c.Ac(51,29,e.page.results,c.Kc(32,mt,e.page.pageSize,e.page.pageNumber,e.page.count))),c.Ub(3),c.Ec("ngIf",null!==e.video.src),c.Ub(3),c.Ec("ngForOf",e.page.results),c.Ub(2),c.Ec("ngIf","artifacts"===e.tabName),c.Ub(3),c.Ec("ngIf","raw"===e.tabName),c.Ub(1),c.Ec("ngIf",e.showOrthoRerunMessage),c.Ub(4),c.Ec("disabled",e.processRunning),c.Ub(3),c.Ec("ngIf","raw"===e.tabName),c.Ub(4),c.Ec("ngIf",e.processable),c.Ub(1),c.Ec("ngIf",e.processable),c.Ub(1),c.Ec("ngIf",e.processable&&e.enableSelectableImages)}}class ut{constructor(e,t,n,c){this.service=e,this.metadataService=t,this.modalService=n,this.bsModalRef=c,this.previous=[],this.folders=[],this.thumbnails={},this.processRunning=!1,this.processable=!1,this.enableSelectableImages=!1,this.showOrthoRerunMessage=!1,this.constPageSize=50,this.page=new V,this.video={src:null,name:null},this.context=acp}set initData(e){this.init(e.entity,e.folders,e.previous)}ngOnInit(){this.onNodeChange=new G.b,this.page.count=0,this.page.pageNumber=1,this.page.pageSize=this.constPageSize,this.page.results=[]}init(e,t,n){this.entity=e,this.folders=t,this.previous=[...n],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.onSelect("raw"),this.processable=this.metadataService.isProcessable(e.type)}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.key]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e){if(null!=e){let t=e.key.substr(0,e.key.lastIndexOf("/")),n=/[^/]*$/.exec(e.key)[0];const c=n.lastIndexOf("."),i=t+"/thumbnails/"+n.substr(0,c)+".png";this.service.download(e.component,i,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}onPageChange(e){this.getData(this.entity.id,this.tabName,e,this.page.pageSize)}onSelect(e){if(this.tabName=e,"raw"===e||"video"===e){this.page.results=[],this.enableSelectableImages="raw"===e;let t=null,n=null;"raw"===e&&(t=null==this.page.pageNumber?1:this.page.pageNumber,n=this.constPageSize),this.video.src=null,this.video.name=null,this.getData(this.entity.id,this.tabName,t,n)}}getData(e,t,n,c){this.service.getObjects(e,t,n,c).then(e=>{this.page=e;for(let e=0;e<this.page.results.length;++e){let t=this.page.results[e];this.isImage(t)&&this.getThumbnail(t)}})}isImage(e){return-1!==e.name.toLowerCase().indexOf(".png")||-1!==e.name.toLowerCase().indexOf(".jpg")||-1!==e.name.toLowerCase().indexOf(".jpeg")||-1!==e.name.toLowerCase().indexOf(".tif")||-1!==e.name.toLowerCase().indexOf(".tiff")}previewImage(e,t){}toggleExcludeImage(e,t){this.service.setExclude(t.id,!t.exclude).then(e=>{t.exclude=e.exclude})}isProcessable(e){return this.metadataService.isProcessable(e.type)}handleErosPush(){this.processRunning=!0,this.service.pushToEros(this.entity.id).then(e=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})}handleRunOrtho(){const e=this.modalService.show(je,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"confirmation-modal"});e.content.init(this.entity),e.content.onConfirm.subscribe(e=>{this.processRunning=!0,this.showOrthoRerunMessage=!0,this.service.runOrtho(this.entity.id,e.processPtcloud,e.processDem,e.processOrtho).then(()=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.entity.id+"&key="+this.tabName}handleDownloadOdmAll(){window.location.href=acp+"/project/download-odm-all?colId="+this.entity.id}handleDownloadVideo(e){window.location.href=e}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.entity.id+"&key="+e.key}handleSetMetadata(){let e=this.modalService.show(W,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"});e.content.init(this.entity.id,this.entity.name),e.content.onMetadataChange.subscribe(()=>{this.entity.metadataUploaded=!0})}handleUpload(){this.modalService.show(Ee,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(this.entity,"raw")}capitalize(e){return e.replace(/^\w/,e=>e.toUpperCase())}showVideo(e){this.video.name=null,this.video.src=null,setTimeout(()=>{this.video.name=e.name,this.video.src=acp+"/project/download?id="+this.entity.component+"&key="+e.key},200)}closeVideo(){this.video.name=null,this.video.src=null}error(e){this.message=S.b.getMessageFromError(e)}}ut.ɵfac=function(e){return new(e||ut)(c.hc(Z),c.hc(te),c.hc(j.b),c.hc(j.a))},ut.ɵcmp=c.bc({type:ut,selectors:[["collection-modal"]],inputs:{initData:"initData"},features:[c.Tb([S.a,De])],decls:4,vars:3,consts:[[1,"modal-body",2,"padding-bottom","0"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],["class","dot pending","style","margin-left: 0;margin-bottom: 5px;",4,"ngIf"],[1,"col-md-6"],["class","table table-bordered",4,"ngIf"],["style","font-style:italic;",4,"ngIf"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"col-sm-12"],[1,"nav-full-width"],["heading","raw",3,"selectTab"],[1,"image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3",4,"ngFor","ngForOf"],["heading","video",3,"selectTab"],["heading","products",2,"margin-top","10px",3,"selectTab"],[3,"entity","processRunning","onError",4,"ngIf"],[3,"pageChange",4,"ngIf"],["style","text-align:right;padding-right:20px;",4,"ngIf"],[1,"btn-holder",2,"margin","20px 0px 10px 0px"],[1,"col-sm-4"],["type","button",1,"btn","btn-warning",3,"disabled","click"],[1,"fa","fa-edit",2,"color","white"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"col-md-8",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","button","class","btn btn-secondary","title","Downloads all files","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-secondary","title","Downloads the all.zip file generated from ODM.","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],["class","btn btn-primary","title","Reprocesses the selected raw imagery and generates new products.","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],[1,"dot","pending",2,"margin-left","0","margin-bottom","5px"],[1,"table","table-bordered"],["target","_blank",3,"routerLink"],[2,"font-style","italic"],[1,"list-group-item","col-xs-3"],[1,"thumbnail",3,"ngClass"],["type","checkbox","class","x-box",3,"checked","change",4,"ngIf"],["alt","Image",2,"max-height","150px",3,"ngClass","src","click"],[1,"caption"],[1,"media-heading"],["type","checkbox",1,"x-box",3,"checked","change"],[1,"col-md-1"],[1,"col-md-10"],[3,"click"],[1,"fas","fa-download"],[1,"pull-right",3,"click"],["aria-hidden","true",1,"fa","fa-times"],["controls","",2,"width","100%"],["type","video/mp4",3,"src"],[1,"thumbnail",3,"click"],["alt","Video",3,"src"],[3,"entity","processRunning","onError"],[3,"pageChange"],[2,"text-align","right","padding-right","20px"],["routerLink","/site/tasks"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["type","button","title","Downloads all files",1,"btn","btn-secondary",2,"margin-left","5px",3,"disabled","click"],["type","button","title","Downloads the all.zip file generated from ODM.",1,"btn","btn-secondary",2,"margin-left","5px",3,"disabled","click"],["title","Reprocesses the selected raw imagery and generates new products.",1,"btn","btn-primary",2,"margin-left","5px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-sync-alt",2,"color","white","vertical-align","middle","margin-left","10px",3,"ngClass"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div"),c.Zc(2,_e,8,1,"div",1),c.Zc(3,ht,76,36,"div",2),c.mc(),c.mc()),2&e&&(c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",null!=t.entity))},directives:[i.t,i.s,p.e,p.b,o.e,i.q,De,h.c],pipes:[Le.a,h.b,L.a],encapsulation:2,data:{animation:[Object(Y.c)(),Object(Y.d)(),Object(Y.e)(),Object(Y.f)()]}});class gt{constructor(e,t){this.http=e,this.eventService=t}getProducts(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("sortField",t),c=c.set("sortOrder",n),this.http.get(acp+"/product/get-all",{params:c}).toPromise()}getDetail(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("pageNumber",t.toString()),c=c.set("pageSize",n.toString()),this.eventService.start(),this.http.get(acp+"/product/detail",{params:c}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}togglePublish(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/toggle-publish",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}function bt(e,t){if(1&e&&(c.nc(0,"div",5),c.nc(1,"div",6),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",7),c.nc(5,"div"),c.nc(6,"p",8),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function ft(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function vt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",26),c.nc(1,"a",27),c.nc(2,"img",28),c.vc("error",(function(t){return c.Rc(e),c.xc(3).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ub(2),c.Ec("src",c.zc(3,1,e.thumbnails[e.product.id]),c.Tc)}}gt.ɵfac=function(e){return new(e||gt)(c.rc(y.c),c.rc(D.a))},gt.ɵprov=c.dc({token:gt,factory:gt.ɵfac});const yt=function(e){return["/site/sensor",e]};function kt(e,t){if(1&e&&(c.nc(0,"table",29),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",30),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.nc(13,"tr"),c.nc(14,"td"),c.bd(15,"Model"),c.mc(),c.nc(16,"td"),c.bd(17),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(6),c.Ec("routerLink",c.Ic(4,yt,e.product.sensor.oid)),c.Ub(1),c.cd(e.product.sensor.name),c.Ub(5),c.dd(" ",e.product.sensor.sensorType.name,""),c.Ub(5),c.cd(e.product.sensor.model)}}function xt(e,t){1&e&&(c.nc(0,"p",31),c.bd(1,"Sensor metadata is not available for this collection."),c.mc())}const Et=function(e){return["/site/platform",e]};function Ct(e,t){if(1&e&&(c.nc(0,"table",29),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",30),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(6),c.Ec("routerLink",c.Ic(3,Et,e.product.platform.oid)),c.Ub(1),c.cd(e.product.platform.name),c.Ub(5),c.dd(" ",e.product.platform.platformType.name,"")}}function wt(e,t){1&e&&(c.nc(0,"p",31),c.bd(1,"Platform metadata is not available for this collection."),c.mc())}const Ut=function(e){return["/site/uav",e]};function Mt(e,t){if(1&e&&(c.nc(0,"table",29),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Serial Number"),c.mc(),c.nc(5,"td"),c.nc(6,"a",30),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"FAA Number"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(6),c.Ec("routerLink",c.Ic(3,Ut,e.product.uav.oid)),c.Ub(1),c.cd(e.product.uav.serialNumber),c.Ub(5),c.dd(" ",e.product.uav.faaNumber,"")}}function It(e,t){1&e&&(c.nc(0,"p",31),c.bd(1,"UAV metadata is not available for this collection."),c.mc())}function Ot(e,t){if(1&e){const e=c.oc();c.nc(0,"div",26),c.nc(1,"a",33),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(3).previewImage(t)})),c.nc(2,"img",34),c.vc("error",(function(t){return c.Rc(e),c.xc(4).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.nc(4,"div",35),c.nc(5,"h4",36),c.bd(6),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc(3);c.Ub(2),c.Ec("src",c.zc(3,2,t.thumbnails[e.id]),c.Tc),c.Ub(4),c.cd(e.name)}}function St(e,t){if(1&e&&(c.nc(0,"li",32),c.Zc(1,Ot,7,4,"div",13),c.mc()),2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("ngIf",null!=n.thumbnails[e.id])}}const Tt=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function Rt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",9),c.nc(2,"div",10),c.nc(3,"h2"),c.bd(4),c.mc(),c.mc(),c.mc(),c.nc(5,"div",9),c.nc(6,"div",10),c.nc(7,"ul",11),c.Zc(8,ft,3,1,"li",12),c.mc(),c.mc(),c.mc(),c.nc(9,"div",9),c.nc(10,"div",10),c.Zc(11,vt,4,3,"div",13),c.mc(),c.mc(),c.nc(12,"div",9),c.nc(13,"div",10),c.nc(14,"label"),c.bd(15,"Pilot Name: "),c.mc(),c.bd(16),c.mc(),c.mc(),c.nc(17,"div",9),c.nc(18,"div",10),c.nc(19,"label"),c.bd(20,"Creation Date: "),c.mc(),c.bd(21),c.yc(22,"idmdate"),c.mc(),c.mc(),c.nc(23,"div",9),c.nc(24,"div",10),c.nc(25,"label"),c.bd(26,"Collection Date: "),c.mc(),c.bd(27),c.yc(28,"idmdate"),c.mc(),c.mc(),c.nc(29,"div",9),c.nc(30,"div",14),c.nc(31,"label"),c.bd(32,"Sensor:"),c.mc(),c.Zc(33,kt,18,6,"table",15),c.Zc(34,xt,2,0,"p",16),c.mc(),c.nc(35,"div",14),c.nc(36,"label"),c.bd(37,"Platform:"),c.mc(),c.Zc(38,Ct,13,5,"table",15),c.Zc(39,wt,2,0,"p",16),c.mc(),c.mc(),c.nc(40,"div",9),c.nc(41,"div",10),c.nc(42,"label"),c.bd(43,"UAV:"),c.mc(),c.Zc(44,Mt,13,5,"table",15),c.Zc(45,It,2,0,"p",16),c.mc(),c.mc(),c.nc(46,"div",17),c.nc(47,"div",10),c.nc(48,"div",18),c.nc(49,"h3"),c.bd(50,"Raw Images"),c.mc(),c.nc(51,"ul",19),c.Zc(52,St,2,1,"li",20),c.yc(53,"paginate"),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(54,"div",9),c.nc(55,"pagination-controls",21),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(2).onPageChange(t)})),c.mc(),c.mc(),c.nc(56,"div",17),c.nc(57,"div",22),c.nc(58,"button",23),c.vc("click",(function(){return c.Rc(e),c.xc(2).bsModalRef.hide()})),c.bd(59,"Close"),c.mc(),c.nc(60,"button",24),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownload()})),c.bd(61,"Download ODM Files"),c.mc(),c.nc(62,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleGoto()})),c.bd(63," Collection Details "),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(4),c.cd(e.product.name),c.Ub(4),c.Ec("ngForOf",e.product.entities),c.Ub(3),c.Ec("ngIf",null!=e.thumbnails[e.product.id]),c.Ub(5),c.dd("   ",e.product.pilotName," "),c.Ub(5),c.dd("   ",c.Ac(22,13,e.product.dateTime,"MMM dd, yyyy")," "),c.Ub(6),c.dd("   ",c.Ac(28,16,e.product.collectionDate,"MMM dd, yyyy")," "),c.Ub(6),c.Ec("ngIf",e.product.sensor),c.Ub(1),c.Ec("ngIf",!e.product.sensor),c.Ub(4),c.Ec("ngIf",e.product.platform),c.Ub(1),c.Ec("ngIf",!e.product.platform),c.Ub(5),c.Ec("ngIf",e.product.uav),c.Ub(1),c.Ec("ngIf",!e.product.platform),c.Ub(7),c.Ec("ngForOf",c.Ac(53,19,e.product.page.resultSet,c.Kc(22,Tt,e.product.page.pageSize,e.product.page.pageNumber,e.product.page.count)))}}function Pt(e,t){if(1&e&&(c.nc(0,"div",2),c.nc(1,"div"),c.Zc(2,bt,8,1,"div",3),c.Zc(3,Rt,64,26,"div",4),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(2),c.Ec("ngIf",null!=e.message),c.Ub(1),c.Ec("ngIf",null!=e.product)}}function Ft(e,t){if(1&e&&c.ic(0,"collection-modal",37),2&e){const e=c.xc();c.Ec("initData",e.initData)}}class Nt{constructor(e,t,n,c){this.pService=e,this.service=t,this.bsModalRef=n,this.modalService=c,this.thumbnails={},this.items=[],this.showSite=!1}ngOnInit(){}init(e){this.product=e,this.product.imageKey&&this.getThumbnail(this.product.id,this.product.imageKey),this.product.page.resultSet.forEach(e=>{this.getThumbnail(e.id,e.key)})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e,t){const n=this.product.entities[this.product.entities.length-1].id,c=t.substr(0,t.lastIndexOf("/")),i=/[^/]*$/.exec(t)[0],o=i.lastIndexOf("."),a=c+"/thumbnails/"+i.substr(0,o)+".png";this.service.download(n,a,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}onPageChange(e){this.pService.getDetail(this.product.id,e,20).then(e=>{this.init(e)})}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleGoto(){const e=this.product.entities[this.product.entities.length-1],t=this.product.entities;this.service.getItems(e.id,null).then(n=>{this.initData={entity:e,folders:n,previous:t},this.showSite=!0})}previewImage(e){this.rawImagePreviewModal=this.modalService.show(B,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.rawImagePreviewModal.content.init(e.component,e.key)}handleDownload(){window.location.href=acp+"/product/get-odm-all?id="+this.product.id}error(e){this.message=S.b.getMessageFromError(e)}}function Dt(e,t){if(1&e&&(c.nc(0,"option",8),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.cd(e.label)}}function At(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",11),c.bd(2," Loading Products "),c.mc())}function Zt(e,t){1&e&&(c.nc(0,"p"),c.bd(1,"No data found"),c.mc())}function jt(e,t){if(1&e&&(c.nc(0,"div",9),c.nc(1,"h4"),c.Zc(2,At,3,0,"span",10),c.Zc(3,Zt,2,0,"p",10),c.mc(),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}function Lt(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name," ")}}function _t(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"a",31),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().previewImage(t)})),c.nc(2,"img",32),c.vc("error",(function(t){return c.Rc(e),c.xc(2).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(2),c.Ec("src",c.zc(3,1,t.thumbnails[e.id]),c.Tc)}}function $t(e,t){1&e&&c.ic(0,"i",33),2&e&&c.Ec("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function zt(e,t){1&e&&c.ic(0,"i",33),2&e&&c.Ec("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function Bt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",26),c.nc(1,"a",34),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleTogglePublish(t)})),c.bd(2,"Unpublish"),c.mc(),c.mc()}}function Gt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",26),c.nc(1,"a",35),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleTogglePublish(t)})),c.bd(2,"Publish"),c.mc(),c.mc()}}function Vt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",12),c.nc(1,"div",13),c.nc(2,"div",14),c.nc(3,"h5",15),c.bd(4),c.mc(),c.nc(5,"ul",16),c.Zc(6,Lt,3,1,"li",17),c.mc(),c.nc(7,"div",18),c.Zc(8,_t,4,3,"div",10),c.mc(),c.nc(9,"div",19),c.nc(10,"ul",20),c.nc(11,"li",21),c.nc(12,"a",22),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleMapIt(n)})),c.bd(13,"Aerial"),c.mc(),c.Zc(14,$t,1,2,"i",23),c.mc(),c.nc(15,"li",24),c.nc(16,"a",25),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleMapDem(n)})),c.bd(17,"Hillshade"),c.mc(),c.Zc(18,zt,1,2,"i",23),c.mc(),c.nc(19,"li",26),c.nc(20,"a",27),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handlePointcloud(n)})),c.bd(21,"3D"),c.mc(),c.mc(),c.nc(22,"li",26),c.nc(23,"a",28),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleGetInfo(n)})),c.bd(24,"Get Info"),c.mc(),c.mc(),c.nc(25,"li",26),c.nc(26,"a",29),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().handleDelete(i,n)})),c.bd(27,"Delete"),c.mc(),c.mc(),c.Zc(28,Bt,3,0,"li",30),c.Zc(29,Gt,3,0,"li",30),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("@fadeInOnEnter",void 0)("@fadeOutOnLeave",void 0),c.Ub(3),c.dd(" ",e.name," "),c.Ub(2),c.Ec("ngForOf",e.entities),c.Ub(2),c.Ec("ngIf",null!=n.thumbnails[e.id]),c.Ub(4),c.Xc(n.hasOrthoLayer(e)?"":"cursor:not-allowed;"),c.Ub(2),c.Ec("ngIf",e.orthoMapped),c.Ub(2),c.Xc(n.hasDemLayer(e)?"":"cursor:not-allowed;"),c.Ub(2),c.Ec("ngIf",e.demMapped),c.Ub(2),c.Xc(e.hasPointcloud?"":"cursor:not-allowed;"),c.Ub(8),c.Ec("ngIf",e.published),c.Ub(1),c.Ec("ngIf",!e.published)}}Nt.ɵfac=function(e){return new(e||Nt)(c.hc(gt),c.hc(Z),c.hc(j.a),c.hc(j.b))},Nt.ɵcmp=c.bc({type:Nt,selectors:[["product-modal"]],features:[c.Tb([ut])],decls:2,vars:2,consts:[["class","modal-body","style","padding-bottom: 0;",4,"ngIf"],[3,"initData",4,"ngIf"],[1,"modal-body",2,"padding-bottom","0"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],["class","",4,"ngIf"],[1,"col-md-6"],["class","table table-bordered",4,"ngIf"],["style","font-style:italic;",4,"ngIf"],[1,"row",2,"background-color","#ececec"],["id","image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3","style","background:none;",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 20px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"click"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[1,""],[1,"thumbnail","non-clickable"],["alt","Image",1,"",3,"src","error"],[1,"table","table-bordered"],["target","_blank",3,"routerLink"],[2,"font-style","italic"],[1,"list-group-item","col-xs-3",2,"background","none"],[1,"thumbnail",3,"click"],["alt","Image",3,"src","error"],[1,"caption"],[1,"media-heading"],[3,"initData"]],template:function(e,t){1&e&&(c.Zc(0,Pt,4,2,"div",0),c.Zc(1,Ft,1,1,"collection-modal",1)),2&e&&(c.Ec("ngIf",!t.showSite),c.Ub(1),c.Ec("ngIf",t.showSite))},directives:[i.t,i.s,h.c,o.e,ut],pipes:[Le.a,h.b,L.a],encapsulation:2,data:{animation:[Object(Y.c)(),Object(Y.d)(),Object(Y.a)()]}});class qt{constructor(e,t,n){this.pService=e,this.mService=t,this.modalService=n,this.toggleMapOrtho=new c.t,this.toggleMapDem=new c.t,this.products=[],this.thumbnails={},this.fields=[{label:"Name",value:"name"},{label:"Sensor",value:"sensor"},{label:"Flight Number",value:"faaNumber"},{label:"Serial Number",value:"serialNumber"},{label:"Product Date",value:"lastUpdateDate"}],this.sortField="name",this.loading=!1,this.requestId=0}ngOnChanges(e){this.refreshProducts(e.id.currentValue)}refresh(){this.refreshProducts(this.id)}refreshProducts(e){this.products=[],this.thumbnails={},this.loading=!0;const t=++this.requestId;this.pService.getProducts(e,this.sortField,"ASC").then(e=>{t===this.requestId&&(this.products=e,this.loading=!1,this.products.forEach(e=>{this.getThumbnail(e)}))})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.id]=n.result},!1),e&&n.readAsDataURL(e)}hasOrthoLayer(e){let t=e.layers.length;for(let n=0;n<t;++n)if("ORTHO"===e.layers[n].classification&&null!=e.layers[n].key&&e.layers[n].key.length>0)return!0;return!1}hasDemLayer(e){let t=e.layers.length;for(let n=0;n<t;++n)if(("DEM_DSM"===e.layers[n].classification||"DEM_DTM"===e.layers[n].classification)&&null!=e.layers[n].key&&e.layers[n].key.length>0)return!0;return!1}getThumbnail(e){if(null!=e.imageKey){const t=e.entities[e.entities.length-1].id,n=e.imageKey.substr(0,e.imageKey.lastIndexOf("/")),c=/[^/]*$/.exec(e.imageKey)[0],i=c.lastIndexOf("."),o=n+"/thumbnails/"+c.substr(0,i)+".png";this.mService.download(t,o,!1).subscribe(t=>{this.createImageFromBlob(t,e)},t=>{console.log(t),this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"})}else this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleMapIt(e){this.hasOrthoLayer(e)&&this.toggleMapOrtho.emit(e)}handleMapDem(e){this.hasDemLayer(e)&&this.toggleMapDem.emit(e)}handlePointcloud(e){if(e.hasPointcloud){let t=e.entities[e.entities.length-1].id;window.open(acp+"/pointcloud/"+t+"/potree")}}handleDelete(e,t){t.stopPropagation(),this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.pService.remove(e.id).then(t=>{this.products=this.products.filter(t=>t.id!==e.id)})}previewImage(e){if(null!=e.imageKey){const t=e.entities[e.entities.length-1].id;this.bsModalRef=this.modalService.show(B,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.bsModalRef.content.init(t,e.imageKey)}}handleGetInfo(e){this.pService.getDetail(e.id,1,20).then(e=>{this.bsModalRef=this.modalService.show(Nt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}),this.bsModalRef.content.init(e)})}handleTogglePublish(e){this.pService.togglePublish(e.id).then(t=>{const n=e.orthoMapped,c=e.demMapped;n&&this.toggleMapOrtho.emit(e),c&&this.toggleMapDem.emit(e),e.published=t.published,e.layers=t.layers,n&&this.toggleMapOrtho.emit(e),c&&this.toggleMapDem.emit(e)})}}function Ht(e,t){if(1&e&&(c.nc(0,"div",10),c.nc(1,"div",11),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",12),c.nc(5,"div"),c.nc(6,"p",13),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Jt(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"h3"),c.bd(2),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(2),c.dd("Add new ",e.entity.type,"")}}function Wt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"input",17),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("placeholder",e.label)("required",e.required)}}function Yt(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.cd(e.label)}}function Xt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"select",18),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.ic(4,"option"),c.Zc(5,Yt,2,2,"option",19),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required),c.Ub(2),c.Ec("ngForOf",e.options)}}function Kt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"textarea",21),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.bd(4,"          "),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required)}}function Qt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"map-attribute",22),c.vc("siteChange",(function(t){return c.Rc(e),c.xc(4).entity=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(4);c.Ub(1),c.Ec("site",e.entity)("center",e.center)("zoom",e.zoom)}}function en(e,t){if(1&e&&(c.nc(0,"div",15),c.Zc(1,Wt,4,6,"div",16),c.Zc(2,Xt,6,6,"div",16),c.Zc(3,Kt,5,5,"div",16),c.Zc(4,Qt,2,3,"div",16),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngIf","text"===e.type),c.Ub(1),c.Ec("ngIf","list"===e.type),c.Ub(1),c.Ec("ngIf","text-area"===e.type),c.Ub(1),c.Ec("ngIf","point"===e.type)}}function tn(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,en,5,4,"div",6),c.mc()),2&e){const e=t.$implicit,n=c.xc(2);c.Ub(1),c.Ec("ngIf",n.evaluate(e))}}function nn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.nc(1,"label"),c.bd(2,"Privilege "),c.mc(),c.nc(3,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).entity.privilegeType=t})),c.nc(4,"option",24),c.bd(5,"Owner"),c.mc(),c.nc(6,"option",25),c.bd(7,"Agency"),c.mc(),c.nc(8,"option",26),c.bd(9,"Public"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(3),c.Ec("ngModel",e.entity.privilegeType)("required",!0)("disabled",!1===e.admin||e.entity.ownerName!==e.userName)}}function cn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",1),c.Zc(1,Ht,8,1,"div",2),c.Zc(2,Jt,3,1,"div",3),c.nc(3,"form",null,4),c.Zc(5,tn,2,1,"div",5),c.Zc(6,nn,10,3,"div",6),c.nc(7,"div",7),c.nc(8,"button",8),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(9,"Cancel"),c.mc(),c.nc(10,"button",9),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(11,"Apply"),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.Pc(4),t=c.xc();c.Ub(1),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",t.newInstance),c.Ub(3),c.Ec("ngForOf",t.attributes),c.Ub(1),c.Ec("ngIf","Collection"===t.entity.type&&!t.newInstance),c.Ub(4),c.Ec("disabled",!e.valid)}}qt.ɵfac=function(e){return new(e||qt)(c.hc(gt),c.hc(Z),c.hc(j.b))},qt.ɵcmp=c.bc({type:qt,selectors:[["product-panel"]],inputs:{id:"id"},outputs:{toggleMapOrtho:"toggleMapOrtho",toggleMapDem:"toggleMapDem"},features:[c.Sb],decls:13,vars:4,consts:[[1,"row"],[1,"col-sm-12"],[2,"padding","10px 15px"],["name","sortField",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"list-group"],["style","padding: 10px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],[3,"value"],[2,"padding","10px","text-align","center","color","grey"],[4,"ngIf"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin"],[1,"list-group-item"],[1,"card","card-default"],[1,"card-body"],[1,"card-title",2,"color","#a0a0a0"],[1,"breadcrumb",2,"margin","5px 0 5px 0"],[4,"ngFor","ngForOf"],[1,"card-left",2,"width","calc(100% - 7.2em)","padding","0px"],[1,"card-right",2,"padding","0px","width","7.2em"],[2,"list-style","none","padding","0"],[2,"padding","3px 0 3px 0","min-width","6em"],["aria-hidden","true","title","View the Orthomosaic generated from the raw data using ODM.",1,"fa","fa-globe",3,"click"],["class","fas fa-check","style","color: #007276;float: right;vertical-align: middle;line-height: 20px;",4,"ngIf"],[2,"padding","3px 0 3px 0","min-width","7.2em"],["aria-hidden","true","title","View the DEM hillshade.",1,"fa","fa-industry",3,"click"],[2,"padding","3px 0 3px 0"],["aria-hidden","true","title","View the 3D pointcloud for this product using the Potree viewer.",1,"fa","fa-cube",3,"click"],["title","View more information about this product, including raw data.",1,"fa","fa-info-circle",3,"click"],["title","Deletes the product and all associated data and public map services.",1,"fa","fa-trash-alt",3,"click"],["style","padding: 3px 0 3px 0;",4,"ngIf"],[1,"thumbnail",3,"click"],["alt","Image",1,"",3,"src","error"],[1,"fas","fa-check",2,"color","#007276","float","right","vertical-align","middle","line-height","20px"],["title","Unpublishes the layer from the public mosaic. This layer will no longer be publicly accessible from Geoserver.",1,"fa","fa-arrow-alt-circle-down",3,"click"],["title","Publish the product to the publish mosaic. The aerial and hillshade services will be publicly accessible.",1,"fa","fa-arrow-alt-circle-up",3,"click"]],template:function(e,t){1&e&&(c.lc(0),c.nc(1,"div",0),c.nc(2,"div",1),c.nc(3,"div",2),c.nc(4,"label"),c.nc(5,"label"),c.bd(6,"Order available products"),c.mc(),c.mc(),c.nc(7,"select",3),c.vc("ngModelChange",(function(e){return t.sortField=e}))("change",(function(){return t.refresh()})),c.ic(8,"option"),c.Zc(9,Dt,2,2,"option",4),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(10,"div",5),c.Zc(11,jt,4,3,"div",6),c.Zc(12,Vt,30,15,"div",7),c.mc(),c.kc()),2&e&&(c.Ub(7),c.Ec("ngModel",t.sortField),c.Ub(2),c.Ec("ngForOf",t.fields),c.Ub(2),c.Ec("ngIf",t.products.length<1),c.Ub(1),c.Ec("ngForOf",t.products))},directives:[a.w,a.k,a.n,a.p,a.y,i.s,i.t],pipes:[L.a],encapsulation:2,data:{animation:[Object(Y.c)(),Object(Y.d)(),Object(Y.a)(),Object(Y.b)()]}});class on{constructor(e,t){this.service=e,this.bsModalRef=t,this.userName="",this.admin=!1,this.newInstance=!1,this.message=null,this.center=null,this.zoom=null}ngOnInit(){this.onNodeChange=new G.b}init(e,t,n,c,i,o,a){this.newInstance=e,this.userName=t,this.admin=n,this.entity=c,this.attributes=i,this.center=o,this.zoom=a}handleOnSubmit(){this.message=null,"Site"!==this.entity.type||null!=this.entity.geometry?this.newInstance?this.service.applyWithParent(this.entity,this.parentId).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{this.error(e)}):this.service.update(this.entity).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{console.log(e),this.error(e)}):this.message="Sites require a location"}evaluate(e){return(!this.newInstance||!e.readonly)&&(null==e.condition||this.service.evaluate(e.condition,this.entity))}error(e){this.message=S.b.getMessageFromError(e)}}function an(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",5),c.nc(5,"div"),c.nc(6,"p",6),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function sn(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function ln(e,t){if(1&e){const e=c.oc();c.nc(0,"tr"),c.nc(1,"td",25),c.nc(2,"a",26),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(3).handleDownloadFile(n)})),c.mc(),c.nc(3,"a",27),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(3).handleDelete(n)})),c.mc(),c.mc(),c.nc(4,"td"),c.bd(5),c.mc(),c.nc(6,"td"),c.bd(7),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(5),c.cd(e.name),c.Ub(2),c.cd(e.lastModified)}}function rn(e,t){1&e&&(c.bd(0," Drag & Drop File "),c.nc(1,"button",28),c.vc("click",(function(){return(0,t.openFileSelector)()})),c.bd(2,"Browse Files"),c.mc())}on.ɵfac=function(e){return new(e||on)(c.hc(Z),c.hc(j.a))},on.ɵcmp=c.bc({type:on,selectors:[["entity-modal"]],decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],["class","modal-title-container",4,"ngIf"],["ngForm","ngForm"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[1,"btn-holder",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"modal-title-container"],[1,"form-group"],[4,"ngIf"],["type","input",1,"form-control",3,"ngModel","name","disabled","placeholder","required","ngModelChange"],["type","input",3,"ngModel","name","disabled","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],[3,"site","center","zoom","siteChange"],["name","collection-privilege","type","input",2,"padding","6px 10px","font-size","14px",3,"ngModel","required","disabled","ngModelChange"],["value","OWNER"],["value","AGENCY"],["value","PUBLIC"]],template:function(e,t){1&e&&c.Zc(0,cn,12,5,"div",0),2&e&&c.Ec("ngIf",null!=t.entity)},directives:[i.t,a.z,a.l,a.m,i.s,a.c,a.k,a.n,a.v,a.w,a.p,a.y,I],encapsulation:2});const dn=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function pn(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",17),c.vc("selectTab",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).onSelect(n)})),c.nc(1,"div",18),c.nc(2,"div",19),c.nc(3,"table",20),c.nc(4,"thead"),c.nc(5,"tr"),c.ic(6,"th",21),c.nc(7,"th",21),c.bd(8,"Name"),c.mc(),c.nc(9,"th",21),c.bd(10,"Date uploaded"),c.mc(),c.mc(),c.mc(),c.nc(11,"tbody",22),c.Zc(12,ln,8,2,"tr",10),c.yc(13,"paginate"),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",19),c.nc(16,"ngx-file-drop",23),c.vc("onFileDrop",(function(t){return c.Rc(e),c.xc(2).dropped(t)})),c.Zc(17,rn,3,0,"ng-template",24),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ec("heading",e.name),c.Ub(12),c.Ec("ngForOf",c.Ac(13,2,n.page.results,c.Kc(5,dn,n.page.pageSize,n.page.pageNumber,n.page.count)))}}function mn(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h2"),c.bd(4),c.mc(),c.mc(),c.mc(),c.nc(5,"div",7),c.nc(6,"div",8),c.nc(7,"ul",9),c.Zc(8,sn,3,1,"li",10),c.mc(),c.mc(),c.mc(),c.nc(9,"div",7),c.nc(10,"tabset",11),c.Zc(11,pn,18,9,"tab",12),c.mc(),c.mc(),c.nc(12,"div",7),c.nc(13,"pagination-controls",13),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",14),c.nc(16,"button",15),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(17,"Close"),c.mc(),c.nc(18,"button",16),c.vc("click",(function(){return c.Rc(e),c.xc().handleDownload()})),c.bd(19,"Download all"),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.cd(e.entity.name),c.Ub(4),c.Ec("ngForOf",e.previous),c.Ub(3),c.Ec("ngForOf",e.folders)}}class hn{constructor(e,t,n){this.service=e,this.modalService=t,this.bsModalRef=n,this.previous=[],this.folders=[],this.page=new V}ngOnInit(){this.page.count=0,this.page.pageNumber=1,this.page.pageSize=10,this.page.results=[]}init(e,t,n){this.entity=e,this.folders=t,this.previous=[...n],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.folders.length>0&&this.onSelect(this.folders[0])}onPageChange(e){this.getData(this.folder.component,this.folder.name,e,this.page.pageSize)}onSelect(e){this.page.results=[],this.folder=e,this.getData(e.component,e.name,1,this.page.pageSize)}refresh(){this.page.results=[],this.getData(this.folder.component,this.folder.name,this.page.pageNumber,this.page.pageSize)}getData(e,t,n,c){this.service.getObjects(e,t,n,c).then(e=>{this.page=e})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.folder.component+"&key="+this.folder.name}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.folder.component+"&key="+e.key}dropped(e){for(const t of e)if(t.fileEntry.isFile){t.fileEntry.file(e=>{this.service.upload(this.folder.component,this.folder.name,e).then(()=>{this.refresh()})})}else{const e=t.fileEntry;console.log(t.relativePath,e)}}handleDelete(e){let t=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.message="Are you sure you want to delete the file ["+e.name+"]?",t.content.type="DANGER",t.content.submitText="Delete",t.content.onConfirm.subscribe(()=>{this.remove(e)})}remove(e){this.service.removeObject(e.component,e.key).then(()=>{this.refresh()})}error(e){this.message=S.b.getMessageFromError(e)}}hn.ɵfac=function(e){return new(e||hn)(c.hc(Z),c.hc(j.b),c.hc(j.a))},hn.ɵcmp=c.bc({type:hn,selectors:[["accessible-support-modal"]],decls:4,vars:2,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"nav-full-width"],[3,"heading","selectTab",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 10px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"click"],[3,"heading","selectTab"],[1,"row","image-list-container"],[1,"col-sm-12"],[1,"table","table-striped"],["scope","col"],[1,"upload-name-style"],["dropZoneLabel","Drop files here",3,"onFileDrop"],["ngx-file-drop-content-tmp",""],[1,"button-column"],["title","Download",1,"fa","fa-download",3,"click"],["title","Remove",1,"fa","fa-trash-alt","ico-remove",2,"margin-left","5px",3,"click"],["type","button",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div"),c.Zc(2,an,8,1,"div",1),c.Zc(3,mn,20,3,"div",2),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",null!=t.entity))},directives:[i.t,i.s,p.e,h.c,p.b,s.a,s.c],pipes:[h.b],encapsulation:2});var un=n(55);class gn{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/uav/page",{params:t}).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/uav/apply",JSON.stringify({uav:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}search(e,t){let n=new y.g;return n=n.set("text",e),n=n.set("field",t),this.http.get(acp+"/uav/search",{params:n}).toPromise()}getMetadataOptions(e){let t=new y.g;return t=t.set("oid",e),this.http.get(acp+"/uav/get-metadata-options",{params:t}).toPromise()}}function bn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",16),c.nc(1,"div",2),c.nc(2,"div",3),c.nc(3,"div",4),c.bd(4,"Point Of Contact"),c.mc(),c.nc(5,"div",5),c.nc(6,"div",6),c.nc(7,"label",17),c.bd(8,"Name"),c.mc(),c.nc(9,"input",18),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.pointOfContact.name=t}))("change",(function(){return c.Rc(e),c.xc().handlePageChange()})),c.mc(),c.mc(),c.nc(10,"div",6),c.nc(11,"label",19),c.bd(12,"Email"),c.mc(),c.nc(13,"input",20),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.pointOfContact.email=t}))("change",(function(){return c.Rc(e),c.xc().handlePageChange()})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngModel",e.page.selection.pointOfContact.name)("maxlength",100)("required",!1)("disabled",!1),c.Ub(4),c.Ec("ngModel",e.page.selection.pointOfContact.email)("maxlength",255)("required",!1)("disabled",!1)}}function fn(e,t){if(1&e&&(c.lc(0),c.nc(1,"div",6),c.nc(2,"label",21),c.bd(3,"Name"),c.mc(),c.bd(4),c.mc(),c.nc(5,"div",6),c.nc(6,"label",21),c.bd(7,"Type"),c.mc(),c.bd(8),c.mc(),c.nc(9,"div",6),c.nc(10,"label",21),c.bd(11,"Serial Number"),c.mc(),c.bd(12),c.mc(),c.nc(13,"div",6),c.nc(14,"label",21),c.bd(15,"FAA Id Number"),c.mc(),c.bd(16),c.mc(),c.nc(17,"div",6),c.nc(18,"label",21),c.bd(19,"Bureau"),c.mc(),c.bd(20),c.mc(),c.kc()),2&e){const e=c.xc();c.Ub(4),c.dd(" ",e.uav.platform," "),c.Ub(4),c.dd(" ",e.uav.platformType," "),c.Ub(4),c.dd(" ",e.uav.serialNumber," "),c.Ub(4),c.dd(" ",e.uav.faaNumber," "),c.Ub(4),c.dd(" ",e.uav.bureau," ")}}function vn(e,t){if(1&e&&(c.nc(0,"option",25),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.dd("",e.name," ")}}function yn(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," ")}}function kn(e,t){if(1&e&&(c.lc(0),c.nc(1,"div",6),c.nc(2,"label",21),c.bd(3,"Type"),c.mc(),c.bd(4),c.mc(),c.nc(5,"div",6),c.nc(6,"label",26),c.bd(7,"Wave Length"),c.mc(),c.nc(8,"ul"),c.Zc(9,yn,2,1,"li",27),c.mc(),c.mc(),c.nc(10,"div",6),c.nc(11,"label",28),c.bd(12,"Sensor Width"),c.mc(),c.bd(13),c.mc(),c.nc(14,"div",6),c.nc(15,"label",28),c.bd(16,"Sensor Width Units"),c.mc(),c.bd(17," Millimeters "),c.mc(),c.nc(18,"div",6),c.nc(19,"label",29),c.bd(20,"Sensor Height"),c.mc(),c.bd(21),c.mc(),c.nc(22,"div",6),c.nc(23,"label",28),c.bd(24,"Sensor Height Units"),c.mc(),c.bd(25," Millimeters "),c.mc(),c.nc(26,"div",6),c.nc(27,"label",30),c.bd(28,"Pixel Size Width"),c.mc(),c.bd(29),c.mc(),c.nc(30,"div",6),c.nc(31,"label",31),c.bd(32,"Pixel Size Height"),c.mc(),c.bd(33),c.mc(),c.kc()),2&e){const e=c.xc(2);c.Ub(4),c.dd(" ",e.metaObject.sensor.sensorType," "),c.Ub(5),c.Ec("ngForOf",e.metaObject.sensor.wavelengths),c.Ub(4),c.dd(" ",e.metaObject.sensor.sensorWidth," "),c.Ub(8),c.dd(" ",e.metaObject.sensor.sensorHeight," "),c.Ub(8),c.dd(" ",e.metaObject.sensor.pixelSizeWidth," "),c.Ub(4),c.dd(" ",e.metaObject.sensor.pixelSizeHeight," ")}}function xn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",1),c.nc(1,"div",2),c.nc(2,"div",3),c.nc(3,"div",4),c.bd(4,"Sensor"),c.mc(),c.nc(5,"div",5),c.nc(6,"div",6),c.nc(7,"label",22),c.bd(8,"Name"),c.mc(),c.nc(9,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.sensor=t}))("change",(function(){return c.Rc(e),c.xc().onSensorChange()})),c.ic(10,"option"),c.Zc(11,vn,2,2,"option",24),c.mc(),c.mc(),c.Zc(12,kn,34,6,"ng-container",14),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngModel",e.page.selection.sensor),c.Ub(2),c.Ec("ngForOf",e.uav.sensors),c.Ub(1),c.Ec("ngIf",null!=e.metaObject)}}gn.ɵfac=function(e){return new(e||gn)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},gn.ɵprov=c.dc({token:gn,factory:gn.ɵfac});const En=function(){return{standalone:!0}};class Cn{constructor(e,t){this.service=e,this.uavService=t,this.pageChange=new c.t,this.search="",this.field="serialNumber",this.uav=null,this.metaObject=null,this.dataSource=new v.a(e=>{this.uavService.search(this.search,this.field).then(t=>{e.next(t)})})}ngOnInit(){null==this.page.selection.pointOfContact&&this.service.getMetadataOptions(null).then(e=>{this.page.selection.pointOfContact={name:e.name,email:e.email}}),null!=this.page.selection.uav&&this.getUavInformation(this.page.selection.uav,!1),null!=this.page.selection.sensor&&this.onSensorChange()}handlePageChange(){this.pageChange.emit(this.page)}onSensorChange(){this.metaObject=null,this.service.getUAVMetadata(this.page.selection.uav,this.page.selection.sensor).then(e=>{this.metaObject={uav:e.uav,sensor:e.sensor}}).catch(e=>{}),this.handlePageChange()}handleUavClick(e){this.getUavInformation(e.item.oid,!0),this.pageChange.emit(this.page)}getUavInformation(e,t){this.uav=null,this.metaObject=null,t&&(this.page.selection.uav=null,this.page.selection.sensor=null),null!=e&&(this.page.selection.uav=e,this.uavService.getMetadataOptions(e).then(e=>{this.uav=e,t||(this.search=this.uav.serialNumber)}))}}function wn(e,t){if(1&e&&(c.nc(0,"div",11),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",14),c.nc(4,"strong",15),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",16),c.nc(7,"div"),c.nc(8,"p",17),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",12),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function Un(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.dd(" ",e,"")}}function Mn(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"ul",18),c.Zc(4,Un,3,2,"li",19),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",e.labels)}}function In(e,t){if(1&e&&(c.nc(0,"option",26),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function On(e,t){if(1&e){const e=c.oc();c.nc(0,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(3).setIsNew(!0)})),c.bd(1," Add "),c.mc()}}function Sn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",4),c.nc(1,"div",13),c.nc(2,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).page.selection.value=t})),c.ic(3,"option"),c.Zc(4,In,2,2,"option",24),c.mc(),c.mc(),c.nc(5,"div",12),c.Zc(6,On,2,0,"button",25),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(2),c.Ec("name",e.page.selection.type)("ngModel",e.page.selection.value)("disabled",e.page.selection.isNew),c.Ub(2),c.Ec("ngForOf",e.page.options),c.Ub(2),c.Ec("ngIf",!e.page.selection.isNew)}}function Tn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(3).setIsNew(!1)})),c.bd(1," Cancel "),c.mc()}}function Rn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",4),c.nc(1,"div",13),c.nc(2,"label",30),c.bd(3,"Collection Date:"),c.mc(),c.nc(4,"input",31),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(3).page.selection.collectionDate=t})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("ngModel",e.page.selection.collectionDate)}}function Pn(e,t){if(1&e){const e=c.oc();c.nc(0,"metadata-page",32),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(3).page=t})),c.mc()}if(2&e){const e=c.xc(3);c.Ec("page",e.page)}}function Fn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",20),c.nc(1,"div",4),c.nc(2,"div",13),c.nc(3,"input",28),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).page.selection.label=t})),c.mc(),c.mc(),c.nc(4,"div",12),c.Zc(5,Tn,2,0,"button",25),c.mc(),c.mc(),c.Zc(6,Rn,5,2,"div",2),c.Zc(7,Pn,1,1,"metadata-page",29),c.mc()}if(2&e){const e=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngModel",e.page.selection.label)("placeholder",e.page.selection.type+" name..."),c.Ub(2),c.Ec("ngIf",!e.hasField("collectionDate")),c.Ub(1),c.Ec("ngIf",e.hasField("collectionDate")),c.Ub(1),c.Ec("ngIf",e.hasField("uav"))}}function Nn(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",20),c.nc(4,"label",21),c.bd(5),c.mc(),c.Zc(6,Sn,7,5,"div",2),c.mc(),c.Zc(7,Fn,8,6,"div",22),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("for",e.page.selection.type),c.Ub(1),c.dd("",e.page.selection.type,":"),c.Ub(1),c.Ec("ngIf",!e.page.selection.isNew),c.Ub(1),c.Ec("ngIf",e.page.selection.isNew)}}function Dn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",20),c.nc(1,"label",21),c.bd(2),c.mc(),c.nc(3,"input",34),c.vc("ngModelChange",(function(n){return c.Rc(e),t.$implicit.label=n})),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("for",e.type),c.Ub(1),c.dd("",e.type,":"),c.Ub(1),c.Ec("ngModel",e.label)("name",e.type)}}function An(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.Zc(3,Dn,4,4,"div",33),c.mc(),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngForOf",e.selections)}}function Zn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",35),c.vc("click",(function(){return c.Rc(e),c.xc().handleBackPage()})),c.ic(1,"i",36),c.bd(2," Back "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",e.disabled)}}function jn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc().handleNextPage()})),c.ic(1,"i",36),c.bd(2," Next "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}function Ln(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc().handleCreate()})),c.ic(1,"i",36),c.bd(2," Create "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}Cn.ɵfac=function(e){return new(e||Cn)(c.hc(Z),c.hc(gn))},Cn.ɵcmp=c.bc({type:Cn,selectors:[["metadata-page"]],inputs:{page:"page"},outputs:{pageChange:"pageChange"},decls:23,vars:14,consts:[["class","row","style","margin-top: 20px;",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"form-group"],["for","platform.name"],["id","serialNumber","type","radio","value","serialNumber","name","field",2,"height","auto",3,"checked","ngModel","ngModelChange"],["for","serialNumber",2,"margin-left","5px"],[2,"margin-left","15px"],["id","faaNumber","type","radio","value","faaNumber","name","field",2,"height","auto",3,"checked","ngModel","ngModelChange"],["for","faaNumber",2,"margin-left","5px"],["type","text","placeholder","Search...","required","",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadOptionField","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"row",2,"margin-top","20px"],["for","pointOfContact.name"],["type","text","name","pointOfContact.name",3,"ngModel","maxlength","required","disabled","ngModelChange","change"],["for","pointOfContact.email"],["type","text","name","pointOfContact.email",3,"ngModel","maxlength","required","disabled","ngModelChange","change"],["for","sensor.type"],["for","sensor.name"],["name","sensor","required","",1,"form-control",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","sensor.wavelength"],[4,"ngFor","ngForOf"],["for","sensor.sensorWidth"],["for","sensor.sensorHeight"],["for","sensor.pixelSizeWidth"],["for","sensor.pixelSizeHeight"]],template:function(e,t){1&e&&(c.lc(0),c.Zc(1,bn,14,8,"div",0),c.nc(2,"div",1),c.nc(3,"div",2),c.nc(4,"div",3),c.nc(5,"div",4),c.bd(6,"Platform"),c.mc(),c.nc(7,"div",5),c.nc(8,"div",6),c.nc(9,"label",7),c.bd(10,"UAV"),c.mc(),c.nc(11,"div"),c.nc(12,"span"),c.nc(13,"input",8),c.vc("ngModelChange",(function(e){return t.field=e})),c.mc(),c.nc(14,"label",9),c.bd(15,"Serial Number"),c.mc(),c.mc(),c.nc(16,"span",10),c.nc(17,"input",11),c.vc("ngModelChange",(function(e){return t.field=e})),c.mc(),c.nc(18,"label",12),c.bd(19,"FAA Number"),c.mc(),c.mc(),c.mc(),c.nc(20,"input",13),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleUavClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.Zc(21,fn,21,5,"ng-container",14),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(22,xn,13,3,"div",15),c.kc()),2&e&&(c.Ub(1),c.Ec("ngIf",null!=t.page.selection.pointOfContact),c.Ub(12),c.Ec("checked","serialNumber"===t.field)("ngModel",t.field),c.Ub(4),c.Ec("checked","faaNumber"===t.field)("ngModel",t.field),c.Ub(3),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadOptionField",t.field)("ngModelOptions",c.Hc(13,En)),c.Ub(1),c.Ec("ngIf",null!=t.uav),c.Ub(1),c.Ec("ngIf",null!=t.uav))},directives:[i.t,a.s,a.c,a.k,a.n,a.v,r.b,a.f,a.w,a.p,a.y,i.s],encapsulation:2});class _n{constructor(e,t,n,c){this.service=e,this.modalService=t,this.metadataService=n,this.bsModalRef=c,this.message="",this.disabled=!1,this.hierarchy=[],this.selections=[],this.labels=[],this.pages=[{index:0,selection:null,options:[],type:"FILE"}],this.hierarchyChange=!1,this.page=this.pages[0],this.sensors=[],this.platforms=[],this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]}}ngAfterViewInit(){}ngOnInit(){this.onCreateComplete=new G.b,this.onHierarchyChange=new G.b}ngOnDestroy(){this.onCreateComplete.unsubscribe(),this.onHierarchyChange.unsubscribe()}init(e){this.hierarchy=this.metadataService.getHierarchy(),this.selections=[],this.pages=[];for(let t=0;t<this.hierarchy.length;t++){const n=this.hierarchy[t],c=e.findIndex(e=>e.type===n);if(-1!==c){const i=e[c];this.selections.push({type:n,isNew:t===this.hierarchy.length-1,value:i.id,label:i.name})}else this.selections.push({type:n,isNew:t===this.hierarchy.length-1,value:null,label:""});t>0&&this.pages.push({index:this.pages.length,selection:this.selections[t],options:[],type:"CATEGORY"})}this.labels.push(this.selections[0].label),this.pages.push({index:this.pages.length,selection:null,options:[],type:"SUMMARY"}),this.page=this.pages[0],this.service.getChildren(this.selections[0].value).then(e=>{this.pages[0].options=e.filter(e=>e.type===this.pages[0].selection.type)}).catch(e=>{this.error(e)})}close(){this.hierarchyChange&&this.onHierarchyChange.next(!0),this.bsModalRef.hide()}isPageValid(e){return"CATEGORY"!==e.type||null==e.selection||(null!=e.selection.value&&e.selection.value.length>0||null!=e.selection.label&&e.selection.label.length>0&&((!this.hasField("uav")||null!=e.selection.uav&&0!==e.selection.uav.length)&&((!this.hasField("sensor")||null!=e.selection.sensor&&0!==e.selection.sensor.length)&&(!this.hasField("collectionDate")||null!=e.selection.collectionDate&&0!==e.selection.collectionDate.length))))}updateCurrentPageLabel(){this.page.options.forEach(e=>{e.id===this.page.selection.value&&(this.page.selection.label=e.name)})}setIsNew(e){this.page.selection.isNew=e,e?this.page.selection.value=null:this.page.selection.label=null}handleCreate(){this.service.createCollection(this.selections).then(e=>{this.onCreateComplete.next(e.oid),this.bsModalRef.hide()}).catch(e=>{this.error(e)})}handleNextPage(){if(this.page.index+1<this.pages.length){const e=this.pages[this.page.index+1];"CATEGORY"===this.page.type&&(this.updateCurrentPageLabel(),this.labels.push(this.page.selection.label)),"CATEGORY"===e.type?"FILE"===this.page.type?this.page=e:!this.page.selection.isNew&&null!=this.page.selection.value&&this.page.selection.value.length>0?this.service.getChildren(this.page.selection.value).then(t=>{e.options=t.filter(t=>t.type===e.selection.type),this.page=e}).catch(e=>{this.error(e)}):this.page=e:(this.page=e,this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!1},{label:"Final",active:!0,enabled:!1}]})}}handleBackPage(){if(this.page.index>0){const e=this.pages[this.page.index-1];"CATEGORY"===e.type&&(this.labels.splice(this.labels.length-1,1),this.modalStepConfig.steps.forEach(e=>{"category"===e.label.toLowerCase()&&!1===e.enabled&&(this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]})})),this.page=e}}hasField(e){return this.metadataService.hasExtraField(this.page.selection.type,e)}error(e){this.message=S.b.getMessageFromError(e)}}_n.ɵfac=function(e){return new(e||_n)(c.hc(Z),c.hc(j.b),c.hc(te),c.hc(j.a))},_n.ɵcmp=c.bc({type:_n,selectors:[["create-collection-modal"]],decls:16,vars:9,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"row","error-container"],[1,"col-md-2"],[1,"col-md-8"],[1,"label-holder"],[2,"color","#8c0000"],[1,"holder"],[1,"error-message"],[1,"breadcrumb"],[4,"ngFor","ngForOf"],[1,"form-group"],[3,"for"],["class","form-group",4,"ngIf"],["required","",3,"name","ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button btn btn-primary","class","btn btn-primary",3,"click",4,"ngIf"],[3,"value"],["type","button btn btn-primary",1,"btn","btn-primary",3,"click"],["autofocus","","name","label","type","input","required","",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[3,"page","pageChange",4,"ngIf"],["for","platform",2,"margin-top","10px"],["name","collectionDate","type","date","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"page","pageChange"],["class","form-group",4,"ngFor","ngForOf"],["type","input","disabled","","required","",1,"form-control",3,"ngModel","name","ngModelChange"],["type","button btn btn-primary",1,"btn","btn-secondary",3,"disabled","click"],[1,"icon-upload","icon-white"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,wn,11,1,"div",1),c.Zc(3,Mn,5,1,"div",2),c.Zc(4,Nn,8,4,"div",2),c.Zc(5,An,4,2,"div",2),c.mc(),c.nc(6,"div",3),c.nc(7,"div",4),c.nc(8,"div",5),c.nc(9,"div",6),c.nc(10,"button",7),c.vc("click",(function(){return t.close()})),c.nc(11,"span",8),c.bd(12,"Close"),c.mc(),c.mc(),c.Zc(13,Zn,3,1,"button",9),c.Zc(14,jn,3,1,"button",10),c.Zc(15,Ln,3,1,"button",10),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",t.labels.length>0),c.Ub(1),c.Ec("ngIf","CATEGORY"===t.page.type),c.Ub(1),c.Ec("ngIf","SUMMARY"===t.page.type),c.Ub(5),c.Ec("disabled",t.disabled)("disabled",t.disabled),c.Ub(3),c.Ec("ngIf",t.page.index>0),c.Ub(1),c.Ec("ngIf",t.page.index<t.pages.length-1),c.Ub(1),c.Ec("ngIf",t.page.index===t.pages.length-1))},directives:[i.t,i.s,a.w,a.v,a.k,a.n,a.p,a.y,a.c,Cn],styles:[".list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tdisplay: inline-block;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tmargin-bottom: 0;\n\tmargin-left: -4px;\n\tmargin-right: 0;\n\tborder-right-width: 0;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child {\n\tborder-top-right-radius: 0;\n\tborder-bottom-left-radius: 4px;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child {\n\tborder-top-right-radius: 4px;\n\tborder-bottom-left-radius: 0;\n\tborder-right-width: 1px;\n}\n\n.list-group-item-success[_ngcontent-%COMP%] {\n\tcolor: #155724;\n\tbackground-color: #c3e6cb;\n}"],data:{animation:[Object(Y.c)(),Object(Y.d)()]}});var $n=n(320),zn=n(65),Bn=n(59);const Gn=["staticTabs"],Vn=["confirmTemplate"];function qn(e,t){if(1&e&&(c.nc(0,"option",36),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.dd(" ",e.label," ")}}function Hn(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",3),c.nc(2,"div",31),c.nc(3,"h3",32),c.bd(4,"IDM Sites"),c.mc(),c.mc(),c.mc(),c.nc(5,"div",3),c.nc(6,"div",33),c.nc(7,"label"),c.bd(8,"Bureau"),c.mc(),c.nc(9,"select",34),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().filter.value=t}))("change",(function(){return c.Rc(e),c.xc().refreshSites()})),c.ic(10,"option"),c.Zc(11,qn,2,2,"option",35),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngModel",e.filter.value),c.Ub(2),c.Ec("ngForOf",e.bureaus)}}function Jn(e,t){if(1&e){const e=c.oc();c.nc(0,"a",40),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).back(t)})),c.bd(1),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ub(1),c.dd(" ",e.name,"")}}function Wn(e,t){if(1&e&&(c.nc(0,"span"),c.nc(1,"b"),c.bd(2),c.mc(),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(2),c.cd(e.name)}}const Yn=function(e){return{active:e}};function Xn(e,t){if(1&e&&(c.nc(0,"li",42),c.Zc(1,Jn,2,1,"a",43),c.Zc(2,Wn,3,1,"span",6),c.mc()),2&e){const e=t.last;c.Ec("ngClass",c.Ic(3,Yn,e)),c.Ub(1),c.Ec("ngIf",!e),c.Ub(1),c.Ec("ngIf",e)}}function Kn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",3),c.nc(1,"div",37),c.nc(2,"ul",38),c.nc(3,"li"),c.ic(4,"i",39),c.nc(5,"a",40),c.vc("click",(function(){return c.Rc(e),c.xc().back(null)})),c.bd(6,"IDM Sites"),c.mc(),c.mc(),c.Zc(7,Xn,3,5,"li",41),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(7),c.Ec("ngForOf",e.breadcrumbs)}}function Qn(e,t){1&e&&(c.nc(0,"span"),c.nc(1,"h4"),c.ic(2,"i",45),c.bd(3," Loading Sites "),c.mc(),c.mc())}function ec(e,t){1&e&&(c.nc(0,"span"),c.nc(1,"h4"),c.bd(2,"No Sites in this area."),c.mc(),c.nc(3,"p"),c.bd(4," Zoom out to find sites in other areas of the map. "),c.mc(),c.mc())}function tc(e,t){if(1&e&&(c.nc(0,"div",44),c.Zc(1,Qn,4,0,"span",6),c.Zc(2,ec,5,0,"span",6),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(1),c.Ec("ngIf",e.loadingSites),c.Ub(1),c.Ec("ngIf",!e.loadingSites)}}function nc(e,t){1&e&&(c.nc(0,"div",44),c.nc(1,"h4"),c.bd(2,"No data at this level."),c.mc(),c.nc(3,"p"),c.bd(4," Create data containers as part of the upload process. "),c.mc(),c.mc()),2&e&&c.Ec("@fadeInOnEnter",void 0)}function cc(e,t){if(1&e){const e=c.oc();c.nc(0,"span",53),c.nc(1,"a",54),c.vc("click",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc().handleEdit(n,t)})),c.mc(),c.nc(2,"a",55),c.vc("click",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc().handleDelete(n,t)})),c.mc(),c.mc()}}function ic(e,t){if(1&e){const e=c.oc();c.nc(0,"div",49),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().select(n,null,t)}))("mouseenter",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().onListEntityHover(t,n)}))("mouseleave",(function(){return c.Rc(e),c.xc(2).onListEntityHoverOff()})),c.nc(1,"div",50),c.nc(2,"div"),c.nc(3,"h4",51),c.bd(4),c.mc(),c.nc(5,"span"),c.nc(6,"span"),c.nc(7,"b"),c.bd(8),c.mc(),c.bd(9),c.mc(),c.Zc(10,cc,3,0,"span",52),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("@fadeInOnEnter",void 0)("ngClass",c.Ic(6,Yn,t.hoverFeatureId===e.id)),c.Ub(4),c.dd(" ",e.name," "),c.Ub(4),c.cd(e.numberOfChildren),c.Ub(1),c.dd(" ",t.getMetadata(e).childLabel,""),c.Ub(1),c.Ec("ngIf","folder"!==e.type)}}function oc(e,t){if(1&e){const e=c.oc();c.nc(0,"span",64),c.nc(1,"a",54),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(3).handleEdit(n,t)})),c.mc(),c.nc(2,"a",55),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(3).handleDelete(n,t)})),c.mc(),c.mc()}}function ac(e,t){if(1&e){const e=c.oc();c.nc(0,"div",62),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit,o=c.xc(2).$implicit;return c.xc().select(i,o,n)})),c.bd(1),c.Zc(2,oc,3,0,"span",63),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," "),c.Ub(1),c.Ec("ngIf","folder"!==e.type)}}const sc=function(e){return{"fa-rotate-270":e}};function lc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",56),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().select(n,null,t)})),c.nc(1,"div",57),c.nc(2,"i",58),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().handleExpand(n,t)})),c.mc(),c.nc(3,"h4",59),c.bd(4),c.mc(),c.nc(5,"p"),c.nc(6,"b"),c.bd(7),c.mc(),c.bd(8),c.mc(),c.nc(9,"div",60),c.Zc(10,ac,3,2,"div",61),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngClass",c.Ic(7,sc,e.active)),c.Ub(2),c.cd(e.name),c.Ub(3),c.cd(e.numberOfChildren),c.Ub(1),c.dd(" ",t.getMetadata(e).childLabel,""),c.Ub(1),c.Ec("collapse",!e.active),c.Ub(1),c.Ec("ngForOf",e.children)}}function rc(e,t){if(1&e&&(c.nc(0,"div",46),c.Zc(1,ic,11,8,"div",47),c.Zc(2,lc,11,9,"div",48),c.mc()),2&e){const e=t.$implicit,n=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(1),c.Ec("ngIf",n.getMetadata(e).root),c.Ub(1),c.Ec("ngIf",!n.getMetadata(e).root)}}function dc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",46),c.nc(1,"div",65),c.nc(2,"div",57),c.nc(3,"h4",59),c.bd(4,"Supporting Data"),c.mc(),c.nc(5,"div",15),c.nc(6,"div",66),c.nc(7,"a",67),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().select(i,null,n)})),c.bd(8),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(7),c.dd(" ",e.name," ")}}function pc(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",68),c.nc(1,"div",69),c.nc(2,"product-panel",70),c.vc("toggleMapOrtho",(function(t){return c.Rc(e),c.xc().handleMapOrtho(t)}))("toggleMapDem",(function(t){return c.Rc(e),c.xc().handleMapDem(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("id",e.current.id)}}function mc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",71),c.nc(1,"div",72),c.nc(2,"button",73),c.vc("click",(function(){return c.Rc(e),c.xc().handleCreateCollection()})),c.bd(3,"Create Collection"),c.mc(),c.mc(),c.mc()}}function hc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",71),c.nc(1,"div",72),c.nc(2,"button",73),c.vc("click",(function(){return c.Rc(e),c.xc().handleCreate(null,null)})),c.bd(3,"Add new site"),c.mc(),c.mc(),c.mc()}}function uc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",74),c.nc(1,"strong"),c.bd(2,"Unfinished upload"),c.mc(),c.bd(3," detected on file "),c.nc(4,"strong"),c.bd(5),c.mc(),c.bd(6," for Collection "),c.nc(7,"strong"),c.bd(8),c.mc(),c.bd(9,". "),c.nc(10,"a",67),c.vc("click",(function(){return c.Rc(e),c.xc().handleExistingTask()})),c.bd(11,"Click to resolve"),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ec("dismissible",!1),c.Ub(5),c.cd(e.existingTask.filename),c.Ub(3),c.cd(e.existingTask.task.collectionLabel)}}function gc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",80),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",67),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleViewSite(t.collection)})),c.bd(5,"Goto the collection view"),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". ")}}function bc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",81),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",82),c.bd(5,"task page"),c.mc(),c.bd(6," for more details. "),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". Task completed with warnings. See the ")}}function fc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",83),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",82),c.bd(5,"task page"),c.mc(),c.bd(6," for more details. "),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". Task completed with errors. See the ")}}function vc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",84),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". ")}}function yc(e,t){if(1&e&&(c.nc(0,"div",75),c.Zc(1,gc,6,3,"alert",76),c.Zc(2,bc,7,3,"alert",77),c.Zc(3,fc,7,3,"alert",78),c.Zc(4,vc,4,3,"alert",79),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","Complete"===e.status&&0===e.actions.length),c.Ub(1),c.Ec("ngIf","Complete"===e.status&&0!==e.actions.length),c.Ub(1),c.Ec("ngIf","Failed"===e.status),c.Ub(1),c.Ec("ngIf","Failed"!==e.status&&"Complete"!==e.status)}}function kc(e,t){1&e&&c.ic(0,"i",85)}function xc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",87),c.nc(1,"input",88),c.vc("change",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleStyle(n)})),c.mc(),c.nc(2,"label",89),c.bd(3),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("value",e.id)("checked",e.selected),c.Ub(2),c.cd(e.label)}}function Ec(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,xc,4,3,"div",86),c.mc()),2&e){const e=c.xc();c.Ub(1),c.Ec("ngForOf",e.baseLayers)}}function Cc(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",91),c.mc())}function wc(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",92),c.mc())}function Uc(e,t){if(1&e&&(c.nc(0,"span"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.label," / ")}}function Mc(e,t){if(1&e&&(c.Zc(0,Cc,2,0,"span",6),c.Zc(1,wc,2,0,"span",6),c.nc(2,"span"),c.Zc(3,Uc,2,1,"span",90),c.mc(),c.nc(4,"b"),c.bd(5),c.mc()),2&e){const e=t.match;c.Ec("ngIf",null==e.item.filename),c.Ub(1),c.Ec("ngIf",null!=e.item.filename),c.Ub(2),c.Ec("ngForOf",e.item.hierarchy),c.Ub(2),c.cd(e.item.label)}}const Ic=function(){return{standalone:!0}};class Oc{constructor(e,t,n,c,i,o,a){this.service=e,this.authService=t,this.mapService=n,this.modalService=c,this.metadataService=i,this.route=o,this.cookieService=a,this.userName="",this.search="",this.nodes=[],this.supportingData=[],this.breadcrumbs=[],this.admin=!1,this.worker=!1,this.active=!1,this.loadingSites=!0,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.layers=[],this.baselayerIconHover=!1,this.tasks=[],this.existingTask=null,this.filter={field:"bureau",value:""},this.bureaus=[],this.bounds=null,this.sort="name",this.subject=new G.b,this.subject.pipe(Object(R.a)(300),Object(P.a)()).subscribe(e=>this.handleExtentChange(e)),this.dataSource=new v.a(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const n=t.features;this.service.searchEntites(this.search).then(t=>{n.forEach(e=>{let n={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};t.push(n)}),e.next(t)})})})}ngOnInit(){this.admin=this.authService.isAdmin(),this.worker=this.authService.isWorker(),this.userName=this.service.getCurrentUser(),this.service.bureaus().then(e=>{this.bureaus=e});let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{console.log(e),"UPLOAD_JOB_CHANGE"===e.type&&this.tasks.push(e.content)});const t=this.route.snapshot.params.oid,n=this.route.snapshot.params.action;null!=t&&null!=n&&"collection"===n&&this.handleViewSite(t);let c={debug:!1,autoUpload:!1,multiple:!1,request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,t){},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,t,n,c){},onComplete:function(e,t,n,c){},onCancel:function(e,t){},onError:function(e,t,n){}}};let i=new $n.FineUploaderBasic(c).getResumableFilesData();if(i.length>0){const e=i[0];this.service.getUploadTask(e.uuid).then(t=>{this.existingTask={task:t,filename:e.name},console.log(this.existingTask)})}}ngOnDestroy(){null!=this.subject&&this.subject.unsubscribe(),this.map.remove(),this.notifier.complete()}ngAfterViewInit(){this.map=new g.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v11",zoom:2,attributionControl:!1,center:[-78.880453,42.897852]}),this.map.on("load",()=>{this.initMap()})}initMap(){this.map.on("style.load",()=>{this.addLayers(),this.refreshMapPoints(!1)}),this.addLayers(),this.refreshMapPoints(!0),this.map.addControl(new g.NavigationControl),this.map.addControl(new g.AttributionControl({compact:!0}),"bottom-left"),this.map.on("mousemove",e=>{let t=e.lngLat.wrap(),n="Lat: "+t.lat+" Long: "+t.lng;document.getElementById("mousemove-panel").textContent=n;let c=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(null==this.current)if(c.length>0){let e=c[0].properties.oid;this.map.setFilter("hover-points",["all",["==","oid",e]]),this.highlightListItem(e)}else this.map.setFilter("hover-points",["all",["==","oid","NONE"]]),this.clearHighlightListItem()}),this.map.on("zoomend",e=>{this.subject.next(e)}),this.map.on("moveend",e=>{this.subject.next(e)}),this.map.on("dblclick",e=>{let t=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(t.length>0){let e=t[0].properties.oid;this.handleViewSite(e)}}),document.getElementById("navigator-left-sidebar").addEventListener("mouseenter",(function(){document.getElementById("mousemove-panel").textContent=""})),Boolean(this.cookieService.get("acceptedDisclaimer"))||(this.bsModalRef=this.modalService.show(un.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.messageTitle="Disclaimer",this.bsModalRef.content.message=window.uasAppDisclaimer,this.bsModalRef.content.submitText="I Accept",this.bsModalRef.content.onConfirm.subscribe(e=>{this.cookieService.set("acceptedDisclaimer","true")}))}addLayers(){this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"points",type:"circle",source:"sites",paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}}),this.map.addLayer({id:"hover-points",type:"circle",source:"sites",paint:{"circle-radius":13,"circle-color":"#cf0000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["==","id","NONE"]]}),this.map.addLayer({id:"points-label",source:"sites",type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":"{name}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}}),this.layers.forEach(e=>{e.isMapped&&this.addImageLayer(e)})}handleExtentChange(e){if(null==this.current){const e=this.map.getBounds();this.isValidBounds(e)&&(this.bounds=e,this.refreshSites())}}refreshSites(){const e=[];return null!=this.bounds&&e.push({field:"bounds",value:this.bounds}),null!=this.filter.value&&this.filter.value.length>0&&e.push(this.filter),this.refreshMapPoints(!1),this.loadingSites=!0,this.service.roots(null,e,this.sort).then(e=>{this.setNodes(e)}).finally(()=>{this.loadingSites=!1})}isValidBounds(e){const t=e.getNorthEast(),n=e.getSouthWest();return!(Math.abs(t.lng)>180||Math.abs(n.lng)>180)&&!(Math.abs(t.lat)>90||Math.abs(n.lat)>90)}refreshMapPoints(e){const t=[];null!=this.bounds&&t.push({field:"bounds",value:this.bounds}),null!=this.filter.value&&this.filter.value.length>0&&t.push(this.filter),this.mapService.features(t).then(t=>{this.map.getSource("sites").setData(t.features),e&&(this.allPointsBounds=new g.LngLatBounds([t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]),this.map.fitBounds(this.allPointsBounds,{padding:50}))})}isData(e){return"Site"!==e.data.type&&("Project"!==e.data.type&&("Mission"!==e.data.type&&("Collection"!==e.data.type&&"Imagery"!==e.data.type)))}handleOnUpdateData(){}handleCloseToast(e){this.tasks.splice(e,1)}handleCreateCollection(){this.bsModalRef=this.modalService.show(_n,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(this.breadcrumbs),this.bsModalRef.content.onCreateComplete.subscribe(e=>{this.handleViewSite(e)})}handleCreate(e,t){let n=null!=e?e.id:null;this.service.newChild(n,t).then(t=>{this.bsModalRef=this.modalService.show(on,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(!0,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),null!=e&&(this.bsModalRef.content.parentId=e.id),this.bsModalRef.content.onNodeChange.subscribe(t=>{null!=e||(0==this.breadcrumbs.length&&this.nodes.push(t),this.refreshMapPoints(!1))})})}zoomToFeature(e){null!=e.geometry&&this.map.flyTo({center:e.geometry.coordinates})}handleExistingTask(){this.service.view(this.existingTask.task.collection).then(e=>{const t=this.modalService.show(Ee,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"});t.content.init(e.item,this.existingTask.task.uploadTarget),t.content.onUploadCancel.subscribe(()=>{this.existingTask=null}),t.content.onUploadComplete.subscribe(()=>{this.existingTask=null})})}handleEdit(e,t){t.stopPropagation(),this.service.edit(e.id).then(t=>{this.bsModalRef=this.modalService.show(on,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"edit-modal"}),this.bsModalRef.content.init(!1,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),this.bsModalRef.content.onNodeChange.subscribe(t=>{t.children=e.children,t.active=e.active,this.refreshEntity(t,this.nodes),this.refreshEntity(t,this.breadcrumbs),this.nodes.forEach(e=>{this.refreshEntity(t,e.children)}),this.metadataService.getMetadata(t).root&&this.refreshMapPoints(!1)})})}refreshEntity(e,t){if(null!=t){let n=t.findIndex(t=>t.id===e.id);-1!==n&&(t[n]=e)}}handleDownloadAll(e){window.location.href=acp+"/project/download-all?id="+e.component+"&key="+e.name}handleDelete(e,t){t.stopPropagation();let n="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files in Collections and Accessible Support";"Collection"===e.type&&(n="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files."),n+=" This can <b>NOT</b> be undone",this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.subText=n,this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.service.remove(e.id).then(()=>{this.nodes=this.nodes.filter(t=>t.id!==e.id),this.nodes.forEach(t=>{null!=t.children&&(t.children=t.children.filter(t=>t.id!==e.id),t.numberOfChildren=t.children.length)}),"Site"===e.type&&this.refreshMapPoints(!1)})}handleDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleImageDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}highlightMapFeature(e){this.map.setFilter("hover-points",["all",["==","oid",e]])}clearHighlightMapFeature(){this.map.setFilter("hover-points",["all",["==","oid","NONE"]])}onListEntityHover(e,t){null==this.current&&this.highlightMapFeature(t.id)}onListEntityHoverOff(){this.clearHighlightMapFeature()}highlightListItem(e){this.nodes.forEach(t=>{t.id===e&&(this.hoverFeatureId=e)})}clearHighlightListItem(){this.hoverFeatureId&&this.nodes.forEach(e=>{e.id===this.hoverFeatureId&&(this.hoverFeatureId=null)})}handleClick(e){let t=e.item;if(t.center)this.map.flyTo({center:t.center,zoom:18});else{const e=t.hierarchy.length-1,n=t.hierarchy[e];this.handleViewSite(n.id)}}handleViewSite(e){this.service.view(e).then(e=>{const t=e.item,n=e.breadcrumbs;if(this.getMetadata(t).leaf)this.breadcrumbs=n,this.current=n[n.length-1],this.nodes=this.current.children,this.select(t,null,null);else{const e=n.length>0?n[n.length-1]:null;this.breadcrumbs=n,this.select(t,e,null)}})}handleMapOrtho(e){const t=this.getLayerByClassification("ORTHO",e);if(null!=t&&null!=t.key)if(null!=this.map.getLayer(t.key))this.map.removeLayer(t.key),this.map.removeSource(t.key),t.isMapped=!1,e.orthoMapped=!1;else if(this.addImageLayer(t),t.isMapped=!0,e.orthoMapped=!0,null!=e.boundingBox){let t=e.boundingBox,n=new g.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(n,{padding:50})}}getLayerByClassification(e,t){let n=t.layers.length;for(let c=0;c<n;++c){let n=t.layers[c];if(n.classification===e)return n}return null}handleMapDem(e){const t=this.getLayerByClassification("DEM_DSM",e);if(null!=t&&null!=t.key)if(null!=this.map.getLayer(t.key))this.map.removeLayer(t.key),this.map.removeSource(t.key),t.isMapped=!1,e.demMapped=!1;else if(this.addImageLayer(t),t.isMapped=!0,e.demMapped=!0,null!=e.boundingBox){let t=e.boundingBox,n=new g.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(n,{padding:50})}}addImageLayer(e){const t=encodeURI(e.workspace),n=encodeURI(e.workspace+":"+e.key);this.map.addLayer({id:e.key,type:"raster",source:{type:"raster",tiles:["/geoserver/"+t+"/wms?layers="+n+"&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&srs=EPSG:3857&transparent=true&width=256&height=256"],tileSize:256},paint:{}},"points")}handleGoto(){var e=new g.LngLatBounds([-111.12439336274211,39.32066259372583,-111.12342302258116,39.32107716199166]);this.map.fitBounds(e)}getMetadata(e){return this.metadataService.getMetadata(e)}select(e,t,n){if(null!=n&&n.stopPropagation(),null!=e&&null!=e.geometry&&"Point"===e.geometry.type&&this.map.easeTo({center:e.geometry.coordinates,zoom:8}),this.metadataService.getMetadata(e).leaf){const n=[...this.breadcrumbs];null!=t&&n.push(t),this.metadataService.getTypeContainsFolders(e)?this.service.getItems(e.id,null).then(t=>{this.showLeafModal(e,t,n)}):this.showLeafModal(this.current,[e],n)}else"object"===e.type||this.service.getItems(e.id,null).then(n=>{this.current=e,null!=t&&this.addBreadcrumb(t),this.addBreadcrumb(e),this.setNodes(n)})}addBreadcrumb(e){0!=this.breadcrumbs.length&&this.breadcrumbs[this.breadcrumbs.length-1].id===e.id||this.breadcrumbs.push(e)}handleExpand(e,t){null!=t&&t.stopPropagation(),null==e.children||0==e.children.length?this.service.getItems(e.id,null).then(t=>{e.children=t,this.expand(e)}):(e.children=[],e.active=!1)}handleGotoSite(e){const t=e.entities[e.entities.length-1],n=e.entities;this.service.getItems(t.id,null).then(e=>{this.showLeafModal(t,e,n)})}back(e){null!=e?(null!=e.geometry&&"Point"===e.geometry.type&&this.map.easeTo({center:e.geometry.coordinates,zoom:8}),this.service.getItems(e.id,null).then(t=>{var n=this.breadcrumbs.findIndex(t=>t.id===e.id);this.current=e,this.breadcrumbs.splice(n+1),this.setNodes(t)})):this.breadcrumbs.length>0&&this.refreshSites().then(()=>{this.breadcrumbs=[],this.staticTabs.tabs[0].active=!0,this.map.fitBounds(this.allPointsBounds,{padding:50});let e=this;window.setTimeout((function(){e.current=null}),500)})}expand(e){e.active=!0,this.current=e}setNodes(e){this.nodes=[],this.supportingData=[],e.forEach(e=>{"folder"===e.type?this.supportingData.push(e):this.nodes.push(e)})}showLeafModal(e,t,n){"Mission"===e.type?(this.bsModalRef=this.modalService.show(hn,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,n)):(this.bsModalRef=this.modalService.show(ut,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,n))}}Oc.ɵfac=function(e){return new(e||Oc)(c.hc(Z),c.hc(A.a),c.hc(x),c.hc(j.b),c.hc(te),c.hc(o.a),c.hc(zn.a))},Oc.ɵcmp=c.bc({type:Oc,selectors:[["projects"]],viewQuery:function(e,t){var n;(1&e&&(c.fd(Gn,!0),c.fd(Vn,!0)),2&e)&&(c.Oc(n=c.wc())&&(t.staticTabs=n.first),c.Oc(n=c.wc())&&(t.confirmTemplate=n.first))},decls:41,vars:23,consts:[["id","navigator-header-container"],[3,"title"],["id","app-container",1,"container-fluid",2,"background","#f7f7f7"],[1,"row"],["id","navigator-left-sidebar",1,"col-md-3","lw-inner-col"],[1,"col-md-12"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"location-management-widget-section"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[1,"col-md-12",2,"background","#f7f7f7","padding","0","height","100%"],[1,"nav-full-width"],["staticTabs",""],["heading","Data"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container"],[1,"list-group"],["style","padding: 20px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["heading","Products",4,"ngIf"],[1,"sidebar-footer"],["class","row","style","background:white;",4,"ngIf"],["id","site-explorer-map",1,"col-md-9"],[2,"position","absolute","z-index","5","margin-left","100px","margin-top","10px"],["type","danger",3,"dismissible",4,"ngIf"],["class","idm-toast",4,"ngFor","ngForOf"],[1,"base-layer-panel"],[1,"layer-toggle",2,"cursor","pointer","background","#fff","padding","8px","border-radius","4px",3,"mouseenter","mouseleave"],["class","fas fa-layer-group","style","vertical-align:middle; font-size: 18px;",4,"ngIf"],["id","mousemove-panel",1,"mapboxgl-ctrl-bottom-right",2,"background","rgba(255, 255, 255, .5)","right","0","padding","0 5px 0 5px","bottom","0px"],["id","map",1,"map-view-port"],["bsItemTemplate",""],[1,"col-md-6",2,"height","64px"],[2,"font-weight","bold"],[1,"col-sm-12"],["name","filter",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"col-md-12",2,"height","65px","overflow","auto"],[1,"breadcrumb",2,"background-color","white","vertical-align","middle","line-height","2"],["aria-hidden","true",1,"fa","fa-angle-left","breadcrumb-back-ico"],[2,"color","#007276",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["style","color: #007276;",3,"click",4,"ngIf"],[2,"padding","20px","text-align","center","color","grey"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin"],[1,"list-group-item"],["style","border-left: solid 15px;","class","card card-default clickable",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","card card-default clickable",3,"click",4,"ngIf"],[1,"card","card-default","clickable",2,"border-left","solid 15px",3,"ngClass","click","mouseenter","mouseleave"],[1,"card-body","card-5-7"],[2,"word-break","break-all","border-bottom-color","rgba(195, 195, 195, 0.3)","border-bottom-style","inset","border-bottom-width","2px","margin-bottom","10px","padding-bottom","10px"],["class","pull-right",4,"ngIf"],[1,"pull-right"],["title","Edit",1,"fa","fa-pencil-alt","ico-edit",3,"click"],["title","Delete",1,"fa","fa-trash-alt","ico-remove",3,"click"],[1,"card","card-default","clickable",3,"click"],[1,"card-body"],["aria-hidden","true",1,"fa","fa-caret-left","expand-arrow-ico","pull-right",2,"font-size","25px","padding","0 5px",3,"ngClass","click"],[2,"word-break","break-all"],[1,"list-group",2,"margin-bottom","0",3,"collapse"],["class","list-group-item","style","background-color: #ececec;border: solid 1px lightgrey;border-radius: 0;",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0",3,"click"],["class","pull-right button-column",4,"ngIf"],[1,"pull-right","button-column"],[1,"card","card-default"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0"],[3,"click"],["heading","Products"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container",2,"height","calc(100vh - 296px)","overflow-y","auto"],[3,"id","toggleMapOrtho","toggleMapDem"],[1,"row",2,"background","white"],[1,"col-md-12",2,"text-align","center","padding","10px","border-top","1px solid lightgrey"],[1,"btn","btn-primary",3,"click"],["type","danger",3,"dismissible"],[1,"idm-toast"],["type","success",3,"dismissible","onClosed",4,"ngIf"],["type","warning",3,"dismissible","onClosed",4,"ngIf"],["type","danger",3,"dismissible","onClosed",4,"ngIf"],["type","info",3,"dismissible","onClosed",4,"ngIf"],["type","success",3,"dismissible","onClosed"],["type","warning",3,"dismissible","onClosed"],["routerLink","/site/tasks"],["type","danger",3,"dismissible","onClosed"],["type","info",3,"dismissible","onClosed"],[1,"fas","fa-layer-group",2,"vertical-align","middle","font-size","18px"],["class","row-form",4,"ngFor","ngForOf"],[1,"row-form"],["type","radio","name","rtoggle",1,"layer-toggle-input",3,"value","checked","change"],[1,"layer-toggle-label"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(c.nc(0,"div",0),c.ic(1,"uasdm-header",1),c.mc(),c.nc(2,"div",2),c.nc(3,"div",3),c.nc(4,"div",4),c.nc(5,"div",3),c.nc(6,"div",5),c.Zc(7,Hn,12,2,"ng-container",6),c.Zc(8,Kn,8,1,"div",7),c.nc(9,"div",3),c.nc(10,"div",5),c.nc(11,"div",8),c.nc(12,"input",9),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(13,"div",3),c.nc(14,"div",10),c.nc(15,"tabset",11,12),c.nc(17,"tab",13),c.nc(18,"div",14),c.nc(19,"div",15),c.Zc(20,tc,3,3,"div",16),c.Zc(21,nc,5,1,"div",16),c.Zc(22,rc,3,3,"div",17),c.Zc(23,dc,9,2,"div",17),c.mc(),c.mc(),c.mc(),c.Zc(24,pc,3,1,"tab",18),c.mc(),c.mc(),c.mc(),c.nc(25,"footer",19),c.Zc(26,mc,4,0,"div",20),c.Zc(27,hc,4,0,"div",20),c.mc(),c.mc(),c.nc(28,"div",21),c.nc(29,"div",3),c.nc(30,"article",22),c.Zc(31,uc,12,3,"alert",23),c.Zc(32,yc,5,4,"div",24),c.mc(),c.nc(33,"article",25),c.nc(34,"div",26),c.vc("mouseenter",(function(){return t.baselayerIconHover=!0}))("mouseleave",(function(){return t.baselayerIconHover=!1})),c.Zc(35,kc,1,0,"i",27),c.Zc(36,Ec,2,1,"div",6),c.mc(),c.mc(),c.ic(37,"div",28),c.ic(38,"div",29),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(39,Mc,6,4,"ng-template",null,30,c.ad)),2&e){const e=c.Pc(40);c.Ub(1),c.Ec("title","Site Viewer"),c.Ub(6),c.Ec("ngIf",!t.current),c.Ub(1),c.Ec("ngIf",t.current),c.Ub(4),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",c.Hc(22,Ic)),c.Ub(6),c.Xc(null!=t.current?"height: calc(100vh - 296px);overflow-y: auto;":"height: calc(100vh - 360px);overflow-y: auto;"),c.Ub(2),c.Ec("ngIf",t.nodes.length<1&&0===t.breadcrumbs.length),c.Ub(1),c.Ec("ngIf",t.nodes.length<1&&t.breadcrumbs.length>0),c.Ub(1),c.Ec("ngForOf",t.nodes),c.Ub(1),c.Ec("ngForOf",t.supportingData),c.Ub(1),c.Ec("ngIf",null!=t.current),c.Ub(2),c.Ec("ngIf",null!=t.current),c.Ub(1),c.Ec("ngIf",null==t.current),c.Ub(4),c.Ec("ngIf",null!=t.existingTask),c.Ub(1),c.Ec("ngForOf",t.tasks),c.Ub(3),c.Ec("ngIf",!t.baselayerIconHover),c.Ub(1),c.Ec("ngIf",t.baselayerIconHover)}},directives:[Bn.a,i.t,a.c,a.k,a.n,r.b,p.e,p.b,i.s,a.w,a.p,a.y,i.q,u.a,qt,m.a,o.e],styles:["./projects.css"],data:{animation:[Object(Y.c)(),Object(Y.d)()]}});var Sc=n(54);const Tc=["uploader"];function Rc(e,t){1&e&&(c.nc(0,"div",3),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"h4",6),c.bd(4," There are no Sites added to the system. Add a Site, Project, Mission, and Collection using the "),c.nc(5,"a",7),c.bd(6,"Site Viewer"),c.mc(),c.bd(7," before uploading data to. "),c.mc(),c.mc(),c.ic(8,"div",4),c.mc())}function Pc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",17),c.nc(1,"div",18),c.nc(2,"div",19),c.bd(3,"Partial Upload Detected"),c.mc(),c.nc(4,"div",20),c.nc(5,"h4"),c.bd(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),c.mc(),c.nc(7,"h4"),c.nc(8,"b"),c.bd(9,"To continue an upload"),c.mc(),c.bd(10," please click the Continue Upload button and re-upload your file and we will try our best to continue where you left off. "),c.mc(),c.ic(11,"hr"),c.nc(12,"button",21),c.vc("click",(function(t){return c.Rc(e),c.xc(2).removeUpload(t)})),c.ic(13,"i",16),c.bd(14," Cancel Upload "),c.mc(),c.nc(15,"button",22),c.vc("click",(function(){return c.Rc(e),c.xc(2).showUploadPanel()})),c.ic(16,"i",16),c.bd(17," Continue Upload "),c.mc(),c.mc(),c.mc(),c.mc()}}function Fc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"div",19),c.bd(2," Upload Details "),c.nc(3,"i",24),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).closeTaskFinishedNotification(n.id)})),c.mc(),c.mc(),c.nc(4,"div",20),c.nc(5,"h4"),c.bd(6," Status: "),c.nc(7,"b"),c.bd(8," Upload successfully completed "),c.mc(),c.mc(),c.nc(9,"h4"),c.bd(10," Message: "),c.nc(11,"b"),c.bd(12," Your uploaded data is being processed into final image products. "),c.mc(),c.mc(),c.mc(),c.mc()}}function Nc(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function Dc(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function Ac(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function Zc(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.dd("",e.name," ")}}function jc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.nc(1,"div",26),c.nc(2,"label",27),c.bd(3,"Site:"),c.mc(),c.nc(4,"select",28),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onSiteSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.site=t})),c.ic(5,"option"),c.Zc(6,Nc,2,2,"option",29),c.mc(),c.mc(),c.nc(7,"div",26),c.nc(8,"label",30),c.bd(9,"Project:"),c.mc(),c.nc(10,"select",31),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onProjectSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.project=t})),c.ic(11,"option"),c.Zc(12,Dc,2,2,"option",29),c.mc(),c.mc(),c.nc(13,"div",26),c.nc(14,"label",32),c.bd(15,"Mission:"),c.mc(),c.nc(16,"select",33),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onMissionSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.mission=t})),c.ic(17,"option"),c.Zc(18,Ac,2,2,"option",29),c.mc(),c.mc(),c.nc(19,"div",26),c.nc(20,"label",34),c.bd(21,"Collection:"),c.mc(),c.nc(22,"select",35),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onCollectionSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.collection=t})),c.ic(23,"option"),c.Zc(24,Zc,2,2,"option",29),c.mc(),c.mc(),c.nc(25,"div",26),c.nc(26,"label",36),c.bd(27,"Output Product Name Prefix"),c.mc(),c.nc(28,"input",37),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.outFileName=t})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(4),c.Ec("ngModel",e.values.site),c.Ub(2),c.Ec("ngForOf",e.sites),c.Ub(4),c.Ec("ngModel",e.values.project),c.Vb("disabled",null==e.values.site?"":null),c.Ub(2),c.Ec("ngForOf",e.projects),c.Ub(4),c.Ec("ngModel",e.values.mission),c.Vb("disabled",null==e.values.project?"":null),c.Ub(2),c.Ec("ngForOf",e.missions),c.Ub(4),c.Ec("ngModel",e.values.collection),c.Vb("disabled",null==e.values.mission?"":null),c.Ub(2),c.Ec("ngForOf",e.collections),c.Ub(4),c.Ec("ngModel",e.values.outFileName)}}function Lc(e,t){if(1&e&&(c.nc(0,"div",18),c.nc(1,"div",19),c.bd(2,"Upload Details"),c.mc(),c.nc(3,"div",20),c.nc(4,"h4"),c.bd(5," Status: "),c.nc(6,"b"),c.bd(7),c.mc(),c.mc(),c.nc(8,"h4"),c.bd(9," Message: "),c.nc(10,"b"),c.bd(11),c.mc(),c.mc(),c.nc(12,"h4"),c.bd(13," Upload Started On: "),c.nc(14,"b"),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"h4"),c.bd(18," Last Updated: "),c.nc(19,"b"),c.bd(20),c.yc(21,"idmdate"),c.mc(),c.mc(),c.nc(22,"h4"),c.bd(23," Elapsed Time: "),c.nc(24,"b"),c.bd(25),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.dd(" ",e.currentTask.status," "),c.Ub(4),c.dd(" ",e.currentTask.message," "),c.Ub(4),c.dd(" ",c.zc(16,5,e.currentTask.createDate)," "),c.Ub(5),c.dd(" ",c.zc(21,7,e.currentTask.lastUpdateDate)," "),c.Ub(5),c.dd(" ",e.uploadCounter," ")}}function _c(e,t){1&e&&c.ic(0,"div",39,40)}function $c(e,t){if(1&e){const e=c.oc();c.nc(0,"div",3),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"form",null,8),c.Zc(5,Pc,18,0,"div",9),c.Zc(6,Fc,13,0,"div",10),c.Zc(7,jc,29,12,"div",11),c.nc(8,"div",12),c.Zc(9,Lc,26,9,"div",13),c.Zc(10,_c,2,0,"div",14),c.nc(11,"button",15),c.vc("click",(function(){return c.Rc(e),c.xc().handleUpload()})),c.ic(12,"i",16),c.bd(13," Upload "),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(14,"div",4),c.mc()}if(2&e){const e=c.Pc(4),t=c.xc();c.Ub(5),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("ngForOf",t.taskFinishedNotifications),c.Ub(1),c.Ec("ngIf",!t.disabled&&!t.existingTask),c.Ub(1),c.Ec("hidden",!t.uploadVisible),c.Ub(1),c.Ec("ngIf",t.currentTask),c.Ub(1),c.Ec("ngIf",t.showFileSelectPanel),c.Ub(1),c.Ec("disabled",!e.valid||t.disabled)}}class zc{constructor(e,t,n){this.service=e,this.modalService=t,this.sites=[],this.projects=[],this.missions=[],this.collections=[],this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.differ=n.find([]).create()}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}set content(e){const t=this;if(null!=e&&null==this.uploader){let n={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,n){t.disabled=!0,t.countUpload(t)},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,n,c,i){c.message&&c.message.currentTask&&!t.currentTask&&(t.currentTask=c.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(X.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(K.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,n,c,i){t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),t.taskFinishedNotifications.push({id:e})},onCancel:function(e,n){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,n,c){t.error(c)}}};this.uploader=new Q.FineUploader(n)}}ngAfterViewInit(){}ngOnInit(){this.service.roots(null,null).then(e=>{this.sites=e})}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0,this.selectedContinue||this.hideUploadPanel())}onSiteSelect(e){this.values.site=e,null!=e&&e.length>0&&(this.projects=[],this.missions=[],this.collections=[],this.values.project=null,this.values.mission=null,this.values.collection=null,this.service.getChildren(this.values.site).then(e=>{this.projects=e}))}onProjectSelect(e){this.values.project=e,this.missions=[],this.collections=[],this.values.mission=null,this.values.collection=null,null!=e&&e.length>0&&this.service.getChildren(this.values.project).then(e=>{this.missions=e.filter(e=>"Mission"===e.type)})}onMissionSelect(e){this.values.mission=e,this.collections=[],this.values.collection=null,this.values.name=null,null!=e&&e.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}handleChange(){this.collections=[],this.values.collection=null,this.values.name=null,null!=this.values.mission&&this.values.mission.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}onCollectionSelect(e){this.values.collection=e,this.values.uasComponentOid=e,e&&e.trim().length>0?this.showFileSelectPanel=!0:this.showFileSelectPanel=!1}handleUpload(){this.values.create||null!=this.values.collection||this.existingTask?!this.values.create||null!=this.values.mission&&null!=this.values.name&&0!=this.values.name.length||this.existingTask?(this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()):(this.bsModalRef=this.modalService.show(Sc.a,{backdrop:!0}),this.bsModalRef.content.message="Name is required"):(this.bsModalRef=this.modalService.show(Sc.a,{backdrop:!0}),this.bsModalRef.content.message="A collection must first be selected before the file can be uploaded")}removeUpload(e){let t=this;this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Cancel Upload",this.bsModalRef.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),t.existingTask=!1,t.showUploadPanel()})})}hideUploadPanel(){this.uploadVisible=!1}showUploadPanel(){this.uploadVisible=!0,this.selectedContinue=!0}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let n=Math.floor(t/3600),c=Math.floor(t%3600/60),i=Math.floor(t%60),o=c<10?"0"+n:n,a=c<10?"0"+c:c,s=i<10?"0"+i:i;e.uploadCounter=o+":"+a+":"+s}),1e3)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}error(e){null!==e&&(this.bsModalRef=this.modalService.show(Sc.a,{backdrop:!0}),this.bsModalRef.content.message=e)}}function Bc(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1,"Sensor: "),c.nc(2,"b"),c.bd(3),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(3),c.cd(e.sensorName)}}function Gc(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return t.showError=!t.showError})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2).$implicit;c.Ub(1),c.dd("",e.showError?"Hide":"Show"," Messages")}}zc.ɵfac=function(e){return new(e||zc)(c.hc(Z),c.hc(j.b),c.hc(c.E))},zc.ɵcmp=c.bc({type:zc,selectors:[["upload"]],viewQuery:function(e,t){var n;(1&e&&c.fd(Tc,!0),2&e)&&(c.Oc(n=c.wc())&&(t.content=n.first))},hostBindings:function(e,t){1&e&&c.vc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.Qc)},decls:4,vars:3,consts:[[3,"title"],["id","app-container",1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-2"],[1,"col-md-8"],[2,"margin-top","50px"],["routerlink","/viewer","routerlinkactive","active","href","#/viewer"],["ngForm","ngForm"],["class","",4,"ngIf"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],["style","margin-top: 30px;","class","",4,"ngIf"],[1,"",3,"hidden"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],["class","uploader-container","style","margin-top: 20px;",4,"ngIf"],["type","button btn btn-primary",1,"btn","btn-primary",2,"margin-top","20px",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,""],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],["type","button",1,"btn","btn-danger",2,"margin-top","20px",3,"click"],["type","button",1,"btn","btn-primary",2,"margin-top","20px",3,"click"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],[1,"",2,"margin-top","30px"],[1,"form-group"],["for","site"],["name","site","required","",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","project"],["name","project","required","",3,"ngModel","change","ngModelChange"],["for","mission"],["name","mission","required","",3,"ngModel","change","ngModelChange"],["for","collection"],["name","collection","required","",3,"ngModel","change","ngModelChange"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""]],template:function(e,t){1&e&&(c.ic(0,"uasdm-header",0),c.nc(1,"div",1),c.Zc(2,Rc,9,0,"div",2),c.Zc(3,$c,15,7,"div",2),c.mc()),2&e&&(c.Ec("title","Data Upload"),c.Ub(2),c.Ec("ngIf",0===t.sites.length),c.Ub(1),c.Ec("ngIf",t.sites.length>0))},directives:[Bn.a,i.t,a.z,a.l,a.m,i.s,a.w,a.v,a.k,a.n,a.p,a.y,a.c],pipes:[Le.a],encapsulation:2});const Vc=function(e,t,n){return{success:e,pending:t,fail:n}};function qc(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"ul",12),c.nc(2,"li"),c.bd(3,"Status: "),c.nc(4,"b",6),c.bd(5),c.mc(),c.mc(),c.nc(6,"li"),c.bd(7,"Created on: "),c.nc(8,"b"),c.bd(9),c.yc(10,"idmdate"),c.mc(),c.mc(),c.nc(11,"li"),c.bd(12,"Last update: "),c.nc(13,"b"),c.bd(14),c.yc(15,"idmdate"),c.mc(),c.mc(),c.nc(16,"li",13),c.bd(17,"Message: "),c.nc(18,"b"),c.bd(19),c.mc(),c.mc(),c.Zc(20,Bc,4,1,"li",10),c.mc(),c.nc(21,"div",14),c.nc(22,"div",15),c.nc(23,"div",16),c.Zc(24,Gc,2,1,"button",17),c.nc(25,"button",18),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().removeTask(t)})),c.bd(26,"Delete Task"),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(4),c.Ec("ngClass",c.Kc(11,Vc,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),c.Ub(1),c.cd(e.status),c.Ub(4),c.cd(c.zc(10,7,e.createDate)),c.Ub(5),c.cd(c.zc(15,9,e.lastUpdateDate)),c.Ub(5),c.cd(e.message),c.Ub(1),c.Ec("ngIf","Upload"==t.taskCategory),c.Ub(4),c.Ec("ngIf",e.actions.length>0)}}function Hc(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1,"Sensor: "),c.nc(2,"b"),c.bd(3),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(3),c.cd(e.sensorName)}}function Jc(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return t.showError=!t.showError})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2).$implicit;c.Ub(1),c.dd("",e.showError?"Hide":"Show"," Messages")}}function Wc(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(3);return t.showODMOutput=!t.showODMOutput})),c.bd(1,"Show Detailed Log Output"),c.mc()}}function Yc(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"h4"),c.bd(3,"Output:"),c.mc(),c.ic(4,"textarea",20),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(4),c.Ec("innerHTML",e.odmOutput,c.Sc)}}function Xc(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"ul",12),c.nc(2,"li"),c.bd(3,"Status: "),c.nc(4,"b",6),c.bd(5),c.mc(),c.mc(),c.nc(6,"li"),c.bd(7,"Message: "),c.nc(8,"b"),c.bd(9),c.mc(),c.mc(),c.nc(10,"li"),c.bd(11,"Created on: "),c.nc(12,"b"),c.bd(13),c.yc(14,"idmdate"),c.mc(),c.mc(),c.nc(15,"li"),c.bd(16,"Last update: "),c.nc(17,"b"),c.bd(18),c.yc(19,"idmdate"),c.mc(),c.mc(),c.Zc(20,Hc,4,1,"li",10),c.mc(),c.nc(21,"div",14),c.nc(22,"div",15),c.nc(23,"div",16),c.Zc(24,Jc,2,1,"button",17),c.Zc(25,Wc,2,0,"button",17),c.nc(26,"button",18),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().removeTask(t)})),c.bd(27,"Delete Task"),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(28,Yc,5,1,"div",11),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(4),c.Ec("ngClass",c.Kc(13,Vc,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),c.Ub(1),c.dd(" ","Complete"===e.status&&e.actions.length>0?"Complete With Messages":e.status," "),c.Ub(4),c.cd(e.message),c.Ub(4),c.cd(c.zc(14,9,e.createDate)),c.Ub(5),c.cd(c.zc(19,11,e.lastUpdateDate)),c.Ub(2),c.Ec("ngIf","Upload"==t.taskCategory),c.Ub(4),c.Ec("ngIf",e.actions.length>0),c.Ub(1),c.Ec("ngIf",e.odmOutput),c.Ub(3),c.Ec("ngIf",e.odmOutput&&t.showODMOutput)}}function Kc(e,t){1&e&&(c.nc(0,"h4",23),c.bd(1,"There are no actions for this task."),c.mc())}function Qc(e,t){if(1&e&&(c.nc(0,"tr"),c.nc(1,"th",26),c.bd(2),c.mc(),c.nc(3,"td"),c.bd(4),c.mc(),c.nc(5,"td"),c.bd(6),c.yc(7,"idmdate"),c.mc(),c.nc(8,"td"),c.bd(9),c.yc(10,"idmdate"),c.mc(),c.mc()),2&e){const e=t.$implicit,n=t.index;c.Ub(2),c.cd(n+1),c.Ub(2),c.cd(e.description),c.Ub(2),c.cd(c.zc(7,4,e.createDate)),c.Ub(3),c.cd(c.zc(10,6,e.lastUpdateDate))}}function ei(e,t){if(1&e&&(c.nc(0,"table",24),c.nc(1,"thead"),c.nc(2,"tr"),c.nc(3,"th"),c.bd(4,"#"),c.mc(),c.nc(5,"th"),c.bd(6,"Description"),c.mc(),c.nc(7,"th"),c.bd(8,"Creation Date"),c.mc(),c.nc(9,"th"),c.bd(10,"Last Updated"),c.mc(),c.mc(),c.mc(),c.nc(11,"tbody"),c.Zc(12,Qc,11,8,"tr",25),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(12),c.Ec("ngForOf",e.actions)}}function ti(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.Zc(2,Kc,2,0,"h4",21),c.Zc(3,ei,13,1,"table",22),c.mc(),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(2),c.Ec("ngIf",0===e.actions.length),c.Ub(1),c.Ec("ngIf",e.actions.length>0)}}function ni(e,t){if(1&e&&(c.nc(0,"div",9),c.Zc(1,qc,27,15,"div",10),c.Zc(2,Xc,29,17,"div",10),c.Zc(3,ti,4,2,"div",11),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","Complete"!==e.status&&"Failed"!==e.status&&"Error"!==e.status),c.Ub(1),c.Ec("ngIf","Complete"===e.status||"Failed"===e.status||"Error"===e.status),c.Ub(1),c.Ec("ngIf",e.showError)}}const ci=function(e,t,n,c){return{success:e,warning:t,pending:n,fail:c}};class ii{constructor(e,t){this.managementService=e,this.modalService=t,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.showODMOutput=!1,this.showError=!1,this.taskGroups=[]}ngOnInit(){if(null!=this.taskGroupType&&null!=this.taskGroupType.tasks)for(var e=0;e<this.taskGroupType.tasks.length;++e){let t=this.taskGroupType.tasks[e];t.actions.length>0&&(t.showError=!0)}}ngOnDestroy(){}removeTask(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let n=0;n<this.taskGroupType.tasks.length;n++){if(this.taskGroupType.tasks[n].uploadId===e.uploadId){t=n;break}}null!==t&&this.taskGroupType.tasks.splice(t,1)})}}function oi(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function ai(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",16),c.nc(2,"div"),c.ic(3,"span",25),c.bd(4),c.mc(),c.nc(5,"div",26),c.nc(6,"ul",27),c.Zc(7,oi,4,1,"li",28),c.nc(8,"li",9),c.nc(9,"a",29),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleGoto(t.collectionId)})),c.bd(10),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(11,"div",30),c.nc(12,"div"),c.nc(13,"button",31),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleGoto(t.data.collectionId)})),c.bd(14," View Collection "),c.mc(),c.nc(15,"button",32),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleMessage(t)})),c.bd(16," Add Metadata "),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc().$implicit;c.Ub(4),c.dd(" ",e.message," "),c.Ub(3),c.Ec("ngForOf",e.data.ancestors),c.Ub(3),c.dd(" ",e.data.collectionName,"")}}function si(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",16),c.nc(2,"div"),c.ic(3,"span",25),c.bd(4),c.mc(),c.mc(),c.nc(5,"div",30),c.nc(6,"div"),c.nc(7,"button",31),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleGoto(t.data.component)})),c.bd(8," View Collection "),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc().$implicit;c.Ub(4),c.dd(" ",e.message," ")}}function li(e,t){if(1&e&&(c.nc(0,"div",20),c.nc(1,"div",21),c.nc(2,"div",2),c.lc(3,22),c.Zc(4,ai,17,3,"ng-container",23),c.Zc(5,si,9,1,"ng-container",24),c.kc(),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.Ec("ngSwitch",e.type),c.Ub(1),c.Ec("ngSwitchCase","MissingMetadataMessage")}}ii.ɵfac=function(e){return new(e||ii)(c.hc(Z),c.hc(j.b))},ii.ɵcmp=c.bc({type:ii,selectors:[["tasks-panel"]],inputs:{taskGroupType:"taskGroupType",groupTypeId:"groupTypeId",taskCategory:"taskCategory"},decls:13,vars:13,consts:[[1,"panel-group"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","panel-heading-light","clickable",2,"margin-top","20px"],[1,"panel-title"],["data-toggle","collapse",3,"click"],[1,"heading-status-label","pull-right"],[3,"ngClass"],[1,"panel-body",3,"id","isAnimated","collapse"],["class","task-container",4,"ngFor","ngForOf"],[1,"task-container"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"list-unstyled",2,"margin","0"],[2,"word-break","break-all"],[1,"row"],[1,"col-sm-12"],[1,"button-holder",2,"margin-top","30px"],["class","btn btn-default",3,"click",4,"ngIf"],[1,"btn","btn-default","caution",3,"click"],[1,"btn","btn-default",3,"click"],[2,"color","grey","width","500px","height","200px",3,"innerHTML"],["style","color:grey;",4,"ngIf"],["class","table table-bordered",4,"ngIf"],[2,"color","grey"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["scope","row"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div",1),c.nc(2,"div",2),c.nc(3,"h4",3),c.nc(4,"a",4),c.vc("click",(function(){return t.showProcess=!t.showProcess})),c.nc(5,"h4"),c.bd(6),c.mc(),c.mc(),c.mc(),c.nc(7,"span",5),c.bd(8,"Current status: "),c.nc(9,"span",6),c.bd(10),c.mc(),c.mc(),c.mc(),c.nc(11,"div",7),c.Zc(12,ni,4,3,"div",8),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(4),c.Wb("aria-controls","task-group-panel-",t.groupTypeId,""),c.Ub(2),c.cd(t.taskCategory),c.Ub(3),c.Ec("ngClass",c.Lc(8,ci,"Complete"===t.taskGroupType.status,"Warning"===t.taskGroupType.status,"Queued"===t.taskGroupType.status||"Processing"===t.taskGroupType.status,"Failed"===t.taskGroupType.status)),c.Ub(1),c.cd(t.taskGroupType.status),c.Ub(1),c.Gc("id","task-group-panel-",t.groupTypeId,""),c.Ec("isAnimated",!1)("collapse",!t.showProcess),c.Ub(1),c.Ec("ngForOf",t.taskGroupType.tasks))},directives:[i.q,u.a,i.s,i.t],pipes:[Le.a],styles:[".button-holder[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\n\tmargin-right: 10px;\n}\n.btn.btn-danger[_ngcontent-%COMP%] {\n    background-color: #d9534f !important;\n    border-color: #d43f3a !important;\n}\n.btn.btn-danger[_ngcontent-%COMP%]:hover {\n    background-color: #d2322d !important;\n    border-color: #ac2925 !important;\n}\n.btn.btn-default.caution[_ngcontent-%COMP%]:hover {\n\tborder-color: #ac2925 !important;\n\tcolor: #ac2925 !important;\n}\n\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%]{\n  background-color: #e9e9e9;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}\n\n\n.dot[_ngcontent-%COMP%] {\n  height: 20px;\n  width: 20px;\n  background-color: #bbb;\n  border-radius: 50%;\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 10px;\n}\n.dot.success[_ngcontent-%COMP%] {\n  background-color: #6CB46F;\n}\n.dot.pending[_ngcontent-%COMP%] {    \n  background-color: #FF8C42;\n}\n.dot.warning[_ngcontent-%COMP%] {\n  background-color: #2C88CB;\n}\n.dot.fail[_ngcontent-%COMP%] {\n  background-color:#BF1E1E;\n}\n.dot.pending.blink[_ngcontent-%COMP%] {\n   animation-duration: 400ms;\n   animation-name: blink;\n   animation-iteration-count: infinite;\n   animation-direction: alternate;\n}\n@keyframes blink {\n   from {\n      opacity: 1;\n   }\n   to {\n      opacity: .5;\n   }\n }"]});const ri=function(e,t,n){return{id:"message-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:n}};function di(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Tasks"),c.mc(),c.nc(3,"div",15),c.nc(4,"div",2),c.nc(5,"h3",16),c.bd(6,"Issue"),c.mc(),c.nc(7,"h3",17),c.bd(8,"Actions"),c.mc(),c.mc(),c.Zc(9,li,6,2,"div",18),c.yc(10,"paginate"),c.nc(11,"div",2),c.nc(12,"pagination-controls",19),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onMessagePageChange(t)})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngForOf",c.Ac(10,1,e.messages.resultSet,c.Kc(4,ri,e.messages.pageSize,e.messages.pageNumber,e.messages.count)))}}function pi(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function mi(e,t){1&e&&c.ic(0,"i",45)}function hi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function ui(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function gi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function bi(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,hi,2,3,"div",6),c.Zc(2,ui,2,3,"div",6),c.Zc(3,gi,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function fi(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,bi,4,4,"div",46),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function vi(e,t){if(1&e&&(c.nc(0,"span"),c.Zc(1,fi,2,1,"div",28),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngForOf",e.groups)}}const yi=function(e,t,n,c){return{success:e,warning:t,"pending blink":n,fail:c}};function ki(e,t){if(1&e){const e=c.oc();c.nc(0,"div",37),c.nc(1,"div",38),c.nc(2,"h4",39),c.nc(3,"a",40),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",41),c.nc(7,"button",42),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",26),c.nc(10,"ul",27),c.Zc(11,pi,4,1,"li",28),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",43),c.Zc(15,mi,1,0,"i",44),c.Zc(16,vi,2,1,"span",6),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(10,yi,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}const xi=function(e,t,n){return{id:"tasks-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:n}};function Ei(e,t){if(1&e){const e=c.oc();c.nc(0,"div",33),c.nc(1,"div",34),c.Zc(2,ki,17,15,"div",35),c.yc(3,"paginate"),c.nc(4,"pagination-controls",36),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,xi,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function Ci(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function wi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function Ui(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function Mi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function Ii(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,wi,2,3,"div",6),c.Zc(2,Ui,2,3,"div",6),c.Zc(3,Mi,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function Oi(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,Ii,4,4,"div",46),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function Si(e,t){if(1&e){const e=c.oc();c.nc(0,"div",37),c.nc(1,"div",38),c.nc(2,"h4",39),c.nc(3,"a",40),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",41),c.nc(7,"button",42),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",26),c.nc(10,"ul",27),c.Zc(11,Ci,4,1,"li",28),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",43),c.Zc(15,Oi,2,1,"div",28),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(9,yi,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngForOf",e.groups)}}function Ti(e,t){if(1&e){const e=c.oc();c.nc(0,"div",49),c.nc(1,"div",34),c.Zc(2,Si,16,14,"div",35),c.yc(3,"paginate"),c.nc(4,"pagination-controls",36),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,xi,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function Ri(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function Pi(e,t){1&e&&c.ic(0,"i",45)}function Fi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function Ni(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function Di(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function Ai(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,Fi,2,3,"div",6),c.Zc(2,Ni,2,3,"div",6),c.Zc(3,Di,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function Zi(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,Ai,4,4,"div",46),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function ji(e,t){if(1&e&&(c.nc(0,"span"),c.Zc(1,Zi,2,1,"div",28),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngForOf",e.groups)}}function Li(e,t){if(1&e){const e=c.oc();c.nc(0,"div",37),c.nc(1,"div",38),c.nc(2,"h4",39),c.nc(3,"a",40),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",41),c.nc(7,"button",42),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",26),c.nc(10,"ul",27),c.Zc(11,Ri,4,1,"li",28),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",43),c.Zc(15,Pi,1,0,"i",44),c.Zc(16,ji,2,1,"span",6),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(10,yi,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}function _i(e,t){if(1&e){const e=c.oc();c.nc(0,"div",50),c.nc(1,"div",34),c.Zc(2,Li,17,15,"div",35),c.yc(3,"paginate"),c.nc(4,"pagination-controls",36),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,xi,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}class $i{constructor(e,t){this.managementService=e,this.modalService=t,this.userName="",this.totalTaskCount=0,this.activeTab="all",this.showSite=!1,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.taskPage={count:0,pageSize:10,pageNumber:1,resultSet:[]},this.errorStatuses=["Failed","Processing"],this.completeStatuses=["Complete"],this.statuses=[],this.token=0,this.messages={count:0,pageSize:5,pageNumber:1,resultSet:[]}}ngOnInit(){this.userName=this.managementService.getCurrentUser(),this.managementService.tasks([],this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e)}),this.getMessages();let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"JOB_CHANGE"===e.type&&(this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{e.token===this.token&&this.updateTaskData(e)}),this.getMessages())})}ngOnDestroy(){this.notifier.complete()}onPageChange(e){this.token++,this.managementService.tasks(this.statuses,this.taskPage.pageSize,e,this.token).then(e=>{this.setTaskData(e)})}onTabClick(e,t){if(this.activeTab=t,this.taskPage={count:0,pageSize:20,pageNumber:1,resultSet:[]},this.token++,"success"===t?this.statuses=this.completeStatuses:"action-required"===t?this.statuses=this.errorStatuses:"all"===t&&(this.statuses=[]),this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e)}),!e.target.parentNode.classList.contains("active")){let t=e.target.parentNode.parentNode.getElementsByTagName("li");for(let e=0;e<t.length;e++){let n=t[e];n.classList.forEach(e=>{"active"===e&&n.classList.remove("active")})}e.target.parentNode.classList.add("active")}}setTaskData(e){this.taskPage=e,this.visible={},this.taskPage.resultSet.forEach(e=>{this.visible[e.collectionId]=!1})}setGroupTasks(e,t){e.groups=[],e.groups.push({tasks:[],status:null,type:"UPLOAD"}),e.groups.push({tasks:[],status:null,type:"PROCESS"}),e.groups.push({tasks:[],status:null,type:"STORE"});for(let n=0;n<t.length;n++){let c=t[n];if("gov.geoplatform.uasdm.bus.WorkflowTask"===c.type){let t=e.groups.findIndex(e=>"UPLOAD"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"UPLOAD"}):e.groups[t].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMProcessingTask"===c.type){let t=e.groups.findIndex(e=>"PROCESS"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"PROCESS"}):e.groups[t].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMUploadTask"===c.type){let t=e.groups.findIndex(e=>"STORE"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"STORE"}):e.groups[t].tasks.push(c)}}this.setTaskGroupStatuses(e)}setTaskGroupStatuses(e){let t=null;e.groups.forEach(e=>{let n=!1;if(e.tasks.length>0){const c=e.tasks.sort((e,t)=>new Date(t.lastUpdateDate).getTime()-new Date(e.lastUpdateDate).getTime());e.status=c[0].status;const i=new Date(c[0].lastUpdateDate);n=null==t||t.getTime()-i.getTime()<=0,n&&(t=i),"Complete"===e.status&&c[0].actions.length>0&&(e.status="Warning")}})}updateTaskData(e){this.taskPage=e,this.taskPage.resultSet.forEach(e=>{this.visible[e.collectionId]&&this.managementService.getTasks(e.collectionId).then(t=>{this.setGroupTasks(e,t)})})}setVisibility(e){this.visible[e.collectionId]?this.visible[e.collectionId]=!1:(this.visible[e.collectionId]=!0,null!=e.groups||e.loading||(e.loading=!0,this.managementService.getTasks(e.collectionId).then(t=>{this.setGroupTasks(e,t),e.loading=!1})))}handleMessage(e){"MissingMetadataMessage"===e.type&&(this.bsModalRef=this.modalService.show(W,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(e.data.collectionId),this.bsModalRef.content.onMetadataChange.subscribe(()=>{this.getMessages()}))}handleGoto(e){this.managementService.view(e).then(t=>{const n=t.item,c=t.breadcrumbs;this.managementService.getItems(e,null).then(e=>{this.bsModalRef=this.modalService.show(ut,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal"}),this.bsModalRef.content.init(n,e,c)})})}removeTask(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let n=0;n<this.tasks.resultSet.length;n++){if(this.tasks[n].uploadId===e.uploadId){t=n;break}}null!==t&&this.tasks.resultSet.splice(t,1),this.getMessages(),this.totalTaskCount=this.tasks.count})}getMessages(){this.onMessagePageChange(this.messages.pageNumber)}onMessagePageChange(e){this.managementService.getMessages(this.messages.pageSize,e).then(e=>{this.messages=e})}}$i.ɵfac=function(e){return new(e||$i)(c.hc(Z),c.hc(j.b))},$i.ɵcmp=c.bc({type:$i,selectors:[["tasks"]],decls:25,vars:5,consts:[[3,"title"],["id","app-container",1,"container-fluid",2,"padding-top","20px"],[1,"row"],[1,"col-sm-1"],[1,"col-sm-10"],["id","tasks"],[4,"ngIf"],[1,"row",2,"margin-bottom","40px"],["role","tablist",1,"nav","nav-tabs"],[1,"active"],["role","tab","data-toggle","tab",3,"click"],[1,"tab-content"],["class","tab-pane active","id","action-required",4,"ngIf"],["class","tab-pane active","id","success",4,"ngIf"],["class","tab-pane active","id","all",4,"ngIf"],["id","tasks-container"],[1,"col-sm-7"],[1,"col-sm-5",2,"text-align","right","padding-right","8em"],["class","panel panel-default",4,"ngFor","ngForOf"],["id","message-pg-ctrl",3,"pageChange"],[1,"panel","panel-default"],[1,"panel-body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"dot","pending",2,"margin-left","0"],[2,"margin-top","10px","margin-bottom","0","color","grey"],[1,"breadcrumb",2,"color","grey"],[4,"ngFor","ngForOf"],[2,"color","#007276",3,"click"],[1,"col-sm-5",2,"text-align","right"],[1,"btn","btn-default",3,"click"],[1,"btn","btn-primary",2,"margin-left","10px",3,"click"],["id","action-required",1,"tab-pane","active"],[1,"panel-group"],["class","panel panel-default","style","background: none;border: none;",4,"ngFor","ngForOf"],["id","tasks-pg-ctrl",3,"pageChange"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","clickable"],[1,"panel-title",2,"display","inline-block","vertical-align","middle"],["data-toggle","collapse",3,"click"],[1,"dot",3,"ngClass"],[1,"btn","btn-default","pull-right",3,"click"],[1,"panel-body",3,"isAnimated","collapse"],["class","fa fa-spinner fa-spin task-group-loading",4,"ngIf"],[1,"fa","fa-spinner","fa-spin","task-group-loading"],[3,"id",4,"ngIf"],[3,"id"],[3,"taskGroupType","groupTypeId","taskCategory"],["id","success",1,"tab-pane","active"],["id","all",1,"tab-pane","active"]],template:function(e,t){1&e&&(c.ic(0,"uasdm-header",0),c.nc(1,"div",1),c.nc(2,"div",2),c.ic(3,"div",3),c.nc(4,"div",4),c.nc(5,"div",5),c.Zc(6,di,13,8,"div",6),c.mc(),c.mc(),c.ic(7,"div",3),c.mc(),c.nc(8,"div",7),c.ic(9,"div",3),c.nc(10,"div",4),c.nc(11,"h3"),c.bd(12,"Processing Jobs"),c.mc(),c.nc(13,"ul",8),c.nc(14,"li",9),c.nc(15,"a",10),c.vc("click",(function(e){return t.onTabClick(e,"all")})),c.bd(16,"All"),c.mc(),c.mc(),c.nc(17,"li"),c.nc(18,"a",10),c.vc("click",(function(e){return t.onTabClick(e,"action-required")})),c.bd(19,"Action Required"),c.mc(),c.mc(),c.mc(),c.nc(20,"div",11),c.Zc(21,Ei,5,8,"div",12),c.Zc(22,Ti,5,8,"div",13),c.Zc(23,_i,5,8,"div",14),c.mc(),c.mc(),c.ic(24,"div",3),c.mc(),c.mc()),2&e&&(c.Ec("title","Tasks"),c.Ub(6),c.Ec("ngIf",t.messages&&t.messages.count>0),c.Ub(15),c.Ec("ngIf","action-required"===t.activeTab),c.Ub(1),c.Ec("ngIf","success"===t.activeTab),c.Ub(1),c.Ec("ngIf","all"===t.activeTab))},directives:[Bn.a,i.t,i.s,h.c,i.x,i.y,i.z,i.q,u.a,ii],pipes:[h.b],styles:["#app-container[_ngcontent-%COMP%] {\n    background: #f7f7f7;\n}\n\n#tasks-container[_ngcontent-%COMP%] {\n    padding: 20px;\n    background: white;\n    border-radius: 6px;\n}\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.task-group-loading[_ngcontent-%COMP%] {\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%] {\n  background-color: #e9e9e9;\n  margin-top: 20px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}"]});class zi{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/sensor/page",{params:t}).toPromise()}getAll(){let e=new y.g;return this.eventService.start(),this.http.get(acp+"/sensor/get-all",{params:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/sensor/apply",JSON.stringify({sensor:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}zi.ɵfac=function(e){return new(e||zi)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},zi.ɵprov=c.dc({token:zi,factory:zi.ɵfac});var Bi,Gi=n(95);function Vi(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}class qi{constructor(e,t,n){this.service=e,this.modalService=t,this.router=n,this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"Model",field:"model",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"Type",field:"sensorType",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"Sensor",sort:{field:"name",order:1}},this.refresh=new G.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the sensor ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/sensor",e.oid])}newInstance(){this.router.navigate(["/site/sensor","__NEW__"])}}qi.ɵfac=function(e){return new(e||qi)(c.hc(zi),c.hc(j.b),c.hc(o.b))},qi.ɵcmp=c.bc({type:qi,selectors:[["sensors"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Sensors"),c.mc(),c.Zc(3,Vi,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,Gi.a],styles:["./sensors.css"]}),function(e){e.SENSOR_TYPE="/sensor-type",e.PLATFORM_TYPE="/platform-type",e.PLATFORM_MANUFACTURER="/platform-manufacturer",e.WAVE_LENGTH="/wave-length"}(Bi||(Bi={}));class Hi{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e,t){let n=new y.g;return n=n.set("criteria",JSON.stringify(e)),this.http.get(acp+t+"/page",{params:n}).toPromise()}getAll(e){let t=new y.g;return this.eventService.start(),this.http.get(acp+e+"/get-all",{params:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}get(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/get",JSON.stringify({oid:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/newInstance",JSON.stringify({}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/remove",JSON.stringify({oid:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+e+"/apply",JSON.stringify({classification:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}function Ji(e,t){if(1&e&&(c.nc(0,"div",18),c.nc(1,"div",19),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",20),c.nc(5,"div"),c.nc(6,"p",21),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Wi(e,t){if(1&e&&(c.nc(0,"option",22),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function Yi(e,t){1&e&&(c.nc(0,"span",21),c.bd(1," A sensor requires at least one Wave Length "),c.mc())}function Xi(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",23),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().updateSelectedWaveLength(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("value",n.sensor.wavelengths&&-1!==n.sensor.wavelengths.indexOf(e.oid))("label",e.name)("disabled","READ"===n.mode)}}Hi.ɵfac=function(e){return new(e||Hi)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},Hi.ɵprov=c.dc({token:Hi,factory:Hi.ɵfac});const Ki=function(e){return["/site/platform",e]};function Qi(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"a",24),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("routerLink",c.Ic(2,Ki,e.oid)),c.Ub(1),c.cd(e.name)}}function eo(e,t){if(1&e&&(c.nc(0,"div",4),c.nc(1,"label"),c.bd(2,"Used on Platforms"),c.mc(),c.nc(3,"ul"),c.Zc(4,Qi,3,4,"li",15),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",e.sensor.platforms)}}function to(e,t){if(1&e){const e=c.oc();c.nc(0,"button",28),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function no(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.Zc(1,to,2,0,"button",26),c.nc(2,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(8);c.Ub(1),c.Ec("ngIf",!e.newInstance),c.Ub(1),c.Ec("disabled",!t.valid||0===e.sensor.wavelengths.length)}}function co(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.nc(1,"button",29),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}class io{constructor(e,t,n,c,i){this.service=e,this.classificationService=t,this.route=n,this.router=c,this.authService=i,this.isAdmin=!1,this.newInstance=!1,this.message=null,this.wavelengths=[],this.types=[],this.mode="READ",this.isAdmin=this.authService.isAdmin()}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.sensor=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.sensor=e,this.original=JSON.parse(JSON.stringify(this.sensor))}),this.classificationService.getAll(Bi.WAVE_LENGTH).then(e=>{this.wavelengths=e}),this.classificationService.getAll(Bi.SENSOR_TYPE).then(e=>{this.types=e})}handleOnSubmit(){this.message=null,this.service.apply(this.sensor).then(e=>{this.router.navigate(["/site/equipment"])}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.sensor=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}updateSelectedWaveLength(e,t){const n=this.sensor.wavelengths.findIndex(t=>e.oid===t);t?n<0&&this.sensor.wavelengths.push(e.oid):n>-1&&this.sensor.wavelengths.splice(n,1)}error(e){this.message=S.b.getMessageFromError(e)}}io.ɵfac=function(e){return new(e||io)(c.hc(zi),c.hc(Hi),c.hc(o.a),c.hc(o.b),c.hc(A.a))},io.ɵcmp=c.bc({type:io,selectors:[["sensor"]],decls:54,vars:23,consts:[["id","app-container",1,"container"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","model","type","input","placeholder","Model","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorType","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","pixelSizeWidth","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","pixelSizeHeight","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorWidth","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorHeight","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","error-message",4,"ngIf"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["class","btn-holder","style","text-align: right;margin-bottom: 40px;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],[3,"value","label","disabled","valueChange"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right","margin-bottom","40px"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,Ji,8,1,"div",1),c.nc(4,"div",2),c.nc(5,"h3"),c.bd(6,"Sensor"),c.mc(),c.mc(),c.nc(7,"form",null,3),c.nc(9,"div",4),c.nc(10,"label"),c.bd(11,"Name"),c.mc(),c.nc(12,"input",5),c.vc("ngModelChange",(function(e){return t.sensor.name=e})),c.mc(),c.mc(),c.nc(13,"div",4),c.nc(14,"label"),c.bd(15,"Description"),c.mc(),c.nc(16,"textarea",6),c.vc("ngModelChange",(function(e){return t.sensor.description=e})),c.bd(17,"        "),c.mc(),c.mc(),c.nc(18,"div",4),c.nc(19,"label"),c.bd(20,"Model"),c.mc(),c.nc(21,"input",7),c.vc("ngModelChange",(function(e){return t.sensor.model=e})),c.mc(),c.mc(),c.nc(22,"div",4),c.nc(23,"label"),c.bd(24,"Type"),c.mc(),c.nc(25,"select",8),c.vc("ngModelChange",(function(e){return t.sensor.sensorType=e})),c.ic(26,"option"),c.Zc(27,Wi,2,2,"option",9),c.mc(),c.mc(),c.nc(28,"div",4),c.nc(29,"label"),c.bd(30,"Pixel Size Width"),c.mc(),c.nc(31,"input",10),c.vc("ngModelChange",(function(e){return t.sensor.pixelSizeWidth=e})),c.mc(),c.mc(),c.nc(32,"div",4),c.nc(33,"label"),c.bd(34,"Pixel Size Height"),c.mc(),c.nc(35,"input",11),c.vc("ngModelChange",(function(e){return t.sensor.pixelSizeHeight=e})),c.mc(),c.mc(),c.nc(36,"div",4),c.nc(37,"label"),c.bd(38,"Sensor Width"),c.mc(),c.bd(39," (millimeters) "),c.nc(40,"input",12),c.vc("ngModelChange",(function(e){return t.sensor.sensorWidth=e})),c.mc(),c.mc(),c.nc(41,"div",4),c.nc(42,"label"),c.bd(43,"Sensor Height"),c.mc(),c.bd(44," (millimeters) "),c.nc(45,"input",13),c.vc("ngModelChange",(function(e){return t.sensor.sensorHeight=e})),c.mc(),c.mc(),c.nc(46,"div",4),c.nc(47,"label"),c.bd(48,"Wave Length"),c.mc(),c.Zc(49,Yi,2,0,"span",14),c.Zc(50,Xi,2,3,"div",15),c.mc(),c.Zc(51,eo,5,1,"div",16),c.Zc(52,no,4,2,"div",17),c.Zc(53,co,3,0,"div",17),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.message),c.Ub(9),c.Ec("ngModel",t.sensor.name)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.description)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.model)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.sensorType)("disabled","READ"===t.mode),c.Ub(2),c.Ec("ngForOf",t.types),c.Ub(4),c.Ec("ngModel",t.sensor.pixelSizeWidth)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.pixelSizeHeight)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.sensorWidth)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.sensorHeight)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngIf",0===t.sensor.wavelengths.length),c.Ub(1),c.Ec("ngForOf",t.wavelengths),c.Ub(1),c.Ec("ngIf","READ"===t.mode&&null!=t.sensor.platforms&&t.sensor.platforms.length>0),c.Ub(1),c.Ec("ngIf",t.isAdmin&&"WRITE"===t.mode),c.Ub(1),c.Ec("ngIf",t.isAdmin&&"READ"===t.mode))},directives:[Bn.a,i.t,a.z,a.l,a.m,a.c,a.v,a.k,a.n,a.w,a.p,a.y,i.s,a.q,we.a,o.e],encapsulation:2});class oo{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/platform/page",{params:t}).toPromise()}getAll(){let e=new y.g;return this.eventService.start(),this.http.get(acp+"/platform/get-all",{params:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/platform/apply",JSON.stringify({platform:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}function ao(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}oo.ɵfac=function(e){return new(e||oo)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},oo.ɵprov=c.dc({token:oo,factory:oo.ɵfac});class so{constructor(e,t,n){this.service=e,this.router=t,this.modalService=n,this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"Platform",sort:{field:"name",order:1}},this.refresh=new G.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the platform ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/platform",e.oid])}newInstance(){this.router.navigate(["/site/platform","__NEW__"])}}function lo(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",16),c.nc(5,"div"),c.nc(6,"p",17),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function ro(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function po(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.dd("",e.name," ")}}function mo(e,t){1&e&&(c.nc(0,"span",17),c.bd(1," A platform requires at least one sensor "),c.mc())}function ho(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",21),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc(3).updateSelectedSensor(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("value",n.platform.sensors&&-1!==n.platform.sensors.indexOf(e.oid))("label",e.name)}}function uo(e,t){if(1&e&&(c.nc(0,"div",6),c.nc(1,"label"),c.bd(2,"Sensors"),c.mc(),c.Zc(3,mo,2,0,"span",19),c.Zc(4,ho,2,2,"div",20),c.mc()),2&e){const e=c.xc(2);c.Ub(3),c.Ec("ngIf",0===e.platform.sensors.length),c.Ub(1),c.Ec("ngForOf",e.sensors)}}so.ɵfac=function(e){return new(e||so)(c.hc(oo),c.hc(o.b),c.hc(j.b))},so.ɵcmp=c.bc({type:so,selectors:[["platforms"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Platforms"),c.mc(),c.Zc(3,ao,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,Gi.a],styles:["./platforms.css"]});const go=function(e){return["/site/sensor",e]};function bo(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"a",22),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("routerLink",c.Ic(2,go,e)),c.Ub(1),c.cd(n.getSensorName(e))}}function fo(e,t){if(1&e&&(c.nc(0,"div",6),c.nc(1,"label"),c.bd(2,"Sensors"),c.mc(),c.nc(3,"ul"),c.Zc(4,bo,3,4,"li",20),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(4),c.Ec("ngForOf",e.platform.sensors)}}function vo(e,t){if(1&e){const e=c.oc();c.nc(0,"button",26),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function yo(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.Zc(1,vo,2,0,"button",24),c.nc(2,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){c.xc();const e=c.Pc(6),t=c.xc();c.Ub(1),c.Ec("ngIf",!t.newInstance),c.Ub(1),c.Ec("disabled",!e.valid||0===t.platform.sensors.length)}}function ko(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}function xo(e,t){if(1&e){const e=c.oc();c.nc(0,"div",2),c.Zc(1,lo,8,1,"div",3),c.nc(2,"div",4),c.nc(3,"h3"),c.bd(4,"Platform"),c.mc(),c.mc(),c.nc(5,"form",null,5),c.nc(7,"div",6),c.nc(8,"label"),c.bd(9,"Name"),c.mc(),c.nc(10,"input",7),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.name=t})),c.mc(),c.mc(),c.nc(11,"div",6),c.nc(12,"label"),c.bd(13,"Description"),c.mc(),c.nc(14,"textarea",8),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.description=t})),c.bd(15,"      "),c.mc(),c.mc(),c.nc(16,"div",6),c.nc(17,"label"),c.bd(18,"Type"),c.mc(),c.nc(19,"select",9),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.platformTypeOid=t})),c.ic(20,"option"),c.Zc(21,ro,2,2,"option",10),c.mc(),c.mc(),c.nc(22,"div",6),c.nc(23,"label"),c.bd(24,"Manufacturer"),c.mc(),c.nc(25,"select",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.manufacturer=t})),c.ic(26,"option"),c.Zc(27,po,2,2,"option",10),c.mc(),c.mc(),c.Zc(28,uo,5,2,"div",12),c.Zc(29,fo,5,1,"div",12),c.Zc(30,yo,4,2,"div",13),c.Zc(31,ko,3,0,"div",13),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf",null!=e.message),c.Ub(9),c.Ec("ngModel",e.platform.name)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.platform.description)("disabled","READ"===e.mode),c.Ub(5),c.Ec("ngModel",e.platform.platformTypeOid)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.types),c.Ub(4),c.Ec("ngModel",e.platform.manufacturer)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.manufacturers),c.Ub(1),c.Ec("ngIf","WRITE"===e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"WRITE"===e.mode),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"READ"===e.mode)}}class Eo{constructor(e,t,n,c,i,o){this.service=e,this.sensorService=t,this.classificationService=n,this.authService=c,this.route=i,this.router=o,this.isAdmin=!1,this.newInstance=!1,this.message=null,this.manufacturers=[],this.types=[],this.sensors=[],this.mode="READ",this.isAdmin=this.authService.isAdmin()}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.platform=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.platform=e,this.original=JSON.parse(JSON.stringify(this.platform))}),this.classificationService.getAll(Bi.PLATFORM_MANUFACTURER).then(e=>{this.manufacturers=e}),this.classificationService.getAll(Bi.PLATFORM_TYPE).then(e=>{this.types=e}),this.sensorService.getAll().then(e=>{this.sensors=e})}handleOnSubmit(){this.message=null,this.service.apply(this.platform).then(e=>{this.router.navigate(["/site/equipment"])}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.platform=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}updateSelectedSensor(e,t){const n=this.platform.sensors.findIndex(t=>e.oid===t);t?n<0&&this.platform.sensors.push(e.oid):n>-1&&this.platform.sensors.splice(n,1)}getSensorName(e){const t=this.sensors.findIndex(t=>t.oid===e);return-1!==t?this.sensors[t].name:""}error(e){this.message=S.b.getMessageFromError(e)}}function Co(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)("baseUrl",e._metadata.baseUrl)}}Eo.ɵfac=function(e){return new(e||Eo)(c.hc(oo),c.hc(zi),c.hc(Hi),c.hc(A.a),c.hc(o.a),c.hc(o.b))},Eo.ɵcmp=c.bc({type:Eo,selectors:[["platform"]],decls:4,vars:1,consts:[["id","app-container",1,"container"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","platformType","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","manufacturer","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngIf"],["class","btn-holder","style","text-align: right;margin-bottom: 40px;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],["class","error-message",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value","label","valueChange"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right","margin-bottom","40px"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,xo,32,15,"div",1),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.platform))},directives:[Bn.a,i.t,a.z,a.l,a.m,a.c,a.v,a.k,a.n,a.w,a.p,a.y,i.s,we.a,o.e],encapsulation:2});class wo{constructor(e,t,n){this.router=e,this.service=t,this.modalService=n,this._metadata={label:"",title:"",baseUrl:""},this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}set metadata(e){this._metadata.title=e.title,this._metadata.label=e.label,this._metadata.baseUrl=e.baseUrl,this.config={service:this.service,remove:!0,view:!0,create:!0,label:e.label}}ngOnInit(){}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(this._metadata.baseUrl,e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the "+this._metadata.label+" ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/"+this._metadata.baseUrl,e.oid])}newInstance(){this.router.navigate(["/site/"+this._metadata.baseUrl,"__NEW__"])}}function Uo(e,t){if(1&e&&(c.nc(0,"div",8),c.nc(1,"div",9),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",10),c.nc(5,"div"),c.nc(6,"p",11),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Mo(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().classification[n.name]=t})),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("value",t.classification[e.name])("label",e.label)("disabled","READ"===t.mode)}}function Io(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"label"),c.Zc(2,Mo,1,3,"boolean-field",12),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.Ec("ngIf","boolean"===e.type)}}function Oo(e,t){if(1&e){const e=c.oc();c.nc(0,"button",17),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function So(e,t){if(1&e){const e=c.oc();c.nc(0,"div",14),c.Zc(1,Oo,2,0,"button",15),c.nc(2,"button",16),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(8);c.Ub(1),c.Ec("ngIf",!e.newInstance),c.Ub(1),c.Ec("disabled",!t.valid)}}function To(e,t){if(1&e){const e=c.oc();c.nc(0,"div",14),c.nc(1,"button",18),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}wo.ɵfac=function(e){return new(e||wo)(c.hc(o.b),c.hc(Hi),c.hc(j.b))},wo.ɵcmp=c.bc({type:wo,selectors:[["classifications"]],inputs:{metadata:"metadata"},decls:4,vars:2,consts:[[3,"cols","config","refresh","baseUrl","click",4,"ngIf"],[3,"cols","config","refresh","baseUrl","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h4"),c.bd(2),c.mc(),c.Zc(3,Co,1,4,"generic-table",0),c.mc()),2&e&&(c.Ub(2),c.cd(t._metadata.title),c.Ub(1),c.Ec("ngIf",null!=t.config))},directives:[i.t,Gi.a],styles:["./classifications.css"]});class Ro{constructor(e,t,n){this.service=e,this.route=t,this.router=n,this.newInstance=!1,this.message=null,this.mode="READ"}ngOnInit(){this.route.data.subscribe(e=>{this.metadata=e;const t=this.route.snapshot.params.oid;"__NEW__"===t?this.service.newInstance(this.metadata.baseUrl).then(e=>{this.classification=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(this.metadata.baseUrl,t).then(e=>{this.classification=e,this.original=JSON.parse(JSON.stringify(this.classification))})})}handleOnSubmit(){this.message=null,this.service.apply(this.metadata.baseUrl,this.classification).then(e=>{this.classification=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/"+this.metadata.baseUrl,e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.classification=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}error(e){this.message=S.b.getMessageFromError(e)}}Ro.ɵfac=function(e){return new(e||Ro)(c.hc(Hi),c.hc(o.a),c.hc(o.b))},Ro.ɵcmp=c.bc({type:Ro,selectors:[["classification"]],decls:16,vars:7,consts:[["id","app-container",1,"container"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","label","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value","label","disabled","valueChange",4,"ngIf"],[3,"value","label","disabled","valueChange"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,Uo,8,1,"div",1),c.nc(4,"div",2),c.nc(5,"h3"),c.bd(6),c.mc(),c.mc(),c.nc(7,"form",null,3),c.nc(9,"div",4),c.nc(10,"label"),c.bd(11,"Name"),c.mc(),c.nc(12,"input",5),c.vc("ngModelChange",(function(e){return t.classification.name=e})),c.mc(),c.mc(),c.Zc(13,Io,3,1,"div",6),c.Zc(14,So,4,2,"div",7),c.Zc(15,To,3,0,"div",7),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.message),c.Ub(3),c.cd(t.metadata.title),c.Ub(6),c.Ec("ngModel",t.classification.name)("disabled","READ"===t.mode),c.Ub(1),c.Ec("ngForOf",t.metadata.columns),c.Ub(1),c.Ec("ngIf","WRITE"===t.mode),c.Ub(1),c.Ec("ngIf","READ"===t.mode))},directives:[Bn.a,i.t,a.z,a.l,a.m,a.c,a.v,a.k,a.n,i.s,we.a],encapsulation:2});const Po=function(e,t){return{"fa-chevron-down":e,"fa-chevron-right":t}},Fo=function(){return{title:"",label:"type",baseUrl:"/sensor-type"}},No=function(){return{title:"",label:"wave length",baseUrl:"/wave-length"}},Do=function(){return{title:"Platform Type",label:"type",baseUrl:"/platform-type"}},Ao=function(){return{title:"Platform Manufacturer",label:"manufacturer",baseUrl:"/platform-manufacturer"}};class Zo{constructor(e){this.modalService=e,this.isSensorTypeCollapsed=!0,this.isSensorWavelengthCollapsed=!0,this.isPlatformTypeCollapsed=!0,this.isPlatformManufacturerCollapsed=!0}ngOnInit(){}}Zo.ɵfac=function(e){return new(e||Zo)(c.hc(j.b))},Zo.ɵcmp=c.bc({type:Zo,selectors:[["equipment"]],decls:41,vars:28,consts:[["id","app-container",1,"container"],[2,"padding","20px","border","solid 1px lightgrey","background","#efefef"],[3,"click"],[1,"fa","fa-fw","collapsible-link",3,"ngClass"],["id","sensorTypeCollabseContainer",3,"collapse"],[3,"metadata"],["id","sensorWavelengthCollabseContainer",3,"collapse"],["id","platformTypeCollabseContainer",3,"collapse"],["id","platformManufacturerCollabseContainer",3,"collapse"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.nc(3,"h2"),c.bd(4,"Equipment Management"),c.mc(),c.nc(5,"h3"),c.bd(6,"Sensor Options"),c.mc(),c.nc(7,"section",1),c.nc(8,"a",2),c.vc("click",(function(){return t.isSensorTypeCollapsed=!t.isSensorTypeCollapsed})),c.nc(9,"h4"),c.ic(10,"i",3),c.bd(11,"Sensor Types"),c.mc(),c.mc(),c.nc(12,"div",4),c.ic(13,"classifications",5),c.mc(),c.nc(14,"a",2),c.vc("click",(function(){return t.isSensorWavelengthCollapsed=!t.isSensorWavelengthCollapsed})),c.nc(15,"h4"),c.ic(16,"i",3),c.bd(17,"Wave Lengths"),c.mc(),c.mc(),c.nc(18,"div",6),c.ic(19,"classifications",5),c.mc(),c.mc(),c.ic(20,"sensors"),c.ic(21,"br"),c.ic(22,"br"),c.nc(23,"h3"),c.bd(24,"Plaform Options"),c.mc(),c.nc(25,"section",1),c.nc(26,"a",2),c.vc("click",(function(){return t.isPlatformTypeCollapsed=!t.isPlatformTypeCollapsed})),c.nc(27,"h4"),c.ic(28,"i",3),c.bd(29,"Platform Types"),c.mc(),c.mc(),c.nc(30,"div",7),c.ic(31,"classifications",5),c.mc(),c.nc(32,"a",2),c.vc("click",(function(){return t.isPlatformManufacturerCollapsed=!t.isPlatformManufacturerCollapsed})),c.nc(33,"h4"),c.ic(34,"i",3),c.bd(35,"Platform Manufacturer"),c.mc(),c.mc(),c.nc(36,"div",8),c.ic(37,"classifications",5),c.mc(),c.mc(),c.ic(38,"platforms"),c.ic(39,"br"),c.ic(40,"br"),c.mc(),c.mc()),2&e&&(c.Ub(10),c.Ec("ngClass",c.Jc(12,Po,!t.isSensorTypeCollapsed,t.isSensorTypeCollapsed)),c.Ub(2),c.Ec("collapse",t.isSensorTypeCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(15,Fo)),c.Ub(3),c.Ec("ngClass",c.Jc(16,Po,!t.isSensorWavelengthCollapsed,t.isSensorWavelengthCollapsed)),c.Ub(2),c.Ec("collapse",t.isSensorWavelengthCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(19,No)),c.Ub(9),c.Ec("ngClass",c.Jc(20,Po,!t.isPlatformTypeCollapsed,t.isPlatformTypeCollapsed)),c.Ub(2),c.Ec("collapse",t.isPlatformTypeCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(23,Do)),c.Ub(3),c.Ec("ngClass",c.Jc(24,Po,!t.isPlatformManufacturerCollapsed,t.isPlatformManufacturerCollapsed)),c.Ub(2),c.Ec("collapse",t.isPlatformManufacturerCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(27,Ao)))},directives:[Bn.a,i.q,u.a,wo,qi,so],styles:[".collapsible-link[_ngcontent-%COMP%] {\n  font-size: 15px;\n}"]});class jo{validate(e){return(t=new RegExp(/[\W<>\-+=!@#$%^&*?/\\']/gm),e=>t.test(e.value)?{forbiddenName:{value:e.value}}:null)(e);var t}}jo.ɵfac=function(e){return new(e||jo)},jo.ɵdir=c.cc({type:jo,selectors:[["","forbiddenName",""]],features:[c.Tb([{provide:a.h,useExisting:jo,multi:!0}])]});class Lo{constructor(e){this.el=e}onKeyDown(e){let t=e;if(this.OnlyNumber){if(-1!==[46,8,9,27,13,110,190].indexOf(t.keyCode)||65==t.keyCode&&!0===t.ctrlKey||67==t.keyCode&&!0===t.ctrlKey||88==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39)return;(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}}}Lo.ɵfac=function(e){return new(e||Lo)(c.hc(c.r))},Lo.ɵdir=c.cc({type:Lo,selectors:[["","OnlyNumber",""]],hostBindings:function(e,t){1&e&&c.vc("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{OnlyNumber:"OnlyNumber"}});class _o{canDeactivate(e){return!e.canDeactivate()||!!confirm("An upload is currently in progress. Are you sure you want to leave?")}}_o.ɵfac=function(e){return new(e||_o)},_o.ɵprov=c.dc({token:_o,factory:_o.ɵfac});var $o=n(133);function zo(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}class Bo{constructor(e,t,n){this.service=e,this.router=t,this.modalService=n,this.message=null,this.cols=[{header:"Serial Number",field:"serialNumber",type:"TEXT",sortable:!0},{header:"FAA Id Number",field:"faaNumber",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"Bureau",field:"bureau",type:"TEXT",sortable:!0},{header:"Platform",field:"platform",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"UAV"},this.refresh=new G.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the UAV ["+e.serialNumber+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/uav",e.oid])}newInstance(){this.router.navigate(["/site/uav","__NEW__"])}}Bo.ɵfac=function(e){return new(e||Bo)(c.hc(gn),c.hc(o.b),c.hc(j.b))},Bo.ɵcmp=c.bc({type:Bo,selectors:[["uavs"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"UAVs"),c.mc(),c.Zc(3,zo,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,Gi.a],styles:["./uavs.css"]});class Go{constructor(){}ngOnInit(){}}Go.ɵfac=function(e){return new(e||Go)},Go.ɵcmp=c.bc({type:Go,selectors:[["uavs-page"]],decls:4,vars:0,consts:[["id","app-container",1,"container"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.ic(3,"uavs"),c.mc(),c.mc())},directives:[Bn.a,Bo],encapsulation:2});var Vo=n(101);function qo(e,t){if(1&e&&(c.nc(0,"div",15),c.nc(1,"div",16),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",17),c.nc(5,"div"),c.nc(6,"p",18),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Ho(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function Jo(e,t){if(1&e){const e=c.oc();c.nc(0,"select",19),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).uav.platform=t})),c.ic(1,"option"),c.Zc(2,Ho,2,2,"option",13),c.mc()}if(2&e){const e=c.xc(2);c.Ec("ngModel",e.uav.platform),c.Ub(2),c.Ec("ngForOf",e.platforms)}}const Wo=function(e){return["/site/platform",e]};function Yo(e,t){if(1&e&&(c.nc(0,"div"),c.nc(1,"a",22),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("routerLink",c.Ic(2,Wo,e.oid)),c.Ub(1),c.cd(e.name)}}function Xo(e,t){if(1&e&&(c.lc(0),c.Zc(1,Yo,3,4,"div",21),c.yc(2,"filter"),c.kc()),2&e){const e=c.xc(2);c.Ub(1),c.Ec("ngForOf",c.Bc(2,1,e.platforms,"oid",e.uav.platform))}}function Ko(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.dd(" ",e.label," ")}}function Qo(e,t){if(1&e){const e=c.oc();c.nc(0,"button",26),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function ea(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.Zc(1,Qo,2,0,"button",24),c.nc(2,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){c.xc();const e=c.Pc(6),t=c.xc();c.Ub(1),c.Ec("ngIf",!t.newInstance),c.Ub(1),c.Ec("disabled",!e.valid)}}function ta(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}function na(e,t){if(1&e){const e=c.oc();c.nc(0,"div",2),c.Zc(1,qo,8,1,"div",3),c.nc(2,"div",4),c.nc(3,"h3"),c.bd(4,"UAV"),c.mc(),c.mc(),c.nc(5,"form",null,5),c.nc(7,"div",6),c.nc(8,"label"),c.bd(9,"Platform"),c.mc(),c.Zc(10,Jo,3,2,"select",7),c.Zc(11,Xo,3,5,"ng-container",8),c.mc(),c.nc(12,"div",6),c.nc(13,"label"),c.bd(14,"Serial Number"),c.mc(),c.nc(15,"input",9),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.serialNumber=t})),c.mc(),c.mc(),c.nc(16,"div",6),c.nc(17,"label"),c.bd(18,"FAA Number"),c.mc(),c.nc(19,"input",10),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.faaNumber=t})),c.mc(),c.mc(),c.nc(20,"div",6),c.nc(21,"label"),c.bd(22,"Description"),c.mc(),c.nc(23,"textarea",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.description=t})),c.mc(),c.mc(),c.nc(24,"div",6),c.nc(25,"label"),c.bd(26,"Bureau"),c.mc(),c.nc(27,"select",12),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.bureau=t})),c.ic(28,"option"),c.Zc(29,Ko,2,2,"option",13),c.mc(),c.mc(),c.Zc(30,ea,4,2,"div",14),c.Zc(31,ta,3,0,"div",14),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf",null!=e.message),c.Ub(9),c.Ec("ngIf","READ"!==e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.serialNumber)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.faaNumber)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.description)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.bureau)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.bureaus),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"WRITE"===e.mode),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"READ"===e.mode)}}class ca{constructor(e,t,n,c,i){this.service=e,this.platformService=t,this.authService=n,this.route=c,this.router=i,this.isAdmin=!1,this.newInstance=!1,this.message=null,this.bureaus=[],this.platforms=[],this.mode="READ",this.isAdmin=this.authService.isAdmin()}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.uav=e.uav,this.bureaus=e.bureaus,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.uav=e.uav,this.bureaus=e.bureaus,this.original=JSON.parse(JSON.stringify(this.uav))}),this.platformService.getAll().then(e=>{this.platforms=e})}handleOnSubmit(){this.message=null,this.service.apply(this.uav).then(e=>{this.uav=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/uav",e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.uav=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}error(e){this.message=S.b.getMessageFromError(e)}}ca.ɵfac=function(e){return new(e||ca)(c.hc(gn),c.hc(oo),c.hc(A.a),c.hc(o.a),c.hc(o.b))},ca.ɵcmp=c.bc({type:ca,selectors:[["uav"]],decls:4,vars:1,consts:[["id","app-container",1,"container"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","platform","type","input","class","form-control","required","",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["name","serialNumber","type","input","placeholder","Serial Number","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","faaNumber","type","input","placeholder","FAA Number","required","","max","10","maxlength","10",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","bureau","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],["name","platform","type","input","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],[4,"ngFor","ngForOf"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,na,32,14,"div",1),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.uav))},directives:[Bn.a,i.t,a.z,a.l,a.m,a.c,a.v,a.k,a.n,a.f,a.w,a.p,a.y,i.s,o.e],pipes:[Vo.a],encapsulation:2});class ia{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/collection-report/page",{params:t}).toPromise()}}ia.ɵfac=function(e){return new(e||ia)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},ia.ɵprov=c.dc({token:ia,factory:ia.ɵfac});var oa=n(321);function aa(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",4),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)}}class sa{constructor(e,t,n){this.service=e,this.pService=t,this.modalService=n,this.message=null,this.cols=[{header:"Collection",field:"collectionName",baseUrl:"site/viewer/collection",urlField:"collection",type:"URL",sortable:!0,columnType:e=>e.exists?"URL":"TEXT"},{header:"Collection Owner",field:"userName",type:"TEXT",sortable:!0},{header:"Collection Date",field:"collectionDate",type:"DATE",sortable:!0},{header:"Mission",field:"missionName",type:"TEXT",sortable:!0},{header:"Project",field:"projectName",type:"TEXT",sortable:!0},{header:"Site",field:"siteName",type:"TEXT",sortable:!0},{header:"Latitude",field:"siteLatDecimalDegree",type:"NUMBER",sortable:!1,filter:!1},{header:"Longitude",field:"siteLongDecimalDegree",type:"NUMBER",sortable:!1,filter:!1},{header:"Bureau",field:"bureauName",type:"TEXT",sortable:!0},{header:"Platform",field:"platformName",type:"TEXT",sortable:!0},{header:"Sensor",field:"sensorName",type:"TEXT",sortable:!0},{header:"FAA Id Number",field:"faaIdNumber",type:"TEXT",sortable:!0},{header:"Serial Number",field:"serialNumber",type:"TEXT",sortable:!0},{header:"ODM Processing",field:"odmProcessing",type:"TEXT",sortable:!1},{header:"RAW Images Count",field:"rawImagesCount",type:"NUMBER",sortable:!1},{header:"EROS Metadata Complete",field:"erosMetadataComplete",type:"BOOLEAN",sortable:!1},{header:"Video",field:"video",type:"BOOLEAN",sortable:!1},{header:"Orthomosaic",field:"orthomosaic",type:"BOOLEAN",sortable:!1},{header:"Point Cloud",field:"pointCloud",type:"BOOLEAN",sortable:!1},{header:"Hillshade",field:"hillshade",type:"BOOLEAN",sortable:!1},{header:"Products Shared",field:"productsShared",type:"BOOLEAN",sortable:!1},{header:"Storage size",field:"allStorageSize",type:"NUMBER",sortable:!0,filter:!1},{header:"Number of Downloads",field:"downloadCounts",type:"NUMBER",sortable:!0,filter:!1},{header:"Date of Create",field:"createDate",type:"DATE",sortable:!0,filter:!1},{header:"Date of Delete",field:"deleteDate",type:"DATE",sortable:!0,filter:!1},{header:"Product",field:"product",text:"View Product",type:"CONSTANT",sortable:!1,columnType:e=>null==e.product||0===e.product.length?"NONE":"CONSTANT"},{header:"Map Services",field:"productURLs",type:"STRING-ARRAY",sortable:!1,columnType:e=>null==e.product||0===e.product.length?"NONE":"STRING-ARRAY"}]}ngOnInit(){this.config={service:this.service,remove:!1,view:!1,create:!1,label:"row"}}onExportCSV(){window.open(acp+"/collection-report/export-csv","_blank")}onClick(e){if("custom"===e.type&&"product"===e.col.field){const t=e.row.product;null!=t&&t.length>0&&this.pService.getDetail(t,1,20).then(e=>{this.modalService.show(Nt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}).content.init(e)})}}}sa.ɵfac=function(e){return new(e||sa)(c.hc(ia),c.hc(gt),c.hc(oa.a))},sa.ɵcmp=c.bc({type:sa,selectors:[["reports"]],decls:9,vars:1,consts:[["id","app-container",1,"container-fluid"],[1,"row"],["type","submit","value","Export CSV",1,"btn","btn-primary","pull-right",2,"margin-bottom","10px","margin-right","10px",3,"click"],[3,"cols","config","click",4,"ngIf"],[3,"cols","config","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.nc(3,"h2"),c.bd(4,"Report"),c.mc(),c.nc(5,"div",1),c.nc(6,"input",2),c.vc("click",(function(){return t.onExportCSV()})),c.mc(),c.mc(),c.nc(7,"div",1),c.Zc(8,aa,1,2,"generic-table",3),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(8),c.Ec("ngIf",null!=t.config))},directives:[Bn.a,i.t,Gi.a],styles:["./reports.css"]});const la=[{path:"",canActivate:[$o.b],component:Oc},{path:"viewer",canActivate:[$o.b],component:Oc},{path:"viewer/:action/:oid",canActivate:[$o.b],component:Oc},{path:"upload",component:zc,canDeactivate:[_o]},{path:"tasks",canActivate:[$o.b],component:$i},{path:"report",canActivate:[$o.b],component:sa},{path:"sensor/:oid",canActivate:[$o.b],component:io},{path:"platform/:oid",canActivate:[$o.b],component:Eo},{path:"platform-manufacturer/:oid",canActivate:[$o.a],component:Ro,data:{title:"Platform Manufacturer",label:"manufacturer",baseUrl:Bi.PLATFORM_MANUFACTURER}},{path:"platform-type/:oid",canActivate:[$o.a],component:Ro,data:{title:"Platform Type",label:"type",baseUrl:Bi.PLATFORM_TYPE}},{path:"sensor-type/:oid",canActivate:[$o.a],component:Ro,data:{title:"Sensor Type",label:"type",baseUrl:Bi.SENSOR_TYPE,columns:[{name:"isMultispectral",label:"Is Multispectral",type:"boolean"}]}},{path:"wave-length/:oid",canActivate:[$o.a],component:Ro,data:{title:"Wave Length",label:"wave length",baseUrl:Bi.WAVE_LENGTH}},{path:"uavs",canActivate:[$o.a],component:Go},{path:"uav/:oid",canActivate:[$o.b],component:ca},{path:"equipment",canActivate:[$o.a],component:Zo,data:{}}];class ra{}ra.ɵmod=c.fc({type:ra}),ra.ɵinj=c.ec({factory:function(e){return new(e||ra)},providers:[{provide:i.o,useClass:i.h}],imports:[[o.f.forChild(la)],o.f]}),("undefined"==typeof ngJitMode||ngJitMode)&&c.Vc(ra,{imports:[o.f],exports:[o.f]});var da=n(102),pa=n(39),ma=n(21),ha=n(103),ua=n(36),ga=n(63),ba=n(99),fa=n(64),va=n(104),ya=n(28),ka=n(105);class xa{}xa.ɵmod=c.fc({type:xa}),xa.ɵinj=c.ec({factory:function(e){return new(e||xa)},providers:[_o,Z,gt,x,zi,oo,te,Hi,gn,ia],imports:[[i.c,o.f,a.e,h.a,m.b,l.c,r.c,d.b,p.d.forRoot(),u.b.forRoot(),da.a,ra,s.b]]}),("undefined"==typeof ngJitMode||ngJitMode)&&c.Vc(xa,{declarations:[I,qt,on,W,B,_n,Ee,De,je,ut,hn,Nt,Oc,zc,$i,jo,Lo,io,qi,Eo,so,ii,wo,Ro,Bo,Go,ca,Cn,sa,Zo],imports:[i.c,o.f,a.e,h.a,m.b,l.c,r.c,d.b,p.d,u.b,da.a,ra,s.b]}),c.Uc(W,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,o.g,o.c,o.e,o.d,o.h,a.z,a.p,a.y,a.c,a.q,a.t,a.a,a.w,a.x,a.s,a.k,a.l,a.v,a.g,a.f,a.r,a.b,a.d,a.n,a.o,a.m,h.c,h.d,m.a,l.b,l.d,l.a,r.a,r.b,d.a,d.c,p.b,p.e,p.c,p.a,u.a,Bn.a,pa.a,O.a,un.a,Sc.a,we.a,ma.a,ha.a,ua.a,ga.a,ba.a,fa.a,Gi.a,s.a,s.c,I,qt,on,W,B,_n,Ee,De,je,ut,hn,Nt,Oc,zc,$i,jo,Lo,io,qi,Eo,so,ii,wo,Ro,Bo,Go,ca,Cn,sa,Zo],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,h.b,va.a,ya.a,ka.a,Vo.a,L.a,Le.a]),c.Uc(Ee,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,o.g,o.c,o.e,o.d,o.h,a.z,a.p,a.y,a.c,a.q,a.t,a.a,a.w,a.x,a.s,a.k,a.l,a.v,a.g,a.f,a.r,a.b,a.d,a.n,a.o,a.m,h.c,h.d,m.a,l.b,l.d,l.a,r.a,r.b,d.a,d.c,p.b,p.e,p.c,p.a,u.a,Bn.a,pa.a,O.a,un.a,Sc.a,we.a,ma.a,ha.a,ua.a,ga.a,ba.a,fa.a,Gi.a,s.a,s.c,I,qt,on,W,B,_n,Ee,De,je,ut,hn,Nt,Oc,zc,$i,jo,Lo,io,qi,Eo,so,ii,wo,Ro,Bo,Go,ca,Cn,sa,Zo],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,h.b,va.a,ya.a,ka.a,Vo.a,L.a,Le.a])}}]);
//# sourceMappingURL=2.chunk.js.map
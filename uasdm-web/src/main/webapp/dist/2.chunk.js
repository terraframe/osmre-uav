(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{208:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteModule",(function(){return ka}));var c=n(0),i=n(3),a=n(11),o=n(5),s=n(381),l=n(19),r=n(30),d=n(32),p=n(81),m=n(35),h=n(113),u=n(26),g=n(205),b=n(206),f=n(207),v=n(8),y=n(13);const k="pk.eyJ1IjoidGVycmFmcmFtZSIsImEiOiJjanZxNTFnaTYyZ2RuNDlxcmNnejNtNjN6In0.-kmlS8Tgb2fNc1NPb5rJEQ";class x{constructor(e){this.http=e,g.accessToken=k}features(){let e=new y.g;return this.http.get(acp+"/project/features",{params:e}).toPromise()}mbForwardGeocode(e){let t=new y.g,n="https://api.mapbox.com/geocoding/v5/mapbox.places/"+e+".json?proximity=-74.70850,40.78375&access_token="+k;return this.http.get(n,{params:t}).toPromise()}}function C(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",13),c.mc())}function E(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",14),c.mc())}function w(e,t){if(1&e&&(c.nc(0,"span"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.label," / ")}}function M(e,t){if(1&e&&(c.Zc(0,C,2,0,"span",11),c.Zc(1,E,2,0,"span",11),c.nc(2,"span"),c.Zc(3,w,2,1,"span",12),c.mc(),c.nc(4,"b"),c.bd(5),c.mc()),2&e){const e=t.match;c.Ec("ngIf",null==e.item.filename),c.Ub(1),c.Ec("ngIf",null!=e.item.filename),c.Ub(2),c.Ec("ngForOf",e.item.hierarchy),c.Ub(2),c.cd(e.item.label)}}x.ɵfac=function(e){return new(e||x)(c.rc(y.c))},x.ɵprov=c.dc({token:x,factory:x.ɵfac});const O=function(){return{standalone:!0}};class U{constructor(e){this.mapService=e,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.center=new g.LngLat(-78.880453,42.897852),this.zoom=2,this.coordinate={longitude:null,latitude:null},this.search="",this.dataSource=v.a.create(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const n=t.features;let c=[];n.forEach(e=>{let t={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};c.push(t)}),e.next(c)})})}ngOnInit(){this.refreshCoordinateFromMap()}ngAfterViewInit(){let e={container:"map-attribute-div",style:"mapbox://styles/mapbox/outdoors-v11",zoom:this.zoom,center:this.center};null!=this.site.geometry&&(e.center=this.site.geometry.coordinates),this.map=new g.Map(e),this.map.on("load",()=>{this.initMap()})}ngOnDestroy(){this.map.remove()}initMap(){let e=b.modes;e.static=f,this.draw=new b({modes:e,displayControlsDefault:!1,controls:{static:!0}}),this.map.addControl(this.draw),this.map.addControl(new g.NavigationControl),this.map.on("draw.update",e=>{this.onDrawUpdate(e)}),this.map.on("draw.create",e=>{this.onDrawCreate(e)}),this.map.on("draw.modechange",e=>{this.onDrawUpdate(e)}),this.map.on("style.load",()=>{this.addLayers()}),this.addLayers()}addLayers(){if(null!=this.site.geometry){let e={id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry};this.draw.add(e),this.draw.changeMode("simple_select",{featureIds:[e.id]})}else this.draw.changeMode("draw_point",{});this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}})}onDrawUpdate(e){"move"===e.action&&null!=e.features&&e.features.length>0&&this.updateGeometry(e.features[0])}onDrawCreate(e){if(null!=e.features&&e.features.length>0){let t=e.features[0];t.id=this.site.id,this.updateGeometry(t)}}updateGeometry(e){this.site.geometry=e.geometry,this.refreshCoordinateFromMap()}refreshCoordinateFromMap(){null!=this.site&&null!=this.site.geometry&&(this.coordinate.longitude=this.site.geometry.coordinates[0],this.coordinate.latitude=this.site.geometry.coordinates[1])}refreshCoordinateFromInput(){if(null!=this.coordinate.longitude&&null!=this.coordinate.latitude){console.log(this.site.geometry),null==this.site.geometry&&(this.site.geometry={type:"Point"}),this.site.geometry.coordinates=[this.coordinate.longitude,this.coordinate.latitude];var e=this.draw.set({type:"FeatureCollection",features:[{id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry}]});this.draw.changeMode("simple_select",{featureIds:e})}}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}handleClick(e){let t=e.item;t.center&&this.map.flyTo({center:t.center,zoom:9})}}U.ɵfac=function(e){return new(e||U)(c.hc(x))},U.ɵcmp=c.bc({type:U,selectors:[["map-attribute"]],inputs:{site:"site",center:"center",zoom:"zoom"},decls:23,vars:9,consts:[[1,"row-holder"],[1,"label-holder"],[1,"holder"],[1,"modal-body"],["id","search-container",2,"position","absolute","z-index","999","padding","15px","width","35%"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],["id","map-attribute-div",1,"map-view-port",2,"height","300px"],[1,"modal-body","text-left"],["name","longitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["name","latitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["bsItemTemplate",""],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(c.nc(0,"div",0),c.ic(1,"div",1),c.nc(2,"div",2),c.nc(3,"div",3),c.nc(4,"div",4),c.nc(5,"input",5),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.ic(6,"div",6),c.mc(),c.mc(),c.mc(),c.nc(7,"div",0),c.nc(8,"div",1),c.nc(9,"label"),c.bd(10,"Longitude"),c.mc(),c.mc(),c.nc(11,"div",2),c.nc(12,"div",7),c.nc(13,"input",8),c.vc("ngModelChange",(function(e){return t.coordinate.longitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",0),c.nc(15,"div",1),c.nc(16,"label"),c.bd(17,"Latitude"),c.mc(),c.mc(),c.nc(18,"div",2),c.nc(19,"div",7),c.nc(20,"input",9),c.vc("ngModelChange",(function(e){return t.coordinate.latitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(21,M,6,4,"ng-template",null,10,c.ad)),2&e){const e=c.Pc(22);c.Ub(5),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",c.Hc(8,O)),c.Ub(8),c.Ec("ngModel",t.coordinate.longitude),c.Ub(7),c.Ec("ngModel",t.coordinate.latitude)}},directives:[o.c,o.k,o.n,r.b,o.q,o.v,i.t,i.s],encapsulation:2});var S=n(54),I=n(83),T=n(140),R=n(386),P=n(390),F=n(387),N=n(168),D=n(34),A=n(27);class j{constructor(e,t,n,c){this.http=e,this.noErrorHttpClient=t,this.eventService=n,this.authService=c}getChildren(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/get-children",{params:t}).toPromise()}getObjects(e,t,n,c){let i=new y.g;return i=i.set("id",e),null!=t&&(i=i.set("key",t)),null!=n&&(i=i.set("pageNumber",n.toString())),null!=c&&(i=i.set("pageSize",c.toString())),this.http.get(acp+"/project/objects",{params:i}).toPromise()}view(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/view",{params:t}).toPromise()}getItems(e,t){let n=new y.g;return n=n.set("id",e),null!=t&&(n=n.set("key",t)),this.http.get(acp+"/project/items",{params:n}).toPromise()}roots(e,t){let n=new y.g;return null!=e&&(n=n.set("id",e)),null!=t&&(n=n.set("bounds",JSON.stringify(t))),this.http.get(acp+"/project/roots",{params:n}).toPromise()}edit(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/edit",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}setExclude(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/set-exclude",JSON.stringify({id:e,exclude:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}runOrtho(e){let t=new y.f({"Content-Type":"application/json"});return this.http.post(acp+"/project/run-ortho",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{})).toPromise()}update(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/update",JSON.stringify({entity:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newChild(e,t){let n="/project/new-default-child",c=new y.f({"Content-Type":"application/json"}),i={};return null!=e&&(i.parentId=e),t&&(i.type=t,n="/project/new-child"),this.eventService.start(),this.http.post(acp+n,JSON.stringify(i),{headers:c}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}applyWithParent(e,t){let n=new y.f({"Content-Type":"application/json"}),c={entity:e};return null!=t&&(c.parentId=t),this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/apply-with-parent",JSON.stringify(c),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}getCurrentUser(){return this.authService.getUserName()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}removeObject(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/removeObject",JSON.stringify({id:e,key:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}removeTask(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove-task",JSON.stringify({uploadId:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}upload(e,t,n){this.eventService.start();const c=new FormData;return c.append("file",n),c.append("id",e),c.append("folder",t),this.http.post(acp+"/project/upload",c).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}tasks(e,t,n,c){let i=new y.g;return i=i.set("statuses",JSON.stringify(e)),i=i.set("pageSize",t.toString()),i=i.set("pageNumber",n.toString()),i=i.set("token",c.toString()),this.http.get(acp+"/project/tasks",{params:i}).toPromise()}getTasks(e){let t=new y.g;return t=t.set("collectionId",e),this.http.get(acp+"/project/collection-tasks",{params:t}).toPromise()}task(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/task",{params:t}).toPromise()}getMissingMetadata(e,t){let n=new y.g;return n=n.set("pageSize",e.toString()),n=n.set("pageNumber",t.toString()),this.http.get(acp+"/project/missing-metadata",{params:n}).toPromise()}download(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("key",t),n&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download",{params:c,responseType:"blob"}).pipe(Object(T.a)(()=>{n&&this.eventService.complete()}))}downloadAll(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("key",t),n&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download-all",{params:c,responseType:"blob"}).pipe(Object(T.a)(()=>{n&&this.eventService.complete()}))}search(e){return e.pipe(Object(R.a)(400)).pipe(Object(P.a)()).pipe(Object(F.a)(e=>this.searchEntries(e)))}searchEntries(e){let t=new y.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t})}searchEntites(e){let t=new y.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t}).toPromise()}submitCollectionMetadata(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/submit-metadata",JSON.stringify({collectionId:e,json:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}pushToEros(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/eros/push",JSON.stringify({collectionId:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}getMetadataOptions(e){let t=new y.g;return null!=e&&(t=t.set("id",e)),this.noErrorHttpClient.get(acp+"/project/metadata-options",{params:t}).toPromise()}getUAVMetadata(e,t){let n=new y.g;return n=n.set("uavId",e),n=n.set("sensorId",t),this.noErrorHttpClient.get(acp+"/project/uav-metadata",{params:n}).toPromise()}evaluate(e,t){return null!=e&&"eq"===e.type?t[e.name]===e.value:null!=e&&"admin"===e.type&&this.authService.isAdmin()}}j.ɵfac=function(e){return new(e||j)(c.rc(y.c),c.rc(N.a),c.rc(D.a),c.rc(A.a))},j.ɵprov=c.dc({token:j,factory:j.ɵfac});var Z=n(15),_=n(98);function L(e,t){if(1&e&&(c.nc(0,"div",7),c.nc(1,"div",8),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",9),c.nc(5,"div"),c.nc(6,"p",10),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function $(e,t){1&e&&(c.nc(0,"p",11),c.bd(1,"Loading image..."),c.mc())}function z(e,t){if(1&e&&(c.ic(0,"img",12),c.yc(1,"safeHtml")),2&e){const e=c.xc();c.Ec("src",c.zc(1,1,e.imageToShow),c.Tc)}}class B{constructor(e,t){this.service=e,this.bsModalRef=t,this.message=null,this.open=!0,this.loading=!0}init(e,t){this.component=e,this.key=t,this.getImage(this.component,this.key)}createImageFromBlob(e){let t=new FileReader;t.addEventListener("load",()=>{this.imageToShow=t.result},!1),e&&t.readAsDataURL(e)}getImage(e,t){this.loading=!0,this.service.download(e,t,!1).subscribe(e=>{this.createImageFromBlob(e),this.loading=!1},e=>{this.loading=!1,this.error(e)})}close(){this.open=!1}error(e){this.message=I.b.getMessageFromError(e)}}B.ɵfac=function(e){return new(e||B)(c.hc(j),c.hc(Z.a))},B.ɵcmp=c.bc({type:B,selectors:[["image-preview-modal"]],decls:7,vars:3,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"image-preview-container"],[1,"fa","fa-times","btn","btn-close",2,"min-width","0",3,"click"],[1,"image-container"],["style","text-align: left;",4,"ngIf"],["class","image-preview img-responsive center-block","alt","Image",3,"src",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[2,"text-align","left"],["alt","Image",1,"image-preview","img-responsive","center-block",3,"src"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.Zc(1,L,8,1,"div",1),c.nc(2,"div",2),c.nc(3,"i",3),c.vc("click",(function(){return t.bsModalRef.hide()})),c.mc(),c.nc(4,"div",4),c.Zc(5,$,2,0,"p",5),c.Zc(6,z,2,3,"img",6),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(1),c.Ec("ngIf",null!=t.message),c.Ub(4),c.Ec("ngIf",t.loading),c.Ub(1),c.Ec("ngIf",!t.loading))},directives:[i.t],pipes:[_.a],encapsulation:2});var q=n(23);class H{}const W=["Natural Color RGB","Thermal","Red Edge","Near Infra Red","LiDAR","Other"];class G{constructor(e){this.el=e}onKeyDown(e){let t=e;if(this.OnlyNumber){if(-1!==[46,8,9,27,13,110,190].indexOf(t.keyCode)||65==t.keyCode&&!0===t.ctrlKey||67==t.keyCode&&!0===t.ctrlKey||88==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39)return;(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}}}G.ɵfac=function(e){return new(e||G)(c.hc(c.r))},G.ɵdir=c.cc({type:G,selectors:[["","OnlyNumber",""]],hostBindings:function(e,t){1&e&&c.vc("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{OnlyNumber:"OnlyNumber"}});var V=n(80);function J(e,t){if(1&e&&(c.nc(0,"div",46),c.nc(1,"div",47),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",48),c.nc(5,"div"),c.nc(6,"p",49),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function X(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",50),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().updateSelectedWaveLength(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("value",n.metaObject.sensor.wavelength&&-1!==n.metaObject.sensor.wavelength.indexOf(e))("label",e)}}class Y{constructor(e,t){this.bsModalRef=e,this.service=t,this.message=null,this.disabled=!1,this.metaObject={pointOfContact:{name:"",email:""},platform:{otherName:"",class:"",type:"",serialNumber:"",faaIdNumber:""},sensor:{otherName:"",type:"",model:"",wavelength:[],sensorWidth:"",sensorWidthUnits:"mm",sensorHeight:"",sensorHeightUnits:"mm",pixelSizeWidth:"",pixelSizeHeight:""},upload:{dataType:"raw"}},this.wavelengths=W}init(e){this.collectionId=e,this.onMetadataChange=new q.b,this.service.getMetadataOptions(null).then(e=>{this.metaObject.pointOfContact.name=e.name,this.metaObject.pointOfContact.email=e.email}).catch(e=>{this.error(e)})}handleSubmit(){this.service.submitCollectionMetadata(this.collectionId,this.metaObject).then(()=>{this.bsModalRef.hide(),this.onMetadataChange.next(this.collectionId)}).catch(e=>{this.error(e)})}updateSelectedWaveLength(e,t){const n=this.metaObject.sensor.wavelength.indexOf(e);t?n<0&&this.metaObject.sensor.wavelength.push(e):n>-1&&this.metaObject.sensor.wavelength.splice(n,1)}error(e){this.message=I.b.getMessageFromError(e)}}Y.ɵfac=function(e){return new(e||Y)(c.hc(Z.a),c.hc(j))},Y.ɵcmp=c.bc({type:Y,selectors:[["metadata-modal"]],decls:108,vars:42,consts:[[1,"modal-header","text-center"],[1,"row"],[1,"col-md-12"],[1,"modal-form"],["ngForm","ngForm"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"form-group"],["for","pointOfContact.name"],["type","text","name","pointOfContact.name",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","pointOfContact.email"],["type","text","name","pointOfContact.email",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","platform.class"],["type","text","name","platform.otherName","maxlength","20","required","",3,"ngModel","ngModelChange"],["for","platform.type"],["name","platform.type","type","input","required","",1,"",3,"ngModel","ngModelChange"],["for","platform.serialNumber"],["type","text","name","platform.serialNumber",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","platform.faaIdNumber"],["type","text","name","platform.faaIdNumber",3,"ngModel","maxlength","required","disabled","ngModelChange"],["for","sensor.class"],["type","text","name","sensor.otherName","maxlength","20","required","",3,"ngModel","ngModelChange"],["for","sensor.type"],["type","text","name","sensor.type",3,"ngModel","maxlength","required","ngModelChange"],["for","sensor.model"],["type","text","name","sensor.model",3,"ngModel","maxlength","required","ngModelChange"],["for","sensor.wavelength"],[4,"ngFor","ngForOf"],["for","sensor.sensorWidth"],["type","number","name","sensor.sensorWidth","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],["name","sensor.sensorWidthUnits","type","input","required","","disabled","",3,"ngModel","ngModelChange"],["value","mm","selected",""],["for","sensor.sensorHeight"],["type","number","name","sensor.sensorHeight","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],["name","sensor.sensorHeightUnits","type","input","required","","disabled","",3,"ngModel","ngModelChange"],["for","sensor.pixelSizeWidth"],["type","number","name","sensor.pixelSizeWidth","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],["for","sensor.pixelSizeHeight"],["type","number","name","sensor.pixelSizeHeight","OnlyNumber","true",3,"ngModel","required","disabled","ngModelChange"],[1,"button-holder"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value","label","valueChange"]],template:function(e,t){if(1&e&&(c.nc(0,"div",0),c.nc(1,"h2"),c.bd(2,"Collection Metadata"),c.mc(),c.mc(),c.nc(3,"div",1),c.nc(4,"div",2),c.nc(5,"form",3,4),c.nc(7,"div",5),c.Zc(8,J,8,1,"div",6),c.nc(9,"div",7),c.nc(10,"div",8),c.bd(11,"Point Of Contact"),c.mc(),c.nc(12,"div",9),c.nc(13,"div",10),c.nc(14,"label",11),c.bd(15,"Name"),c.mc(),c.nc(16,"input",12),c.vc("ngModelChange",(function(e){return t.metaObject.pointOfContact.name=e})),c.mc(),c.mc(),c.nc(17,"div",10),c.nc(18,"label",13),c.bd(19,"Email"),c.mc(),c.nc(20,"input",14),c.vc("ngModelChange",(function(e){return t.metaObject.pointOfContact.email=e})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(21,"div",7),c.nc(22,"div",8),c.bd(23,"Platform"),c.mc(),c.nc(24,"div",9),c.nc(25,"div",10),c.nc(26,"label",15),c.bd(27,"Name"),c.mc(),c.nc(28,"input",16),c.vc("ngModelChange",(function(e){return t.metaObject.platform.otherName=e})),c.mc(),c.mc(),c.nc(29,"div",10),c.nc(30,"label",17),c.bd(31,"Type"),c.mc(),c.nc(32,"select",18),c.vc("ngModelChange",(function(e){return t.metaObject.platform.type=e})),c.ic(33,"option"),c.nc(34,"option"),c.bd(35,"Fixed Wing"),c.mc(),c.nc(36,"option"),c.bd(37,"Hybrid"),c.mc(),c.nc(38,"option"),c.bd(39,"Multi-rotor"),c.mc(),c.nc(40,"option"),c.bd(41,"Helicopter"),c.mc(),c.nc(42,"option"),c.bd(43,"VTOL Fixed-wing"),c.mc(),c.nc(44,"option"),c.bd(45,"Quadcopter"),c.mc(),c.mc(),c.mc(),c.nc(46,"div",10),c.nc(47,"label",19),c.bd(48,"Serial Number"),c.mc(),c.nc(49,"input",20),c.vc("ngModelChange",(function(e){return t.metaObject.platform.serialNumber=e})),c.mc(),c.mc(),c.nc(50,"div",10),c.nc(51,"label",21),c.bd(52,"FAA Id Number"),c.mc(),c.nc(53,"input",22),c.vc("ngModelChange",(function(e){return t.metaObject.platform.faaIdNumber=e})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(54,"div",7),c.nc(55,"div",8),c.bd(56,"Sensor"),c.mc(),c.nc(57,"div",9),c.nc(58,"div",10),c.nc(59,"label",23),c.bd(60,"Name"),c.mc(),c.nc(61,"input",24),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.otherName=e})),c.mc(),c.mc(),c.nc(62,"div",10),c.nc(63,"label",25),c.bd(64,"Type"),c.mc(),c.nc(65,"input",26),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.type=e})),c.mc(),c.mc(),c.nc(66,"div",10),c.nc(67,"label",27),c.bd(68,"Model"),c.mc(),c.nc(69,"input",28),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.model=e})),c.mc(),c.mc(),c.nc(70,"div",10),c.nc(71,"label",29),c.bd(72,"Wave Length"),c.mc(),c.Zc(73,X,2,2,"div",30),c.mc(),c.nc(74,"div",10),c.nc(75,"label",31),c.bd(76,"Sensor Width"),c.mc(),c.nc(77,"input",32),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.sensorWidth=e})),c.mc(),c.mc(),c.nc(78,"div",10),c.nc(79,"label",31),c.bd(80,"Sensor Width Units"),c.mc(),c.nc(81,"select",33),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.sensorWidthUnits=e})),c.nc(82,"option",34),c.bd(83,"Millimeters"),c.mc(),c.mc(),c.mc(),c.nc(84,"div",10),c.nc(85,"label",35),c.bd(86,"Sensor Height"),c.mc(),c.nc(87,"input",36),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.sensorHeight=e})),c.mc(),c.mc(),c.nc(88,"div",10),c.nc(89,"label",31),c.bd(90,"Sensor Height Units"),c.mc(),c.nc(91,"select",37),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.sensorHeightUnits=e})),c.nc(92,"option",34),c.bd(93,"Millimeters"),c.mc(),c.mc(),c.mc(),c.nc(94,"div",10),c.nc(95,"label",38),c.bd(96,"Pixel Size Width"),c.mc(),c.nc(97,"input",39),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.pixelSizeWidth=e})),c.mc(),c.mc(),c.nc(98,"div",10),c.nc(99,"label",40),c.bd(100,"Pixel Size Height"),c.mc(),c.nc(101,"input",41),c.vc("ngModelChange",(function(e){return t.metaObject.sensor.pixelSizeHeight=e})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(102,"div",42),c.nc(103,"button",43),c.vc("click",(function(){return t.bsModalRef.hide()})),c.bd(104,"Cancel"),c.mc(),c.nc(105,"button",44),c.vc("click",(function(){return t.handleSubmit()})),c.ic(106,"i",45),c.bd(107," Submit "),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.Pc(6);c.Ub(8),c.Ec("ngIf",null!=t.message),c.Ub(8),c.Ec("ngModel",t.metaObject.pointOfContact.name)("maxlength",100)("required",!1)("disabled",!1),c.Ub(4),c.Ec("ngModel",t.metaObject.pointOfContact.email)("maxlength",255)("required",!1)("disabled",!1),c.Ub(8),c.Ec("ngModel",t.metaObject.platform.otherName),c.Ub(4),c.Ec("ngModel",t.metaObject.platform.type),c.Ub(17),c.Ec("ngModel",t.metaObject.platform.serialNumber)("maxlength",50)("required",!0)("disabled",!1),c.Ub(4),c.Ec("ngModel",t.metaObject.platform.faaIdNumber)("maxlength",30)("required",!0)("disabled",!1),c.Ub(8),c.Ec("ngModel",t.metaObject.sensor.otherName),c.Ub(4),c.Ec("ngModel",t.metaObject.sensor.type)("maxlength",20)("required",!0),c.Ub(4),c.Ec("ngModel",t.metaObject.sensor.model)("maxlength",20)("required",!0),c.Ub(4),c.Ec("ngForOf",t.wavelengths),c.Ub(4),c.Ec("ngModel",t.metaObject.sensor.sensorWidth)("required",!0)("disabled",!1),c.Ub(4),c.Ec("ngModel",t.metaObject.sensor.sensorWidthUnits),c.Ub(6),c.Ec("ngModel",t.metaObject.sensor.sensorHeight)("required",!0)("disabled",!1),c.Ub(4),c.Ec("ngModel",t.metaObject.sensor.sensorHeightUnits),c.Ub(6),c.Ec("ngModel",t.metaObject.sensor.pixelSizeWidth)("required",!0)("disabled",!1),c.Ub(4),c.Ec("ngModel",t.metaObject.sensor.pixelSizeHeight)("required",!0)("disabled",!1),c.Ub(4),c.Ec("disabled",!e.valid)}},directives:[o.z,o.l,o.m,i.t,o.c,o.k,o.n,o.f,o.v,o.w,o.p,o.y,i.s,o.q,G,V.a],encapsulation:2});var K=n(100);class Q{constructor(e,t,n,c,i,a,o){this.root=e,this.leaf=t,this.drillable=n,this.expandable=c,this.uploadable=i,this.processable=a,this.childLabel=o}}class ee{constructor(){this.cache={},this.cache.Site=new Q(!0,!1,!0,!1,!1,!1,"Projects"),this.cache.Project=new Q(!1,!1,!0,!1,!1,!1,"Missions"),this.cache.Mission=new Q(!1,!1,!1,!0,!1,!1,"Collections"),this.cache.Collection=new Q(!1,!0,!1,!1,!1,!0,"Images"),this.cache.folder=new Q(!1,!0,!1,!1,!0,!1,""),this.cache.raw=new Q(!1,!1,!1,!1,!0,!1,""),this.cache.accessible=new Q(!1,!1,!1,!1,!0,!1,"")}getMetadata(e){return this.cache[e.type]}getTypeContainsFolders(e){return"Collection"===e.type}isUploadable(e){return null!=this.cache[e]&&this.cache[e].uploadable}hasExtraField(e,t){return"Collection"===e&&("collectionDate"===t||"sensor"===t||"uav"===t)}isProcessable(e){return null!=this.cache[e]&&this.cache[e].processable}getUploadTarget(e){return"Imagery"===e?"imagery":"raw"}getHierarchy(){return["Site","Project","Mission","Collection"]}}function te(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",5),c.nc(5,"div"),c.nc(6,"p",6),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function ne(e,t){1&e&&c.ic(0,"span",26)}function ce(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function ie(e,t){if(1&e&&(c.nc(0,"li",35),c.nc(1,"a",36),c.ic(2,"img",37),c.nc(3,"div",38),c.nc(4,"h4",39),c.bd(5),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit,n=c.xc(4);c.Ub(2),c.Ec("src",n.context+"/net/geoprism/images/thumbnail-default.png",c.Tc),c.Ub(3),c.cd(e.name)}}function ae(e,t){if(1&e&&(c.nc(0,"div",32),c.nc(1,"ul",33),c.Zc(2,ie,6,2,"li",34),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(2),c.Ec("ngForOf",e.page.results)}}function oe(e,t){if(1&e&&(c.nc(0,"li",35),c.nc(1,"a",36),c.ic(2,"img",37),c.yc(3,"safeHtml"),c.nc(4,"div",38),c.nc(5,"h4",39),c.bd(6),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit,n=c.xc(4);c.Ub(2),c.Ec("src",null!=n.thumbnails[e.key]?c.zc(3,2,n.thumbnails[e.key]):n.context+"/net/geoprism/images/thumbnail-default.png",c.Tc),c.Ub(4),c.cd(e.name)}}function se(e,t){if(1&e&&(c.nc(0,"div",32),c.nc(1,"ul",33),c.Zc(2,oe,7,4,"li",34),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(2),c.Ec("ngForOf",e.page.results)}}function le(e,t){if(1&e){const e=c.oc();c.nc(0,"input",43),c.vc("change",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(4).toggleExcludeImage(t,n)})),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("checked",e.exclude)}}ee.ɵfac=function(e){return new(e||ee)},ee.ɵprov=c.dc({token:ee,factory:ee.ɵfac});const re=function(e,t){return{"card-disabled":e,"non-clickable":t}},de=function(e){return{"img-disabled":e}};function pe(e,t){if(1&e){const e=c.oc();c.nc(0,"li",35),c.nc(1,"a",40),c.Zc(2,le,1,1,"input",41),c.nc(3,"img",42),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit,a=c.xc(4);return!!a.enableSelectableImages&&a.toggleExcludeImage(n,i)})),c.yc(4,"safeHtml"),c.mc(),c.nc(5,"div",38),c.nc(6,"h4",39),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(4);c.Ub(1),c.Ec("ngClass",c.Jc(7,re,e.exclude,!n.enableSelectableImages)),c.Ub(1),c.Ec("ngIf",n.enableSelectableImages),c.Ub(1),c.Ec("ngClass",c.Ic(10,de,e.exclude))("src",null!=n.thumbnails[e.key]?c.zc(4,5,n.thumbnails[e.key]):n.context+"/net/geoprism/images/thumbnail-default.png",c.Tc),c.Ub(4),c.dd(" ",e.name," ")}}const me=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function he(e,t){if(1&e&&(c.nc(0,"div",32),c.nc(1,"ul",33),c.Zc(2,pe,8,12,"li",34),c.yc(3,"paginate"),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.page.results,c.Kc(4,me,e.page.pageSize,e.page.pageNumber,e.page.count)))}}function ue(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.ic(2,"div",44),c.nc(3,"div",45),c.nc(4,"h3"),c.bd(5),c.nc(6,"a",46),c.vc("click",(function(){c.Rc(e);const t=c.xc(4);return t.handleDownloadVideo(t.video.src)})),c.ic(7,"i",47),c.mc(),c.nc(8,"a",48),c.vc("click",(function(){return c.Rc(e),c.xc(4).closeVideo()})),c.ic(9,"i",49),c.mc(),c.mc(),c.mc(),c.ic(10,"div",44),c.mc(),c.nc(11,"div",7),c.ic(12,"div",44),c.nc(13,"div",45),c.nc(14,"video",50),c.ic(15,"source",51),c.bd(16," Browser not supported "),c.mc(),c.mc(),c.ic(17,"div",44),c.mc(),c.mc()}if(2&e){const e=c.xc(4);c.Ub(5),c.dd(" ",e.video.name," "),c.Ub(10),c.Ec("src",e.video.src,c.Tc)}}function ge(e,t){if(1&e){const e=c.oc();c.nc(0,"li",35),c.nc(1,"a",52),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(4).showVideo(n)})),c.ic(2,"img",53),c.nc(3,"div",38),c.nc(4,"h4",39),c.bd(5),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(4);c.Ub(2),c.Ec("src",n.context+"/net/geoprism/images/thumbnail-video.png",c.Tc),c.Ub(3),c.cd(e.name)}}function be(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,ue,18,2,"div",2),c.nc(2,"div",32),c.nc(3,"ul",33),c.Zc(4,ge,6,2,"li",34),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(1),c.Ec("ngIf",null!==e.video.src),c.Ub(3),c.Ec("ngForOf",e.page.results)}}function fe(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",27),c.vc("selectTab",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).onSelect(n)})),c.nc(1,"div",28),c.Zc(2,ae,3,1,"div",29),c.Zc(3,se,3,1,"div",30),c.Zc(4,he,4,8,"div",30),c.Zc(5,be,5,2,"div",31),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ec("heading",e.name),c.Ub(1),c.Ec("ngSwitch",e.name),c.Ub(2),c.Ec("ngSwitchCase","ortho"),c.Ub(1),c.Ec("ngSwitchCase","raw"),c.Ub(1),c.Ec("ngSwitchCase","video")}}function ve(e,t){if(1&e){const e=c.oc();c.nc(0,"pagination-controls",54),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(2).onPageChange(t)})),c.mc()}}function ye(e,t){if(1&e&&(c.nc(0,"div",55),c.nc(1,"p"),c.bd(2),c.mc(),c.nc(3,"p"),c.bd(4,"See this process on "),c.nc(5,"a",56),c.bd(6,"your tasks page"),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(2),c.cd(e.statusMessage)}}function ke(e,t){if(1&e){const e=c.oc();c.nc(0,"button",57),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleSetMetadata()})),c.ic(1,"i",58),c.bd(2," Add Metadata "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}function xe(e,t){if(1&e){const e=c.oc();c.nc(0,"button",59),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownload()})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2);c.Gc("title","Downloads all files in the ",e.folder.name," folder."),c.Ec("disabled",e.processRunning),c.Ub(1),c.dd(" Download All ",e.capitalize(e.folder.name)," ")}}function Ce(e,t){if(1&e){const e=c.oc();c.nc(0,"button",60),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownloadOdmAll()})),c.bd(1," Download All Generated Data "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}const Ee=function(e){return{"fa-spin":e}};function we(e,t){if(1&e){const e=c.oc();c.nc(0,"button",61),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleRunOrtho()})),c.bd(1," Reprocess Imagery "),c.ic(2,"i",62),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning),c.Ub(2),c.Ec("ngClass",c.Ic(2,Ee,e.processRunning))}}function Me(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h2"),c.bd(4),c.Zc(5,ne,1,0,"span",9),c.mc(),c.mc(),c.mc(),c.nc(6,"div",7),c.nc(7,"div",8),c.nc(8,"ul",10),c.Zc(9,ce,3,1,"li",11),c.mc(),c.mc(),c.mc(),c.nc(10,"div",7),c.nc(11,"div",12),c.nc(12,"tabset",13),c.Zc(13,fe,6,5,"tab",14),c.mc(),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",15),c.Zc(16,ve,1,0,"pagination-controls",16),c.Zc(17,ye,7,1,"div",17),c.nc(18,"div",18),c.nc(19,"div",7),c.nc(20,"div",19),c.Zc(21,ke,3,1,"button",20),c.mc(),c.nc(22,"div",21),c.nc(23,"button",22),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(24,"Close"),c.mc(),c.Zc(25,xe,2,3,"button",23),c.Zc(26,Ce,2,1,"button",24),c.Zc(27,we,3,4,"button",25),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.dd("",e.entity.name," "),c.Ub(1),c.Ec("ngIf",!e.entity.metadataUploaded),c.Ub(4),c.Ec("ngForOf",e.previous),c.Ub(4),c.Ec("ngForOf",e.folders),c.Ub(3),c.Ec("ngIf","raw"===e.folder.name),c.Ub(1),c.Ec("ngIf",e.showOrthoRerunMessage),c.Ub(4),c.Ec("ngIf",!e.entity.metadataUploaded),c.Ub(4),c.Ec("ngIf",e.processable),c.Ub(1),c.Ec("ngIf",e.processable),c.Ub(1),c.Ec("ngIf",e.processable&&e.enableSelectableImages)}}class Oe{constructor(e,t,n,c){this.service=e,this.metadataService=t,this.modalService=n,this.bsModalRef=c,this.previous=[],this.folders=[],this.thumbnails={},this.processRunning=!1,this.processable=!1,this.enableSelectableImages=!1,this.showOrthoRerunMessage=!1,this.constPageSize=50,this.page=new H,this.video={src:null,name:null},this.context=acp}set initData(e){this.init(e.entity,e.folders,e.previous)}ngOnInit(){this.onNodeChange=new q.b,this.page.count=0,this.page.pageNumber=1,this.page.pageSize=this.constPageSize,this.page.results=[]}init(e,t,n){this.entity=e,this.folders=t,this.previous=[...n],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.folders.length>0&&this.onSelect(this.folders[0]),this.processable=this.metadataService.isProcessable(e.type)}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.key]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e){if(null!=e){let t=e.key.substr(0,e.key.lastIndexOf("/")),n=/[^/]*$/.exec(e.key)[0];const c=n.lastIndexOf("."),i=t+"/thumbnails/"+n.substr(0,c)+".png";this.service.download(e.component,i,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}onPageChange(e){this.getData(this.folder.component,this.folder.name,e,this.page.pageSize)}onSelect(e){this.page.results=[],"raw"===e.name?this.enableSelectableImages=!0:this.enableSelectableImages=!1;let t=null,n=null;"raw"===e.name&&(t=null==this.page.pageNumber?1:this.page.pageNumber,n=this.constPageSize),this.folder=e,this.video.src=null,this.video.name=null,this.getData(e.component,e.name,t,n)}getData(e,t,n,c){this.service.getObjects(e,t,n,c).then(e=>{this.page=e;for(let e=0;e<this.page.results.length;++e){let t=this.page.results[e];this.isImage(t)&&this.getThumbnail(t)}})}isImage(e){return-1!==e.name.toLowerCase().indexOf(".png")||-1!==e.name.toLowerCase().indexOf(".jpg")||-1!==e.name.toLowerCase().indexOf(".jpeg")||-1!==e.name.toLowerCase().indexOf(".tif")||-1!==e.name.toLowerCase().indexOf(".tiff")}previewImage(e,t){}toggleExcludeImage(e,t){this.service.setExclude(t.id,!t.exclude).then(e=>{t.exclude=e.exclude})}isProcessable(e){return this.metadataService.isProcessable(e.type)}handleErosPush(){this.processRunning=!0,this.service.pushToEros(this.entity.id).then(e=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})}handleRunOrtho(){event.stopPropagation(),this.confirmModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"confirmation-modal"}),this.confirmModalRef.content.message="Running this process will replace all output products for this "+this.entity.type+". Are you sure you want to re-process this data?",this.confirmModalRef.content.type="DANGER",this.confirmModalRef.content.submitText="Run Process",this.confirmModalRef.content.onConfirm.subscribe(e=>{this.processRunning=!0,this.showOrthoRerunMessage=!0,this.service.runOrtho(this.entity.id).then(e=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.folder.component+"&key="+this.folder.name}handleDownloadOdmAll(){window.location.href=acp+"/project/download-odm-all?colId="+this.entity.id}handleDownloadVideo(e){window.location.href=e}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.folder.component+"&key="+e.key}handleSetMetadata(){let e=this.modalService.show(Y,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"});e.content.init(this.entity.id),e.content.onMetadataChange.subscribe(()=>{this.entity.metadataUploaded=!0})}capitalize(e){return e.replace(/^\w/,e=>e.toUpperCase())}showVideo(e){this.video.name=null,this.video.src=null,setTimeout(()=>{this.video.name=e.name,this.video.src=acp+"/project/download?id="+this.folder.component+"&key="+e.key},200)}closeVideo(){this.video.name=null,this.video.src=null}error(e){this.message=I.b.getMessageFromError(e)}}Oe.ɵfac=function(e){return new(e||Oe)(c.hc(j),c.hc(ee),c.hc(Z.b),c.hc(Z.a))},Oe.ɵcmp=c.bc({type:Oe,selectors:[["leaf-modal"]],inputs:{initData:"initData"},features:[c.Tb([I.a])],decls:4,vars:3,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],["class","dot pending","style","margin-left: 0;margin-bottom: 5px;",4,"ngIf"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"col-sm-12",2,"padding","0"],[1,"nav-full-width"],[3,"heading","selectTab",4,"ngFor","ngForOf"],[1,"col-sm-12"],[3,"pageChange",4,"ngIf"],["style","text-align:right;padding-right:20px;",4,"ngIf"],[1,"btn-holder",2,"margin","20px 20px 10px 20px"],[1,"col-sm-2"],["type","button","class","btn btn-warning",3,"disabled","click",4,"ngIf"],[1,"col-md-10",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","button","class","btn btn-secondary","style","margin-left: 5px;",3,"title","disabled","click",4,"ngIf"],["type","button","class","btn btn-secondary","title","Downloads the all.zip file generated from ODM.","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],["class","btn btn-primary","title","Reprocesses the selected raw imagery and generates new products.","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],[1,"dot","pending",2,"margin-left","0","margin-bottom","5px"],[3,"heading","selectTab"],[3,"ngSwitch"],["class","image-list-container",4,"ngSwitchDefault"],["class","image-list-container",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3",4,"ngFor","ngForOf"],[1,"list-group-item","col-xs-3"],[1,"thumbnail","non-clickable"],["alt","Image",3,"src"],[1,"caption"],[1,"media-heading"],[1,"thumbnail",3,"ngClass"],["type","checkbox","class","x-box",3,"checked","change",4,"ngIf"],["alt","Image",2,"max-height","150px",3,"ngClass","src","click"],["type","checkbox",1,"x-box",3,"checked","change"],[1,"col-md-1"],[1,"col-md-10"],[3,"click"],[1,"fas","fa-download"],[1,"pull-right",3,"click"],["aria-hidden","true",1,"fa","fa-times"],["controls","",2,"width","100%"],["type","video/mp4",3,"src"],[1,"thumbnail",3,"click"],["alt","Video",3,"src"],[3,"pageChange"],[2,"text-align","right","padding-right","20px"],["routerlink","/site/tasks","routerlinkactive","active","href","#/site/tasks"],["type","button",1,"btn","btn-warning",3,"disabled","click"],[1,"fa","fa-plus",2,"color","white"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"title","disabled","click"],["type","button","title","Downloads the all.zip file generated from ODM.",1,"btn","btn-secondary",2,"margin-left","5px",3,"disabled","click"],["title","Reprocesses the selected raw imagery and generates new products.",1,"btn","btn-primary",2,"margin-left","5px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-sync-alt",2,"color","white","vertical-align","middle","margin-left","10px",3,"ngClass"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div"),c.Zc(2,te,8,1,"div",1),c.Zc(3,Me,28,10,"div",2),c.mc(),c.mc()),2&e&&(c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",null!=t.entity))},directives:[i.t,i.s,p.e,p.b,i.x,i.z,i.y,i.q,h.c],pipes:[_.a,h.b],encapsulation:2,data:{animation:[Object(K.c)(),Object(K.d)(),Object(K.e)(),Object(K.f)()]}});class Ue{constructor(e,t){this.http=e,this.eventService=t}getProducts(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/product/get-all",{params:t}).toPromise()}getDetail(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("pageNumber",t.toString()),c=c.set("pageSize",n.toString()),this.eventService.start(),this.http.get(acp+"/product/detail",{params:c}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}togglePublish(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/toggle-publish",JSON.stringify({id:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}Ue.ɵfac=function(e){return new(e||Ue)(c.rc(y.c),c.rc(D.a))},Ue.ɵprov=c.dc({token:Ue,factory:Ue.ɵfac});var Se=n(99);function Ie(e,t){if(1&e&&(c.nc(0,"div",5),c.nc(1,"div",6),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",7),c.nc(5,"div"),c.nc(6,"p",8),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Te(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function Re(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"a",24),c.nc(2,"img",25),c.vc("error",(function(t){return c.Rc(e),c.xc(3).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ub(2),c.Ec("src",c.zc(3,1,e.thumbnails[e.product.id]),c.Tc)}}function Pe(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"a",27),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(3).previewImage(t)})),c.nc(2,"img",28),c.vc("error",(function(t){return c.Rc(e),c.xc(4).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.nc(4,"div",29),c.nc(5,"h4",30),c.bd(6),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc(3);c.Ub(2),c.Ec("src",c.zc(3,2,t.thumbnails[e.id]),c.Tc),c.Ub(4),c.cd(e.name)}}function Fe(e,t){if(1&e&&(c.nc(0,"li",26),c.Zc(1,Pe,7,4,"div",13),c.mc()),2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("ngIf",null!=n.thumbnails[e.id])}}const Ne=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function De(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",9),c.nc(2,"div",10),c.nc(3,"h2"),c.bd(4),c.mc(),c.mc(),c.mc(),c.nc(5,"div",9),c.nc(6,"div",10),c.nc(7,"ul",11),c.Zc(8,Te,3,1,"li",12),c.mc(),c.mc(),c.mc(),c.nc(9,"div",9),c.nc(10,"div",10),c.Zc(11,Re,4,3,"div",13),c.mc(),c.mc(),c.nc(12,"div",9),c.nc(13,"div",10),c.nc(14,"label"),c.bd(15,"Pilot Name: "),c.mc(),c.bd(16),c.mc(),c.mc(),c.nc(17,"div",9),c.nc(18,"div",10),c.nc(19,"label"),c.bd(20,"Date/Time: "),c.mc(),c.bd(21),c.yc(22,"idmdate"),c.mc(),c.mc(),c.nc(23,"div",9),c.nc(24,"div",10),c.nc(25,"label"),c.bd(26,"Sensor Information:"),c.mc(),c.bd(27),c.mc(),c.mc(),c.nc(28,"div",14),c.nc(29,"div",10),c.nc(30,"div",15),c.nc(31,"h3"),c.bd(32,"Raw Images"),c.mc(),c.nc(33,"ul",16),c.Zc(34,Fe,2,1,"li",17),c.yc(35,"paginate"),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(36,"div",9),c.nc(37,"pagination-controls",18),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(2).onPageChange(t)})),c.mc(),c.mc(),c.nc(38,"div",14),c.nc(39,"div",19),c.nc(40,"button",20),c.vc("click",(function(){return c.Rc(e),c.xc(2).bsModalRef.hide()})),c.bd(41,"Close"),c.mc(),c.nc(42,"button",21),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownload()})),c.bd(43,"Download ODM Files"),c.mc(),c.nc(44,"button",22),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleGoto()})),c.bd(45," Collection Details "),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(4),c.cd(e.product.name),c.Ub(4),c.Ec("ngForOf",e.product.entities),c.Ub(3),c.Ec("ngIf",null!=e.thumbnails[e.product.id]),c.Ub(5),c.dd("   ",e.product.pilotName," "),c.Ub(5),c.dd("   ",c.zc(22,7,e.product.dateTime)," "),c.Ub(6),c.dd("   ",e.product.sensor," "),c.Ub(7),c.Ec("ngForOf",c.Ac(35,9,e.product.page.resultSet,c.Kc(12,Ne,e.product.page.pageSize,e.product.page.pageNumber,e.product.page.count)))}}function Ae(e,t){if(1&e&&(c.nc(0,"div",2),c.nc(1,"div"),c.Zc(2,Ie,8,1,"div",3),c.Zc(3,De,46,16,"div",4),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(2),c.Ec("ngIf",null!=e.message),c.Ub(1),c.Ec("ngIf",null!=e.product)}}function je(e,t){if(1&e&&c.ic(0,"leaf-modal",31),2&e){const e=c.xc();c.Ec("initData",e.initData)}}class Ze{constructor(e,t,n,c){this.pService=e,this.service=t,this.bsModalRef=n,this.modalService=c,this.thumbnails={},this.items=[],this.showSite=!1}ngOnInit(){}init(e){this.product=e,this.product.imageKey&&this.getThumbnail(this.product.id,this.product.imageKey),this.product.page.resultSet.forEach(e=>{this.getThumbnail(e.id,e.key)})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e,t){const n=this.product.entities[this.product.entities.length-1].id,c=t.substr(0,t.lastIndexOf("/")),i=/[^/]*$/.exec(t)[0],a=i.lastIndexOf("."),o=c+"/thumbnails/"+i.substr(0,a)+".png";this.service.download(n,o,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}onPageChange(e){this.pService.getDetail(this.product.id,e,20).then(e=>{this.init(e)})}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleGoto(){const e=this.product.entities[this.product.entities.length-1],t=this.product.entities;this.service.getItems(e.id,null).then(n=>{this.initData={entity:e,folders:n,previous:t},this.showSite=!0})}previewImage(e){this.rawImagePreviewModal=this.modalService.show(B,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.rawImagePreviewModal.content.init(e.component,e.key)}handleDownload(){window.location.href=acp+"/product/get-odm-all?id="+this.product.id}error(e){this.message=I.b.getMessageFromError(e)}}function _e(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",5),c.bd(2," Loading Products "),c.mc())}function Le(e,t){1&e&&(c.nc(0,"p"),c.bd(1,"No data found"),c.mc())}function $e(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"h4"),c.Zc(2,_e,3,0,"span",4),c.Zc(3,Le,2,0,"p",4),c.mc(),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}function ze(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name," ")}}function Be(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"a",25),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().previewImage(t)})),c.nc(2,"img",26),c.vc("error",(function(t){return c.Rc(e),c.xc(2).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(2),c.Ec("src",c.zc(3,1,t.thumbnails[e.id]),c.Tc)}}function qe(e,t){1&e&&c.ic(0,"i",27),2&e&&c.Ec("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function He(e,t){1&e&&c.ic(0,"i",27),2&e&&c.Ec("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function We(e,t){if(1&e){const e=c.oc();c.nc(0,"li",20),c.nc(1,"a",28),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleTogglePublish(t)})),c.bd(2,"Unpublish"),c.mc(),c.mc()}}function Ge(e,t){if(1&e){const e=c.oc();c.nc(0,"li",20),c.nc(1,"a",29),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleTogglePublish(t)})),c.bd(2,"Publish"),c.mc(),c.mc()}}function Ve(e,t){if(1&e){const e=c.oc();c.nc(0,"div",6),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h5",9),c.bd(4),c.mc(),c.nc(5,"ul",10),c.Zc(6,ze,3,1,"li",11),c.mc(),c.nc(7,"div",12),c.Zc(8,Be,4,3,"div",4),c.mc(),c.nc(9,"div",13),c.nc(10,"ul",14),c.nc(11,"li",15),c.nc(12,"a",16),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleMapIt(n)})),c.bd(13,"Aerial"),c.mc(),c.Zc(14,qe,1,2,"i",17),c.mc(),c.nc(15,"li",18),c.nc(16,"a",19),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleMapDem(n)})),c.bd(17,"Hillshade"),c.mc(),c.Zc(18,He,1,2,"i",17),c.mc(),c.nc(19,"li",20),c.nc(20,"a",21),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handlePointcloud(n)})),c.bd(21,"3D"),c.mc(),c.mc(),c.nc(22,"li",20),c.nc(23,"a",22),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleGetInfo(n)})),c.bd(24,"Get Info"),c.mc(),c.mc(),c.nc(25,"li",20),c.nc(26,"a",23),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().handleDelete(i,n)})),c.bd(27,"Delete"),c.mc(),c.mc(),c.Zc(28,We,3,0,"li",24),c.Zc(29,Ge,3,0,"li",24),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("@fadeInOnEnter",void 0)("@fadeOutOnLeave",void 0),c.Ub(3),c.dd(" ",e.name," "),c.Ub(2),c.Ec("ngForOf",e.entities),c.Ub(2),c.Ec("ngIf",null!=n.thumbnails[e.id]),c.Ub(4),c.Xc(n.hasOrthoLayer(e)?"":"cursor:not-allowed;"),c.Ub(2),c.Ec("ngIf",e.orthoMapped),c.Ub(2),c.Xc(n.hasDemLayer(e)?"":"cursor:not-allowed;"),c.Ub(2),c.Ec("ngIf",e.demMapped),c.Ub(2),c.Xc(e.hasPointcloud?"":"cursor:not-allowed;"),c.Ub(8),c.Ec("ngIf",e.published),c.Ub(1),c.Ec("ngIf",!e.published)}}Ze.ɵfac=function(e){return new(e||Ze)(c.hc(Ue),c.hc(j),c.hc(Z.a),c.hc(Z.b))},Ze.ɵcmp=c.bc({type:Ze,selectors:[["product-modal"]],features:[c.Tb([Oe])],decls:2,vars:2,consts:[["class","modal-body","style","padding-bottom: 0;",4,"ngIf"],[3,"initData",4,"ngIf"],[1,"modal-body",2,"padding-bottom","0"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],["class","",4,"ngIf"],[1,"row",2,"background-color","#ececec"],["id","image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3","style","background:none;",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 20px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[1,""],[1,"thumbnail","non-clickable"],["alt","Image",1,"",3,"src","error"],[1,"list-group-item","col-xs-3",2,"background","none"],[1,"thumbnail",3,"click"],["alt","Image",3,"src","error"],[1,"caption"],[1,"media-heading"],[3,"initData"]],template:function(e,t){1&e&&(c.Zc(0,Ae,4,2,"div",0),c.Zc(1,je,1,1,"leaf-modal",1)),2&e&&(c.Ec("ngIf",!t.showSite),c.Ub(1),c.Ec("ngIf",t.showSite))},directives:[i.t,i.s,h.c,Oe],pipes:[Se.a,h.b,_.a],encapsulation:2,data:{animation:[Object(K.c)(),Object(K.d)(),Object(K.a)()]}});class Je{constructor(e,t,n){this.pService=e,this.mService=t,this.modalService=n,this.toggleMapOrtho=new c.t,this.toggleMapDem=new c.t,this.products=[],this.thumbnails={},this.loading=!1}ngOnChanges(e){this.refreshProducts(e.id.currentValue)}refreshProducts(e){this.products=[],this.thumbnails={},this.loading=!0,this.pService.getProducts(e).then(e=>{this.products=e,this.loading=!1,this.products.forEach(e=>{this.getThumbnail(e)})})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.id]=n.result},!1),e&&n.readAsDataURL(e)}hasOrthoLayer(e){let t=e.layers.length;for(let n=0;n<t;++n)if("ORTHO"===e.layers[n].classification&&null!=e.layers[n].key&&e.layers[n].key.length>0)return!0;return!1}hasDemLayer(e){let t=e.layers.length;for(let n=0;n<t;++n)if(("DEM_DSM"===e.layers[n].classification||"DEM_DTM"===e.layers[n].classification)&&null!=e.layers[n].key&&e.layers[n].key.length>0)return!0;return!1}getThumbnail(e){if(e.imageKey){const t=e.entities[e.entities.length-1].id,n=e.imageKey.substr(0,e.imageKey.lastIndexOf("/")),c=/[^/]*$/.exec(e.imageKey)[0],i=c.lastIndexOf("."),a=n+"/thumbnails/"+c.substr(0,i)+".png";this.mService.download(t,a,!1).subscribe(t=>{this.createImageFromBlob(t,e)},t=>{console.log(t),this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"})}else this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleMapIt(e){this.hasOrthoLayer(e)&&this.toggleMapOrtho.emit(e)}handleMapDem(e){this.hasDemLayer(e)&&this.toggleMapDem.emit(e)}handlePointcloud(e){if(e.hasPointcloud){let t=e.entities[e.entities.length-1].id;window.open(acp+"/pointcloud/"+t+"/potree")}}handleDelete(e,t){t.stopPropagation(),this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.pService.remove(e.id).then(t=>{this.products=this.products.filter(t=>t.id!==e.id)})}previewImage(e){const t=e.entities[e.entities.length-1].id;this.bsModalRef=this.modalService.show(B,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.bsModalRef.content.init(t,e.imageKey)}handleGetInfo(e){this.pService.getDetail(e.id,1,20).then(e=>{this.bsModalRef=this.modalService.show(Ze,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}),this.bsModalRef.content.init(e)})}handleTogglePublish(e){this.pService.togglePublish(e.id).then(t=>{const n=e.orthoMapped,c=e.demMapped;n&&this.toggleMapOrtho.emit(e),c&&this.toggleMapDem.emit(e),e.published=t.published,e.layers=t.layers,n&&this.toggleMapOrtho.emit(e),c&&this.toggleMapDem.emit(e)})}}function Xe(e,t){if(1&e&&(c.nc(0,"div",10),c.nc(1,"div",11),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",12),c.nc(5,"div"),c.nc(6,"p",13),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Ye(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"h3"),c.bd(2),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(2),c.dd("Add new ",e.entity.type,"")}}function Ke(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"input",17),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("placeholder",e.label)("required",e.required)}}function Qe(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.cd(e.label)}}function et(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"select",18),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.ic(4,"option"),c.Zc(5,Qe,2,2,"option",19),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required),c.Ub(2),c.Ec("ngForOf",e.options)}}function tt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"textarea",21),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.bd(4,"          "),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required)}}function nt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"map-attribute",22),c.vc("siteChange",(function(t){return c.Rc(e),c.xc(4).entity=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(4);c.Ub(1),c.Ec("site",e.entity)("center",e.center)("zoom",e.zoom)}}function ct(e,t){if(1&e&&(c.nc(0,"div",15),c.Zc(1,Ke,4,6,"div",16),c.Zc(2,et,6,6,"div",16),c.Zc(3,tt,5,5,"div",16),c.Zc(4,nt,2,3,"div",16),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngIf","text"===e.type),c.Ub(1),c.Ec("ngIf","list"===e.type),c.Ub(1),c.Ec("ngIf","text-area"===e.type),c.Ub(1),c.Ec("ngIf","point"===e.type)}}function it(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,ct,5,4,"div",6),c.mc()),2&e){const e=t.$implicit,n=c.xc(2);c.Ub(1),c.Ec("ngIf",n.evaluate(e))}}function at(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.nc(1,"label"),c.bd(2,"Privilege "),c.mc(),c.nc(3,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).entity.privilegeType=t})),c.nc(4,"option",24),c.bd(5,"Owner"),c.mc(),c.nc(6,"option",25),c.bd(7,"Agency"),c.mc(),c.nc(8,"option",26),c.bd(9,"Public"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(3),c.Ec("ngModel",e.entity.privilegeType)("required",!0)("disabled",!1===e.admin||e.entity.ownerName!==e.userName)}}function ot(e,t){if(1&e){const e=c.oc();c.nc(0,"div",1),c.Zc(1,Xe,8,1,"div",2),c.Zc(2,Ye,3,1,"div",3),c.nc(3,"form",null,4),c.Zc(5,it,2,1,"div",5),c.Zc(6,at,10,3,"div",6),c.nc(7,"div",7),c.nc(8,"button",8),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(9,"Cancel"),c.mc(),c.nc(10,"button",9),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(11,"Apply"),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.Pc(4),t=c.xc();c.Ub(1),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",t.newInstance),c.Ub(3),c.Ec("ngForOf",t.attributes),c.Ub(1),c.Ec("ngIf","Collection"===t.entity.type&&!t.newInstance),c.Ub(4),c.Ec("disabled",!e.valid)}}Je.ɵfac=function(e){return new(e||Je)(c.hc(Ue),c.hc(j),c.hc(Z.b))},Je.ɵcmp=c.bc({type:Je,selectors:[["product-panel"]],inputs:{id:"id"},outputs:{toggleMapOrtho:"toggleMapOrtho",toggleMapDem:"toggleMapDem"},features:[c.Sb],decls:3,vars:2,consts:[[1,"list-group"],["style","padding: 10px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],[2,"padding","10px","text-align","center","color","grey"],[4,"ngIf"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin"],[1,"list-group-item"],[1,"card","card-default"],[1,"card-body"],[1,"card-title",2,"color","#a0a0a0"],[1,"breadcrumb",2,"margin","5px 0 5px 0"],[4,"ngFor","ngForOf"],[1,"card-left",2,"width","calc(100% - 7.2em)","padding","0px"],[1,"card-right",2,"padding","0px","width","7.2em"],[2,"list-style","none","padding","0"],[2,"padding","3px 0 3px 0","min-width","6em"],["aria-hidden","true","title","View the Orthomosaic generated from the raw data using ODM.",1,"fa","fa-globe",3,"click"],["class","fas fa-check","style","color: #007276;float: right;vertical-align: middle;line-height: 20px;",4,"ngIf"],[2,"padding","3px 0 3px 0","min-width","7.2em"],["aria-hidden","true","title","View the DEM hillshade.",1,"fa","fa-industry",3,"click"],[2,"padding","3px 0 3px 0"],["aria-hidden","true","title","View the 3D pointcloud for this product using the Potree viewer.",1,"fa","fa-cube",3,"click"],["title","View more information about this product, including raw data.",1,"fa","fa-info-circle",3,"click"],["title","Deletes the product and all associated data and public map services.",1,"fa","fa-trash-alt",3,"click"],["style","padding: 3px 0 3px 0;",4,"ngIf"],[1,"thumbnail",3,"click"],["alt","Image",1,"",3,"src","error"],[1,"fas","fa-check",2,"color","#007276","float","right","vertical-align","middle","line-height","20px"],["title","Unpublishes the layer from the public mosaic. This layer will no longer be publicly accessible from Geoserver.",1,"fa","fa-arrow-alt-circle-down",3,"click"],["title","Publish the product to the publish mosaic. The aerial and hillshade services will be publicly accessible.",1,"fa","fa-arrow-alt-circle-up",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.Zc(1,$e,4,3,"div",1),c.Zc(2,Ve,30,15,"div",2),c.mc()),2&e&&(c.Ub(1),c.Ec("ngIf",t.products.length<1),c.Ub(1),c.Ec("ngForOf",t.products))},directives:[i.t,i.s],pipes:[_.a],encapsulation:2,data:{animation:[Object(K.c)(),Object(K.d)(),Object(K.a)(),Object(K.b)()]}});class st{constructor(e,t){this.service=e,this.bsModalRef=t,this.userName="",this.admin=!1,this.newInstance=!1,this.message=null,this.center=null,this.zoom=null}ngOnInit(){this.onNodeChange=new q.b}init(e,t,n,c,i,a,o){this.newInstance=e,this.userName=t,this.admin=n,this.entity=c,this.attributes=i,this.center=a,this.zoom=o}handleOnSubmit(){this.message=null,"Site"!==this.entity.type||null!=this.entity.geometry?this.newInstance?this.service.applyWithParent(this.entity,this.parentId).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{this.error(e)}):this.service.update(this.entity).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{console.log(e),this.error(e)}):this.message="Sites require a location"}evaluate(e){return(!this.newInstance||!e.readonly)&&(null==e.condition||this.service.evaluate(e.condition,this.entity))}error(e){this.message=I.b.getMessageFromError(e)}}st.ɵfac=function(e){return new(e||st)(c.hc(j),c.hc(Z.a))},st.ɵcmp=c.bc({type:st,selectors:[["entity-modal"]],decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],["class","modal-title-container",4,"ngIf"],["ngForm","ngForm"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[1,"btn-holder",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"modal-title-container"],[1,"form-group"],[4,"ngIf"],["type","input",1,"form-control",3,"ngModel","name","disabled","placeholder","required","ngModelChange"],["type","input",3,"ngModel","name","disabled","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],[3,"site","center","zoom","siteChange"],["name","collection-privilege","type","input",2,"padding","6px 10px","font-size","14px",3,"ngModel","required","disabled","ngModelChange"],["value","OWNER"],["value","AGENCY"],["value","PUBLIC"]],template:function(e,t){1&e&&c.Zc(0,ot,12,5,"div",0),2&e&&c.Ec("ngIf",null!=t.entity)},directives:[i.t,o.z,o.l,o.m,i.s,o.c,o.k,o.n,o.v,o.w,o.p,o.y,U],encapsulation:2});var lt=n(391),rt=n(47),dt=n(382);const pt=["uploader"];function mt(e,t){if(1&e&&(c.nc(0,"div",22),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"div",23),c.nc(4,"strong",24),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",25),c.nc(7,"div"),c.nc(8,"p",26),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",4),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function ht(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"ol",27),c.ic(4,"modal-step-indicator",28),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("stepConfig",e.modalStepConfig)}}function ut(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.dd(" ",e,"")}}function gt(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"ul",29),c.Zc(4,ut,3,2,"li",30),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",e.labels)}}function bt(e,t){if(1&e&&(c.nc(0,"option",37),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function ft(e,t){if(1&e){const e=c.oc();c.nc(0,"button",38),c.vc("click",(function(){return c.Rc(e),c.xc(3).setIsNew(!0)})),c.bd(1," Add "),c.mc()}}function vt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.nc(1,"div",5),c.nc(2,"select",34),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).page.selection.value=t})),c.ic(3,"option"),c.Zc(4,bt,2,2,"option",35),c.mc(),c.mc(),c.nc(5,"div",4),c.Zc(6,ft,2,0,"button",36),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(2),c.Ec("name",e.page.selection.type)("ngModel",e.page.selection.value)("disabled",e.page.selection.isNew),c.Ub(2),c.Ec("ngForOf",e.page.options),c.Ub(2),c.Ec("ngIf",!e.page.selection.isNew)}}function yt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.nc(1,"div",5),c.nc(2,"label",41),c.bd(3,"Collection Date:"),c.mc(),c.nc(4,"input",42),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(3).page.selection.collectionDate=t})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("ngModel",e.page.selection.collectionDate)}}function kt(e,t){if(1&e){const e=c.oc();c.nc(0,"metadata-page",43),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(3).page=t})),c.mc()}if(2&e){const e=c.xc(3);c.Ec("page",e.page)}}function xt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",31),c.nc(1,"div",15),c.nc(2,"div",5),c.nc(3,"input",39),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).page.selection.label=t})),c.mc(),c.mc(),c.nc(4,"div",4),c.nc(5,"button",38),c.vc("click",(function(){return c.Rc(e),c.xc(2).setIsNew(!1)})),c.bd(6," Cancel "),c.mc(),c.mc(),c.mc(),c.Zc(7,yt,5,2,"div",2),c.Zc(8,kt,1,1,"metadata-page",40),c.mc()}if(2&e){const e=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngModel",e.page.selection.label)("placeholder",e.page.selection.type+" name..."),c.Ub(4),c.Ec("ngIf",e.hasField("collectionDate")),c.Ub(1),c.Ec("ngIf",e.hasField("uav"))}}function Ct(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"div",31),c.nc(4,"label",32),c.bd(5),c.mc(),c.Zc(6,vt,7,5,"div",2),c.mc(),c.Zc(7,xt,9,5,"div",33),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("for",e.page.selection.type),c.Ub(1),c.dd("",e.page.selection.type,":"),c.Ub(1),c.Ec("ngIf",!e.page.selection.isNew),c.Ub(1),c.Ec("ngIf",e.page.selection.isNew)}}function Et(e,t){if(1&e){const e=c.oc();c.nc(0,"div",31),c.nc(1,"label",32),c.bd(2),c.mc(),c.nc(3,"input",48),c.vc("ngModelChange",(function(n){return c.Rc(e),t.$implicit.label=n})),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("for",e.type),c.Ub(1),c.dd("",e.type,":"),c.Ub(1),c.Ec("ngModel",e.label)("name",e.type)}}function wt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.ic(1,"div",4),c.nc(2,"div",5),c.Zc(3,Et,4,4,"div",44),c.nc(4,"div",31),c.nc(5,"label",45),c.bd(6,"Output Product Name Prefix"),c.mc(),c.nc(7,"input",46),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().values.outFileName=t})),c.mc(),c.mc(),c.nc(8,"div",31),c.nc(9,"boolean-field",47),c.vc("valueChange",(function(t){return c.Rc(e),c.xc().updateProcessUpload(t)})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngForOf",e.selections),c.Ub(4),c.Ec("ngModel",e.values.outFileName),c.Ub(2),c.Ec("value",e.processUpload)}}function Mt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",49),c.nc(2,"div",50),c.bd(3,"Partial Upload Detected"),c.mc(),c.nc(4,"div",51),c.nc(5,"h4"),c.bd(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),c.mc(),c.nc(7,"h4"),c.nc(8,"b"),c.bd(9,"To continue an upload"),c.mc(),c.bd(10," please re-upload your file and we will try our best to continue where you left off. "),c.mc(),c.ic(11,"hr"),c.nc(12,"button",52),c.vc("click",(function(t){return c.Rc(e),c.xc().removeUpload(t)})),c.ic(13,"i",53),c.bd(14," Cancel Upload "),c.mc(),c.mc(),c.mc(),c.mc()}}function Ot(e,t){if(1&e){const e=c.oc();c.nc(0,"div",54),c.nc(1,"div",50),c.bd(2," Upload Details "),c.nc(3,"i",55),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().closeTaskFinishedNotification(n.id)})),c.mc(),c.mc(),c.nc(4,"div",51),c.nc(5,"h4"),c.bd(6," Status: "),c.nc(7,"b"),c.bd(8," Upload successfully completed "),c.mc(),c.mc(),c.nc(9,"h4"),c.bd(10," Message: "),c.nc(11,"b"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(12),c.dd(" ",e.message," ")}}function Ut(e,t){if(1&e&&(c.nc(0,"div",49),c.nc(1,"div",50),c.bd(2,"Upload Details"),c.mc(),c.nc(3,"div",51),c.nc(4,"h4"),c.bd(5," Status: "),c.nc(6,"b"),c.bd(7),c.mc(),c.mc(),c.nc(8,"h4"),c.bd(9," Message: "),c.nc(10,"b"),c.bd(11),c.mc(),c.mc(),c.nc(12,"h4"),c.bd(13," Upload Started On: "),c.nc(14,"b"),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"h4"),c.bd(18," Last Updated: "),c.nc(19,"b"),c.bd(20),c.yc(21,"idmdate"),c.mc(),c.mc(),c.nc(22,"h4"),c.bd(23," Elapsed Time: "),c.nc(24,"b"),c.bd(25),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.dd(" ",e.currentTask.status," "),c.Ub(4),c.dd(" ",e.currentTask.message," "),c.Ub(4),c.dd(" ",c.zc(16,5,e.currentTask.createDate)," "),c.Ub(5),c.dd(" ",c.zc(21,7,e.currentTask.lastUpdateDate)," "),c.Ub(5),c.dd(" ",e.uploadCounter," ")}}function St(e,t){if(1&e){const e=c.oc();c.nc(0,"button",56),c.vc("click",(function(){return c.Rc(e),c.xc().handleBackPage()})),c.ic(1,"i",53),c.bd(2," Back "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",e.disabled)}}function It(e,t){if(1&e){const e=c.oc();c.nc(0,"button",57),c.vc("click",(function(){return c.Rc(e),c.xc().handleNextPage()})),c.ic(1,"i",53),c.bd(2," Next "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}function Tt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",57),c.vc("click",(function(){return c.Rc(e),c.xc().handleUpload()})),c.ic(1,"i",53),c.bd(2," Upload "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}class Rt{constructor(e,t,n,c,i){this.service=e,this.metadataService=t,this.modalService=n,this.bsModalRef=c,this.objectKeys=Object.keys,this.importedValues=!1,this.message="",this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.finishedTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.processUpload=!0,this.hierarchy=[],this.selections=[],this.labels=[],this.pages=[{index:0,selection:null,options:[],type:"FILE"}],this.hierarchyChange=!1,this.page=this.pages[0],this.sensors=[],this.platforms=[],this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]},this.differ=i.find([]).create()}set content(e){const t=this;if(null!=e&&null==this.uploader){let n={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,n){t.disabled=!0,this.finishedTask=null,t.countUpload(t),t.message&&t.message.length>0&&(t.message="")},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,n,c,i){c.message&&c.message.currentTask&&!t.currentTask&&(t.currentTask=c.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(lt.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(rt.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,n,c,i){if(t.disabled=!1,t.finishedTask=t.currentTask,t.currentTask=null,t.existingTask=!1,!t.hierarchyChange)for(let e=0;e<t.selections.length;e++)t.selections[e].isNew&&(t.hierarchyChange=!0);t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),c.success&&t.bsModalRef.hide(),t.onUploadComplete.next()},onCancel:function(e,n){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.existingTask&&(t.page=t.pages[0]),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,n,c){t.error({error:{message:c}})}}};this.uploader=new dt.FineUploader(n)}}ngAfterViewInit(){}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}ngOnInit(){this.onUploadComplete=new q.b,this.onHierarchyChange=new q.b}init(e){this.hierarchy=this.metadataService.getHierarchy(),this.selections=[],this.pages=[];for(let t=0;t<this.hierarchy.length;t++){const n=this.hierarchy[t],c=e.findIndex(e=>e.type===n);if(-1!==c){const t=e[c];this.selections.push({type:n,isNew:!1,value:t.id,label:t.name})}else this.selections.push({type:n,isNew:!1,value:null,label:""});t>0&&this.pages.push({index:this.pages.length,selection:this.selections[t],options:[],type:"CATEGORY"})}this.labels.push(this.selections[0].label),this.pages.push({index:this.pages.length,selection:null,options:[],type:"SUMMARY"}),this.page=this.pages[0],this.service.getChildren(this.selections[0].value).then(e=>{this.pages[0].options=e.filter(e=>e.type===this.pages[0].selection.type)}).catch(e=>{this.error(e)}),this.existingTask&&(this.page=this.pages[this.pages.length-1])}close(){this.hierarchyChange&&this.onHierarchyChange.next(!0),this.bsModalRef.hide()}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0)}isPageValid(e){if("CATEGORY"===e.type){if(null!=e.selection)return null!=e.selection.value&&e.selection.value.length>0||null!=e.selection.label&&e.selection.label.length>0&&((!this.hasField("uav")||null!=e.selection.uav&&0!==e.selection.uav.length)&&((!this.hasField("sensor")||null!=e.selection.sensor&&0!==e.selection.sensor.length)&&(!this.hasField("collectionDate")||null!=e.selection.collectionDate&&0!==e.selection.collectionDate.length)))}else if("FILE"===e.type){if(null!=this.uploader){const e=this.uploader.getUploads();return null!=e&&e.length>0}}else if("SUMMARY"===e.type)return null==this.currentTask;return!0}updateCurrentPageLabel(){this.page.options.forEach(e=>{e.id===this.page.selection.value&&(this.page.selection.label=e.name)})}setIsNew(e){this.page.selection.isNew=e,e?this.page.selection.value=null:this.page.selection.label=null}handleAddMetadata(e){this.modalService.show(Y,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(e.collection)}handleNextPage(){if(this.page.index+1<this.pages.length){const e=this.pages[this.page.index+1];"CATEGORY"===this.page.type&&(this.updateCurrentPageLabel(),this.labels.push(this.page.selection.label)),"CATEGORY"===e.type?"FILE"===this.page.type?this.page=e:!this.page.selection.isNew&&null!=this.page.selection.value&&this.page.selection.value.length>0?this.service.getChildren(this.page.selection.value).then(t=>{e.options=t.filter(t=>t.type===e.selection.type),this.page=e}).catch(e=>{this.error(e)}):this.page=e:(this.page=e,this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!1},{label:"Final",active:!0,enabled:!1}]})}}handleBackPage(){if(this.page.index>0){const e=this.pages[this.page.index-1];"CATEGORY"===e.type&&(this.labels.splice(this.labels.length-1,1),this.modalStepConfig.steps.forEach(e=>{"category"===e.label.toLowerCase()&&!1===e.enabled&&(this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]})})),this.page=e}}handleUpload(){if(this.existingTask)this.uploader.uploadStoredFiles();else{const e=this.selections[this.selections.length-1];this.values.selections=JSON.stringify(this.selections),this.values.uploadTarget=this.metadataService.getUploadTarget(e.type),this.values.processUpload=this.processUpload,this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()}}hasField(e){return this.metadataService.hasExtraField(this.page.selection.type,e)}removeUpload(e){let t=this;this.bsModalRef=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Cancel Upload",this.bsModalRef.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),t.existingTask=!1,this.page=this.pages[0]}).catch(e=>{this.error(e)})})}updateProcessUpload(e){this.processUpload=e}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let n=Math.floor(t/3600),c=Math.floor(t%3600/60),i=Math.floor(t%60),a=c<10?"0"+n:n,o=c<10?"0"+c:c,s=i<10?"0"+i:i;e.uploadCounter=a+":"+o+":"+s}),1e3)}error(e){this.message=I.b.getMessageFromError(e)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}}function Pt(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",5),c.nc(5,"div"),c.nc(6,"p",6),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Ft(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function Nt(e,t){if(1&e){const e=c.oc();c.nc(0,"tr"),c.nc(1,"td",25),c.nc(2,"a",26),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(3).handleDownloadFile(n)})),c.mc(),c.nc(3,"a",27),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(3).handleDelete(n)})),c.mc(),c.mc(),c.nc(4,"td"),c.bd(5),c.mc(),c.nc(6,"td"),c.bd(7),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(5),c.cd(e.name),c.Ub(2),c.cd(e.lastModified)}}function Dt(e,t){1&e&&(c.bd(0," Drag & Drop File "),c.nc(1,"button",28),c.vc("click",(function(){return(0,t.openFileSelector)()})),c.bd(2,"Browse Files"),c.mc())}Rt.ɵfac=function(e){return new(e||Rt)(c.hc(j),c.hc(ee),c.hc(Z.b),c.hc(Z.a),c.hc(c.E))},Rt.ɵcmp=c.bc({type:Rt,selectors:[["upload-modal"]],viewQuery:function(e,t){var n;(1&e&&c.fd(pt,!0),2&e)&&(c.Oc(n=c.wc())&&(t.content=n.first))},hostBindings:function(e,t){1&e&&c.vc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.Qc)},decls:60,vars:16,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[1,"row",3,"hidden"],[1,"col-md-2"],[1,"col-md-8"],[4,"ngIf"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],[1,"",3,"hidden"],[1,"well"],[1,"table"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"row","error-container"],[1,"label-holder"],[2,"color","#8c0000"],[1,"holder"],[1,"error-message"],[1,"list-group","list-group-horizontal"],[3,"stepConfig"],[1,"breadcrumb"],[4,"ngFor","ngForOf"],[1,"form-group"],[3,"for"],["class","form-group",4,"ngIf"],["required","",3,"name","ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button btn btn-primary","class","btn btn-primary",3,"click",4,"ngIf"],[3,"value"],["type","button btn btn-primary",1,"btn","btn-primary",3,"click"],["autofocus","","name","label","type","input","required","",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[3,"page","pageChange",4,"ngIf"],["for","platform",2,"margin-top","10px"],["name","collectionDate","type","date","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"page","pageChange"],["class","form-group",4,"ngFor","ngForOf"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],["label","Generate products from raw images",3,"value","valueChange"],["type","input","disabled","","required","",1,"form-control",3,"ngModel","name","ngModelChange"],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],["type","button",1,"btn","btn-danger",2,"margin-top","20px",3,"click"],[1,"icon-upload","icon-white"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],["type","button btn btn-primary",1,"btn","btn-secondary",3,"disabled","click"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,mt,11,1,"div",1),c.Zc(3,ht,5,1,"div",2),c.Zc(4,gt,5,1,"div",2),c.Zc(5,Ct,8,4,"div",2),c.Zc(6,wt,10,4,"div",2),c.nc(7,"div",3),c.ic(8,"div",4),c.nc(9,"div",5),c.Zc(10,Mt,15,0,"div",6),c.Zc(11,Ot,13,1,"div",7),c.nc(12,"div",8),c.nc(13,"div",9),c.nc(14,"h4"),c.bd(15,"All files uploaded through the upload wizard must"),c.mc(),c.nc(16,"ul"),c.nc(17,"li"),c.bd(18,"be compressed into a .zip or .tar.gz format "),c.mc(),c.nc(19,"li"),c.bd(20,"not contain spaces or special characters such as <,>, -, +, =, !, @, #, $, %, ^, &, *, ?,/,\\ or apostrophes in any file name"),c.mc(),c.mc(),c.nc(21,"h4"),c.bd(22," Supported File Formats "),c.mc(),c.nc(23,"table",10),c.nc(24,"thead"),c.nc(25,"tr"),c.nc(26,"th"),c.bd(27,"Type"),c.mc(),c.nc(28,"th"),c.bd(29,"Formats"),c.mc(),c.mc(),c.mc(),c.nc(30,"tbody"),c.nc(31,"tr"),c.nc(32,"td"),c.bd(33,"RGB Image Data"),c.mc(),c.nc(34,"td"),c.bd(35,"jpg, jpeg, png"),c.mc(),c.mc(),c.nc(36,"tr"),c.nc(37,"td"),c.bd(38,"Multispectral Image Data"),c.mc(),c.nc(39,"td"),c.bd(40,"tif"),c.mc(),c.mc(),c.nc(41,"tr"),c.nc(42,"td"),c.bd(43,"Video"),c.mc(),c.nc(44,"td"),c.bd(45,"mp4"),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(46,Ut,26,9,"div",11),c.ic(47,"div",12,13),c.mc(),c.mc(),c.ic(49,"div",4),c.mc(),c.mc(),c.nc(50,"div",14),c.nc(51,"div",15),c.nc(52,"div",16),c.nc(53,"div",17),c.nc(54,"button",18),c.vc("click",(function(){return t.close()})),c.nc(55,"span",19),c.bd(56,"Close"),c.mc(),c.mc(),c.Zc(57,St,3,1,"button",20),c.Zc(58,It,3,1,"button",21),c.Zc(59,Tt,3,1,"button",21),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",!t.existingTask),c.Ub(1),c.Ec("ngIf",!t.existingTask&&t.labels.length>0),c.Ub(1),c.Ec("ngIf","CATEGORY"===t.page.type),c.Ub(1),c.Ec("ngIf","SUMMARY"===t.page.type&&!t.existingTask&&null==t.currentTask),c.Ub(1),c.Ec("@fadeInOnEnter",void 0)("hidden","FILE"!==t.page.type&&"SUMMARY"!==t.page.type),c.Ub(3),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("ngForOf",t.taskFinishedNotifications),c.Ub(1),c.Ec("hidden",!t.uploadVisible),c.Ub(34),c.Ec("ngIf",t.currentTask),c.Ub(8),c.Ec("disabled",t.disabled)("disabled",t.disabled),c.Ub(3),c.Ec("ngIf",!t.existingTask&&t.page.index>0),c.Ub(1),c.Ec("ngIf",!t.existingTask&&t.page.index<t.pages.length-1),c.Ub(1),c.Ec("ngIf",t.page.index===t.pages.length-1))},styles:[".list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tdisplay: inline-block;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tmargin-bottom: 0;\n\tmargin-left: -4px;\n\tmargin-right: 0;\n\tborder-right-width: 0;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child {\n\tborder-top-right-radius: 0;\n\tborder-bottom-left-radius: 4px;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child {\n\tborder-top-right-radius: 4px;\n\tborder-bottom-left-radius: 0;\n\tborder-right-width: 1px;\n}\n\n.list-group-item-success[_ngcontent-%COMP%] {\n\tcolor: #155724;\n\tbackground-color: #c3e6cb;\n}"],data:{animation:[Object(K.c)(),Object(K.d)()]}});const At=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function jt(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",17),c.vc("selectTab",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).onSelect(n)})),c.nc(1,"div",18),c.nc(2,"div",19),c.nc(3,"table",20),c.nc(4,"thead"),c.nc(5,"tr"),c.ic(6,"th",21),c.nc(7,"th",21),c.bd(8,"Name"),c.mc(),c.nc(9,"th",21),c.bd(10,"Date uploaded"),c.mc(),c.mc(),c.mc(),c.nc(11,"tbody",22),c.Zc(12,Nt,8,2,"tr",10),c.yc(13,"paginate"),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",19),c.nc(16,"ngx-file-drop",23),c.vc("onFileDrop",(function(t){return c.Rc(e),c.xc(2).dropped(t)})),c.Zc(17,Dt,3,0,"ng-template",24),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ec("heading",e.name),c.Ub(12),c.Ec("ngForOf",c.Ac(13,2,n.page.results,c.Kc(5,At,n.page.pageSize,n.page.pageNumber,n.page.count)))}}function Zt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h2"),c.bd(4),c.mc(),c.mc(),c.mc(),c.nc(5,"div",7),c.nc(6,"div",8),c.nc(7,"ul",9),c.Zc(8,Ft,3,1,"li",10),c.mc(),c.mc(),c.mc(),c.nc(9,"div",7),c.nc(10,"tabset",11),c.Zc(11,jt,18,9,"tab",12),c.mc(),c.mc(),c.nc(12,"div",7),c.nc(13,"pagination-controls",13),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",14),c.nc(16,"button",15),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(17,"Close"),c.mc(),c.nc(18,"button",16),c.vc("click",(function(){return c.Rc(e),c.xc().handleDownload()})),c.bd(19,"Download all"),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.cd(e.entity.name),c.Ub(4),c.Ec("ngForOf",e.previous),c.Ub(3),c.Ec("ngForOf",e.folders)}}class _t{constructor(e,t,n){this.service=e,this.modalService=t,this.bsModalRef=n,this.previous=[],this.folders=[],this.page=new H}ngOnInit(){this.page.count=0,this.page.pageNumber=1,this.page.pageSize=10,this.page.results=[]}init(e,t,n){this.entity=e,this.folders=t,this.previous=[...n],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.folders.length>0&&this.onSelect(this.folders[0])}onPageChange(e){this.getData(this.folder.component,this.folder.name,e,this.page.pageSize)}onSelect(e){this.page.results=[],this.folder=e,this.getData(e.component,e.name,1,this.page.pageSize)}refresh(){this.page.results=[],this.getData(this.folder.component,this.folder.name,this.page.pageNumber,this.page.pageSize)}getData(e,t,n,c){this.service.getObjects(e,t,n,c).then(e=>{this.page=e})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.folder.component+"&key="+this.folder.name}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.folder.component+"&key="+e.key}dropped(e){for(const t of e)if(t.fileEntry.isFile){t.fileEntry.file(e=>{this.service.upload(this.folder.component,this.folder.name,e).then(()=>{this.refresh()})})}else{const e=t.fileEntry;console.log(t.relativePath,e)}}handleDelete(e){let t=this.modalService.show(I.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.message="Are you sure you want to delete the file ["+e.name+"]?",t.content.type="DANGER",t.content.submitText="Delete",t.content.onConfirm.subscribe(()=>{this.remove(e)})}remove(e){this.service.removeObject(e.component,e.key).then(()=>{this.refresh()})}error(e){this.message=I.b.getMessageFromError(e)}}_t.ɵfac=function(e){return new(e||_t)(c.hc(j),c.hc(Z.b),c.hc(Z.a))},_t.ɵcmp=c.bc({type:_t,selectors:[["accessible-support-modal"]],decls:4,vars:2,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"nav-full-width"],[3,"heading","selectTab",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 10px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"click"],[3,"heading","selectTab"],[1,"row","image-list-container"],[1,"col-sm-12"],[1,"table","table-striped"],["scope","col"],[1,"upload-name-style"],["dropZoneLabel","Drop files here",3,"onFileDrop"],["ngx-file-drop-content-tmp",""],[1,"button-column"],["title","Download",1,"fa","fa-download",3,"click"],["title","Remove",1,"fa","fa-trash-alt","ico-remove",2,"margin-left","5px",3,"click"],["type","button",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div"),c.Zc(2,Pt,8,1,"div",1),c.Zc(3,Zt,20,3,"div",2),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",null!=t.entity))},directives:[i.t,i.s,p.e,h.c,p.b,s.a,s.c],pipes:[h.b],encapsulation:2});var Lt=n(393),$t=n(60);const zt=["staticTabs"],Bt=["confirmTemplate"];function qt(e,t){1&e&&(c.nc(0,"div",3),c.nc(1,"div",30),c.nc(2,"h3",31),c.bd(3,"IDM Sites"),c.mc(),c.mc(),c.mc())}function Ht(e,t){if(1&e){const e=c.oc();c.nc(0,"a",35),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).back(t)})),c.bd(1),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ub(1),c.dd(" ",e.name,"")}}function Wt(e,t){if(1&e&&(c.nc(0,"span"),c.nc(1,"b"),c.bd(2),c.mc(),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(2),c.cd(e.name)}}const Gt=function(e){return{active:e}};function Vt(e,t){if(1&e&&(c.nc(0,"li",37),c.Zc(1,Ht,2,1,"a",38),c.Zc(2,Wt,3,1,"span",26),c.mc()),2&e){const e=t.last;c.Ec("ngClass",c.Ic(3,Gt,e)),c.Ub(1),c.Ec("ngIf",!e),c.Ub(1),c.Ec("ngIf",e)}}function Jt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",3),c.nc(1,"div",32),c.nc(2,"ul",33),c.nc(3,"li"),c.ic(4,"i",34),c.nc(5,"a",35),c.vc("click",(function(){return c.Rc(e),c.xc().back(null)})),c.bd(6,"IDM Sites"),c.mc(),c.mc(),c.Zc(7,Vt,3,5,"li",36),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(7),c.Ec("ngForOf",e.breadcrumbs)}}function Xt(e,t){1&e&&(c.nc(0,"span"),c.nc(1,"h4"),c.ic(2,"i",40),c.bd(3," Loading Sites "),c.mc(),c.mc())}function Yt(e,t){1&e&&(c.nc(0,"span"),c.nc(1,"h4"),c.bd(2,"No Sites in this area."),c.mc(),c.nc(3,"p"),c.bd(4," Zoom out to find sites in other areas of the map. "),c.mc(),c.mc())}function Kt(e,t){if(1&e&&(c.nc(0,"div",39),c.Zc(1,Xt,4,0,"span",26),c.Zc(2,Yt,5,0,"span",26),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(1),c.Ec("ngIf",e.loadingSites),c.Ub(1),c.Ec("ngIf",!e.loadingSites)}}function Qt(e,t){1&e&&(c.nc(0,"div",39),c.nc(1,"h4"),c.bd(2,"No data at this level."),c.mc(),c.nc(3,"p"),c.bd(4," Create data containers as part of the upload process. "),c.mc(),c.mc()),2&e&&c.Ec("@fadeInOnEnter",void 0)}function en(e,t){if(1&e){const e=c.oc();c.nc(0,"span",48),c.nc(1,"a",49),c.vc("click",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc().handleEdit(n,t)})),c.mc(),c.nc(2,"a",50),c.vc("click",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc().handleDelete(n,t)})),c.mc(),c.mc()}}function tn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",44),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().select(n,null,t)}))("mouseenter",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().onListEntityHover(t,n)}))("mouseleave",(function(){return c.Rc(e),c.xc(2).onListEntityHoverOff()})),c.nc(1,"div",45),c.nc(2,"div"),c.nc(3,"h4",46),c.bd(4),c.mc(),c.nc(5,"span"),c.nc(6,"span"),c.nc(7,"b"),c.bd(8),c.mc(),c.bd(9),c.mc(),c.Zc(10,en,3,0,"span",47),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("@fadeInOnEnter",void 0)("ngClass",c.Ic(6,Gt,t.hoverFeatureId===e.id)),c.Ub(4),c.dd(" ",e.name," "),c.Ub(4),c.cd(e.numberOfChildren),c.Ub(1),c.dd(" ",t.getMetadata(e).childLabel,""),c.Ub(1),c.Ec("ngIf","folder"!==e.type)}}function nn(e,t){if(1&e){const e=c.oc();c.nc(0,"span",59),c.nc(1,"a",49),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(3).handleEdit(n,t)})),c.mc(),c.nc(2,"a",50),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(3).handleDelete(n,t)})),c.mc(),c.mc()}}function cn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",57),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit,a=c.xc(2).$implicit;return c.xc().select(i,a,n)})),c.bd(1),c.Zc(2,nn,3,0,"span",58),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," "),c.Ub(1),c.Ec("ngIf","folder"!==e.type)}}const an=function(e){return{"fa-rotate-270":e}};function on(e,t){if(1&e){const e=c.oc();c.nc(0,"div",51),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().select(n,null,t)})),c.nc(1,"div",52),c.nc(2,"i",53),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().handleExpand(n,t)})),c.mc(),c.nc(3,"h4",54),c.bd(4),c.mc(),c.nc(5,"p"),c.nc(6,"b"),c.bd(7),c.mc(),c.bd(8),c.mc(),c.nc(9,"div",55),c.Zc(10,cn,3,2,"div",56),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngClass",c.Ic(7,an,e.active)),c.Ub(2),c.cd(e.name),c.Ub(3),c.cd(e.numberOfChildren),c.Ub(1),c.dd(" ",t.getMetadata(e).childLabel,""),c.Ub(1),c.Ec("collapse",!e.active),c.Ub(1),c.Ec("ngForOf",e.children)}}function sn(e,t){if(1&e&&(c.nc(0,"div",41),c.Zc(1,tn,11,8,"div",42),c.Zc(2,on,11,9,"div",43),c.mc()),2&e){const e=t.$implicit,n=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(1),c.Ec("ngIf",n.getMetadata(e).root),c.Ub(1),c.Ec("ngIf",!n.getMetadata(e).root)}}function ln(e,t){if(1&e){const e=c.oc();c.nc(0,"div",41),c.nc(1,"div",60),c.nc(2,"div",52),c.nc(3,"h4",54),c.bd(4,"Supporting Data"),c.mc(),c.nc(5,"div",14),c.nc(6,"div",61),c.nc(7,"a",62),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().select(i,null,n)})),c.bd(8),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(7),c.dd(" ",e.name," ")}}function rn(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",63),c.nc(1,"div",13),c.nc(2,"product-panel",64),c.vc("toggleMapOrtho",(function(t){return c.Rc(e),c.xc().handleMapOrtho(t)}))("toggleMapDem",(function(t){return c.Rc(e),c.xc().handleMapDem(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("id",e.current.id)}}function dn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",65),c.nc(1,"div",66),c.nc(2,"button",67),c.vc("click",(function(){return c.Rc(e),c.xc().handleUploadFile()})),c.bd(3,"Upload"),c.mc(),c.mc(),c.mc()}}function pn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",65),c.nc(1,"div",66),c.nc(2,"button",67),c.vc("click",(function(){return c.Rc(e),c.xc().handleCreate(null,null)})),c.bd(3,"Add new site"),c.mc(),c.mc(),c.mc()}}function mn(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",73),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",62),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleViewSite(t.collection)})),c.bd(5,"Goto the collection view"),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". ")}}function hn(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",74),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",75),c.bd(5,"task page"),c.mc(),c.bd(6," for more details. "),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". Task completed with warnings. See the ")}}function un(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",76),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",75),c.bd(5,"task page"),c.mc(),c.bd(6," for more details. "),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". Task completed with errors. See the ")}}function gn(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",77),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". ")}}function bn(e,t){if(1&e&&(c.nc(0,"div",68),c.Zc(1,mn,6,3,"alert",69),c.Zc(2,hn,7,3,"alert",70),c.Zc(3,un,7,3,"alert",71),c.Zc(4,gn,4,3,"alert",72),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","Complete"===e.status&&0===e.actions.length),c.Ub(1),c.Ec("ngIf","Complete"===e.status&&0!==e.actions.length),c.Ub(1),c.Ec("ngIf","Failed"===e.status),c.Ub(1),c.Ec("ngIf","Failed"!==e.status&&"Complete"!==e.status)}}function fn(e,t){1&e&&c.ic(0,"i",78)}function vn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",80),c.nc(1,"input",81),c.vc("change",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleStyle(n)})),c.mc(),c.nc(2,"label",82),c.bd(3),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("value",e.id)("checked",e.selected),c.Ub(2),c.cd(e.label)}}function yn(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,vn,4,3,"div",79),c.mc()),2&e){const e=c.xc();c.Ub(1),c.Ec("ngForOf",e.baseLayers)}}function kn(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",84),c.mc())}function xn(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",85),c.mc())}function Cn(e,t){if(1&e&&(c.nc(0,"span"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.label," / ")}}function En(e,t){if(1&e&&(c.Zc(0,kn,2,0,"span",26),c.Zc(1,xn,2,0,"span",26),c.nc(2,"span"),c.Zc(3,Cn,2,1,"span",83),c.mc(),c.nc(4,"b"),c.bd(5),c.mc()),2&e){const e=t.match;c.Ec("ngIf",null==e.item.filename),c.Ub(1),c.Ec("ngIf",null!=e.item.filename),c.Ub(2),c.Ec("ngForOf",e.item.hierarchy),c.Ub(2),c.cd(e.item.label)}}const wn=function(){return{standalone:!0}};class Mn{constructor(e,t,n,c,i,a){this.service=e,this.authService=t,this.mapService=n,this.modalService=c,this.metadataService=i,this.route=a,this.userName="",this.search="",this.nodes=[],this.supportingData=[],this.breadcrumbs=[],this.admin=!1,this.worker=!1,this.active=!1,this.loadingSites=!0,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.layers=[],this.baselayerIconHover=!1,this.tasks=[],this.subject=new q.b,this.subject.pipe(Object(R.a)(300),Object(P.a)()).subscribe(e=>this.handleExtentChange(e)),this.dataSource=v.a.create(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const n=t.features;this.service.searchEntites(this.search).then(t=>{n.forEach(e=>{let n={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};t.push(n)}),e.next(t)})})})}ngOnInit(){this.admin=this.authService.isAdmin(),this.worker=this.authService.isWorker(),this.userName=this.service.getCurrentUser();let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Lt.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"UPLOAD_JOB_CHANGE"===e.type&&this.tasks.push(e.content)});const t=this.route.snapshot.params.oid,n=this.route.snapshot.params.action;null!=t&&null!=n&&"collection"===n&&this.handleViewSite(t)}ngOnDestroy(){this.map.remove(),this.notifier.complete()}ngAfterViewInit(){this.map=new g.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v11",zoom:2,attributionControl:!1,center:[-78.880453,42.897852]}),this.map.on("load",()=>{this.initMap()})}initMap(){this.map.on("style.load",()=>{this.addLayers(),this.refreshMapPoints(!1)}),this.addLayers(),this.refreshMapPoints(!0),this.map.addControl(new g.NavigationControl),this.map.addControl(new g.AttributionControl({compact:!0}),"bottom-left"),this.map.on("mousemove",e=>{let t=e.lngLat.wrap(),n="Lat: "+t.lat+" Long: "+t.lng;document.getElementById("mousemove-panel").textContent=n;let c=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(null==this.current)if(c.length>0){let e=c[0].properties.oid;this.map.setFilter("hover-points",["all",["==","oid",e]]),this.highlightListItem(e)}else this.map.setFilter("hover-points",["all",["==","oid","NONE"]]),this.clearHighlightListItem()}),this.map.on("zoomend",e=>{this.subject.next(e)}),this.map.on("moveend",e=>{this.subject.next(e)}),this.map.on("dblclick",e=>{let t=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(t.length>0){let e=t[0].properties.oid;this.handleViewSite(e)}}),document.getElementById("navigator-left-sidebar").addEventListener("mouseenter",(function(){document.getElementById("mousemove-panel").textContent=""}))}addLayers(){this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"points",type:"circle",source:"sites",paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}}),this.map.addLayer({id:"hover-points",type:"circle",source:"sites",paint:{"circle-radius":13,"circle-color":"#cf0000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["==","id","NONE"]]}),this.map.addLayer({id:"points-label",source:"sites",type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":"{name}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}}),this.layers.forEach(e=>{e.isMapped&&this.addImageLayer(e)})}handleExtentChange(e){if(null==this.current){const e=this.map.getBounds();this.isValidBounds(e)&&(this.loadingSites=!0,this.service.roots(null,e).then(e=>{this.nodes=e,this.loadingSites=!1}))}}isValidBounds(e){const t=e.getNorthEast(),n=e.getSouthWest();return!(Math.abs(t.lng)>180||Math.abs(n.lng)>180)&&!(Math.abs(t.lat)>90||Math.abs(n.lat)>90)}refreshMapPoints(e){this.mapService.features().then(t=>{this.map.getSource("sites").setData(t.features),e&&(this.allPointsBounds=new g.LngLatBounds([t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]),this.map.fitBounds(this.allPointsBounds,{padding:50}))})}isData(e){return"Site"!==e.data.type&&("Project"!==e.data.type&&("Mission"!==e.data.type&&("Collection"!==e.data.type&&"Imagery"!==e.data.type)))}handleOnUpdateData(){}handleCloseToast(e){this.tasks.splice(e,1)}handleUploadFile(){this.bsModalRef=this.modalService.show(Rt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(this.breadcrumbs),this.bsModalRef.content.onUploadComplete.subscribe(e=>{this.service.getItems(this.current.id,null).then(e=>{this.setNodes(e)})})}handleCreate(e,t){let n=null!=e?e.id:null;this.service.newChild(n,t).then(t=>{this.bsModalRef=this.modalService.show(st,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(!0,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),null!=e&&(this.bsModalRef.content.parentId=e.id),this.bsModalRef.content.onNodeChange.subscribe(t=>{null!=e||(0==this.breadcrumbs.length&&this.nodes.push(t),this.refreshMapPoints(!1))})})}zoomToFeature(e){null!=e.geometry&&this.map.flyTo({center:e.geometry.coordinates})}handleEdit(e,t){t.stopPropagation(),this.service.edit(e.id).then(t=>{this.bsModalRef=this.modalService.show(st,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"edit-modal"}),this.bsModalRef.content.init(!1,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),this.bsModalRef.content.onNodeChange.subscribe(t=>{t.children=e.children,t.active=e.active,this.refreshEntity(t,this.nodes),this.refreshEntity(t,this.breadcrumbs),this.nodes.forEach(e=>{this.refreshEntity(t,e.children)}),this.metadataService.getMetadata(t).root&&this.refreshMapPoints(!1)})})}refreshEntity(e,t){if(null!=t){let n=t.findIndex(t=>t.id===e.id);-1!==n&&(t[n]=e)}}handleDownloadAll(e){window.location.href=acp+"/project/download-all?id="+e.component+"&key="+e.name}handleDelete(e,t){t.stopPropagation();let n="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files in Collections and Accessible Support";"Collection"===e.type&&(n="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files."),n+=" This can <b>NOT</b> be undone",this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.subText=n,this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.service.remove(e.id).then(()=>{this.nodes=this.nodes.filter(t=>t.id!==e.id),this.nodes.forEach(t=>{null!=t.children&&(t.children=t.children.filter(t=>t.id!==e.id),t.numberOfChildren=t.children.length)}),"Site"===e.type&&this.refreshMapPoints(!1)})}handleDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleImageDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}highlightMapFeature(e){this.map.setFilter("hover-points",["all",["==","oid",e]])}clearHighlightMapFeature(){this.map.setFilter("hover-points",["all",["==","oid","NONE"]])}onListEntityHover(e,t){null==this.current&&this.highlightMapFeature(t.id)}onListEntityHoverOff(){this.clearHighlightMapFeature()}highlightListItem(e){this.nodes.forEach(t=>{t.id===e&&(this.hoverFeatureId=e)})}clearHighlightListItem(){this.hoverFeatureId&&this.nodes.forEach(e=>{e.id===this.hoverFeatureId&&(this.hoverFeatureId=null)})}handleClick(e){let t=e.item;if(t.center)this.map.flyTo({center:t.center,zoom:18});else{const e=t.hierarchy.length-1,n=t.hierarchy[e];this.handleViewSite(n.id)}}handleViewSite(e){this.service.view(e).then(e=>{const t=e.item,n=e.breadcrumbs;if(this.getMetadata(t).leaf)this.breadcrumbs=n,this.current=n[n.length-1],this.nodes=this.current.children,this.select(t,null,null);else{const e=n.length>0?n[n.length-1]:null;this.breadcrumbs=n,this.select(t,e,null)}})}handleMapOrtho(e){const t=this.getLayerByClassification("ORTHO",e);if(null!=t&&null!=t.key)if(null!=this.map.getLayer(t.key))this.map.removeLayer(t.key),this.map.removeSource(t.key),t.isMapped=!1,e.orthoMapped=!1;else if(this.addImageLayer(t),t.isMapped=!0,e.orthoMapped=!0,null!=e.boundingBox){let t=e.boundingBox,n=new g.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(n,{padding:50})}}getLayerByClassification(e,t){let n=t.layers.length;for(let c=0;c<n;++c){let n=t.layers[c];if(n.classification===e)return n}return null}handleMapDem(e){const t=this.getLayerByClassification("DEM_DSM",e);if(null!=t&&null!=t.key)if(null!=this.map.getLayer(t.key))this.map.removeLayer(t.key),this.map.removeSource(t.key),t.isMapped=!1,e.demMapped=!1;else if(this.addImageLayer(t),t.isMapped=!0,e.demMapped=!0,null!=e.boundingBox){let t=e.boundingBox,n=new g.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(n,{padding:50})}}addImageLayer(e){const t=encodeURI(e.workspace),n=encodeURI(e.workspace+":"+e.key);this.map.addLayer({id:e.key,type:"raster",source:{type:"raster",tiles:["/geoserver/"+t+"/wms?layers="+n+"&bbox={bbox-epsg-3857}&format=image/png&service=WMS&version=1.1.1&request=GetMap&srs=EPSG:3857&transparent=true&width=256&height=256"],tileSize:256},paint:{}},"points")}handleGoto(){var e=new g.LngLatBounds([-111.12439336274211,39.32066259372583,-111.12342302258116,39.32107716199166]);this.map.fitBounds(e)}getMetadata(e){return this.metadataService.getMetadata(e)}select(e,t,n){if(null!=n&&n.stopPropagation(),null!=e&&null!=e.geometry&&"Point"===e.geometry.type&&this.map.easeTo({center:e.geometry.coordinates,zoom:8}),this.metadataService.getMetadata(e).leaf){const n=[...this.breadcrumbs];null!=t&&n.push(t),this.metadataService.getTypeContainsFolders(e)?this.service.getItems(e.id,null).then(t=>{this.showLeafModal(e,t,n)}):this.showLeafModal(this.current,[e],n)}else"object"===e.type||this.service.getItems(e.id,null).then(n=>{this.current=e,null!=t&&this.addBreadcrumb(t),this.addBreadcrumb(e),this.setNodes(n)})}addBreadcrumb(e){0!=this.breadcrumbs.length&&this.breadcrumbs[this.breadcrumbs.length-1].id===e.id||this.breadcrumbs.push(e)}handleExpand(e,t){null!=t&&t.stopPropagation(),null==e.children||0==e.children.length?this.service.getItems(e.id,null).then(t=>{e.children=t,this.expand(e)}):(e.children=[],e.active=!1)}handleGotoSite(e){const t=e.entities[e.entities.length-1],n=e.entities;this.service.getItems(t.id,null).then(e=>{this.showLeafModal(t,e,n)})}back(e){null!=e?(null!=e.geometry&&"Point"===e.geometry.type&&this.map.easeTo({center:e.geometry.coordinates,zoom:8}),this.service.getItems(e.id,null).then(t=>{var n=this.breadcrumbs.findIndex(t=>t.id===e.id);this.current=e,this.breadcrumbs.splice(n+1),this.setNodes(t)})):this.breadcrumbs.length>0&&(this.loadingSites=!0,this.service.roots(null,null).then(e=>{this.loadingSites=!1,this.breadcrumbs=[],this.setNodes(e),this.staticTabs.tabs[0].active=!0,this.map.fitBounds(this.allPointsBounds,{padding:50});let t=this;window.setTimeout((function(){t.current=null}),500)}))}expand(e){e.active=!0,this.current=e}setNodes(e){this.nodes=[],this.supportingData=[],e.forEach(e=>{"folder"===e.type?this.supportingData.push(e):this.nodes.push(e)})}showLeafModal(e,t,n){"Mission"===e.type?(this.bsModalRef=this.modalService.show(_t,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,n)):(this.bsModalRef=this.modalService.show(Oe,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,n))}}Mn.ɵfac=function(e){return new(e||Mn)(c.hc(j),c.hc(A.a),c.hc(x),c.hc(Z.b),c.hc(ee),c.hc(a.a))},Mn.ɵcmp=c.bc({type:Mn,selectors:[["projects"]],viewQuery:function(e,t){var n;(1&e&&(c.fd(zt,!0),c.fd(Bt,!0)),2&e)&&(c.Oc(n=c.wc())&&(t.staticTabs=n.first),c.Oc(n=c.wc())&&(t.confirmTemplate=n.first))},decls:40,vars:20,consts:[["id","navigator-header-container"],[3,"title"],["id","app-container",1,"container-fluid",2,"background","#f7f7f7"],[1,"row"],["id","navigator-left-sidebar",1,"col-md-3","lw-inner-col"],[1,"col-md-12"],["class","row",4,"ngIf"],[1,"location-management-widget-section"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[1,"col-md-12",2,"background","#f7f7f7","padding","0","height","100%"],[1,"nav-full-width"],["staticTabs",""],["heading","Data"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container",2,"height","calc(100vh - 296px)","overflow-y","auto"],[1,"list-group"],["style","padding: 20px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["heading","Products",4,"ngIf"],[1,"sidebar-footer"],["class","row","style","background:white;",4,"ngIf"],["id","site-explorer-map",1,"col-md-9"],[2,"position","absolute","z-index","5","margin-left","100px","margin-top","10px"],["class","idm-toast",4,"ngFor","ngForOf"],[1,"base-layer-panel"],[1,"layer-toggle",2,"cursor","pointer","background","#fff","padding","8px","border-radius","4px",3,"mouseenter","mouseleave"],["class","fas fa-layer-group","style","vertical-align:middle; font-size: 18px;",4,"ngIf"],[4,"ngIf"],["id","mousemove-panel",1,"mapboxgl-ctrl-bottom-right",2,"background","rgba(255, 255, 255, .5)","right","0","padding","0 5px 0 5px","bottom","0px"],["id","map",1,"map-view-port"],["bsItemTemplate",""],[1,"col-md-6",2,"height","64px"],[2,"font-weight","bold"],[1,"col-md-12",2,"height","65px","overflow","auto"],[1,"breadcrumb",2,"background-color","white","vertical-align","middle","line-height","2"],["aria-hidden","true",1,"fa","fa-angle-left","breadcrumb-back-ico"],[2,"color","#007276",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["style","color: #007276;",3,"click",4,"ngIf"],[2,"padding","20px","text-align","center","color","grey"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin"],[1,"list-group-item"],["style","border-left: solid 15px;","class","card card-default clickable",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","card card-default clickable",3,"click",4,"ngIf"],[1,"card","card-default","clickable",2,"border-left","solid 15px",3,"ngClass","click","mouseenter","mouseleave"],[1,"card-body","card-5-7"],[2,"word-break","break-all","border-bottom-color","rgba(195, 195, 195, 0.3)","border-bottom-style","inset","border-bottom-width","2px","margin-bottom","10px","padding-bottom","10px"],["class","pull-right",4,"ngIf"],[1,"pull-right"],["title","Edit",1,"fa","fa-pencil-alt","ico-edit",3,"click"],["title","Delete",1,"fa","fa-trash-alt","ico-remove",3,"click"],[1,"card","card-default","clickable",3,"click"],[1,"card-body"],["aria-hidden","true",1,"fa","fa-caret-left","expand-arrow-ico","pull-right",2,"font-size","25px","padding","0 5px",3,"ngClass","click"],[2,"word-break","break-all"],[1,"list-group",2,"margin-bottom","0",3,"collapse"],["class","list-group-item","style","background-color: #ececec;border: solid 1px lightgrey;border-radius: 0;",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0",3,"click"],["class","pull-right button-column",4,"ngIf"],[1,"pull-right","button-column"],[1,"card","card-default"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0"],[3,"click"],["heading","Products"],[3,"id","toggleMapOrtho","toggleMapDem"],[1,"row",2,"background","white"],[1,"col-md-12",2,"text-align","center","padding","10px","border-top","1px solid lightgrey"],[1,"btn","btn-primary",3,"click"],[1,"idm-toast"],["type","success",3,"dismissible","onClosed",4,"ngIf"],["type","warning",3,"dismissible","onClosed",4,"ngIf"],["type","danger",3,"dismissible","onClosed",4,"ngIf"],["type","info",3,"dismissible","onClosed",4,"ngIf"],["type","success",3,"dismissible","onClosed"],["type","warning",3,"dismissible","onClosed"],["routerLink","/site/tasks"],["type","danger",3,"dismissible","onClosed"],["type","info",3,"dismissible","onClosed"],[1,"fas","fa-layer-group",2,"vertical-align","middle","font-size","18px"],["class","row-form",4,"ngFor","ngForOf"],[1,"row-form"],["type","radio","name","rtoggle",1,"layer-toggle-input",3,"value","checked","change"],[1,"layer-toggle-label"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(c.nc(0,"div",0),c.ic(1,"uasdm-header",1),c.mc(),c.nc(2,"div",2),c.nc(3,"div",3),c.nc(4,"div",4),c.nc(5,"div",3),c.nc(6,"div",5),c.Zc(7,qt,4,0,"div",6),c.Zc(8,Jt,8,1,"div",6),c.nc(9,"div",3),c.nc(10,"div",5),c.nc(11,"div",7),c.nc(12,"input",8),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(13,"div",3),c.nc(14,"div",9),c.nc(15,"tabset",10,11),c.nc(17,"tab",12),c.nc(18,"div",13),c.nc(19,"div",14),c.Zc(20,Kt,3,3,"div",15),c.Zc(21,Qt,5,1,"div",15),c.Zc(22,sn,3,3,"div",16),c.Zc(23,ln,9,2,"div",16),c.mc(),c.mc(),c.mc(),c.Zc(24,rn,3,1,"tab",17),c.mc(),c.mc(),c.mc(),c.nc(25,"footer",18),c.Zc(26,dn,4,0,"div",19),c.Zc(27,pn,4,0,"div",19),c.mc(),c.mc(),c.nc(28,"div",20),c.nc(29,"div",3),c.nc(30,"article",21),c.Zc(31,bn,5,4,"div",22),c.mc(),c.nc(32,"article",23),c.nc(33,"div",24),c.vc("mouseenter",(function(){return t.baselayerIconHover=!0}))("mouseleave",(function(){return t.baselayerIconHover=!1})),c.Zc(34,fn,1,0,"i",25),c.Zc(35,yn,2,1,"div",26),c.mc(),c.mc(),c.ic(36,"div",27),c.ic(37,"div",28),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(38,En,6,4,"ng-template",null,29,c.ad)),2&e){const e=c.Pc(39);c.Ub(1),c.Ec("title","Site Viewer"),c.Ub(6),c.Ec("ngIf",!t.current),c.Ub(1),c.Ec("ngIf",t.current),c.Ub(4),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",c.Hc(19,wn)),c.Ub(8),c.Ec("ngIf",t.nodes.length<1&&0===t.breadcrumbs.length),c.Ub(1),c.Ec("ngIf",t.nodes.length<1&&t.breadcrumbs.length>0),c.Ub(1),c.Ec("ngForOf",t.nodes),c.Ub(1),c.Ec("ngForOf",t.supportingData),c.Ub(1),c.Ec("ngIf",null!=t.current),c.Ub(2),c.Ec("ngIf",null!=t.current),c.Ub(1),c.Ec("ngIf",null==t.current),c.Ub(4),c.Ec("ngForOf",t.tasks),c.Ub(3),c.Ec("ngIf",!t.baselayerIconHover),c.Ub(1),c.Ec("ngIf",t.baselayerIconHover)}},directives:[$t.a,i.t,o.c,o.k,o.n,r.b,p.e,p.b,i.s,i.q,u.a,Je,m.a,a.e],styles:["./projects.css"],data:{animation:[Object(K.c)(),Object(K.d)()]}});var On=n(55);const Un=["uploader"];function Sn(e,t){1&e&&(c.nc(0,"div",3),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"h4",6),c.bd(4," There are no Sites added to the system. Add a Site, Project, Mission, and Collection using the "),c.nc(5,"a",7),c.bd(6,"Site Viewer"),c.mc(),c.bd(7," before uploading data to. "),c.mc(),c.mc(),c.ic(8,"div",4),c.mc())}function In(e,t){if(1&e){const e=c.oc();c.nc(0,"div",17),c.nc(1,"div",18),c.nc(2,"div",19),c.bd(3,"Partial Upload Detected"),c.mc(),c.nc(4,"div",20),c.nc(5,"h4"),c.bd(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),c.mc(),c.nc(7,"h4"),c.nc(8,"b"),c.bd(9,"To continue an upload"),c.mc(),c.bd(10," please click the Continue Upload button and re-upload your file and we will try our best to continue where you left off. "),c.mc(),c.ic(11,"hr"),c.nc(12,"button",21),c.vc("click",(function(t){return c.Rc(e),c.xc(2).removeUpload(t)})),c.ic(13,"i",16),c.bd(14," Cancel Upload "),c.mc(),c.nc(15,"button",22),c.vc("click",(function(){return c.Rc(e),c.xc(2).showUploadPanel()})),c.ic(16,"i",16),c.bd(17," Continue Upload "),c.mc(),c.mc(),c.mc(),c.mc()}}function Tn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"div",19),c.bd(2," Upload Details "),c.nc(3,"i",24),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).closeTaskFinishedNotification(n.id)})),c.mc(),c.mc(),c.nc(4,"div",20),c.nc(5,"h4"),c.bd(6," Status: "),c.nc(7,"b"),c.bd(8," Upload successfully completed "),c.mc(),c.mc(),c.nc(9,"h4"),c.bd(10," Message: "),c.nc(11,"b"),c.bd(12," Your uploaded data is being processed into final image products. "),c.mc(),c.mc(),c.mc(),c.mc()}}function Rn(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function Pn(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function Fn(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function Nn(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.dd("",e.name," ")}}function Dn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.nc(1,"div",26),c.nc(2,"label",27),c.bd(3,"Site:"),c.mc(),c.nc(4,"select",28),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onSiteSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.site=t})),c.ic(5,"option"),c.Zc(6,Rn,2,2,"option",29),c.mc(),c.mc(),c.nc(7,"div",26),c.nc(8,"label",30),c.bd(9,"Project:"),c.mc(),c.nc(10,"select",31),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onProjectSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.project=t})),c.ic(11,"option"),c.Zc(12,Pn,2,2,"option",29),c.mc(),c.mc(),c.nc(13,"div",26),c.nc(14,"label",32),c.bd(15,"Mission:"),c.mc(),c.nc(16,"select",33),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onMissionSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.mission=t})),c.ic(17,"option"),c.Zc(18,Fn,2,2,"option",29),c.mc(),c.mc(),c.nc(19,"div",26),c.nc(20,"label",34),c.bd(21,"Collection:"),c.mc(),c.nc(22,"select",35),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onCollectionSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.collection=t})),c.ic(23,"option"),c.Zc(24,Nn,2,2,"option",29),c.mc(),c.mc(),c.nc(25,"div",26),c.nc(26,"label",36),c.bd(27,"Output Product Name Prefix"),c.mc(),c.nc(28,"input",37),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.outFileName=t})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(4),c.Ec("ngModel",e.values.site),c.Ub(2),c.Ec("ngForOf",e.sites),c.Ub(4),c.Ec("ngModel",e.values.project),c.Vb("disabled",null==e.values.site?"":null),c.Ub(2),c.Ec("ngForOf",e.projects),c.Ub(4),c.Ec("ngModel",e.values.mission),c.Vb("disabled",null==e.values.project?"":null),c.Ub(2),c.Ec("ngForOf",e.missions),c.Ub(4),c.Ec("ngModel",e.values.collection),c.Vb("disabled",null==e.values.mission?"":null),c.Ub(2),c.Ec("ngForOf",e.collections),c.Ub(4),c.Ec("ngModel",e.values.outFileName)}}function An(e,t){if(1&e&&(c.nc(0,"div",18),c.nc(1,"div",19),c.bd(2,"Upload Details"),c.mc(),c.nc(3,"div",20),c.nc(4,"h4"),c.bd(5," Status: "),c.nc(6,"b"),c.bd(7),c.mc(),c.mc(),c.nc(8,"h4"),c.bd(9," Message: "),c.nc(10,"b"),c.bd(11),c.mc(),c.mc(),c.nc(12,"h4"),c.bd(13," Upload Started On: "),c.nc(14,"b"),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"h4"),c.bd(18," Last Updated: "),c.nc(19,"b"),c.bd(20),c.yc(21,"idmdate"),c.mc(),c.mc(),c.nc(22,"h4"),c.bd(23," Elapsed Time: "),c.nc(24,"b"),c.bd(25),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.dd(" ",e.currentTask.status," "),c.Ub(4),c.dd(" ",e.currentTask.message," "),c.Ub(4),c.dd(" ",c.zc(16,5,e.currentTask.createDate)," "),c.Ub(5),c.dd(" ",c.zc(21,7,e.currentTask.lastUpdateDate)," "),c.Ub(5),c.dd(" ",e.uploadCounter," ")}}function jn(e,t){1&e&&c.ic(0,"div",39,40)}function Zn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",3),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"form",null,8),c.Zc(5,In,18,0,"div",9),c.Zc(6,Tn,13,0,"div",10),c.Zc(7,Dn,29,12,"div",11),c.nc(8,"div",12),c.Zc(9,An,26,9,"div",13),c.Zc(10,jn,2,0,"div",14),c.nc(11,"button",15),c.vc("click",(function(){return c.Rc(e),c.xc().handleUpload()})),c.ic(12,"i",16),c.bd(13," Upload "),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(14,"div",4),c.mc()}if(2&e){const e=c.Pc(4),t=c.xc();c.Ub(5),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("ngForOf",t.taskFinishedNotifications),c.Ub(1),c.Ec("ngIf",!t.disabled&&!t.existingTask),c.Ub(1),c.Ec("hidden",!t.uploadVisible),c.Ub(1),c.Ec("ngIf",t.currentTask),c.Ub(1),c.Ec("ngIf",t.showFileSelectPanel),c.Ub(1),c.Ec("disabled",!e.valid||t.disabled)}}class _n{constructor(e,t,n){this.service=e,this.modalService=t,this.sites=[],this.projects=[],this.missions=[],this.collections=[],this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.differ=n.find([]).create()}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}set content(e){const t=this;if(null!=e&&null==this.uploader){let n={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,n){t.disabled=!0,t.countUpload(t)},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,n,c,i){c.message&&c.message.currentTask&&!t.currentTask&&(t.currentTask=c.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(lt.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(rt.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,n,c,i){t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),t.taskFinishedNotifications.push({id:e})},onCancel:function(e,n){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,n,c){t.error(c)}}};this.uploader=new dt.FineUploader(n)}}ngAfterViewInit(){}ngOnInit(){this.service.roots(null,null).then(e=>{this.sites=e})}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0,this.selectedContinue||this.hideUploadPanel())}onSiteSelect(e){this.values.site=e,null!=e&&e.length>0&&(this.projects=[],this.missions=[],this.collections=[],this.values.project=null,this.values.mission=null,this.values.collection=null,this.service.getChildren(this.values.site).then(e=>{this.projects=e}))}onProjectSelect(e){this.values.project=e,this.missions=[],this.collections=[],this.values.mission=null,this.values.collection=null,null!=e&&e.length>0&&this.service.getChildren(this.values.project).then(e=>{this.missions=e.filter(e=>"Mission"===e.type)})}onMissionSelect(e){this.values.mission=e,this.collections=[],this.values.collection=null,this.values.name=null,null!=e&&e.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}handleChange(){this.collections=[],this.values.collection=null,this.values.name=null,null!=this.values.mission&&this.values.mission.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}onCollectionSelect(e){this.values.collection=e,this.values.uasComponentOid=e,e&&e.trim().length>0?this.showFileSelectPanel=!0:this.showFileSelectPanel=!1}handleUpload(){this.values.create||null!=this.values.collection||this.existingTask?!this.values.create||null!=this.values.mission&&null!=this.values.name&&0!=this.values.name.length||this.existingTask?(this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()):(this.bsModalRef=this.modalService.show(On.a,{backdrop:!0}),this.bsModalRef.content.message="Name is required"):(this.bsModalRef=this.modalService.show(On.a,{backdrop:!0}),this.bsModalRef.content.message="A collection must first be selected before the file can be uploaded")}removeUpload(e){let t=this;this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Cancel Upload",this.bsModalRef.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),t.existingTask=!1,t.showUploadPanel()})})}hideUploadPanel(){this.uploadVisible=!1}showUploadPanel(){this.uploadVisible=!0,this.selectedContinue=!0}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let n=Math.floor(t/3600),c=Math.floor(t%3600/60),i=Math.floor(t%60),a=c<10?"0"+n:n,o=c<10?"0"+c:c,s=i<10?"0"+i:i;e.uploadCounter=a+":"+o+":"+s}),1e3)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}error(e){null!==e&&(this.bsModalRef=this.modalService.show(On.a,{backdrop:!0}),this.bsModalRef.content.message=e)}}function Ln(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1,"Sensor: "),c.nc(2,"b"),c.bd(3),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(3),c.cd(e.sensorName)}}function $n(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return t.showError=!t.showError})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2).$implicit;c.Ub(1),c.dd("",e.showError?"Hide":"Show"," Messages")}}_n.ɵfac=function(e){return new(e||_n)(c.hc(j),c.hc(Z.b),c.hc(c.E))},_n.ɵcmp=c.bc({type:_n,selectors:[["upload"]],viewQuery:function(e,t){var n;(1&e&&c.fd(Un,!0),2&e)&&(c.Oc(n=c.wc())&&(t.content=n.first))},hostBindings:function(e,t){1&e&&c.vc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.Qc)},decls:4,vars:3,consts:[[3,"title"],["id","app-container",1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-2"],[1,"col-md-8"],[2,"margin-top","50px"],["routerlink","/viewer","routerlinkactive","active","href","#/viewer"],["ngForm","ngForm"],["class","",4,"ngIf"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],["style","margin-top: 30px;","class","",4,"ngIf"],[1,"",3,"hidden"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],["class","uploader-container","style","margin-top: 20px;",4,"ngIf"],["type","button btn btn-primary",1,"btn","btn-primary",2,"margin-top","20px",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,""],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],["type","button",1,"btn","btn-danger",2,"margin-top","20px",3,"click"],["type","button",1,"btn","btn-primary",2,"margin-top","20px",3,"click"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],[1,"",2,"margin-top","30px"],[1,"form-group"],["for","site"],["name","site","required","",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","project"],["name","project","required","",3,"ngModel","change","ngModelChange"],["for","mission"],["name","mission","required","",3,"ngModel","change","ngModelChange"],["for","collection"],["name","collection","required","",3,"ngModel","change","ngModelChange"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""]],template:function(e,t){1&e&&(c.ic(0,"uasdm-header",0),c.nc(1,"div",1),c.Zc(2,Sn,9,0,"div",2),c.Zc(3,Zn,15,7,"div",2),c.mc()),2&e&&(c.Ec("title","Data Upload"),c.Ub(2),c.Ec("ngIf",0===t.sites.length),c.Ub(1),c.Ec("ngIf",t.sites.length>0))},directives:[$t.a,i.t,o.z,o.l,o.m,i.s,o.w,o.v,o.k,o.n,o.p,o.y,o.c],pipes:[Se.a],encapsulation:2});const zn=function(e,t,n){return{success:e,pending:t,fail:n}};function Bn(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"ul",12),c.nc(2,"li"),c.bd(3,"Status: "),c.nc(4,"b",6),c.bd(5),c.mc(),c.mc(),c.nc(6,"li"),c.bd(7,"Created on: "),c.nc(8,"b"),c.bd(9),c.yc(10,"idmdate"),c.mc(),c.mc(),c.nc(11,"li"),c.bd(12,"Last update: "),c.nc(13,"b"),c.bd(14),c.yc(15,"idmdate"),c.mc(),c.mc(),c.nc(16,"li",13),c.bd(17,"Message: "),c.nc(18,"b"),c.bd(19),c.mc(),c.mc(),c.Zc(20,Ln,4,1,"li",10),c.mc(),c.nc(21,"div",14),c.nc(22,"div",15),c.nc(23,"div",16),c.Zc(24,$n,2,1,"button",17),c.nc(25,"button",18),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().removeTask(t)})),c.bd(26,"Delete Task"),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(4),c.Ec("ngClass",c.Kc(11,zn,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),c.Ub(1),c.cd(e.status),c.Ub(4),c.cd(c.zc(10,7,e.createDate)),c.Ub(5),c.cd(c.zc(15,9,e.lastUpdateDate)),c.Ub(5),c.cd(e.message),c.Ub(1),c.Ec("ngIf","Upload"==t.taskCategory),c.Ub(4),c.Ec("ngIf",e.actions.length>0)}}function qn(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1,"Sensor: "),c.nc(2,"b"),c.bd(3),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(3),c.cd(e.sensorName)}}function Hn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return t.showError=!t.showError})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2).$implicit;c.Ub(1),c.dd("",e.showError?"Hide":"Show"," Messages")}}function Wn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(3);return t.showODMOutput=!t.showODMOutput})),c.bd(1,"Show Detailed Log Output"),c.mc()}}function Gn(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"h4"),c.bd(3,"Output:"),c.mc(),c.ic(4,"textarea",20),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(4),c.Ec("innerHTML",e.odmOutput,c.Sc)}}function Vn(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"ul",12),c.nc(2,"li"),c.bd(3,"Status: "),c.nc(4,"b",6),c.bd(5),c.mc(),c.mc(),c.nc(6,"li"),c.bd(7,"Message: "),c.nc(8,"b"),c.bd(9),c.mc(),c.mc(),c.nc(10,"li"),c.bd(11,"Created on: "),c.nc(12,"b"),c.bd(13),c.yc(14,"idmdate"),c.mc(),c.mc(),c.nc(15,"li"),c.bd(16,"Last update: "),c.nc(17,"b"),c.bd(18),c.yc(19,"idmdate"),c.mc(),c.mc(),c.Zc(20,qn,4,1,"li",10),c.mc(),c.nc(21,"div",14),c.nc(22,"div",15),c.nc(23,"div",16),c.Zc(24,Hn,2,1,"button",17),c.Zc(25,Wn,2,0,"button",17),c.nc(26,"button",18),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().removeTask(t)})),c.bd(27,"Delete Task"),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(28,Gn,5,1,"div",11),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(4),c.Ec("ngClass",c.Kc(13,zn,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),c.Ub(1),c.dd(" ","Complete"===e.status&&e.actions.length>0?"Complete With Messages":e.status," "),c.Ub(4),c.cd(e.message),c.Ub(4),c.cd(c.zc(14,9,e.createDate)),c.Ub(5),c.cd(c.zc(19,11,e.lastUpdateDate)),c.Ub(2),c.Ec("ngIf","Upload"==t.taskCategory),c.Ub(4),c.Ec("ngIf",e.actions.length>0),c.Ub(1),c.Ec("ngIf",e.odmOutput),c.Ub(3),c.Ec("ngIf",e.odmOutput&&t.showODMOutput)}}function Jn(e,t){1&e&&(c.nc(0,"h4",23),c.bd(1,"There are no actions for this task."),c.mc())}function Xn(e,t){if(1&e&&(c.nc(0,"tr"),c.nc(1,"th",26),c.bd(2),c.mc(),c.nc(3,"td"),c.bd(4),c.mc(),c.nc(5,"td"),c.bd(6),c.yc(7,"idmdate"),c.mc(),c.nc(8,"td"),c.bd(9),c.yc(10,"idmdate"),c.mc(),c.mc()),2&e){const e=t.$implicit,n=t.index;c.Ub(2),c.cd(n+1),c.Ub(2),c.cd(e.description),c.Ub(2),c.cd(c.zc(7,4,e.createDate)),c.Ub(3),c.cd(c.zc(10,6,e.lastUpdateDate))}}function Yn(e,t){if(1&e&&(c.nc(0,"table",24),c.nc(1,"thead"),c.nc(2,"tr"),c.nc(3,"th"),c.bd(4,"#"),c.mc(),c.nc(5,"th"),c.bd(6,"Description"),c.mc(),c.nc(7,"th"),c.bd(8,"Creation Date"),c.mc(),c.nc(9,"th"),c.bd(10,"Last Updated"),c.mc(),c.mc(),c.mc(),c.nc(11,"tbody"),c.Zc(12,Xn,11,8,"tr",25),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(12),c.Ec("ngForOf",e.actions)}}function Kn(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.Zc(2,Jn,2,0,"h4",21),c.Zc(3,Yn,13,1,"table",22),c.mc(),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(2),c.Ec("ngIf",0===e.actions.length),c.Ub(1),c.Ec("ngIf",e.actions.length>0)}}function Qn(e,t){if(1&e&&(c.nc(0,"div",9),c.Zc(1,Bn,27,15,"div",10),c.Zc(2,Vn,29,17,"div",10),c.Zc(3,Kn,4,2,"div",11),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","Complete"!==e.status&&"Failed"!==e.status&&"Error"!==e.status),c.Ub(1),c.Ec("ngIf","Complete"===e.status||"Failed"===e.status||"Error"===e.status),c.Ub(1),c.Ec("ngIf",e.showError)}}const ec=function(e,t,n,c){return{success:e,warning:t,pending:n,fail:c}};class tc{constructor(e,t){this.managementService=e,this.modalService=t,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.showODMOutput=!1,this.showError=!1,this.taskGroups=[]}ngOnInit(){if(null!=this.taskGroupType&&null!=this.taskGroupType.tasks)for(var e=0;e<this.taskGroupType.tasks.length;++e){let t=this.taskGroupType.tasks[e];t.actions.length>0&&(t.showError=!0)}}ngOnDestroy(){}removeTask(e){this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let n=0;n<this.taskGroupType.tasks.length;n++){if(this.taskGroupType.tasks[n].uploadId===e.uploadId){t=n;break}}null!==t&&this.taskGroupType.tasks.splice(t,1)})}}function nc(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function cc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",20),c.nc(1,"div",21),c.nc(2,"div",2),c.nc(3,"div",16),c.nc(4,"div"),c.ic(5,"span",22),c.bd(6),c.mc(),c.nc(7,"div",23),c.nc(8,"ul",24),c.Zc(9,nc,4,1,"li",25),c.nc(10,"li",9),c.nc(11,"a",26),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(13,"div",27),c.nc(14,"div"),c.nc(15,"button",28),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(16,"View Collection"),c.mc(),c.nc(17,"button",29),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleMessage(n)})),c.bd(18,"Add Metadata"),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(6),c.dd(" ",e.message," "),c.Ub(3),c.Ec("ngForOf",e.ancestors),c.Ub(3),c.dd(" ",e.collectionName,"")}}tc.ɵfac=function(e){return new(e||tc)(c.hc(j),c.hc(Z.b))},tc.ɵcmp=c.bc({type:tc,selectors:[["tasks-panel"]],inputs:{taskGroupType:"taskGroupType",groupTypeId:"groupTypeId",taskCategory:"taskCategory"},decls:13,vars:13,consts:[[1,"panel-group"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","panel-heading-light","clickable",2,"margin-top","20px"],[1,"panel-title"],["data-toggle","collapse",3,"click"],[1,"heading-status-label","pull-right"],[3,"ngClass"],[1,"panel-body",3,"id","isAnimated","collapse"],["class","task-container",4,"ngFor","ngForOf"],[1,"task-container"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"list-unstyled",2,"margin","0"],[2,"word-break","break-all"],[1,"row"],[1,"col-sm-12"],[1,"button-holder",2,"margin-top","30px"],["class","btn btn-default",3,"click",4,"ngIf"],[1,"btn","btn-default","caution",3,"click"],[1,"btn","btn-default",3,"click"],[2,"color","grey","width","500px","height","200px",3,"innerHTML"],["style","color:grey;",4,"ngIf"],["class","table table-bordered",4,"ngIf"],[2,"color","grey"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["scope","row"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div",1),c.nc(2,"div",2),c.nc(3,"h4",3),c.nc(4,"a",4),c.vc("click",(function(){return t.showProcess=!t.showProcess})),c.nc(5,"h4"),c.bd(6),c.mc(),c.mc(),c.mc(),c.nc(7,"span",5),c.bd(8,"Current status: "),c.nc(9,"span",6),c.bd(10),c.mc(),c.mc(),c.mc(),c.nc(11,"div",7),c.Zc(12,Qn,4,3,"div",8),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(4),c.Wb("aria-controls","task-group-panel-",t.groupTypeId,""),c.Ub(2),c.cd(t.taskCategory),c.Ub(3),c.Ec("ngClass",c.Lc(8,ec,"Complete"===t.taskGroupType.status,"Warning"===t.taskGroupType.status,"Queued"===t.taskGroupType.status||"Processing"===t.taskGroupType.status,"Failed"===t.taskGroupType.status)),c.Ub(1),c.cd(t.taskGroupType.status),c.Ub(1),c.Gc("id","task-group-panel-",t.groupTypeId,""),c.Ec("isAnimated",!1)("collapse",!t.showProcess),c.Ub(1),c.Ec("ngForOf",t.taskGroupType.tasks))},directives:[i.q,u.a,i.s,i.t],pipes:[Se.a],styles:[".button-holder[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\n\tmargin-right: 10px;\n}\n.btn.btn-danger[_ngcontent-%COMP%] {\n    background-color: #d9534f !important;\n    border-color: #d43f3a !important;\n}\n.btn.btn-danger[_ngcontent-%COMP%]:hover {\n    background-color: #d2322d !important;\n    border-color: #ac2925 !important;\n}\n.btn.btn-default.caution[_ngcontent-%COMP%]:hover {\n\tborder-color: #ac2925 !important;\n\tcolor: #ac2925 !important;\n}\n\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%]{\n  background-color: #e9e9e9;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}\n\n\n.dot[_ngcontent-%COMP%] {\n  height: 20px;\n  width: 20px;\n  background-color: #bbb;\n  border-radius: 50%;\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 10px;\n}\n.dot.success[_ngcontent-%COMP%] {\n  background-color: #6CB46F;\n}\n.dot.pending[_ngcontent-%COMP%] {    \n  background-color: #FF8C42;\n}\n.dot.warning[_ngcontent-%COMP%] {\n  background-color: #2C88CB;\n}\n.dot.fail[_ngcontent-%COMP%] {\n  background-color:#BF1E1E;\n}\n.dot.pending.blink[_ngcontent-%COMP%] {\n   animation-duration: 400ms;\n   animation-name: blink;\n   animation-iteration-count: infinite;\n   animation-direction: alternate;\n}\n@keyframes blink {\n   from {\n      opacity: 1;\n   }\n   to {\n      opacity: .5;\n   }\n }"]});const ic=function(e,t,n){return{id:"message-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:n}};function ac(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Tasks"),c.mc(),c.nc(3,"div",15),c.nc(4,"div",2),c.nc(5,"h3",16),c.bd(6,"Issue"),c.mc(),c.nc(7,"h3",17),c.bd(8,"Actions"),c.mc(),c.mc(),c.Zc(9,cc,19,3,"div",18),c.yc(10,"paginate"),c.nc(11,"div",2),c.nc(12,"pagination-controls",19),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onMessagePageChange(t)})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngForOf",c.Ac(10,1,e.messages.resultSet,c.Kc(4,ic,e.messages.pageSize,e.messages.pageNumber,e.messages.count)))}}function oc(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function sc(e,t){1&e&&c.ic(0,"i",42)}function lc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function rc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function dc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function pc(e,t){if(1&e&&(c.nc(0,"div",44),c.Zc(1,lc,2,3,"div",6),c.Zc(2,rc,2,3,"div",6),c.Zc(3,dc,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function mc(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,pc,4,4,"div",43),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function hc(e,t){if(1&e&&(c.nc(0,"span"),c.Zc(1,mc,2,1,"div",25),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngForOf",e.groups)}}const uc=function(e,t,n,c){return{success:e,warning:t,"pending blink":n,fail:c}};function gc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",34),c.nc(1,"div",35),c.nc(2,"h4",36),c.nc(3,"a",37),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",38),c.nc(7,"button",39),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",23),c.nc(10,"ul",24),c.Zc(11,oc,4,1,"li",25),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",40),c.Zc(15,sc,1,0,"i",41),c.Zc(16,hc,2,1,"span",6),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(10,uc,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}const bc=function(e,t,n){return{id:"tasks-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:n}};function fc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",30),c.nc(1,"div",31),c.Zc(2,gc,17,15,"div",32),c.yc(3,"paginate"),c.nc(4,"pagination-controls",33),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,bc,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function vc(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function yc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function kc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function xc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function Cc(e,t){if(1&e&&(c.nc(0,"div",44),c.Zc(1,yc,2,3,"div",6),c.Zc(2,kc,2,3,"div",6),c.Zc(3,xc,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function Ec(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,Cc,4,4,"div",43),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function wc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",34),c.nc(1,"div",35),c.nc(2,"h4",36),c.nc(3,"a",37),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",38),c.nc(7,"button",39),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",23),c.nc(10,"ul",24),c.Zc(11,vc,4,1,"li",25),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",40),c.Zc(15,Ec,2,1,"div",25),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(9,uc,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngForOf",e.groups)}}function Mc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",46),c.nc(1,"div",31),c.Zc(2,wc,16,14,"div",32),c.yc(3,"paginate"),c.nc(4,"pagination-controls",33),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,bc,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function Oc(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function Uc(e,t){1&e&&c.ic(0,"i",42)}function Sc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function Ic(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function Tc(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",45),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function Rc(e,t){if(1&e&&(c.nc(0,"div",44),c.Zc(1,Sc,2,3,"div",6),c.Zc(2,Ic,2,3,"div",6),c.Zc(3,Tc,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function Pc(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,Rc,4,4,"div",43),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function Fc(e,t){if(1&e&&(c.nc(0,"span"),c.Zc(1,Pc,2,1,"div",25),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngForOf",e.groups)}}function Nc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",34),c.nc(1,"div",35),c.nc(2,"h4",36),c.nc(3,"a",37),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",38),c.nc(7,"button",39),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",23),c.nc(10,"ul",24),c.Zc(11,Oc,4,1,"li",25),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",40),c.Zc(15,Uc,1,0,"i",41),c.Zc(16,Fc,2,1,"span",6),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(10,uc,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}function Dc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",47),c.nc(1,"div",31),c.Zc(2,Nc,17,15,"div",32),c.yc(3,"paginate"),c.nc(4,"pagination-controls",33),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,bc,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}class Ac{constructor(e,t){this.managementService=e,this.modalService=t,this.userName="",this.totalTaskCount=0,this.activeTab="all",this.showSite=!1,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.taskPage={count:0,pageSize:10,pageNumber:1,resultSet:[]},this.errorStatuses=["Failed","Processing"],this.completeStatuses=["Complete"],this.statuses=[],this.token=0,this.messages={count:0,pageSize:5,pageNumber:1,resultSet:[]}}ngOnInit(){this.userName=this.managementService.getCurrentUser(),this.managementService.tasks([],this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e)}),this.getMissingMetadata();let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Lt.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"JOB_CHANGE"===e.type&&this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{e.token===this.token&&this.updateTaskData(e)})})}ngOnDestroy(){this.notifier.complete()}onPageChange(e){this.token++,this.managementService.tasks(this.statuses,this.taskPage.pageSize,e,this.token).then(e=>{this.setTaskData(e)})}onTabClick(e,t){if(this.activeTab=t,this.taskPage={count:0,pageSize:20,pageNumber:1,resultSet:[]},this.token++,"success"===t?this.statuses=this.completeStatuses:"action-required"===t?this.statuses=this.errorStatuses:"all"===t&&(this.statuses=[]),this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e)}),!e.target.parentNode.classList.contains("active")){let t=e.target.parentNode.parentNode.getElementsByTagName("li");for(let e=0;e<t.length;e++){let n=t[e];n.classList.forEach(e=>{"active"===e&&n.classList.remove("active")})}e.target.parentNode.classList.add("active")}}setTaskData(e){this.taskPage=e,this.visible={},this.taskPage.resultSet.forEach(e=>{this.visible[e.collectionId]=!1})}setGroupTasks(e,t){e.groups=[],e.groups.push({tasks:[],status:null,type:"UPLOAD"}),e.groups.push({tasks:[],status:null,type:"PROCESS"}),e.groups.push({tasks:[],status:null,type:"STORE"});for(let n=0;n<t.length;n++){let c=t[n];if("gov.geoplatform.uasdm.bus.WorkflowTask"===c.type){let t=e.groups.findIndex(e=>"UPLOAD"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"UPLOAD"}):e.groups[t].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMProcessingTask"===c.type){let t=e.groups.findIndex(e=>"PROCESS"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"PROCESS"}):e.groups[t].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMUploadTask"===c.type){let t=e.groups.findIndex(e=>"STORE"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"STORE"}):e.groups[t].tasks.push(c)}}this.setTaskGroupStatuses(e)}setTaskGroupStatuses(e){let t=null;e.groups.forEach(e=>{let n=!1;if(e.tasks.length>0){const c=e.tasks.sort((e,t)=>new Date(t.lastUpdateDate).getTime()-new Date(e.lastUpdateDate).getTime());e.status=c[0].status;const i=new Date(c[0].lastUpdateDate);n=null==t||t.getTime()-i.getTime()<=0,n&&(t=i),"Complete"===e.status&&c[0].actions.length>0&&(e.status="Warning")}})}updateTaskData(e){this.taskPage=e,this.taskPage.resultSet.forEach(e=>{this.visible[e.collectionId]&&this.managementService.getTasks(e.collectionId).then(t=>{this.setGroupTasks(e,t)})})}setVisibility(e){this.visible[e.collectionId]?this.visible[e.collectionId]=!1:(this.visible[e.collectionId]=!0,null!=e.groups||e.loading||(e.loading=!0,this.managementService.getTasks(e.collectionId).then(t=>{this.setGroupTasks(e,t),e.loading=!1})))}handleMessage(e){this.bsModalRef=this.modalService.show(Y,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(e.collectionId),this.bsModalRef.content.onMetadataChange.subscribe(e=>{let t=-1;for(let n=0;n<this.messages.resultSet.length;n++){this.messages.resultSet[n].collectionId===e&&(t=n)}t>=0&&this.messages.resultSet.splice(t,1)})}handleGoto(e){this.managementService.view(e).then(t=>{const n=t.item,c=t.breadcrumbs;this.managementService.getItems(e,null).then(e=>{this.bsModalRef=this.modalService.show(Oe,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal"}),this.bsModalRef.content.init(n,e,c)})})}removeTask(e){this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let n=0;n<this.tasks.resultSet.length;n++){if(this.tasks[n].uploadId===e.uploadId){t=n;break}}null!==t&&this.tasks.resultSet.splice(t,1),this.getMissingMetadata(),this.totalTaskCount=this.tasks.count})}getMissingMetadata(){this.onMessagePageChange(this.messages.pageNumber)}onMessagePageChange(e){this.managementService.getMissingMetadata(this.messages.pageSize,e).then(e=>{this.messages=e})}}Ac.ɵfac=function(e){return new(e||Ac)(c.hc(j),c.hc(Z.b))},Ac.ɵcmp=c.bc({type:Ac,selectors:[["tasks"]],decls:25,vars:5,consts:[[3,"title"],["id","app-container",1,"container-fluid",2,"padding-top","20px"],[1,"row"],[1,"col-sm-1"],[1,"col-sm-10"],["id","tasks"],[4,"ngIf"],[1,"row",2,"margin-bottom","40px"],["role","tablist",1,"nav","nav-tabs"],[1,"active"],["role","tab","data-toggle","tab",3,"click"],[1,"tab-content"],["class","tab-pane active","id","action-required",4,"ngIf"],["class","tab-pane active","id","success",4,"ngIf"],["class","tab-pane active","id","all",4,"ngIf"],["id","tasks-container"],[1,"col-sm-7"],[1,"col-sm-5",2,"text-align","right","padding-right","8em"],["class","panel panel-default",4,"ngFor","ngForOf"],["id","message-pg-ctrl",3,"pageChange"],[1,"panel","panel-default"],[1,"panel-body"],[1,"dot","pending",2,"margin-left","0"],[2,"margin-top","10px","margin-bottom","0","color","grey"],[1,"breadcrumb",2,"color","grey"],[4,"ngFor","ngForOf"],[2,"color","#007276",3,"click"],[1,"col-sm-5",2,"text-align","right"],[1,"btn","btn-default",3,"click"],[1,"btn","btn-primary",2,"margin-left","10px",3,"click"],["id","action-required",1,"tab-pane","active"],[1,"panel-group"],["class","panel panel-default","style","background: none;border: none;",4,"ngFor","ngForOf"],["id","tasks-pg-ctrl",3,"pageChange"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","clickable"],[1,"panel-title",2,"display","inline-block","vertical-align","middle"],["data-toggle","collapse",3,"click"],[1,"dot",3,"ngClass"],[1,"btn","btn-default","pull-right",3,"click"],[1,"panel-body",3,"isAnimated","collapse"],["class","fa fa-spinner fa-spin task-group-loading",4,"ngIf"],[1,"fa","fa-spinner","fa-spin","task-group-loading"],[3,"id",4,"ngIf"],[3,"id"],[3,"taskGroupType","groupTypeId","taskCategory"],["id","success",1,"tab-pane","active"],["id","all",1,"tab-pane","active"]],template:function(e,t){1&e&&(c.ic(0,"uasdm-header",0),c.nc(1,"div",1),c.nc(2,"div",2),c.ic(3,"div",3),c.nc(4,"div",4),c.nc(5,"div",5),c.Zc(6,ac,13,8,"div",6),c.mc(),c.mc(),c.ic(7,"div",3),c.mc(),c.nc(8,"div",7),c.ic(9,"div",3),c.nc(10,"div",4),c.nc(11,"h3"),c.bd(12,"Processing Jobs"),c.mc(),c.nc(13,"ul",8),c.nc(14,"li",9),c.nc(15,"a",10),c.vc("click",(function(e){return t.onTabClick(e,"all")})),c.bd(16,"All"),c.mc(),c.mc(),c.nc(17,"li"),c.nc(18,"a",10),c.vc("click",(function(e){return t.onTabClick(e,"action-required")})),c.bd(19,"Action Required"),c.mc(),c.mc(),c.mc(),c.nc(20,"div",11),c.Zc(21,fc,5,8,"div",12),c.Zc(22,Mc,5,8,"div",13),c.Zc(23,Dc,5,8,"div",14),c.mc(),c.mc(),c.ic(24,"div",3),c.mc(),c.mc()),2&e&&(c.Ec("title","Tasks"),c.Ub(6),c.Ec("ngIf",t.messages&&t.messages.count>0),c.Ub(15),c.Ec("ngIf","action-required"===t.activeTab),c.Ub(1),c.Ec("ngIf","success"===t.activeTab),c.Ub(1),c.Ec("ngIf","all"===t.activeTab))},directives:[$t.a,i.t,i.s,h.c,i.q,u.a,tc],pipes:[h.b],styles:["#app-container[_ngcontent-%COMP%] {\n    background: #f7f7f7;\n}\n\n#tasks-container[_ngcontent-%COMP%] {\n    padding: 20px;\n    background: white;\n    border-radius: 6px;\n}\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.task-group-loading[_ngcontent-%COMP%] {\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%] {\n  background-color: #e9e9e9;\n  margin-top: 20px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}"]});class jc{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/sensor/page",{params:t}).toPromise()}getAll(){let e=new y.g;return this.eventService.start(),this.http.get(acp+"/sensor/get-all",{params:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/sensor/apply",JSON.stringify({sensor:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}jc.ɵfac=function(e){return new(e||jc)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},jc.ɵprov=c.dc({token:jc,factory:jc.ɵfac});var Zc,_c=n(97);function Lc(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}class $c{constructor(e,t,n){this.service=e,this.modalService=t,this.router=n,this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"Sensor"},this.refresh=new q.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the sensor ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/sensor",e.oid])}newInstance(){this.router.navigate(["/site/sensor","__NEW__"])}}$c.ɵfac=function(e){return new(e||$c)(c.hc(jc),c.hc(Z.b),c.hc(a.b))},$c.ɵcmp=c.bc({type:$c,selectors:[["sensors"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Sensors"),c.mc(),c.Zc(3,Lc,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,_c.a],styles:["./sensors.css"]}),function(e){e.SENSOR_TYPE="/sensor-type",e.PLATFORM_TYPE="/platform-type",e.PLATFORM_MANUFACTURER="/platform-manufacturer",e.WAVE_LENGTH="/wave-length"}(Zc||(Zc={}));class zc{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e,t){let n=new y.g;return n=n.set("criteria",JSON.stringify(e)),this.http.get(acp+t+"/page",{params:n}).toPromise()}getAll(e){let t=new y.g;return this.eventService.start(),this.http.get(acp+e+"/get-all",{params:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}get(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/get",JSON.stringify({oid:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/newInstance",JSON.stringify({}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/remove",JSON.stringify({oid:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+e+"/apply",JSON.stringify({classification:t}),{headers:n}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}function Bc(e,t){if(1&e&&(c.nc(0,"div",18),c.nc(1,"div",19),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",20),c.nc(5,"div"),c.nc(6,"p",21),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function qc(e,t){if(1&e&&(c.nc(0,"option",22),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function Hc(e,t){1&e&&(c.nc(0,"span",21),c.bd(1," A sensor requires at least one Wave Length "),c.mc())}function Wc(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",23),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().updateSelectedWaveLength(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("value",n.sensor.wavelengths&&-1!==n.sensor.wavelengths.indexOf(e.oid))("label",e.name)("disabled","READ"===n.mode)}}zc.ɵfac=function(e){return new(e||zc)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},zc.ɵprov=c.dc({token:zc,factory:zc.ɵfac});const Gc=function(e){return["/site/platform",e]};function Vc(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"a",24),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("routerLink",c.Ic(2,Gc,e.oid)),c.Ub(1),c.cd(e.name)}}function Jc(e,t){if(1&e&&(c.nc(0,"div",4),c.nc(1,"label"),c.bd(2,"Used on Platforms"),c.mc(),c.nc(3,"ul"),c.Zc(4,Vc,3,4,"li",15),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",e.sensor.platforms)}}function Xc(e,t){if(1&e){const e=c.oc();c.nc(0,"button",28),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function Yc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.Zc(1,Xc,2,0,"button",26),c.nc(2,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(8);c.Ub(1),c.Ec("ngIf",!e.newInstance),c.Ub(1),c.Ec("disabled",!t.valid||0===e.sensor.wavelengths.length)}}function Kc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.nc(1,"button",29),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}class Qc{constructor(e,t,n,c){this.service=e,this.classificationService=t,this.route=n,this.router=c,this.newInstance=!1,this.message=null,this.wavelengths=[],this.types=[],this.mode="READ"}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.sensor=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.sensor=e,this.original=JSON.parse(JSON.stringify(this.sensor))}),this.classificationService.getAll(Zc.WAVE_LENGTH).then(e=>{this.wavelengths=e}),this.classificationService.getAll(Zc.SENSOR_TYPE).then(e=>{this.types=e})}handleOnSubmit(){this.message=null,this.service.apply(this.sensor).then(e=>{this.sensor=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/sensor",e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.sensor=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}updateSelectedWaveLength(e,t){const n=this.sensor.wavelengths.findIndex(t=>e.oid===t);t?n<0&&this.sensor.wavelengths.push(e.oid):n>-1&&this.sensor.wavelengths.splice(n,1)}error(e){this.message=I.b.getMessageFromError(e)}}Qc.ɵfac=function(e){return new(e||Qc)(c.hc(jc),c.hc(zc),c.hc(a.a),c.hc(a.b))},Qc.ɵcmp=c.bc({type:Qc,selectors:[["sensor"]],decls:52,vars:23,consts:[["id","app-container",1,"container"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","model","type","input","placeholder","Model","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorType","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","pixelSizeWidth","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","pixelSizeHeight","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorWidth","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorHeight","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","error-message",4,"ngIf"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],[3,"value","label","disabled","valueChange"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,Bc,8,1,"div",1),c.nc(4,"div",2),c.nc(5,"h3"),c.bd(6,"Sensor"),c.mc(),c.mc(),c.nc(7,"form",null,3),c.nc(9,"div",4),c.nc(10,"label"),c.bd(11,"Name"),c.mc(),c.nc(12,"input",5),c.vc("ngModelChange",(function(e){return t.sensor.name=e})),c.mc(),c.mc(),c.nc(13,"div",4),c.nc(14,"label"),c.bd(15,"Description"),c.mc(),c.nc(16,"textarea",6),c.vc("ngModelChange",(function(e){return t.sensor.description=e})),c.bd(17,"        "),c.mc(),c.mc(),c.nc(18,"div",4),c.nc(19,"label"),c.bd(20,"Model"),c.mc(),c.nc(21,"input",7),c.vc("ngModelChange",(function(e){return t.sensor.model=e})),c.mc(),c.mc(),c.nc(22,"div",4),c.nc(23,"label"),c.bd(24,"Type"),c.mc(),c.nc(25,"select",8),c.vc("ngModelChange",(function(e){return t.sensor.sensorType=e})),c.ic(26,"option"),c.Zc(27,qc,2,2,"option",9),c.mc(),c.mc(),c.nc(28,"div",4),c.nc(29,"label"),c.bd(30,"Pixel Size Width"),c.mc(),c.nc(31,"input",10),c.vc("ngModelChange",(function(e){return t.sensor.pixelSizeWidth=e})),c.mc(),c.mc(),c.nc(32,"div",4),c.nc(33,"label"),c.bd(34,"Pixel Size Height"),c.mc(),c.nc(35,"input",11),c.vc("ngModelChange",(function(e){return t.sensor.pixelSizeHeight=e})),c.mc(),c.mc(),c.nc(36,"div",4),c.nc(37,"label"),c.bd(38,"Sensor Width"),c.mc(),c.nc(39,"input",12),c.vc("ngModelChange",(function(e){return t.sensor.sensorWidth=e})),c.mc(),c.mc(),c.nc(40,"div",4),c.nc(41,"label"),c.bd(42,"Sensor Height"),c.mc(),c.nc(43,"input",13),c.vc("ngModelChange",(function(e){return t.sensor.sensorHeight=e})),c.mc(),c.mc(),c.nc(44,"div",4),c.nc(45,"label"),c.bd(46,"Wave Length"),c.mc(),c.Zc(47,Hc,2,0,"span",14),c.Zc(48,Wc,2,3,"div",15),c.mc(),c.Zc(49,Jc,5,1,"div",16),c.Zc(50,Yc,4,2,"div",17),c.Zc(51,Kc,3,0,"div",17),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.message),c.Ub(9),c.Ec("ngModel",t.sensor.name)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.description)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.model)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.sensorType)("disabled","READ"===t.mode),c.Ub(2),c.Ec("ngForOf",t.types),c.Ub(4),c.Ec("ngModel",t.sensor.pixelSizeWidth)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.pixelSizeHeight)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.sensorWidth)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.sensorHeight)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngIf",0===t.sensor.wavelengths.length),c.Ub(1),c.Ec("ngForOf",t.wavelengths),c.Ub(1),c.Ec("ngIf","READ"===t.mode&&null!=t.sensor.platforms&&t.sensor.platforms.length>0),c.Ub(1),c.Ec("ngIf","WRITE"===t.mode),c.Ub(1),c.Ec("ngIf","READ"===t.mode))},directives:[$t.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,o.w,o.p,o.y,i.s,o.q,V.a,a.e],encapsulation:2});class ei{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/platform/page",{params:t}).toPromise()}getAll(){let e=new y.g;return this.eventService.start(),this.http.get(acp+"/platform/get-all",{params:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/platform/apply",JSON.stringify({platform:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}}function ti(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}ei.ɵfac=function(e){return new(e||ei)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},ei.ɵprov=c.dc({token:ei,factory:ei.ɵfac});class ni{constructor(e,t,n){this.service=e,this.router=t,this.modalService=n,this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"Platform"},this.refresh=new q.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the platform ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/platform",e.oid])}newInstance(){this.router.navigate(["/site/platform","__NEW__"])}}function ci(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",16),c.nc(5,"div"),c.nc(6,"p",17),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function ii(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function ai(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.dd("",e.name," ")}}function oi(e,t){1&e&&(c.nc(0,"span",17),c.bd(1," A platform requires at least one sensor "),c.mc())}function si(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",21),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc(3).updateSelectedSensor(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("value",n.platform.sensors&&-1!==n.platform.sensors.indexOf(e.oid))("label",e.name)}}function li(e,t){if(1&e&&(c.nc(0,"div",6),c.nc(1,"label"),c.bd(2,"Sensors"),c.mc(),c.Zc(3,oi,2,0,"span",19),c.Zc(4,si,2,2,"div",20),c.mc()),2&e){const e=c.xc(2);c.Ub(3),c.Ec("ngIf",0===e.platform.sensors.length),c.Ub(1),c.Ec("ngForOf",e.sensors)}}ni.ɵfac=function(e){return new(e||ni)(c.hc(ei),c.hc(a.b),c.hc(Z.b))},ni.ɵcmp=c.bc({type:ni,selectors:[["platforms"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Platforms"),c.mc(),c.Zc(3,ti,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,_c.a],styles:["./platforms.css"]});const ri=function(e){return["/site/sensor",e]};function di(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"a",22),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("routerLink",c.Ic(2,ri,e)),c.Ub(1),c.cd(n.getSensorName(e))}}function pi(e,t){if(1&e&&(c.nc(0,"div",6),c.nc(1,"label"),c.bd(2,"Sensors"),c.mc(),c.nc(3,"ul"),c.Zc(4,di,3,4,"li",20),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(4),c.Ec("ngForOf",e.platform.sensors)}}function mi(e,t){if(1&e){const e=c.oc();c.nc(0,"button",26),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function hi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.Zc(1,mi,2,0,"button",24),c.nc(2,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){c.xc();const e=c.Pc(6),t=c.xc();c.Ub(1),c.Ec("ngIf",!t.newInstance),c.Ub(1),c.Ec("disabled",!e.valid||0===t.platform.sensors.length)}}function ui(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}function gi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",2),c.Zc(1,ci,8,1,"div",3),c.nc(2,"div",4),c.nc(3,"h3"),c.bd(4,"Platform"),c.mc(),c.mc(),c.nc(5,"form",null,5),c.nc(7,"div",6),c.nc(8,"label"),c.bd(9,"Name"),c.mc(),c.nc(10,"input",7),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.name=t})),c.mc(),c.mc(),c.nc(11,"div",6),c.nc(12,"label"),c.bd(13,"Description"),c.mc(),c.nc(14,"textarea",8),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.description=t})),c.bd(15,"      "),c.mc(),c.mc(),c.nc(16,"div",6),c.nc(17,"label"),c.bd(18,"Type"),c.mc(),c.nc(19,"select",9),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.platformType=t})),c.ic(20,"option"),c.Zc(21,ii,2,2,"option",10),c.mc(),c.mc(),c.nc(22,"div",6),c.nc(23,"label"),c.bd(24,"Manufacturer"),c.mc(),c.nc(25,"select",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.manufacturer=t})),c.ic(26,"option"),c.Zc(27,ai,2,2,"option",10),c.mc(),c.mc(),c.Zc(28,li,5,2,"div",12),c.Zc(29,pi,5,1,"div",12),c.Zc(30,hi,4,2,"div",13),c.Zc(31,ui,3,0,"div",13),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf",null!=e.message),c.Ub(9),c.Ec("ngModel",e.platform.name)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.platform.description)("disabled","READ"===e.mode),c.Ub(5),c.Ec("ngModel",e.platform.platformType)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.types),c.Ub(4),c.Ec("ngModel",e.platform.manufacturer)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.manufacturers),c.Ub(1),c.Ec("ngIf","WRITE"===e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode),c.Ub(1),c.Ec("ngIf","WRITE"===e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode)}}class bi{constructor(e,t,n,c,i){this.service=e,this.sensorService=t,this.classificationService=n,this.route=c,this.router=i,this.newInstance=!1,this.message=null,this.manufacturers=[],this.types=[],this.sensors=[],this.mode="READ"}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.platform=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.platform=e,this.original=JSON.parse(JSON.stringify(this.platform))}),this.classificationService.getAll(Zc.PLATFORM_MANUFACTURER).then(e=>{this.manufacturers=e}),this.classificationService.getAll(Zc.PLATFORM_TYPE).then(e=>{this.types=e}),this.sensorService.getAll().then(e=>{this.sensors=e})}handleOnSubmit(){this.message=null,this.service.apply(this.platform).then(e=>{this.platform=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/platform",e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.platform=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}updateSelectedSensor(e,t){const n=this.platform.sensors.findIndex(t=>e.oid===t);t?n<0&&this.platform.sensors.push(e.oid):n>-1&&this.platform.sensors.splice(n,1)}getSensorName(e){const t=this.sensors.findIndex(t=>t.oid===e);return-1!==t?this.sensors[t].name:""}error(e){this.message=I.b.getMessageFromError(e)}}function fi(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)("baseUrl",e._metadata.baseUrl)}}bi.ɵfac=function(e){return new(e||bi)(c.hc(ei),c.hc(jc),c.hc(zc),c.hc(a.a),c.hc(a.b))},bi.ɵcmp=c.bc({type:bi,selectors:[["platform"]],decls:4,vars:1,consts:[["id","app-container",1,"container"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","platformType","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","manufacturer","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngIf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],["class","error-message",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value","label","valueChange"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,gi,32,15,"div",1),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.platform))},directives:[$t.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,o.w,o.p,o.y,i.s,V.a,a.e],encapsulation:2});class vi{constructor(e,t,n){this.router=e,this.service=t,this.modalService=n,this._metadata={label:"",title:"",baseUrl:""},this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}set metadata(e){this._metadata.title=e.title,this._metadata.label=e.label,this._metadata.baseUrl=e.baseUrl,this.config={service:this.service,remove:!0,view:!0,create:!0,label:e.label}}ngOnInit(){}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(this._metadata.baseUrl,e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the "+this._metadata.label+" ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/"+this._metadata.baseUrl,e.oid])}newInstance(){this.router.navigate(["/site/"+this._metadata.baseUrl,"__NEW__"])}}function yi(e,t){if(1&e&&(c.nc(0,"div",8),c.nc(1,"div",9),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",10),c.nc(5,"div"),c.nc(6,"p",11),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function ki(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().classification[n.name]=t})),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("value",t.classification[e.name])("label",e.label)("disabled","READ"===t.mode)}}function xi(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"label"),c.Zc(2,ki,1,3,"boolean-field",12),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.Ec("ngIf","boolean"===e.type)}}function Ci(e,t){if(1&e){const e=c.oc();c.nc(0,"button",17),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function Ei(e,t){if(1&e){const e=c.oc();c.nc(0,"div",14),c.Zc(1,Ci,2,0,"button",15),c.nc(2,"button",16),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(8);c.Ub(1),c.Ec("ngIf",!e.newInstance),c.Ub(1),c.Ec("disabled",!t.valid)}}function wi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",14),c.nc(1,"button",18),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}vi.ɵfac=function(e){return new(e||vi)(c.hc(a.b),c.hc(zc),c.hc(Z.b))},vi.ɵcmp=c.bc({type:vi,selectors:[["classifications"]],inputs:{metadata:"metadata"},decls:4,vars:2,consts:[[3,"cols","config","refresh","baseUrl","click",4,"ngIf"],[3,"cols","config","refresh","baseUrl","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h4"),c.bd(2),c.mc(),c.Zc(3,fi,1,4,"generic-table",0),c.mc()),2&e&&(c.Ub(2),c.cd(t._metadata.title),c.Ub(1),c.Ec("ngIf",null!=t.config))},directives:[i.t,_c.a],styles:["./classifications.css"]});class Mi{constructor(e,t,n){this.service=e,this.route=t,this.router=n,this.newInstance=!1,this.message=null,this.mode="READ"}ngOnInit(){this.route.data.subscribe(e=>{this.metadata=e;const t=this.route.snapshot.params.oid;"__NEW__"===t?this.service.newInstance(this.metadata.baseUrl).then(e=>{this.classification=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(this.metadata.baseUrl,t).then(e=>{this.classification=e,this.original=JSON.parse(JSON.stringify(this.classification))})})}handleOnSubmit(){this.message=null,this.service.apply(this.metadata.baseUrl,this.classification).then(e=>{this.classification=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/"+this.metadata.baseUrl,e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.classification=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}error(e){this.message=I.b.getMessageFromError(e)}}Mi.ɵfac=function(e){return new(e||Mi)(c.hc(zc),c.hc(a.a),c.hc(a.b))},Mi.ɵcmp=c.bc({type:Mi,selectors:[["classification"]],decls:16,vars:7,consts:[["id","app-container",1,"container"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","label","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value","label","disabled","valueChange",4,"ngIf"],[3,"value","label","disabled","valueChange"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,yi,8,1,"div",1),c.nc(4,"div",2),c.nc(5,"h3"),c.bd(6),c.mc(),c.mc(),c.nc(7,"form",null,3),c.nc(9,"div",4),c.nc(10,"label"),c.bd(11,"Name"),c.mc(),c.nc(12,"input",5),c.vc("ngModelChange",(function(e){return t.classification.name=e})),c.mc(),c.mc(),c.Zc(13,xi,3,1,"div",6),c.Zc(14,Ei,4,2,"div",7),c.Zc(15,wi,3,0,"div",7),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.message),c.Ub(3),c.cd(t.metadata.title),c.Ub(6),c.Ec("ngModel",t.classification.name)("disabled","READ"===t.mode),c.Ub(1),c.Ec("ngForOf",t.metadata.columns),c.Ub(1),c.Ec("ngIf","WRITE"===t.mode),c.Ub(1),c.Ec("ngIf","READ"===t.mode))},directives:[$t.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,i.s,V.a],encapsulation:2});const Oi=function(e,t){return{"fa-chevron-down":e,"fa-chevron-right":t}},Ui=function(){return{title:"",label:"type",baseUrl:"/sensor-type"}},Si=function(){return{title:"",label:"wave length",baseUrl:"/wave-length"}},Ii=function(){return{title:"Platform Type",label:"type",baseUrl:"/platform-type"}},Ti=function(){return{title:"Platform Manufacturer",label:"manufacturer",baseUrl:"/platform-manufacturer"}};class Ri{constructor(e){this.modalService=e,this.isSensorTypeCollapsed=!0,this.isSensorWavelengthCollapsed=!0,this.isPlatformTypeCollapsed=!0,this.isPlatformManufacturerCollapsed=!0}ngOnInit(){}}Ri.ɵfac=function(e){return new(e||Ri)(c.hc(Z.b))},Ri.ɵcmp=c.bc({type:Ri,selectors:[["equipment"]],decls:41,vars:28,consts:[["id","app-container",1,"container"],[2,"padding","20px","border","solid 1px lightgrey","background","#efefef"],[3,"click"],[1,"fa","fa-fw","collapsible-link",3,"ngClass"],["id","sensorTypeCollabseContainer",3,"collapse"],[3,"metadata"],["id","sensorWavelengthCollabseContainer",3,"collapse"],["id","platformTypeCollabseContainer",3,"collapse"],["id","platformManufacturerCollabseContainer",3,"collapse"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.nc(3,"h2"),c.bd(4,"Equipment Management"),c.mc(),c.nc(5,"h3"),c.bd(6,"Sensor Options"),c.mc(),c.nc(7,"section",1),c.nc(8,"a",2),c.vc("click",(function(){return t.isSensorTypeCollapsed=!t.isSensorTypeCollapsed})),c.nc(9,"h4"),c.ic(10,"i",3),c.bd(11,"Sensor Types"),c.mc(),c.mc(),c.nc(12,"div",4),c.ic(13,"classifications",5),c.mc(),c.nc(14,"a",2),c.vc("click",(function(){return t.isSensorWavelengthCollapsed=!t.isSensorWavelengthCollapsed})),c.nc(15,"h4"),c.ic(16,"i",3),c.bd(17,"Wave Lengths"),c.mc(),c.mc(),c.nc(18,"div",6),c.ic(19,"classifications",5),c.mc(),c.mc(),c.ic(20,"sensors"),c.ic(21,"br"),c.ic(22,"br"),c.nc(23,"h3"),c.bd(24,"Plaform Options"),c.mc(),c.nc(25,"section",1),c.nc(26,"a",2),c.vc("click",(function(){return t.isPlatformTypeCollapsed=!t.isPlatformTypeCollapsed})),c.nc(27,"h4"),c.ic(28,"i",3),c.bd(29,"Platform Types"),c.mc(),c.mc(),c.nc(30,"div",7),c.ic(31,"classifications",5),c.mc(),c.nc(32,"a",2),c.vc("click",(function(){return t.isPlatformManufacturerCollapsed=!t.isPlatformManufacturerCollapsed})),c.nc(33,"h4"),c.ic(34,"i",3),c.bd(35,"Platform Manufacturer"),c.mc(),c.mc(),c.nc(36,"div",8),c.ic(37,"classifications",5),c.mc(),c.mc(),c.ic(38,"platforms"),c.ic(39,"br"),c.ic(40,"br"),c.mc(),c.mc()),2&e&&(c.Ub(10),c.Ec("ngClass",c.Jc(12,Oi,!t.isSensorTypeCollapsed,t.isSensorTypeCollapsed)),c.Ub(2),c.Ec("collapse",t.isSensorTypeCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(15,Ui)),c.Ub(3),c.Ec("ngClass",c.Jc(16,Oi,!t.isSensorWavelengthCollapsed,t.isSensorWavelengthCollapsed)),c.Ub(2),c.Ec("collapse",t.isSensorWavelengthCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(19,Si)),c.Ub(9),c.Ec("ngClass",c.Jc(20,Oi,!t.isPlatformTypeCollapsed,t.isPlatformTypeCollapsed)),c.Ub(2),c.Ec("collapse",t.isPlatformTypeCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(23,Ii)),c.Ub(3),c.Ec("ngClass",c.Jc(24,Oi,!t.isPlatformManufacturerCollapsed,t.isPlatformManufacturerCollapsed)),c.Ub(2),c.Ec("collapse",t.isPlatformManufacturerCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(27,Ti)))},directives:[$t.a,i.q,u.a,vi,$c,ni],styles:[".collapsible-link[_ngcontent-%COMP%] {\n  font-size: 15px;\n}"]});class Pi{validate(e){return(t=new RegExp(/[\W<>\-+=!@#$%^&*?/\\']/gm),e=>t.test(e.value)?{forbiddenName:{value:e.value}}:null)(e);var t}}Pi.ɵfac=function(e){return new(e||Pi)},Pi.ɵdir=c.cc({type:Pi,selectors:[["","forbiddenName",""]],features:[c.Tb([{provide:o.h,useExisting:Pi,multi:!0}])]});class Fi{canDeactivate(e){return!e.canDeactivate()||!!confirm("An upload is currently in progress. Are you sure you want to leave?")}}Fi.ɵfac=function(e){return new(e||Fi)},Fi.ɵprov=c.dc({token:Fi,factory:Fi.ɵfac});var Ni=n(141);class Di{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/uav/page",{params:t}).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/uav/apply",JSON.stringify({uav:e}),{headers:t}).pipe(Object(T.a)(()=>{this.eventService.complete()})).toPromise()}search(e){let t=new y.g;return t=t.set("text",e),this.http.get(acp+"/uav/search",{params:t}).toPromise()}getMetadataOptions(e){let t=new y.g;return t=t.set("oid",e),this.http.get(acp+"/uav/get-metadata-options",{params:t}).toPromise()}}function Ai(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}Di.ɵfac=function(e){return new(e||Di)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},Di.ɵprov=c.dc({token:Di,factory:Di.ɵfac});class ji{constructor(e,t,n){this.service=e,this.router=t,this.modalService=n,this.message=null,this.cols=[{header:"Serial Number",field:"serialNumber",type:"TEXT",sortable:!0},{header:"FAA Id Number",field:"faaNumber",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"Bureau",field:"bureau",type:"TEXT",sortable:!0},{header:"Platform",field:"platform",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"UAV"},this.refresh=new q.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the UAV ["+e.serialNumber+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/uav",e.oid])}newInstance(){this.router.navigate(["/site/uav","__NEW__"])}}ji.ɵfac=function(e){return new(e||ji)(c.hc(Di),c.hc(a.b),c.hc(Z.b))},ji.ɵcmp=c.bc({type:ji,selectors:[["uavs"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"UAVs"),c.mc(),c.Zc(3,Ai,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,_c.a],styles:["./uavs.css"]});class Zi{constructor(){}ngOnInit(){}}function _i(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",16),c.nc(5,"div"),c.nc(6,"p",17),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Li(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function $i(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.dd(" ",e.label," ")}}function zi(e,t){if(1&e){const e=c.oc();c.nc(0,"button",22),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function Bi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",19),c.Zc(1,zi,2,0,"button",20),c.nc(2,"button",21),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){c.xc();const e=c.Pc(6),t=c.xc();c.Ub(1),c.Ec("ngIf",!t.newInstance),c.Ub(1),c.Ec("disabled",!e.valid)}}function qi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",19),c.nc(1,"button",23),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}function Hi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",2),c.Zc(1,_i,8,1,"div",3),c.nc(2,"div",4),c.nc(3,"h3"),c.bd(4,"UAV"),c.mc(),c.mc(),c.nc(5,"form",null,5),c.nc(7,"div",6),c.nc(8,"label"),c.bd(9,"Platform"),c.mc(),c.nc(10,"select",7),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.platform=t})),c.ic(11,"option"),c.Zc(12,Li,2,2,"option",8),c.mc(),c.mc(),c.nc(13,"div",6),c.nc(14,"label"),c.bd(15,"Serial Number"),c.mc(),c.nc(16,"input",9),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.serialNumber=t})),c.mc(),c.mc(),c.nc(17,"div",6),c.nc(18,"label"),c.bd(19,"FAA Number"),c.mc(),c.nc(20,"input",10),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.faaNumber=t})),c.mc(),c.mc(),c.nc(21,"div",6),c.nc(22,"label"),c.bd(23,"Description"),c.mc(),c.nc(24,"textarea",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.description=t})),c.mc(),c.mc(),c.nc(25,"div",6),c.nc(26,"label"),c.bd(27,"Bureau"),c.mc(),c.nc(28,"select",12),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.bureau=t})),c.ic(29,"option"),c.Zc(30,$i,2,2,"option",8),c.mc(),c.mc(),c.Zc(31,Bi,4,2,"div",13),c.Zc(32,qi,3,0,"div",13),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf",null!=e.message),c.Ub(9),c.Ec("ngModel",e.uav.platform)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.platforms),c.Ub(4),c.Ec("ngModel",e.uav.serialNumber)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.faaNumber)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.description)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.bureau)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.bureaus),c.Ub(1),c.Ec("ngIf","WRITE"===e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode)}}Zi.ɵfac=function(e){return new(e||Zi)},Zi.ɵcmp=c.bc({type:Zi,selectors:[["uavs-page"]],decls:4,vars:0,consts:[["id","app-container",1,"container"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.ic(3,"uavs"),c.mc(),c.mc())},directives:[$t.a,ji],encapsulation:2});class Wi{constructor(e,t,n,c){this.service=e,this.platformService=t,this.route=n,this.router=c,this.newInstance=!1,this.message=null,this.bureaus=[],this.platforms=[],this.mode="READ"}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.uav=e.uav,this.bureaus=e.bureaus,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.uav=e.uav,this.bureaus=e.bureaus,this.original=JSON.parse(JSON.stringify(this.uav))}),this.platformService.getAll().then(e=>{this.platforms=e})}handleOnSubmit(){this.message=null,this.service.apply(this.uav).then(e=>{this.uav=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/uav",e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.uav=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}error(e){this.message=I.b.getMessageFromError(e)}}Wi.ɵfac=function(e){return new(e||Wi)(c.hc(Di),c.hc(ei),c.hc(a.a),c.hc(a.b))},Wi.ɵcmp=c.bc({type:Wi,selectors:[["uav"]],decls:4,vars:1,consts:[["id","app-container",1,"container"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","platform","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","serialNumber","type","input","placeholder","Serial Number","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","faaNumber","type","input","placeholder","FAA Number","required","","max","10","maxlength","10",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","bureau","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,Hi,33,15,"div",1),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.uav))},directives:[$t.a,i.t,o.z,o.l,o.m,o.w,o.v,o.k,o.n,o.p,o.y,i.s,o.c,o.f],encapsulation:2});class Gi{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/collection-report/page",{params:t}).toPromise()}}Gi.ɵfac=function(e){return new(e||Gi)(c.rc(y.c),c.rc(N.a),c.rc(D.a))},Gi.ɵprov=c.dc({token:Gi,factory:Gi.ɵfac});var Vi=n(383);function Ji(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",4),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)}}class Xi{constructor(e,t,n){this.service=e,this.pService=t,this.modalService=n,this.message=null,this.cols=[{header:"Collection",field:"collectionName",baseUrl:"site/viewer/collection",urlField:"collection",type:"URL",sortable:!0,columnType:e=>e.exists?"URL":"TEXT"},{header:"Collection Owner",field:"userName",type:"TEXT",sortable:!0},{header:"Collection Date",field:"collectionDate",type:"DATE",sortable:!0},{header:"Mission",field:"missionName",type:"TEXT",sortable:!0},{header:"Project",field:"projectName",type:"TEXT",sortable:!0},{header:"Site",field:"siteName",type:"TEXT",sortable:!0},{header:"Latitude",field:"siteLatDecimalDegree",type:"NUMBER",sortable:!1,filter:!1},{header:"Longitude",field:"siteLongDecimalDegree",type:"NUMBER",sortable:!1,filter:!1},{header:"Bureau",field:"bureauName",type:"TEXT",sortable:!0},{header:"Platform",field:"platformName",type:"TEXT",sortable:!0},{header:"Sensor",field:"sensorName",type:"TEXT",sortable:!0},{header:"FAA Id Number",field:"faaIdNumber",type:"TEXT",sortable:!0},{header:"Serial Number",field:"serialNumber",type:"TEXT",sortable:!0},{header:"ODM Processing",field:"odmProcessing",type:"TEXT",sortable:!1},{header:"RAW Images Count",field:"rawImagesCount",type:"NUMBER",sortable:!1},{header:"EROS Metadata Complete",field:"erosMetadataComplete",type:"BOOLEAN",sortable:!1},{header:"Video",field:"video",type:"BOOLEAN",sortable:!1},{header:"Orthomosaic",field:"orthomosaic",type:"BOOLEAN",sortable:!1},{header:"Point Cloud",field:"pointCloud",type:"BOOLEAN",sortable:!1},{header:"Hillshade",field:"hillshade",type:"BOOLEAN",sortable:!1},{header:"Products Shared",field:"productsShared",type:"BOOLEAN",sortable:!1},{header:"Storage size",field:"allStorageSize",type:"NUMBER",sortable:!0,filter:!1},{header:"Number of Downloads",field:"downloadCounts",type:"NUMBER",sortable:!0,filter:!1},{header:"Date of Create",field:"createDate",type:"DATE",sortable:!0,filter:!1},{header:"Date of Delete",field:"deleteDate",type:"DATE",sortable:!0,filter:!1},{header:"",field:"product",text:"View Product",type:"CONSTANT",sortable:!1,columnType:e=>null==e.product||0===e.product.length?"NONE":"CONSTANT"}]}ngOnInit(){this.config={service:this.service,remove:!1,view:!1,create:!1,label:"row"}}onExportCSV(){window.open(acp+"/collection-report/export-csv","_blank")}onClick(e){if("custom"===e.type&&"product"===e.col.field){const t=e.row.product;null!=t&&t.length>0&&this.pService.getDetail(t,1,20).then(e=>{this.modalService.show(Ze,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}).content.init(e)})}}}Xi.ɵfac=function(e){return new(e||Xi)(c.hc(Gi),c.hc(Ue),c.hc(Vi.a))},Xi.ɵcmp=c.bc({type:Xi,selectors:[["reports"]],decls:9,vars:1,consts:[["id","app-container",1,"container-fluid"],[1,"row"],["type","submit","value","Export CSV",1,"btn","btn-primary","pull-right",3,"click"],[3,"cols","config","click",4,"ngIf"],[3,"cols","config","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.nc(3,"h2"),c.bd(4,"Report"),c.mc(),c.nc(5,"div",1),c.nc(6,"input",2),c.vc("click",(function(){return t.onExportCSV()})),c.mc(),c.mc(),c.nc(7,"div",1),c.Zc(8,Ji,1,2,"generic-table",3),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(8),c.Ec("ngIf",null!=t.config))},directives:[$t.a,i.t,_c.a],styles:["./reports.css"]});const Yi=[{path:"",canActivate:[Ni.b],component:Mn},{path:"viewer",canActivate:[Ni.b],component:Mn},{path:"viewer/:action/:oid",canActivate:[Ni.b],component:Mn},{path:"upload",component:_n,canDeactivate:[Fi]},{path:"tasks",canActivate:[Ni.b],component:Ac},{path:"report",canActivate:[Ni.b],component:Xi},{path:"sensors",canActivate:[Ni.a],component:$c},{path:"sensor/:oid",canActivate:[Ni.a],component:Qc},{path:"platforms",canActivate:[Ni.a],component:ni},{path:"platform/:oid",canActivate:[Ni.a],component:bi},{path:"platform-manufacturers",canActivate:[Ni.a],component:vi,data:{title:"Platform Manufacturer",label:"manufacturer",baseUrl:Zc.PLATFORM_MANUFACTURER}},{path:"platform-manufacturer/:oid",canActivate:[Ni.a],component:Mi,data:{title:"Platform Manufacturer",label:"manufacturer",baseUrl:Zc.PLATFORM_MANUFACTURER}},{path:"platform-types",canActivate:[Ni.a],component:vi,data:{title:"Platform Type",label:"type",baseUrl:Zc.PLATFORM_TYPE}},{path:"platform-type/:oid",canActivate:[Ni.a],component:Mi,data:{title:"Platform Type",label:"type",baseUrl:Zc.PLATFORM_TYPE}},{path:"sensor-types",canActivate:[Ni.a],component:vi,data:{title:"Sensor Type",label:"type",baseUrl:Zc.SENSOR_TYPE,columns:[{name:"isMultispectral",label:"Is Multispectral",type:"boolean"}]}},{path:"sensor-type/:oid",canActivate:[Ni.a],component:Mi,data:{title:"Sensor Type",label:"type",baseUrl:Zc.SENSOR_TYPE,columns:[{name:"isMultispectral",label:"Is Multispectral",type:"boolean"}]}},{path:"wave-lengths",canActivate:[Ni.a],component:vi,data:{title:"Wave Length",label:"wave length",baseUrl:Zc.WAVE_LENGTH}},{path:"wave-length/:oid",canActivate:[Ni.a],component:Mi,data:{title:"Wave Length",label:"wave length",baseUrl:Zc.WAVE_LENGTH}},{path:"uavs",canActivate:[Ni.a],component:Zi},{path:"uav/:oid",canActivate:[Ni.a],component:Wi},{path:"equipment",canActivate:[Ni.a],component:Ri,data:{}}];class Ki{}Ki.ɵmod=c.fc({type:Ki}),Ki.ɵinj=c.ec({factory:function(e){return new(e||Ki)},providers:[{provide:i.o,useClass:i.h}],imports:[[a.f.forChild(Yi)],a.f]}),("undefined"==typeof ngJitMode||ngJitMode)&&c.Vc(Ki,{imports:[a.f],exports:[a.f]});var Qi=n(104);function ea(e,t){if(1&e){const e=c.oc();c.nc(0,"div",11),c.nc(1,"div",2),c.nc(2,"div",3),c.nc(3,"div",4),c.bd(4,"Point Of Contact"),c.mc(),c.nc(5,"div",5),c.nc(6,"div",6),c.nc(7,"label",12),c.bd(8,"Name"),c.mc(),c.nc(9,"input",13),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.pointOfContact.name=t}))("change",(function(){return c.Rc(e),c.xc().handlePageChange()})),c.mc(),c.mc(),c.nc(10,"div",6),c.nc(11,"label",14),c.bd(12,"Email"),c.mc(),c.nc(13,"input",15),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.pointOfContact.email=t}))("change",(function(){return c.Rc(e),c.xc().handlePageChange()})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(9),c.Ec("ngModel",e.page.selection.pointOfContact.name)("maxlength",100)("required",!1)("disabled",!1),c.Ub(4),c.Ec("ngModel",e.page.selection.pointOfContact.email)("maxlength",255)("required",!1)("disabled",!1)}}function ta(e,t){if(1&e&&(c.lc(0),c.nc(1,"div",6),c.nc(2,"label",16),c.bd(3,"Name"),c.mc(),c.bd(4),c.mc(),c.nc(5,"div",6),c.nc(6,"label",16),c.bd(7,"Type"),c.mc(),c.bd(8),c.mc(),c.nc(9,"div",6),c.nc(10,"label",16),c.bd(11,"Serial Number"),c.mc(),c.bd(12),c.mc(),c.nc(13,"div",6),c.nc(14,"label",16),c.bd(15,"FAA Id Number"),c.mc(),c.bd(16),c.mc(),c.nc(17,"div",6),c.nc(18,"label",16),c.bd(19,"Bureau"),c.mc(),c.bd(20),c.mc(),c.kc()),2&e){const e=c.xc();c.Ub(4),c.dd(" ",e.uav.platform," "),c.Ub(4),c.dd(" ",e.uav.platformType," "),c.Ub(4),c.dd(" ",e.uav.serialNumber," "),c.Ub(4),c.dd(" ",e.uav.faaNumber," "),c.Ub(4),c.dd(" ",e.uav.bureau," ")}}function na(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.dd("",e.name," ")}}function ca(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," ")}}function ia(e,t){if(1&e&&(c.lc(0),c.nc(1,"div",6),c.nc(2,"label",16),c.bd(3,"Type"),c.mc(),c.bd(4),c.mc(),c.nc(5,"div",6),c.nc(6,"label",21),c.bd(7,"Wave Length"),c.mc(),c.nc(8,"ul"),c.Zc(9,ca,2,1,"li",22),c.mc(),c.mc(),c.nc(10,"div",6),c.nc(11,"label",23),c.bd(12,"Sensor Width"),c.mc(),c.bd(13),c.mc(),c.nc(14,"div",6),c.nc(15,"label",23),c.bd(16,"Sensor Width Units"),c.mc(),c.bd(17," Millimeters "),c.mc(),c.nc(18,"div",6),c.nc(19,"label",24),c.bd(20,"Sensor Height"),c.mc(),c.bd(21),c.mc(),c.nc(22,"div",6),c.nc(23,"label",23),c.bd(24,"Sensor Height Units"),c.mc(),c.bd(25," Millimeters "),c.mc(),c.nc(26,"div",6),c.nc(27,"label",25),c.bd(28,"Pixel Size Width"),c.mc(),c.bd(29),c.mc(),c.nc(30,"div",6),c.nc(31,"label",26),c.bd(32,"Pixel Size Height"),c.mc(),c.bd(33),c.mc(),c.kc()),2&e){const e=c.xc(2);c.Ub(4),c.dd(" ",e.metaObject.sensor.sensorType," "),c.Ub(5),c.Ec("ngForOf",e.metaObject.sensor.wavelengths),c.Ub(4),c.dd(" ",e.metaObject.sensor.sensorWidth," "),c.Ub(8),c.dd(" ",e.metaObject.sensor.sensorHeight," "),c.Ub(8),c.dd(" ",e.metaObject.sensor.pixelSizeWidth," "),c.Ub(4),c.dd(" ",e.metaObject.sensor.pixelSizeHeight," ")}}function aa(e,t){if(1&e){const e=c.oc();c.nc(0,"div",1),c.nc(1,"div",2),c.nc(2,"div",3),c.nc(3,"div",4),c.bd(4,"Sensor"),c.mc(),c.nc(5,"div",5),c.nc(6,"div",6),c.nc(7,"label",17),c.bd(8,"Name"),c.mc(),c.nc(9,"select",18),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.sensor=t}))("change",(function(){return c.Rc(e),c.xc().onSensorChange()})),c.ic(10,"option"),c.Zc(11,na,2,2,"option",19),c.mc(),c.mc(),c.Zc(12,ia,34,6,"ng-container",9),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(9),c.Ec("ngModel",e.page.selection.sensor),c.Ub(2),c.Ec("ngForOf",e.uav.sensors),c.Ub(1),c.Ec("ngIf",null!=e.metaObject)}}const oa=function(){return{standalone:!0}};class sa{constructor(e,t){this.service=e,this.uavService=t,this.pageChange=new c.t,this.search="",this.uav=null,this.metaObject=null,this.dataSource=new v.a(e=>{this.uavService.search(this.search).then(t=>{e.next(t)})})}ngOnInit(){null==this.page.selection.pointOfContact&&this.service.getMetadataOptions(null).then(e=>{this.page.selection.pointOfContact={name:e.name,email:e.email}}),null!=this.page.selection.uav&&this.getUavInformation(this.page.selection.uav,!1),null!=this.page.selection.sensor&&this.onSensorChange()}handlePageChange(){this.pageChange.emit(this.page)}onSensorChange(){this.metaObject=null,this.service.getUAVMetadata(this.page.selection.uav,this.page.selection.sensor).then(e=>{this.metaObject={uav:e.uav,sensor:e.sensor}}).catch(e=>{}),this.handlePageChange()}handleUavClick(e){this.getUavInformation(e.item.oid,!0),this.pageChange.emit(this.page)}getUavInformation(e,t){this.uav=null,this.metaObject=null,t&&(this.page.selection.uav=null,this.page.selection.sensor=null),null!=e&&(this.page.selection.uav=e,this.uavService.getMetadataOptions(e).then(e=>{this.uav=e,t||(this.search=this.uav.serialNumber)}))}}sa.ɵfac=function(e){return new(e||sa)(c.hc(j),c.hc(Di))},sa.ɵcmp=c.bc({type:sa,selectors:[["metadata-page"]],inputs:{page:"page"},outputs:{pageChange:"pageChange"},decls:14,vars:10,consts:[["class","row","style","margin-top: 20px;",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"form-group"],["for","platform.name"],["type","text","placeholder","Search...","typeaheadOptionField","serialNumber","required","",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"row",2,"margin-top","20px"],["for","pointOfContact.name"],["type","text","name","pointOfContact.name",3,"ngModel","maxlength","required","disabled","ngModelChange","change"],["for","pointOfContact.email"],["type","text","name","pointOfContact.email",3,"ngModel","maxlength","required","disabled","ngModelChange","change"],["for","sensor.type"],["for","sensor.name"],["name","sensor","required","",1,"form-control",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","sensor.wavelength"],[4,"ngFor","ngForOf"],["for","sensor.sensorWidth"],["for","sensor.sensorHeight"],["for","sensor.pixelSizeWidth"],["for","sensor.pixelSizeHeight"]],template:function(e,t){1&e&&(c.lc(0),c.Zc(1,ea,14,9,"div",0),c.nc(2,"div",1),c.nc(3,"div",2),c.nc(4,"div",3),c.nc(5,"div",4),c.bd(6,"Platform"),c.mc(),c.nc(7,"div",5),c.nc(8,"div",6),c.nc(9,"label",7),c.bd(10,"UAV"),c.mc(),c.nc(11,"input",8),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleUavClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.Zc(12,ta,21,5,"ng-container",9),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(13,aa,13,4,"div",10),c.kc()),2&e&&(c.Ub(1),c.Ec("ngIf",null!=t.page.selection.pointOfContact),c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(9),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("ngModelOptions",c.Hc(9,oa)),c.Ub(1),c.Ec("ngIf",null!=t.uav),c.Ub(1),c.Ec("ngIf",null!=t.uav))},directives:[i.t,o.c,o.v,o.k,o.n,r.b,o.f,o.w,o.p,o.y,i.s],encapsulation:2});var la=n(40),ra=n(57),da=n(22),pa=n(105),ma=n(37),ha=n(64),ua=n(101),ga=n(65),ba=n(106),fa=n(29),va=n(107),ya=n(109);class ka{}ka.ɵmod=c.fc({type:ka}),ka.ɵinj=c.ec({factory:function(e){return new(e||ka)},providers:[Fi,j,Ue,x,jc,ei,ee,zc,Di,Gi],imports:[[i.c,a.f,o.e,h.a,m.b,l.c,r.c,d.b,p.d.forRoot(),u.b.forRoot(),Qi.a,Ki,s.b]]}),("undefined"==typeof ngJitMode||ngJitMode)&&c.Vc(ka,{declarations:[U,Je,st,Y,B,Rt,Oe,_t,Ze,Mn,_n,Ac,Pi,G,Qc,$c,bi,ni,tc,vi,Mi,ji,Zi,Wi,sa,Xi,Ri],imports:[i.c,a.f,o.e,h.a,m.b,l.c,r.c,d.b,p.d,u.b,Qi.a,Ki,s.b]}),c.Uc(Rt,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,a.g,a.c,a.e,a.d,a.h,o.z,o.p,o.y,o.c,o.q,o.t,o.a,o.w,o.x,o.s,o.k,o.l,o.v,o.g,o.f,o.r,o.b,o.d,o.n,o.o,o.m,h.c,h.d,m.a,l.b,l.d,l.a,r.a,r.b,d.a,d.c,p.b,p.e,p.c,p.a,u.a,$t.a,la.a,S.a,ra.a,On.a,V.a,da.a,pa.a,ma.a,ha.a,ua.a,ga.a,_c.a,s.a,s.c,U,Je,st,Y,B,Rt,Oe,_t,Ze,Mn,_n,Ac,Pi,G,Qc,$c,bi,ni,tc,vi,Mi,ji,Zi,Wi,sa,Xi,Ri],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,h.b,ba.a,fa.a,va.a,ya.a,_.a,Se.a])}}]);
//# sourceMappingURL=2.chunk.js.map
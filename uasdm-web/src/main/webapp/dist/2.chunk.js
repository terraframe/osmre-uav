(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{189:function(e,t,n){"use strict";n.r(t),n.d(t,"SiteModule",(function(){return Jo}));var c=n(0),i=n(3),a=n(11),o=n(5),s=n(322),l=n(19),r=n(29),d=n(31),p=n(80),m=n(34),h=n(110),u=n(26),g=n(186),b=n(187),f=n(188),v=n(8),y=n(13);const x="pk.eyJ1IjoidGVycmFmcmFtZSIsImEiOiJjanZxNTFnaTYyZ2RuNDlxcmNnejNtNjN6In0.-kmlS8Tgb2fNc1NPb5rJEQ";class k{constructor(e){this.http=e,g.accessToken=x}features(e){let t=new y.g;return null!=e&&(t=t.set("conditions",JSON.stringify(e))),this.http.get(acp+"/project/features",{params:t}).toPromise()}mbForwardGeocode(e){let t=new y.g,n="https://api.mapbox.com/geocoding/v5/mapbox.places/"+e+".json?proximity=-74.70850,40.78375&access_token="+x;return this.http.get(n,{params:t}).toPromise()}tilejson(e){new y.g;return this.http.get(e).toPromise()}}function E(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",13),c.mc())}function C(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",14),c.mc())}function w(e,t){if(1&e&&(c.nc(0,"span"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.label," / ")}}function U(e,t){if(1&e&&(c.Zc(0,E,2,0,"span",11),c.Zc(1,C,2,0,"span",11),c.nc(2,"span"),c.Zc(3,w,2,1,"span",12),c.mc(),c.nc(4,"b"),c.bd(5),c.mc()),2&e){const e=t.match;c.Ec("ngIf",null==e.item.filename),c.Ub(1),c.Ec("ngIf",null!=e.item.filename),c.Ub(2),c.Ec("ngForOf",e.item.hierarchy),c.Ub(2),c.cd(e.item.label)}}k.ɵfac=function(e){return new(e||k)(c.rc(y.c))},k.ɵprov=c.dc({token:k,factory:k.ɵfac});const I=function(){return{standalone:!0}};class M{constructor(e){this.mapService=e,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.center=new g.LngLat(-78.880453,42.897852),this.zoom=2,this.coordinate={longitude:null,latitude:null},this.search="",this.dataSource=v.a.create(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const n=t.features;let c=[];n.forEach(e=>{let t={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};c.push(t)}),e.next(c)})})}ngOnInit(){this.refreshCoordinateFromMap()}ngAfterViewInit(){let e={container:"map-attribute-div",style:"mapbox://styles/mapbox/outdoors-v11",zoom:this.zoom,center:this.center};null!=this.site.geometry&&(e.center=this.site.geometry.coordinates),this.map=new g.Map(e),this.map.on("load",()=>{this.initMap()})}ngOnDestroy(){this.map.remove()}initMap(){let e=b.modes;e.static=f,this.draw=new b({modes:e,displayControlsDefault:!1,controls:{static:!0}}),this.map.addControl(this.draw),this.map.addControl(new g.NavigationControl),this.map.on("draw.update",e=>{this.onDrawUpdate(e)}),this.map.on("draw.create",e=>{this.onDrawCreate(e)}),this.map.on("draw.modechange",e=>{this.onDrawUpdate(e)}),this.map.on("style.load",()=>{this.addLayers()}),this.addLayers()}addLayers(){if(null!=this.site.geometry){let e={id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry};this.draw.add(e),this.draw.changeMode("simple_select",{featureIds:[e.id]})}else this.draw.changeMode("draw_point",{});this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}})}onDrawUpdate(e){"move"===e.action&&null!=e.features&&e.features.length>0&&this.updateGeometry(e.features[0])}onDrawCreate(e){if(null!=e.features&&e.features.length>0){let t=e.features[0];t.id=this.site.id,this.updateGeometry(t)}}updateGeometry(e){this.site.geometry=e.geometry,this.refreshCoordinateFromMap()}refreshCoordinateFromMap(){null!=this.site&&null!=this.site.geometry&&(this.coordinate.longitude=this.site.geometry.coordinates[0],this.coordinate.latitude=this.site.geometry.coordinates[1])}refreshCoordinateFromInput(){if(null!=this.coordinate.longitude&&null!=this.coordinate.latitude){console.log(this.site.geometry),null==this.site.geometry&&(this.site.geometry={type:"Point"}),this.site.geometry.coordinates=[this.coordinate.longitude,this.coordinate.latitude];var e=this.draw.set({type:"FeatureCollection",features:[{id:this.site.id,type:"Feature",properties:{oid:this.site.id,name:this.site.name},geometry:this.site.geometry}]});this.draw.changeMode("simple_select",{featureIds:e})}}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}handleClick(e){let t=e.item;t.center&&this.map.flyTo({center:t.center,zoom:9})}}M.ɵfac=function(e){return new(e||M)(c.hc(k))},M.ɵcmp=c.bc({type:M,selectors:[["map-attribute"]],inputs:{site:"site",center:"center",zoom:"zoom"},decls:23,vars:9,consts:[[1,"row-holder"],[1,"label-holder"],[1,"holder"],[1,"modal-body"],["id","search-container",2,"position","absolute","z-index","999","padding","15px","width","35%"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],["id","map-attribute-div",1,"map-view-port",2,"height","300px"],[1,"modal-body","text-left"],["name","longitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["name","latitude","type","number","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["bsItemTemplate",""],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){if(1&e&&(c.nc(0,"div",0),c.ic(1,"div",1),c.nc(2,"div",2),c.nc(3,"div",3),c.nc(4,"div",4),c.nc(5,"input",5),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.ic(6,"div",6),c.mc(),c.mc(),c.mc(),c.nc(7,"div",0),c.nc(8,"div",1),c.nc(9,"label"),c.bd(10,"Longitude"),c.mc(),c.mc(),c.nc(11,"div",2),c.nc(12,"div",7),c.nc(13,"input",8),c.vc("ngModelChange",(function(e){return t.coordinate.longitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",0),c.nc(15,"div",1),c.nc(16,"label"),c.bd(17,"Latitude"),c.mc(),c.mc(),c.nc(18,"div",2),c.nc(19,"div",7),c.nc(20,"input",9),c.vc("ngModelChange",(function(e){return t.coordinate.latitude=e}))("change",(function(){return t.refreshCoordinateFromInput()})),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(21,U,6,4,"ng-template",null,10,c.ad)),2&e){const e=c.Pc(22);c.Ub(5),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",e)("ngModelOptions",c.Hc(8,I)),c.Ub(8),c.Ec("ngModel",t.coordinate.longitude),c.Ub(7),c.Ec("ngModel",t.coordinate.latitude)}},directives:[o.c,o.k,o.n,r.b,o.q,o.v,i.t,i.s],encapsulation:2});var O=n(53),S=n(82),R=n(132),T=n(330),P=n(334),F=n(331),D=n(155),N=n(33),Z=n(25);class A{constructor(e,t,n,c){this.http=e,this.noErrorHttpClient=t,this.eventService=n,this.authService=c}getChildren(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/get-children",{params:t}).toPromise()}getObjects(e,t,n,c){let i=new y.g;return i=i.set("id",e),null!=t&&(i=i.set("key",t)),null!=n&&(i=i.set("pageNumber",n.toString())),null!=c&&(i=i.set("pageSize",c.toString())),this.http.get(acp+"/project/objects",{params:i}).toPromise()}view(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/view",{params:t}).toPromise()}getItems(e,t){let n=new y.g;return n=n.set("id",e),null!=t&&(n=n.set("key",t)),this.http.get(acp+"/project/items",{params:n}).toPromise()}getArtifacts(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/get-artifacts",{params:t}).toPromise()}removeArtifacts(e,t){let n=new y.f({"Content-Type":"application/json"});const c={id:e,folder:t};return this.eventService.start(),this.http.post(acp+"/project/remove-artifacts",JSON.stringify(c),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}roots(e,t,n){let c=new y.g;return null!=e&&(c=c.set("id",e)),null!=t&&(c=c.set("conditions",JSON.stringify(t))),null!=n&&(c=c.set("sort",n)),this.http.get(acp+"/project/roots",{params:c}).toPromise()}edit(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/edit",JSON.stringify({id:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}setExclude(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/set-exclude",JSON.stringify({id:e,exclude:t}),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}runOrtho(e,t,n,c){let i=new y.f({"Content-Type":"application/json"});const a={id:e,processPtcloud:t,processDem:n,processOrtho:c};return this.http.post(acp+"/project/run-ortho",JSON.stringify(a),{headers:i}).pipe(Object(R.a)(()=>{})).toPromise()}update(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/update",JSON.stringify({entity:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}newChild(e,t){let n="/project/new-default-child",c=new y.f({"Content-Type":"application/json"}),i={};return null!=e&&(i.parentId=e),t&&(i.type=t,n="/project/new-child"),this.eventService.start(),this.http.post(acp+n,JSON.stringify(i),{headers:c}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}applyWithParent(e,t){let n=new y.f({"Content-Type":"application/json"}),c={entity:e};return null!=t&&(c.parentId=t),this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/apply-with-parent",JSON.stringify(c),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}getCurrentUser(){return this.authService.getUserName()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}removeObject(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/removeObject",JSON.stringify({id:e,key:t}),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}removeTask(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/remove-task",JSON.stringify({uploadId:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}upload(e,t,n){this.eventService.start();const c=new FormData;return c.append("file",n),c.append("id",e),c.append("folder",t),this.http.post(acp+"/project/upload",c).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}tasks(e,t,n,c){let i=new y.g;return i=i.set("statuses",JSON.stringify(e)),i=i.set("pageSize",t.toString()),i=i.set("pageNumber",n.toString()),i=i.set("token",c.toString()),this.http.get(acp+"/project/tasks",{params:i}).toPromise()}getTasks(e){let t=new y.g;return t=t.set("collectionId",e),this.http.get(acp+"/project/collection-tasks",{params:t}).toPromise()}task(e){let t=new y.g;return t=t.set("id",e),this.http.get(acp+"/project/task",{params:t}).toPromise()}getUploadTask(e){let t=new y.g;return t=t.set("uploadId",e),this.http.get(acp+"/project/get-upload-task",{params:t}).toPromise()}getMessages(e,t){let n=new y.g;return n=n.set("pageSize",e.toString()),n=n.set("pageNumber",t.toString()),this.http.get(acp+"/project/get-messages",{params:n}).toPromise()}download(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("key",t),n&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download",{params:c,responseType:"blob"}).pipe(Object(R.a)(()=>{n&&this.eventService.complete()}))}downloadProductPreview(e,t){let n=new y.g;return n=n.set("productId",e),n=n.set("artifactName","ortho"),t&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/downloadProductPreview",{params:n,responseType:"blob"}).pipe(Object(R.a)(()=>{t&&this.eventService.complete()}))}downloadFile(e,t){let n=new y.g;return n=n.set("url",e),t&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download-file",{params:n,responseType:"blob"}).pipe(Object(R.a)(()=>{t&&this.eventService.complete()})).toPromise()}downloadAll(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("key",t),n&&this.eventService.start(),this.noErrorHttpClient.get(acp+"/project/download-all",{params:c,responseType:"blob"}).pipe(Object(R.a)(()=>{n&&this.eventService.complete()}))}search(e){return e.pipe(Object(T.a)(400)).pipe(Object(P.a)()).pipe(Object(F.a)(e=>this.searchEntries(e)))}searchEntries(e){let t=new y.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t})}searchEntites(e){let t=new y.g;return t=t.set("term",e),this.http.get(acp+"/project/search",{params:t}).toPromise()}submitCollectionMetadata(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/project/submit-metadata",JSON.stringify({collectionId:e,json:t}),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}applyMetadata(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/apply-metadata",JSON.stringify({selection:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}createCollection(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/project/create-collection",JSON.stringify({selections:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}pushToEros(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/eros/push",JSON.stringify({collectionId:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}getMetadataOptions(e){let t=new y.g;return null!=e&&(t=t.set("id",e)),this.noErrorHttpClient.get(acp+"/project/metadata-options",{params:t}).toPromise()}getUAVMetadata(e,t){let n=new y.g;return n=n.set("uavId",e),n=n.set("sensorId",t),this.noErrorHttpClient.get(acp+"/project/uav-metadata",{params:n}).toPromise()}evaluate(e,t){return null!=e&&"eq"===e.type?t[e.name]===e.value:null!=e&&"admin"===e.type&&this.authService.isAdmin()}bureaus(){let e=new y.g;return this.http.get(acp+"/uav/bureaus",{params:e}).toPromise()}getTotals(e,t){let n=new y.g;return n=n.set("text",e),n=n.set("filters",JSON.stringify(t)),this.http.get(acp+"/project/get-totals",{params:n}).toPromise()}getStacItems(e,t,n){let c=new y.g;return c=c.set("criteria",JSON.stringify(e)),c=c.set("pageSize",t.toString()),c=c.set("pageNumber",n.toString()),this.http.get(acp+"/project/get-stac-items",{params:c}).toPromise()}}A.ɵfac=function(e){return new(e||A)(c.rc(y.c),c.rc(D.a),c.rc(N.a),c.rc(Z.a))},A.ɵprov=c.dc({token:A,factory:A.ɵfac});var j=n(15),L=n(96);function _(e,t){if(1&e&&(c.nc(0,"div",7),c.nc(1,"div",8),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",9),c.nc(5,"div"),c.nc(6,"p",10),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function $(e,t){1&e&&(c.nc(0,"p",11),c.bd(1,"Loading image..."),c.mc())}function z(e,t){if(1&e&&(c.ic(0,"img",12),c.yc(1,"safeHtml")),2&e){const e=c.xc();c.Ec("src",c.zc(1,1,e.imageToShow),c.Tc)}}class B{constructor(e,t){this.service=e,this.bsModalRef=t,this.message=null,this.open=!0,this.loading=!0}init(e){this.productId=e,this.getImage(this.productId)}createImageFromBlob(e){let t=new FileReader;t.addEventListener("load",()=>{this.imageToShow=t.result},!1),e&&t.readAsDataURL(e)}getImage(e){this.loading=!0;this.service.downloadProductPreview(e,!1).subscribe(e=>{this.createImageFromBlob(e),this.loading=!1},e=>{this.loading=!1,this.error(e)})}close(){this.open=!1}error(e){this.message=S.b.getMessageFromError(e)}}B.ɵfac=function(e){return new(e||B)(c.hc(A),c.hc(j.a))},B.ɵcmp=c.bc({type:B,selectors:[["image-preview-modal"]],decls:7,vars:3,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"image-preview-container"],[1,"fa","fa-times","btn","btn-close",2,"min-width","0",3,"click"],[1,"image-container"],["style","text-align: left;",4,"ngIf"],["class","image-preview img-responsive center-block","alt","Image",3,"src",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[2,"text-align","left"],["alt","Image",1,"image-preview","img-responsive","center-block",3,"src"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.Zc(1,_,8,1,"div",1),c.nc(2,"div",2),c.nc(3,"i",3),c.vc("click",(function(){return t.bsModalRef.hide()})),c.mc(),c.nc(4,"div",4),c.Zc(5,$,2,0,"p",5),c.Zc(6,z,2,3,"img",6),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(1),c.Ec("ngIf",null!=t.message),c.Ub(4),c.Ec("ngIf",t.loading),c.Ub(1),c.Ec("ngIf",!t.loading))},directives:[i.t],pipes:[L.a],encapsulation:2});var G=n(22);class V{}function q(e,t){1&e&&(c.nc(0,"div",11),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",14),c.nc(4,"strong",15),c.bd(5,"Information"),c.mc(),c.mc(),c.nc(6,"div",16),c.nc(7,"div"),c.nc(8,"p",15),c.bd(9,"The metadata was originally submitted in an out of date format and needs to be re-entered"),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",12),c.mc())}function H(e,t){if(1&e&&(c.nc(0,"div",11),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",14),c.nc(4,"strong",17),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",16),c.nc(7,"div"),c.nc(8,"p",18),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",12),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function J(e,t){if(1&e){const e=c.oc();c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",19),c.nc(4,"metadata-page",20),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().page=t})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.Ec("page",e.page)}}class W{constructor(e,t){this.bsModalRef=e,this.service=t,this.message=null,this.disabled=!1,this.isOldFormat=!1,this.page=null}ngOnInit(){this.onMetadataChange=new G.b}ngOnDestroy(){this.onMetadataChange.unsubscribe()}init(e,t){this.collectionId=e,this.service.getMetadataOptions(this.collectionId).then(e=>{this.isOldFormat=null==e.uav||null==e.sensor,this.page={selection:{type:"CATEGORY",isNew:!1,value:this.collectionId,label:t,uav:null!=e.uav?e.uav.oid:null,sensor:null!=e.sensor?e.sensor.oid:null,pointOfContact:{name:e.name,email:e.email}}}}).catch(e=>{this.error(e)})}close(){this.bsModalRef.hide()}handleSubmit(){this.service.applyMetadata(this.page.selection).then(()=>{this.onMetadataChange.next(this.page.selection),this.bsModalRef.hide()}).catch(e=>{this.error(e)})}error(e){this.message=S.b.getMessageFromError(e)}}W.ɵfac=function(e){return new(e||W)(c.hc(j.a),c.hc(A))},W.ɵcmp=c.bc({type:W,selectors:[["metadata-modal"]],decls:17,vars:5,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,"row","error-container"],[1,"col-md-2"],[1,"col-md-8"],[1,"label-holder"],[2,"color","#c7a717"],[1,"holder"],[2,"color","#8c0000"],[1,"error-message"],[1,"form-group"],[3,"page","pageChange"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h3"),c.bd(2,"Metadata"),c.mc(),c.nc(3,"div",0),c.Zc(4,q,11,0,"div",1),c.Zc(5,H,11,1,"div",1),c.Zc(6,J,5,1,"div",2),c.mc(),c.nc(7,"div",3),c.nc(8,"div",4),c.nc(9,"div",5),c.nc(10,"div",6),c.nc(11,"button",7),c.vc("click",(function(){return t.close()})),c.nc(12,"span",8),c.bd(13,"Close"),c.mc(),c.mc(),c.nc(14,"button",9),c.vc("click",(function(){return t.handleSubmit()})),c.ic(15,"i",10),c.bd(16," Submit "),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(4),c.Ec("ngIf",t.isOldFormat),c.Ub(1),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",null!=t.page),c.Ub(5),c.Ec("disabled",t.disabled),c.Ub(3),c.Ec("disabled",t.disabled))},encapsulation:2});var Y=n(98),X=n(335),K=n(46),Q=n(323);class ee{constructor(e,t,n,c,i,a,o){this.root=e,this.leaf=t,this.drillable=n,this.expandable=c,this.uploadable=i,this.processable=a,this.childLabel=o}}class te{constructor(){this.cache={},this.cache.Site=new ee(!0,!1,!0,!1,!1,!1,"Projects"),this.cache.Project=new ee(!1,!1,!0,!1,!1,!1,"Missions"),this.cache.Mission=new ee(!1,!1,!1,!0,!1,!1,"Collections"),this.cache.Collection=new ee(!1,!0,!1,!1,!1,!0,"Images"),this.cache.folder=new ee(!1,!0,!1,!1,!0,!1,""),this.cache.raw=new ee(!1,!1,!1,!1,!0,!1,""),this.cache.accessible=new ee(!1,!1,!1,!1,!0,!1,"")}getMetadata(e){return this.cache[e.type]}getTypeContainsFolders(e){return"Collection"===e.type}isUploadable(e){return null!=this.cache[e]&&this.cache[e].uploadable}hasExtraField(e,t){return"Collection"===e&&("collectionDate"===t||"sensor"===t||"uav"===t)}isProcessable(e){return null!=this.cache[e]&&this.cache[e].processable}getHierarchy(){return["Site","Project","Mission","Collection"]}}te.ɵfac=function(e){return new(e||te)},te.ɵprov=c.dc({token:te,factory:te.ɵfac});const ne=["uploader"];function ce(e,t){if(1&e&&(c.nc(0,"div",22),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"div",23),c.nc(4,"strong",24),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",25),c.nc(7,"div"),c.nc(8,"p",26),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",5),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function ie(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"ol",27),c.ic(4,"modal-step-indicator",28),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("stepConfig",e.modalStepConfig)}}function ae(e,t){if(1&e){const e=c.oc();c.nc(0,"artifact-page",31),c.vc("onError",(function(t){return c.Rc(e),c.xc(3).error(t)})),c.mc()}if(2&e){const e=c.xc(3);c.Ec("edit",!0)("entity",e.component)("config",e.config)}}function oe(e,t){if(1&e){const e=c.oc();c.nc(0,"div",32),c.nc(1,"label",33),c.bd(2,"Output Product Name Prefix"),c.mc(),c.nc(3,"input",34),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(3).values.outFileName=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ub(3),c.Ec("ngModel",e.values.outFileName)}}function se(e,t){if(1&e&&(c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.Zc(3,ae,1,3,"artifact-page",29),c.Zc(4,oe,4,1,"div",30),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngIf",null!=e.component),c.Ub(1),c.Ec("ngIf",e.processUpload)}}function le(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"div",32),c.nc(4,"boolean-field",38),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(3).config.processOrtho=t})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("value",e.config.processOrtho)}}function re(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.ic(1,"div",5),c.nc(2,"div",6),c.nc(3,"div",32),c.nc(4,"boolean-field",39),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(3).config.processDem=t})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("value",e.config.processDem)}}function de(e,t){if(1&e){const e=c.oc();c.lc(0),c.Zc(1,le,5,2,"div",2),c.Zc(2,re,5,2,"div",2),c.nc(3,"div",15),c.ic(4,"div",5),c.nc(5,"div",6),c.nc(6,"div",32),c.nc(7,"label",35),c.bd(8,"Description"),c.mc(),c.nc(9,"input",36),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.description=t})),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(10,"div",15),c.ic(11,"div",5),c.nc(12,"div",6),c.nc(13,"div",32),c.nc(14,"label",35),c.bd(15,"Processing Software"),c.mc(),c.nc(16,"input",37),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.tool=t})),c.mc(),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc(2);c.Ub(1),c.Ec("ngIf","ortho"===e.uploadTarget),c.Ub(1),c.Ec("ngIf","dem"===e.uploadTarget),c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(6),c.Ec("ngModel",e.values.description),c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(6),c.Ec("ngModel",e.values.tool)}}function pe(e,t){if(1&e&&(c.lc(0),c.Zc(1,se,5,3,"div",2),c.Zc(2,de,17,6,"ng-container",3),c.kc()),2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf","raw"===e.uploadTarget),c.Ub(1),c.Ec("ngIf","raw"!==e.uploadTarget)}}function me(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",40),c.nc(2,"div",41),c.bd(3,"Partial Upload Detected"),c.mc(),c.nc(4,"div",42),c.nc(5,"h4"),c.bd(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),c.mc(),c.nc(7,"h4"),c.nc(8,"b"),c.bd(9,"To continue an upload"),c.mc(),c.bd(10," please re-upload your file and we will try our best to continue where you left off. "),c.mc(),c.mc(),c.mc(),c.mc())}function he(e,t){if(1&e){const e=c.oc();c.nc(0,"div",43),c.nc(1,"div",41),c.bd(2," Upload Details "),c.nc(3,"i",44),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().closeTaskFinishedNotification(n.id)})),c.mc(),c.mc(),c.nc(4,"div",42),c.nc(5,"h4"),c.bd(6," Status: "),c.nc(7,"b"),c.bd(8," Upload successfully completed "),c.mc(),c.mc(),c.nc(9,"h4"),c.bd(10," Message: "),c.nc(11,"b"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(12),c.dd(" ",e.message," ")}}function ue(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.nc(2,"td"),c.bd(3,"RGB Image Data"),c.mc(),c.nc(4,"td"),c.bd(5,"jpg, jpeg, png"),c.mc(),c.mc(),c.nc(6,"tr"),c.nc(7,"td"),c.bd(8,"Multispectral Image Data"),c.mc(),c.nc(9,"td"),c.bd(10,"tif"),c.mc(),c.mc(),c.nc(11,"tr"),c.nc(12,"td"),c.bd(13,"Video"),c.mc(),c.nc(14,"td"),c.bd(15,"mp4"),c.mc(),c.mc(),c.mc())}function ge(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"laz"),c.mc(),c.mc(),c.mc())}function be(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"tif"),c.mc(),c.mc(),c.mc())}function fe(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"tif, png"),c.mc(),c.mc(),c.mc())}function ve(e,t){1&e&&(c.nc(0,"tbody"),c.nc(1,"tr"),c.ic(2,"td"),c.nc(3,"td"),c.bd(4,"mp4"),c.mc(),c.mc(),c.mc())}function ye(e,t){if(1&e&&(c.nc(0,"div",40),c.nc(1,"div",41),c.bd(2,"Upload Details"),c.mc(),c.nc(3,"div",42),c.nc(4,"h4"),c.bd(5," Status: "),c.nc(6,"b"),c.bd(7),c.mc(),c.mc(),c.nc(8,"h4"),c.bd(9," Message: "),c.nc(10,"b"),c.bd(11),c.mc(),c.mc(),c.nc(12,"h4"),c.bd(13," Upload Started On: "),c.nc(14,"b"),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"h4"),c.bd(18," Last Updated: "),c.nc(19,"b"),c.bd(20),c.yc(21,"idmdate"),c.mc(),c.mc(),c.nc(22,"h4"),c.bd(23," Elapsed Time: "),c.nc(24,"b"),c.bd(25),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.dd(" ",e.currentTask.status," "),c.Ub(4),c.dd(" ",e.currentTask.message," "),c.Ub(4),c.dd(" ",c.zc(16,5,e.currentTask.createDate)," "),c.Ub(5),c.dd(" ",c.zc(21,7,e.currentTask.lastUpdateDate)," "),c.Ub(5),c.dd(" ",e.uploadCounter," ")}}function xe(e,t){if(1&e){const e=c.oc();c.nc(0,"button",45),c.vc("click",(function(){return c.Rc(e),c.xc().removeUpload()})),c.ic(1,"i",46),c.bd(2," Cancel Upload "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",e.disabled)}}function ke(e,t){if(1&e){const e=c.oc();c.nc(0,"button",47),c.vc("click",(function(){return c.Rc(e),c.xc().handleUpload()})),c.ic(1,"i",46),c.bd(2," Upload "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}class Ee{constructor(e,t,n,c,i){this.service=e,this.metadataService=t,this.modalService=n,this.bsModalRef=c,this.objectKeys=Object.keys,this.importedValues=!1,this.message="",this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.finishedTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.processUpload=!0,this.config={processPtcloud:!1,processDem:!1,processOrtho:!1},this.hierarchy=[],this.component=null,this.uploadTarget=null,this.labels=[],this.pages=[{index:0,selection:null,options:[],type:"FILE"}],this.hierarchyChange=!1,this.page=this.pages[0],this.sensors=[],this.platforms=[],this.modalStepConfig={steps:[{label:"Final",active:!0,enabled:!0}]},this.differ=i.find([]).create()}set content(e){const t=this;if(null!=e&&null==this.uploader&&null!=this.uploadTarget){const n=[];"ortho"===this.uploadTarget||"dem"===this.uploadTarget?n.push("tif"):"ptcloud"===this.uploadTarget?n.push("laz"):(n.push("zip"),n.push("tar.gz"));const c={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:n},showMessage:function(e){},callbacks:{onUpload:function(e,n){t.disabled=!0,this.finishedTask=null,t.countUpload(t),t.message&&t.message.length>0&&(t.message="")},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,n,c,i){c.message&&c.message.currentTask&&!t.currentTask&&(t.currentTask=c.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(X.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(K.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,n,c,i){t.disabled=!1,t.finishedTask=t.currentTask,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),c.success&&t.bsModalRef.hide(),t.onUploadComplete.next()},onCancel:function(e,n){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.existingTask&&(t.page=t.pages[0]),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,n,c){t.error({error:{message:c}})}}};this.uploader=new Q.FineUploader(c)}}ngOnInit(){this.onUploadComplete=new G.b,this.onUploadCancel=new G.b}ngOnDestroy(){this.onUploadComplete.unsubscribe(),this.onUploadCancel.unsubscribe()}ngAfterViewInit(){}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}init(e,t){this.component=e,this.uploadTarget=t,this.hierarchy=this.metadataService.getHierarchy(),this.pages=[],this.pages.push({index:this.pages.length,selection:null,options:[],type:"SUMMARY"}),this.page=this.pages[0],this.existingTask&&(this.page=this.pages[this.pages.length-1])}close(){this.bsModalRef.hide()}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0)}isPageValid(e){if("CATEGORY"===e.type){if(null!=e.selection)return null!=e.selection.value&&e.selection.value.length>0||null!=e.selection.label&&e.selection.label.length>0&&((!this.hasField("uav")||null!=e.selection.uav&&0!==e.selection.uav.length)&&((!this.hasField("sensor")||null!=e.selection.sensor&&0!==e.selection.sensor.length)&&(!this.hasField("collectionDate")||null!=e.selection.collectionDate&&0!==e.selection.collectionDate.length)))}else if("FILE"===e.type){if(null!=this.uploader){const e=this.uploader.getUploads();return null!=e&&e.length>0}}else if("SUMMARY"===e.type)return null==this.currentTask;return!0}updateCurrentPageLabel(){this.page.options.forEach(e=>{e.id===this.page.selection.value&&(this.page.selection.label=e.name)})}setIsNew(e){this.page.selection.isNew=e,e?this.page.selection.value=null:this.page.selection.label=null}handleAddMetadata(e){this.modalService.show(W,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(e.collection)}handleNextPage(){if(this.page.index+1<this.pages.length){const e=this.pages[this.page.index+1];"CATEGORY"===this.page.type&&(this.updateCurrentPageLabel(),this.labels.push(this.page.selection.label)),"CATEGORY"===e.type?"FILE"===this.page.type?this.page=e:!this.page.selection.isNew&&null!=this.page.selection.value&&this.page.selection.value.length>0?this.service.getChildren(this.page.selection.value).then(t=>{e.options=t.filter(t=>t.type===e.selection.type),this.page=e}).catch(e=>{this.error(e)}):this.page=e:(this.page=e,this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!1},{label:"Final",active:!0,enabled:!1}]})}}handleBackPage(){if(this.page.index>0){const e=this.pages[this.page.index-1];"CATEGORY"===e.type&&(this.labels.splice(this.labels.length-1,1),this.modalStepConfig.steps.forEach(e=>{"category"===e.label.toLowerCase()&&!1===e.enabled&&(this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]})})),this.page=e}}handleUpload(){if(this.existingTask)this.uploader.uploadStoredFiles();else{(()=>{this.values.uploadTarget=this.uploadTarget,this.values.uasComponentOid=this.component.id,this.values.processUpload=this.processUpload,this.values.processDem=this.config.processDem,this.values.processOrtho=this.config.processOrtho,this.values.processPtcloud=this.config.processPtcloud,this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()})()}}hasField(e){return this.metadataService.hasExtraField(this.page.selection.type,e)}removeUpload(){const e=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});e.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",e.content.type="DANGER",e.content.submitText="Cancel Upload",e.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),this.existingTask=!1,this.page=this.pages[0],this.onUploadCancel.next(),this.bsModalRef.hide()}).catch(e=>{this.error(e)})})}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let n=Math.floor(t/3600),c=Math.floor(t%3600/60),i=Math.floor(t%60),a=c<10?"0"+n:n,o=c<10?"0"+c:c,s=i<10?"0"+i:i;e.uploadCounter=a+":"+o+":"+s}),1e3)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}error(e){this.message=S.b.getMessageFromError(e)}}Ee.ɵfac=function(e){return new(e||Ee)(c.hc(A),c.hc(te),c.hc(j.b),c.hc(j.a),c.hc(c.E))},Ee.ɵcmp=c.bc({type:Ee,selectors:[["upload-modal"]],viewQuery:function(e,t){var n;(1&e&&c.fd(ne,!0),2&e)&&(c.Oc(n=c.wc())&&(t.content=n.first))},hostBindings:function(e,t){1&e&&c.vc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.Qc)},decls:46,vars:17,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[4,"ngIf"],[1,"row",3,"hidden"],[1,"col-md-2"],[1,"col-md-8"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],[1,"",3,"hidden"],[1,"well"],[1,"table"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-danger",3,"disabled","click",4,"ngIf"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"row","error-container"],[1,"label-holder"],[2,"color","#8c0000"],[1,"holder"],[1,"error-message"],[1,"list-group","list-group-horizontal"],[3,"stepConfig"],[3,"edit","entity","config","onError",4,"ngIf"],["class","form-group",4,"ngIf"],[3,"edit","entity","config","onError"],[1,"form-group"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],["for","description"],["name","description","type","input","placeholder","Description...",1,"form-control",3,"ngModel","ngModelChange"],["name","tool","type","input","placeholder","Software...",1,"form-control",3,"ngModel","ngModelChange"],["label","Generate png from upload",3,"value","valueChange"],["label","Generate hillshade from tif",3,"value","valueChange"],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],["type","button",1,"btn","btn-danger",3,"disabled","click"],[1,"icon-upload","icon-white"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,ce,11,1,"div",1),c.Zc(3,ie,5,1,"div",2),c.Zc(4,pe,3,2,"ng-container",3),c.nc(5,"div",4),c.ic(6,"div",5),c.nc(7,"div",6),c.Zc(8,me,11,0,"div",3),c.Zc(9,he,13,1,"div",7),c.nc(10,"div",8),c.nc(11,"div",9),c.nc(12,"h4"),c.bd(13,"All files uploaded through the upload wizard must"),c.mc(),c.nc(14,"ul"),c.nc(15,"li"),c.bd(16,"be compressed into a .zip or .tar.gz format "),c.mc(),c.nc(17,"li"),c.bd(18,"not contain spaces or special characters such as <,>, -, +, =, !, @, #, $, %, ^, &, *, ?,/,\\ or apostrophes in any file name"),c.mc(),c.mc(),c.nc(19,"h4"),c.bd(20," Supported File Formats "),c.mc(),c.nc(21,"table",10),c.nc(22,"thead"),c.nc(23,"tr"),c.nc(24,"th"),c.bd(25,"Type"),c.mc(),c.nc(26,"th"),c.bd(27,"Formats"),c.mc(),c.mc(),c.mc(),c.Zc(28,ue,16,0,"tbody",3),c.Zc(29,ge,5,0,"tbody",3),c.Zc(30,be,5,0,"tbody",3),c.Zc(31,fe,5,0,"tbody",3),c.Zc(32,ve,5,0,"tbody",3),c.mc(),c.mc(),c.Zc(33,ye,26,9,"div",11),c.ic(34,"div",12,13),c.mc(),c.mc(),c.ic(36,"div",5),c.mc(),c.mc(),c.nc(37,"div",14),c.nc(38,"div",15),c.nc(39,"div",16),c.nc(40,"div",17),c.Zc(41,xe,3,1,"button",18),c.nc(42,"button",19),c.vc("click",(function(){return t.close()})),c.nc(43,"span",20),c.bd(44,"Close"),c.mc(),c.mc(),c.Zc(45,ke,3,1,"button",21),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",!t.existingTask),c.Ub(1),c.Ec("ngIf","SUMMARY"===t.page.type&&!t.existingTask&&null==t.currentTask),c.Ub(1),c.Ec("@fadeInOnEnter",void 0)("hidden","FILE"!==t.page.type&&"SUMMARY"!==t.page.type),c.Ub(3),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("ngForOf",t.taskFinishedNotifications),c.Ub(1),c.Ec("hidden",!t.uploadVisible),c.Ub(18),c.Ec("ngIf","row"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","ptcloud"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","dem"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","ortho"===t.uploadTarget),c.Ub(1),c.Ec("ngIf","video"===t.uploadTarget),c.Ub(1),c.Ec("ngIf",t.currentTask),c.Ub(8),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("disabled",t.disabled),c.Ub(3),c.Ec("ngIf",t.page.index===t.pages.length-1))},styles:[".list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tdisplay: inline-block;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tmargin-bottom: 0;\n\tmargin-left: -4px;\n\tmargin-right: 0;\n\tborder-right-width: 0;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child {\n\tborder-top-right-radius: 0;\n\tborder-bottom-left-radius: 4px;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child {\n\tborder-top-right-radius: 4px;\n\tborder-bottom-left-radius: 0;\n\tborder-right-width: 1px;\n}\n\n.list-group-item-success[_ngcontent-%COMP%] {\n\tcolor: #155724;\n\tbackground-color: #c3e6cb;\n}"],data:{animation:[Object(Y.c)(),Object(Y.d)()]}});var Ce=n(337),we=n(79);function Ue(e,t){1&e&&c.ic(0,"i",2)}function Ie(e,t){if(1&e&&(c.nc(0,"tr"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," ")}}function Me(e,t){if(1&e&&(c.lc(0),c.nc(1,"table"),c.Zc(2,Ie,2,1,"tr",4),c.mc(),c.kc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(2),c.Ec("ngForOf",t.artifacts[e.folder])}}function Oe(e,t){if(1&e&&(c.nc(0,"tr"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.tool," ")}}function Se(e,t){if(1&e&&(c.lc(0),c.nc(1,"table"),c.Zc(2,Oe,2,1,"tr",4),c.mc(),c.kc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(2),c.Ec("ngForOf",t.artifacts[e.folder])}}function Re(e,t){if(1&e&&(c.nc(0,"tr"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.lastModified," ")}}function Te(e,t){if(1&e&&(c.lc(0),c.nc(1,"table"),c.Zc(2,Re,2,1,"tr",4),c.mc(),c.kc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(2),c.Ec("ngForOf",t.artifacts[e.folder])}}function Pe(e,t){if(1&e&&(c.nc(0,"tr"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.description," ")}}function Fe(e,t){if(1&e&&(c.lc(0),c.nc(1,"table"),c.Zc(2,Pe,2,1,"tr",4),c.mc(),c.kc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(2),c.Ec("ngForOf",t.artifacts[e.folder])}}function De(e,t){if(1&e){const e=c.oc();c.nc(0,"button",10),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return c.xc(2).handleRemove(t)})),c.bd(1," Remove "),c.mc()}if(2&e){const e=c.xc(4);c.Ec("disabled",e.processRunning)}}function Ne(e,t){if(1&e){const e=c.oc();c.nc(0,"button",11),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return c.xc(2).handleUpload(t.folder)})),c.bd(1," Upload "),c.mc()}if(2&e){const e=c.xc(4);c.Ec("disabled",e.processRunning)}}function Ze(e,t){if(1&e&&(c.nc(0,"td",7),c.Zc(1,De,2,1,"button",8),c.Zc(2,Ne,2,1,"button",9),c.mc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(1),c.Ec("ngIf",null!=t.artifacts[e.folder]&&t.artifacts[e.folder].length>0),c.Ub(1),c.Ec("ngIf",null==t.artifacts[e.folder]||0==t.artifacts[e.folder].length)}}function Ae(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(4).config.processPtcloud=t})),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ec("value",t.config.processPtcloud)("label",null!=t.artifacts[e.folder]&&t.artifacts[e.folder].length>0?"Overwirte":"Generate")}}function je(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(4).config.processDem=t})),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ec("value",t.config.processDem)("label",null!=t.artifacts[e.folder]&&t.artifacts[e.folder].length>0?"Overwirte":"Generate")}}function Le(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){return c.Rc(e),c.xc(4).config.processOrtho=t})),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ec("value",t.config.processOrtho)("label",null!=t.artifacts[e.folder]&&t.artifacts[e.folder].length>0?"Overwirte":"Generate")}}function _e(e,t){if(1&e&&(c.nc(0,"td"),c.Zc(1,Ae,1,2,"boolean-field",12),c.Zc(2,je,1,2,"boolean-field",12),c.Zc(3,Le,1,2,"boolean-field",12),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngIf","ptcloud"===e.folder),c.Ub(1),c.Ec("ngIf","dem"===e.folder),c.Ub(1),c.Ec("ngIf","ortho"===e.folder)}}function $e(e,t){if(1&e&&(c.lc(0),c.nc(1,"tr"),c.nc(2,"td"),c.bd(3),c.mc(),c.nc(4,"td"),c.Zc(5,Me,3,1,"ng-container",5),c.mc(),c.nc(6,"td"),c.Zc(7,Se,3,1,"ng-container",5),c.mc(),c.nc(8,"td"),c.Zc(9,Te,3,1,"ng-container",5),c.mc(),c.nc(10,"td"),c.Zc(11,Fe,3,1,"ng-container",5),c.mc(),c.Zc(12,Ze,3,2,"td",6),c.Zc(13,_e,4,3,"td",5),c.mc(),c.kc()),2&e){const e=t.$implicit,n=c.xc(2);c.Ub(3),c.cd(e.label),c.Ub(2),c.Ec("ngIf",null!=n.artifacts[e.folder]),c.Ub(2),c.Ec("ngIf",null!=n.artifacts[e.folder]),c.Ub(2),c.Ec("ngIf",null!=n.artifacts[e.folder]),c.Ub(2),c.Ec("ngIf",null!=n.artifacts[e.folder]),c.Ub(1),c.Ec("ngIf",!n.edit),c.Ub(1),c.Ec("ngIf",n.edit)}}function ze(e,t){if(1&e&&(c.nc(0,"table",3),c.nc(1,"thead"),c.nc(2,"th"),c.bd(3,"Type"),c.mc(),c.nc(4,"th"),c.bd(5,"Name"),c.mc(),c.nc(6,"th"),c.bd(7,"Processing Software"),c.mc(),c.nc(8,"th"),c.bd(9,"Date"),c.mc(),c.nc(10,"th"),c.bd(11,"Description"),c.mc(),c.ic(12,"th"),c.mc(),c.Zc(13,$e,14,7,"ng-container",4),c.mc()),2&e){const e=c.xc();c.Ub(13),c.Ec("ngForOf",e.sections)}}class Be{constructor(e,t){this.service=e,this.modalService=t,this.edit=!1,this.config={processPtcloud:!1,processDem:!1,processOrtho:!1},this.onError=new c.t,this.loading=!1,this.sections=[{label:"Ptcloud",folder:"ptcloud"},{label:"DEM",folder:"dem"},{label:"Ortho",folder:"ortho"}],this.thumbnails={},this.context=acp}ngOnInit(){let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"UPLOAD_JOB_CHANGE"===e.type&&"Complete"===e.content.status&&e.content.collection===this.entity.id&&this.loadArtifacts()}),this.loadArtifacts()}ngOnDestroy(){this.notifier.unsubscribe()}loadArtifacts(){this.loading=!0,this.service.getArtifacts(this.entity.id).then(e=>{this.loading=!1,this.artifacts=e,this.config.processDem=null==this.artifacts.dem,this.config.processOrtho=null==this.artifacts.ortho,this.config.processPtcloud=null==this.artifacts.ptcloud}).catch(e=>{this.error(e)})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.key]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e){if(null!=e){let t=e.key.substr(0,e.key.lastIndexOf("/")),n=/[^/]*$/.exec(e.key)[0];const c=n.lastIndexOf("."),i=t+"/thumbnails/"+n.substr(0,c)+".png";this.service.download(e.component,i,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}isImage(e){return-1!==e.name.toLowerCase().indexOf(".png")||-1!==e.name.toLowerCase().indexOf(".jpg")||-1!==e.name.toLowerCase().indexOf(".jpeg")||-1!==e.name.toLowerCase().indexOf(".tif")||-1!==e.name.toLowerCase().indexOf(".tiff")}previewImage(e,t){}toggleExcludeImage(e,t){this.service.setExclude(t.id,!t.exclude).then(e=>{t.exclude=e.exclude})}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.entity.id+"&key="+e.key}handleUpload(e){this.modalService.show(Ee,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(this.entity,e)}handleRemove(e){const t=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.message="Do you want to delete the ["+e.label+"] products? This action cannot be undone.",t.content.type="DANGER",t.content.submitText="Delete",t.content.onConfirm.subscribe(()=>{this.service.removeArtifacts(this.entity.id,e.folder).then(e=>{this.artifacts=e}).catch(e=>{this.error(e)})})}capitalize(e){return e.replace(/^\w/,e=>e.toUpperCase())}error(e){this.onError.emit(e)}}function Ge(e,t){if(1&e&&(c.nc(0,"div",7),c.nc(1,"div",8),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",9),c.nc(5,"div"),c.nc(6,"p",10),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Ve(e,t){if(1&e){const e=c.oc();c.nc(0,"artifact-page",11),c.vc("onError",(function(t){return c.Rc(e),c.xc().error(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("edit",!0)("entity",e.entity)("config",e.config)}}Be.ɵfac=function(e){return new(e||Be)(c.hc(A),c.hc(j.b))},Be.ɵcmp=c.bc({type:Be,selectors:[["artifact-page"]],inputs:{entity:"entity",processRunning:"processRunning",edit:"edit",config:"config"},outputs:{onError:"onError"},features:[c.Tb([])],decls:3,vars:2,consts:[["class","fa fa-spinner fa-spin","style","margin-left:50%;",4,"ngIf"],["style","width: 100%;",4,"ngIf"],[1,"fa","fa-spinner","fa-spin",2,"margin-left","50%"],[2,"width","100%"],[4,"ngFor","ngForOf"],[4,"ngIf"],["style","text-align:right;",4,"ngIf"],[2,"text-align","right"],["type","button","class","btn btn-warning","style","margin: 5px 0;",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-primary","style","margin: 5px 0;",3,"disabled","click",4,"ngIf"],["type","button",1,"btn","btn-warning",2,"margin","5px 0",3,"disabled","click"],["type","button",1,"btn","btn-primary",2,"margin","5px 0",3,"disabled","click"],[3,"value","label","valueChange",4,"ngIf"],[3,"value","label","valueChange"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.Zc(1,Ue,1,0,"i",0),c.Zc(2,ze,14,1,"table",1),c.mc()),2&e&&(c.Ub(1),c.Ec("ngIf",t.loading),c.Ub(1),c.Ec("ngIf",null!=t.artifacts))},directives:[i.t,i.s,we.a],encapsulation:2});class qe{constructor(e){this.bsModalRef=e,this.message=null,this.entity=null,this.config={processPtcloud:!1,processDem:!1,processOrtho:!1}}init(e){this.entity=e}ngOnInit(){this.onConfirm=new G.b}ngOnDestroy(){this.onConfirm.unsubscribe()}confirm(){this.onConfirm.next(this.config),this.bsModalRef.hide()}error(e){this.message=S.b.getMessageFromError(e)}}qe.ɵfac=function(e){return new(e||qe)(c.hc(j.a))},qe.ɵcmp=c.bc({type:qe,selectors:[["run-ortho-modal"]],decls:12,vars:2,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[3,"edit","entity","config","onError",4,"ngIf"],[1,"modal-footer"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],["type","button","role","button","aria-disabled","false",1,"btn","btn-primary",2,"padding","4px 18px",3,"click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"edit","entity","config","onError"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,Ge,8,1,"div",1),c.nc(3,"h3"),c.bd(4,"Run ortho to process the following products: "),c.mc(),c.Zc(5,Ve,1,3,"artifact-page",2),c.mc(),c.nc(6,"div",3),c.nc(7,"div",4),c.nc(8,"button",5),c.vc("click",(function(){return t.bsModalRef.hide()})),c.bd(9,"Cancel"),c.mc(),c.nc(10,"button",6),c.vc("click",(function(){return t.confirm()})),c.bd(11,"Submit"),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(3),c.Ec("ngIf",null!=t.entity))},directives:[i.t,Be],encapsulation:2});var He=n(97);function Je(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",5),c.nc(5,"div"),c.nc(6,"p",6),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function We(e,t){1&e&&c.ic(0,"span",36)}const Ye=function(e){return["/site/sensor",e]};function Xe(e,t){if(1&e&&(c.nc(0,"table",37),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",38),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.nc(13,"tr"),c.nc(14,"td"),c.bd(15,"Model"),c.mc(),c.nc(16,"td"),c.bd(17),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(6),c.Ec("routerLink",c.Ic(4,Ye,e.entity.sensor.oid)),c.Ub(1),c.cd(e.entity.sensor.name),c.Ub(5),c.dd(" ",e.entity.sensor.sensorType.name,""),c.Ub(5),c.cd(e.entity.sensor.model)}}function Ke(e,t){1&e&&(c.nc(0,"p",39),c.bd(1,"Sensor metadata is not available for this collection."),c.mc())}const Qe=function(e){return["/site/platform",e]};function et(e,t){if(1&e&&(c.nc(0,"table",37),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",38),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(6),c.Ec("routerLink",c.Ic(3,Qe,e.entity.platform.oid)),c.Ub(1),c.cd(e.entity.platform.name),c.Ub(5),c.dd(" ",e.entity.platform.platformType.name,"")}}function tt(e,t){1&e&&(c.nc(0,"p",39),c.bd(1,"Platform metadata is not available for this collection. "),c.mc())}const nt=function(e){return["/site/uav",e]};function ct(e,t){if(1&e&&(c.nc(0,"table",37),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Serial Number"),c.mc(),c.nc(5,"td"),c.nc(6,"a",38),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(6),c.Ec("routerLink",c.Ic(3,nt,e.entity.uav.oid)),c.Ub(1),c.cd(e.entity.uav.serialNumber),c.Ub(5),c.dd(" ",e.entity.uav.faaNumber,"")}}function it(e,t){1&e&&(c.nc(0,"p",39),c.bd(1,"UAV metadata is not available for this collection."),c.mc())}function at(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function ot(e,t){if(1&e){const e=c.oc();c.nc(0,"input",46),c.vc("change",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(2).toggleExcludeImage(t,n)})),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("checked",e.exclude)}}const st=function(e,t){return{"card-disabled":e,"non-clickable":t}},lt=function(e){return{"img-disabled":e}};function rt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",40),c.nc(1,"a",41),c.Zc(2,ot,1,1,"input",42),c.nc(3,"img",43),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit,a=c.xc(2);return!!a.enableSelectableImages&&a.toggleExcludeImage(n,i)})),c.yc(4,"safeHtml"),c.mc(),c.nc(5,"div",44),c.nc(6,"h4",45),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ub(1),c.Ec("ngClass",c.Jc(7,st,e.exclude,!n.enableSelectableImages)),c.Ub(1),c.Ec("ngIf",n.enableSelectableImages),c.Ub(1),c.Ec("ngClass",c.Ic(10,lt,e.exclude))("src",null!=n.thumbnails[e.key]?c.zc(4,5,n.thumbnails[e.key]):n.context+"/net/geoprism/images/thumbnail-default.png",c.Tc),c.Ub(4),c.dd(" ",e.name," ")}}function dt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.ic(2,"div",47),c.nc(3,"div",48),c.nc(4,"h3"),c.bd(5),c.nc(6,"a",49),c.vc("click",(function(){c.Rc(e);const t=c.xc(2);return t.handleDownloadVideo(t.video.src)})),c.ic(7,"i",50),c.mc(),c.nc(8,"a",51),c.vc("click",(function(){return c.Rc(e),c.xc(2).closeVideo()})),c.ic(9,"i",52),c.mc(),c.mc(),c.mc(),c.ic(10,"div",47),c.mc(),c.nc(11,"div",7),c.ic(12,"div",47),c.nc(13,"div",48),c.nc(14,"video",53),c.ic(15,"source",54),c.bd(16," Browser not supported "),c.mc(),c.mc(),c.ic(17,"div",47),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(5),c.dd(" ",e.video.name," "),c.Ub(10),c.Ec("src",e.video.src,c.Tc)}}function pt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",40),c.nc(1,"a",55),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).showVideo(n)})),c.ic(2,"img",56),c.nc(3,"div",44),c.nc(4,"h4",45),c.bd(5),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ub(2),c.Ec("src",n.context+"/net/geoprism/images/thumbnail-video.png",c.Tc),c.Ub(3),c.cd(e.name)}}function mt(e,t){if(1&e){const e=c.oc();c.nc(0,"artifact-page",57),c.vc("onError",(function(t){return c.Rc(e),c.xc(2).error(t)})),c.mc()}if(2&e){const e=c.xc(2);c.Ec("entity",e.entity)("processRunning",e.processRunning)}}function ht(e,t){if(1&e){const e=c.oc();c.nc(0,"pagination-controls",58),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(2).onPageChange(t)})),c.mc()}}function ut(e,t){if(1&e){const e=c.oc();c.nc(0,"div",59),c.nc(1,"p"),c.bd(2),c.mc(),c.nc(3,"p"),c.bd(4,"See this process on "),c.nc(5,"a",60),c.vc("click",(function(){return c.Rc(e),c.xc(2).bsModalRef.hide()})),c.bd(6,"your tasks page"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(2),c.cd(e.statusMessage)}}function gt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",61),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleUpload()})),c.bd(1," Upload "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}function bt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",62),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownload()})),c.bd(1," Download All "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}function ft(e,t){if(1&e){const e=c.oc();c.nc(0,"button",63),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleDownloadOdmAll()})),c.bd(1," Download All Generated Data "),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning)}}const vt=function(e){return{"fa-spin":e}};function yt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",64),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleRunOrtho()})),c.bd(1," Reprocess Imagery "),c.ic(2,"i",65),c.mc()}if(2&e){const e=c.xc(2);c.Ec("disabled",e.processRunning||!e.canReprocessImagery),c.Ub(2),c.Ec("ngClass",c.Ic(2,vt,e.processRunning))}}const xt=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function kt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h2"),c.bd(4),c.Zc(5,We,1,0,"span",9),c.mc(),c.mc(),c.mc(),c.nc(6,"div",7),c.nc(7,"div",8),c.nc(8,"label"),c.bd(9,"Pilot Name: "),c.mc(),c.bd(10),c.mc(),c.mc(),c.nc(11,"div",7),c.nc(12,"div",8),c.nc(13,"label"),c.bd(14,"Upload Date: "),c.mc(),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"div",7),c.nc(18,"div",8),c.nc(19,"label"),c.bd(20,"Collection Date: "),c.mc(),c.bd(21),c.yc(22,"idmdate"),c.mc(),c.mc(),c.nc(23,"div",7),c.nc(24,"div",10),c.nc(25,"label"),c.bd(26,"Sensor:"),c.mc(),c.Zc(27,Xe,18,6,"table",11),c.Zc(28,Ke,2,0,"p",12),c.mc(),c.nc(29,"div",10),c.nc(30,"label"),c.bd(31,"Platform:"),c.mc(),c.Zc(32,et,13,5,"table",11),c.Zc(33,tt,2,0,"p",12),c.mc(),c.mc(),c.nc(34,"div",7),c.nc(35,"div",8),c.nc(36,"label"),c.bd(37,"UAV:"),c.mc(),c.Zc(38,ct,13,5,"table",11),c.Zc(39,it,2,0,"p",12),c.mc(),c.mc(),c.nc(40,"div",7),c.nc(41,"div",8),c.nc(42,"ul",13),c.Zc(43,at,3,1,"li",14),c.mc(),c.mc(),c.mc(),c.nc(44,"div",7),c.nc(45,"div",15),c.nc(46,"tabset",16),c.nc(47,"tab",17),c.vc("selectTab",(function(){return c.Rc(e),c.xc().onSelect("raw")})),c.nc(48,"div",18),c.nc(49,"ul",19),c.Zc(50,rt,8,12,"li",20),c.yc(51,"paginate"),c.mc(),c.mc(),c.mc(),c.nc(52,"tab",21),c.vc("selectTab",(function(){return c.Rc(e),c.xc().onSelect("video")})),c.Zc(53,dt,18,2,"div",2),c.nc(54,"div",18),c.nc(55,"ul",19),c.Zc(56,pt,6,2,"li",20),c.mc(),c.mc(),c.mc(),c.nc(57,"tab",22),c.vc("selectTab",(function(){return c.Rc(e),c.xc().onSelect("artifacts")})),c.Zc(58,mt,1,2,"artifact-page",23),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(59,"div",7),c.nc(60,"div",15),c.Zc(61,ht,1,0,"pagination-controls",24),c.Zc(62,ut,7,1,"div",25),c.nc(63,"div",26),c.nc(64,"div",7),c.nc(65,"div",27),c.nc(66,"button",28),c.vc("click",(function(){return c.Rc(e),c.xc().handleSetMetadata()})),c.ic(67,"i",29),c.bd(68," Edit Metadata "),c.mc(),c.Zc(69,gt,2,1,"button",30),c.mc(),c.nc(70,"div",31),c.nc(71,"button",32),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(72,"Close"),c.mc(),c.Zc(73,bt,2,1,"button",33),c.Zc(74,ft,2,1,"button",34),c.Zc(75,yt,3,4,"button",35),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.dd("",e.entity.name," "),c.Ub(1),c.Ec("ngIf",!e.entity.metadataUploaded),c.Ub(5),c.dd("   ",e.entity.pilotName," "),c.Ub(5),c.dd("   ",c.Ac(16,23,e.entity.dateTime,"MMM dd, yyyy")," "),c.Ub(6),c.dd("   ",c.Ac(22,26,e.entity.collectionDate,"MMM dd, yyyy")," "),c.Ub(6),c.Ec("ngIf",e.entity.sensor),c.Ub(1),c.Ec("ngIf",!e.entity.sensor),c.Ub(4),c.Ec("ngIf",e.entity.platform),c.Ub(1),c.Ec("ngIf",!e.entity.platform),c.Ub(5),c.Ec("ngIf",e.entity.uav),c.Ub(1),c.Ec("ngIf",!e.entity.platform),c.Ub(4),c.Ec("ngForOf",e.previous),c.Ub(7),c.Ec("ngForOf",c.Ac(51,29,e.page.results,c.Kc(32,xt,e.page.pageSize,e.page.pageNumber,e.page.count))),c.Ub(3),c.Ec("ngIf",null!==e.video.src),c.Ub(3),c.Ec("ngForOf",e.page.results),c.Ub(2),c.Ec("ngIf","artifacts"===e.tabName),c.Ub(3),c.Ec("ngIf","raw"===e.tabName),c.Ub(1),c.Ec("ngIf",e.showOrthoRerunMessage),c.Ub(4),c.Ec("disabled",e.processRunning),c.Ub(3),c.Ec("ngIf","raw"===e.tabName),c.Ub(4),c.Ec("ngIf",e.processable),c.Ub(1),c.Ec("ngIf",e.processable&&e.entity.hasAllZip),c.Ub(1),c.Ec("ngIf",e.processable&&e.enableSelectableImages)}}class Et{constructor(e,t,n,c){this.service=e,this.metadataService=t,this.modalService=n,this.bsModalRef=c,this.previous=[],this.folders=[],this.thumbnails={},this.processRunning=!1,this.processable=!1,this.enableSelectableImages=!1,this.showOrthoRerunMessage=!1,this.canReprocessImagery=!1,this.constPageSize=50,this.page=new V,this.video={src:null,name:null},this.context=acp}set initData(e){this.init(e.entity,e.folders,e.previous)}ngOnInit(){this.onNodeChange=new G.b,this.page.count=0,this.page.pageNumber=1,this.page.pageSize=this.constPageSize,this.page.results=[];let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{null!=this.entity&&"UPLOAD_JOB_CHANGE"===e.type&&e.content.collection===this.entity.id&&("raw"===this.tabName?this.onPageChange(this.page.pageNumber):"video"===this.tabName&&this.getData(this.entity.id,this.tabName,null,null))})}ngOnDestroy(){this.notifier.unsubscribe()}init(e,t,n){this.entity=e,this.folders=t,this.previous=[...n],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.onSelect("raw"),this.processable=this.metadataService.isProcessable(e.type)}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.key]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e){if(null!=e){let t=e.key.substr(0,e.key.lastIndexOf("/")),n=/[^/]*$/.exec(e.key)[0];const c=n.lastIndexOf("."),i=t+"/thumbnails/"+n.substr(0,c)+".png";this.service.download(e.component,i,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}onPageChange(e){this.getData(this.entity.id,this.tabName,e,this.page.pageSize)}onSelect(e){if(this.tabName=e,this.enableSelectableImages="raw"===e,"raw"===e||"video"===e){this.page.results=[];let t=null,n=null;"raw"===e&&(t=null==this.page.pageNumber?1:this.page.pageNumber,n=this.constPageSize),this.video.src=null,this.video.name=null,this.getData(this.entity.id,this.tabName,t,n)}}getData(e,t,n,c){this.service.getObjects(e,t,n,c).then(e=>{this.page=e,this.canReprocessImagery=this.page.results.length>1;for(let e=0;e<this.page.results.length;++e){let t=this.page.results[e];this.isImage(t)&&this.getThumbnail(t)}})}isImage(e){return-1!==e.name.toLowerCase().indexOf(".png")||-1!==e.name.toLowerCase().indexOf(".jpg")||-1!==e.name.toLowerCase().indexOf(".jpeg")||-1!==e.name.toLowerCase().indexOf(".tif")||-1!==e.name.toLowerCase().indexOf(".tiff")}previewImage(e,t){}toggleExcludeImage(e,t){this.service.setExclude(t.id,!t.exclude).then(e=>{t.exclude=e.exclude})}isProcessable(e){return this.metadataService.isProcessable(e.type)}handleErosPush(){this.processRunning=!0,this.service.pushToEros(this.entity.id).then(e=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})}handleRunOrtho(){const e=this.modalService.show(qe,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"confirmation-modal"});e.content.init(this.entity),e.content.onConfirm.subscribe(e=>{this.processRunning=!0,this.showOrthoRerunMessage=!0,this.service.runOrtho(this.entity.id,e.processPtcloud,e.processDem,e.processOrtho).then(()=>{this.processRunning=!1,setTimeout(()=>{this.showOrthoRerunMessage=!1,this.statusMessage="Your process is started."},3e4)}).catch(e=>{this.error(e)})})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.entity.id+"&key="+this.tabName}handleDownloadOdmAll(){window.location.href=acp+"/project/download-odm-all?colId="+this.entity.id}handleDownloadVideo(e){window.location.href=e}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.entity.id+"&key="+e.key}handleSetMetadata(){let e=this.modalService.show(W,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"});e.content.init(this.entity.id,this.entity.name),e.content.onMetadataChange.subscribe(()=>{this.entity.metadataUploaded=!0})}handleUpload(){this.modalService.show(Ee,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}).content.init(this.entity,"raw")}capitalize(e){return e.replace(/^\w/,e=>e.toUpperCase())}showVideo(e){this.video.name=null,this.video.src=null,setTimeout(()=>{this.video.name=e.name,this.video.src=acp+"/project/download?id="+e.component+"&key="+e.key},200)}closeVideo(){this.video.name=null,this.video.src=null}error(e){this.message=S.b.getMessageFromError(e)}}Et.ɵfac=function(e){return new(e||Et)(c.hc(A),c.hc(te),c.hc(j.b),c.hc(j.a))},Et.ɵcmp=c.bc({type:Et,selectors:[["collection-modal"]],inputs:{initData:"initData"},features:[c.Tb([S.a,Be])],decls:4,vars:3,consts:[[1,"modal-body",2,"padding-bottom","0"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],["class","dot pending","style","margin-left: 0;margin-bottom: 5px;",4,"ngIf"],[1,"col-md-6"],["class","table table-bordered",4,"ngIf"],["style","font-style:italic;",4,"ngIf"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"col-sm-12"],[1,"nav-full-width"],["heading","raw",3,"selectTab"],[1,"image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3",4,"ngFor","ngForOf"],["heading","video",3,"selectTab"],["heading","products",2,"margin-top","10px",3,"selectTab"],[3,"entity","processRunning","onError",4,"ngIf"],[3,"pageChange",4,"ngIf"],["style","text-align:right;padding-right:20px;",4,"ngIf"],[1,"btn-holder",2,"margin","20px 0px 10px 0px"],[1,"col-sm-4"],["type","button",1,"btn","btn-warning",3,"disabled","click"],[1,"fa","fa-edit",2,"color","white"],["type","button","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"col-md-8",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","button","class","btn btn-secondary","title","Downloads all files","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-secondary","title","Downloads the all.zip file generated from ODM.","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],["class","btn btn-primary","title","Reprocesses the selected raw imagery and generates new products.","style","margin-left: 5px;",3,"disabled","click",4,"ngIf"],[1,"dot","pending",2,"margin-left","0","margin-bottom","5px"],[1,"table","table-bordered"],["target","_blank",3,"routerLink"],[2,"font-style","italic"],[1,"list-group-item","col-xs-3"],[1,"thumbnail",3,"ngClass"],["type","checkbox","class","x-box",3,"checked","change",4,"ngIf"],["alt","Image",2,"max-height","150px",3,"ngClass","src","click"],[1,"caption"],[1,"media-heading"],["type","checkbox",1,"x-box",3,"checked","change"],[1,"col-md-1"],[1,"col-md-10"],[3,"click"],[1,"fas","fa-download"],[1,"pull-right",3,"click"],["aria-hidden","true",1,"fa","fa-times"],["controls","",2,"width","100%"],["type","video/mp4",3,"src"],[1,"thumbnail",3,"click"],["alt","Video",3,"src"],[3,"entity","processRunning","onError"],[3,"pageChange"],[2,"text-align","right","padding-right","20px"],["routerLink","/site/tasks",3,"click"],["type","button",1,"btn","btn-primary",3,"disabled","click"],["type","button","title","Downloads all files",1,"btn","btn-secondary",2,"margin-left","5px",3,"disabled","click"],["type","button","title","Downloads the all.zip file generated from ODM.",1,"btn","btn-secondary",2,"margin-left","5px",3,"disabled","click"],["title","Reprocesses the selected raw imagery and generates new products.",1,"btn","btn-primary",2,"margin-left","5px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-sync-alt",2,"color","white","vertical-align","middle","margin-left","10px",3,"ngClass"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div"),c.Zc(2,Je,8,1,"div",1),c.Zc(3,kt,76,36,"div",2),c.mc(),c.mc()),2&e&&(c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",null!=t.entity))},directives:[i.t,i.s,p.e,p.b,a.e,i.q,Be,h.c],pipes:[He.a,h.b,L.a],encapsulation:2,data:{animation:[Object(Y.c)(),Object(Y.d)(),Object(Y.e)(),Object(Y.f)()]}});class Ct{constructor(e,t){this.http=e,this.eventService=t}getProducts(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("sortField",t),c=c.set("sortOrder",n),this.http.get(acp+"/product/get-all",{params:c}).toPromise()}getDetail(e,t,n){let c=new y.g;return c=c.set("id",e),c=c.set("pageNumber",t.toString()),c=c.set("pageSize",n.toString()),this.eventService.start(),this.http.get(acp+"/product/detail",{params:c}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/remove",JSON.stringify({id:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}togglePublish(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/product/toggle-publish",JSON.stringify({id:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}}function wt(e,t){if(1&e&&(c.nc(0,"div",5),c.nc(1,"div",6),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",7),c.nc(5,"div"),c.nc(6,"p",8),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Ut(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function It(e,t){if(1&e){const e=c.oc();c.nc(0,"div",26),c.nc(1,"a",27),c.nc(2,"img",28),c.vc("error",(function(t){return c.Rc(e),c.xc(3).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ub(2),c.Ec("src",c.zc(3,1,e.thumbnails[e.product.id]),c.Tc)}}Ct.ɵfac=function(e){return new(e||Ct)(c.rc(y.c),c.rc(N.a))},Ct.ɵprov=c.dc({token:Ct,factory:Ct.ɵfac});const Mt=function(e){return["/site/sensor",e]};function Ot(e,t){if(1&e&&(c.nc(0,"table",29),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",30),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.nc(13,"tr"),c.nc(14,"td"),c.bd(15,"Model"),c.mc(),c.nc(16,"td"),c.bd(17),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(6),c.Ec("routerLink",c.Ic(4,Mt,e.product.sensor.oid)),c.Ub(1),c.cd(e.product.sensor.name),c.Ub(5),c.dd(" ",e.product.sensor.sensorType.name,""),c.Ub(5),c.cd(e.product.sensor.model)}}function St(e,t){1&e&&(c.nc(0,"p",31),c.bd(1,"Sensor metadata is not available for this collection."),c.mc())}const Rt=function(e){return["/site/platform",e]};function Tt(e,t){if(1&e&&(c.nc(0,"table",29),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Name"),c.mc(),c.nc(5,"td"),c.nc(6,"a",30),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"Type"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(6),c.Ec("routerLink",c.Ic(3,Rt,e.product.platform.oid)),c.Ub(1),c.cd(e.product.platform.name),c.Ub(5),c.dd(" ",e.product.platform.platformType.name,"")}}function Pt(e,t){1&e&&(c.nc(0,"p",31),c.bd(1,"Platform metadata is not available for this collection."),c.mc())}const Ft=function(e){return["/site/uav",e]};function Dt(e,t){if(1&e&&(c.nc(0,"table",29),c.nc(1,"tbody"),c.nc(2,"tr"),c.nc(3,"td"),c.bd(4,"Serial Number"),c.mc(),c.nc(5,"td"),c.nc(6,"a",30),c.bd(7),c.mc(),c.mc(),c.mc(),c.nc(8,"tr"),c.nc(9,"td"),c.bd(10,"FAA Number"),c.mc(),c.nc(11,"td"),c.bd(12),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(3);c.Ub(6),c.Ec("routerLink",c.Ic(3,Ft,e.product.uav.oid)),c.Ub(1),c.cd(e.product.uav.serialNumber),c.Ub(5),c.dd(" ",e.product.uav.faaNumber,"")}}function Nt(e,t){1&e&&(c.nc(0,"p",31),c.bd(1,"UAV metadata is not available for this collection."),c.mc())}function Zt(e,t){if(1&e){const e=c.oc();c.nc(0,"div",26),c.nc(1,"a",33),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(3).previewImage(t)})),c.nc(2,"img",34),c.vc("error",(function(t){return c.Rc(e),c.xc(4).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.nc(4,"div",35),c.nc(5,"h4",36),c.bd(6),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc(3);c.Ub(2),c.Ec("src",c.zc(3,2,t.thumbnails[e.id]),c.Tc),c.Ub(4),c.cd(e.name)}}function At(e,t){if(1&e&&(c.nc(0,"li",32),c.Zc(1,Zt,7,4,"div",13),c.mc()),2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("ngIf",null!=n.thumbnails[e.id])}}function jt(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleDownload()})),c.bd(1,"Download ODM Files"),c.mc()}}const Lt=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function _t(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",9),c.nc(2,"div",10),c.nc(3,"h2"),c.bd(4),c.mc(),c.mc(),c.mc(),c.nc(5,"div",9),c.nc(6,"div",10),c.nc(7,"ul",11),c.Zc(8,Ut,3,1,"li",12),c.mc(),c.mc(),c.mc(),c.nc(9,"div",9),c.nc(10,"div",10),c.Zc(11,It,4,3,"div",13),c.mc(),c.mc(),c.nc(12,"div",9),c.nc(13,"div",10),c.nc(14,"label"),c.bd(15,"Pilot Name: "),c.mc(),c.bd(16),c.mc(),c.mc(),c.nc(17,"div",9),c.nc(18,"div",10),c.nc(19,"label"),c.bd(20,"Creation Date: "),c.mc(),c.bd(21),c.yc(22,"idmdate"),c.mc(),c.mc(),c.nc(23,"div",9),c.nc(24,"div",10),c.nc(25,"label"),c.bd(26,"Collection Date: "),c.mc(),c.bd(27),c.yc(28,"idmdate"),c.mc(),c.mc(),c.nc(29,"div",9),c.nc(30,"div",14),c.nc(31,"label"),c.bd(32,"Sensor:"),c.mc(),c.Zc(33,Ot,18,6,"table",15),c.Zc(34,St,2,0,"p",16),c.mc(),c.nc(35,"div",14),c.nc(36,"label"),c.bd(37,"Platform:"),c.mc(),c.Zc(38,Tt,13,5,"table",15),c.Zc(39,Pt,2,0,"p",16),c.mc(),c.mc(),c.nc(40,"div",9),c.nc(41,"div",10),c.nc(42,"label"),c.bd(43,"UAV:"),c.mc(),c.Zc(44,Dt,13,5,"table",15),c.Zc(45,Nt,2,0,"p",16),c.mc(),c.mc(),c.nc(46,"div",17),c.nc(47,"div",10),c.nc(48,"div",18),c.nc(49,"h3"),c.bd(50,"Raw Images"),c.mc(),c.nc(51,"ul",19),c.Zc(52,At,2,1,"li",20),c.yc(53,"paginate"),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(54,"div",9),c.nc(55,"pagination-controls",21),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(2).onPageChange(t)})),c.mc(),c.mc(),c.nc(56,"div",17),c.nc(57,"div",22),c.nc(58,"button",23),c.vc("click",(function(){return c.Rc(e),c.xc(2).bsModalRef.hide()})),c.bd(59,"Close"),c.mc(),c.Zc(60,jt,2,0,"button",24),c.nc(61,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleGoto()})),c.bd(62," Collection Details "),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(4),c.cd(e.product.name),c.Ub(4),c.Ec("ngForOf",e.product.entities),c.Ub(3),c.Ec("ngIf",null!=e.thumbnails[e.product.id]),c.Ub(5),c.dd("   ",e.product.pilotName," "),c.Ub(5),c.dd("   ",c.Ac(22,14,e.product.dateTime,"MMM dd, yyyy")," "),c.Ub(6),c.dd("   ",c.Ac(28,17,e.product.collectionDate,"MMM dd, yyyy")," "),c.Ub(6),c.Ec("ngIf",e.product.sensor),c.Ub(1),c.Ec("ngIf",!e.product.sensor),c.Ub(4),c.Ec("ngIf",e.product.platform),c.Ub(1),c.Ec("ngIf",!e.product.platform),c.Ub(5),c.Ec("ngIf",e.product.uav),c.Ub(1),c.Ec("ngIf",!e.product.platform),c.Ub(7),c.Ec("ngForOf",c.Ac(53,20,e.product.page.resultSet,c.Kc(23,Lt,e.product.page.pageSize,e.product.page.pageNumber,e.product.page.count))),c.Ub(8),c.Ec("ngIf",e.product.hasAllZip)}}function $t(e,t){if(1&e&&(c.nc(0,"div",2),c.nc(1,"div"),c.Zc(2,wt,8,1,"div",3),c.Zc(3,_t,63,27,"div",4),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(2),c.Ec("ngIf",null!=e.message),c.Ub(1),c.Ec("ngIf",null!=e.product)}}function zt(e,t){if(1&e&&c.ic(0,"collection-modal",38),2&e){const e=c.xc();c.Ec("initData",e.initData)}}class Bt{constructor(e,t,n,c){this.pService=e,this.service=t,this.bsModalRef=n,this.modalService=c,this.thumbnails={},this.items=[],this.showSite=!1}ngOnInit(){}init(e){this.product=e,this.product.imageKey&&this.getThumbnail(this.product.id,this.product.imageKey),this.product.page.resultSet.forEach(e=>{this.getThumbnail(e.id,e.key)})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t]=n.result},!1),e&&n.readAsDataURL(e)}getThumbnail(e,t){const n=this.product.entities[this.product.entities.length-1].id,c=t.substr(0,t.lastIndexOf("/")),i=/[^/]*$/.exec(t)[0],a=i.lastIndexOf("."),o=c+"/thumbnails/"+i.substr(0,a)+".png";this.service.download(n,o,!1).subscribe(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}onPageChange(e){this.pService.getDetail(this.product.id,e,20).then(e=>{this.init(e)})}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleGoto(){const e=this.product.entities[this.product.entities.length-1],t=this.product.entities;this.service.getItems(e.id,null).then(n=>{this.initData={entity:e,folders:n,previous:t},this.showSite=!0})}previewImage(e){this.rawImagePreviewModal=this.modalService.show(B,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.rawImagePreviewModal.content.init(this.product.id)}handleDownload(){window.location.href=acp+"/product/get-odm-all?id="+this.product.id}error(e){this.message=S.b.getMessageFromError(e)}}function Gt(e,t){if(1&e&&(c.nc(0,"option",8),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.cd(e.label)}}function Vt(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",11),c.bd(2," Loading Products "),c.mc())}function qt(e,t){1&e&&(c.nc(0,"p"),c.bd(1,"No data found"),c.mc())}function Ht(e,t){if(1&e&&(c.nc(0,"div",9),c.nc(1,"h4"),c.Zc(2,Vt,3,0,"span",10),c.Zc(3,qt,2,0,"p",10),c.mc(),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}function Jt(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name," ")}}function Wt(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"a",31),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().previewImage(t)})),c.nc(2,"img",32),c.vc("error",(function(t){return c.Rc(e),c.xc(2).getDefaultImgURL(t)})),c.yc(3,"safeHtml"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(2),c.Ec("src",c.zc(3,1,t.thumbnails[e.id]),c.Tc)}}function Yt(e,t){1&e&&c.ic(0,"i",33),2&e&&c.Ec("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function Xt(e,t){1&e&&c.ic(0,"i",33),2&e&&c.Ec("@bounceInOnEnter",void 0)("@bounceOutOnLeave",void 0)}function Kt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",26),c.nc(1,"a",34),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleTogglePublish(t)})),c.bd(2,"Unpublish"),c.mc(),c.mc()}}function Qt(e,t){if(1&e){const e=c.oc();c.nc(0,"li",26),c.nc(1,"a",35),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleTogglePublish(t)})),c.bd(2,"Publish"),c.mc(),c.mc()}}function en(e,t){if(1&e){const e=c.oc();c.nc(0,"div",12),c.nc(1,"div",13),c.nc(2,"div",14),c.nc(3,"h5",15),c.bd(4),c.mc(),c.nc(5,"ul",16),c.Zc(6,Jt,3,1,"li",17),c.mc(),c.nc(7,"div",18),c.Zc(8,Wt,4,3,"div",10),c.mc(),c.nc(9,"div",19),c.nc(10,"ul",20),c.nc(11,"li",21),c.nc(12,"a",22),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleMapIt(n)})),c.bd(13,"Aerial"),c.mc(),c.Zc(14,Yt,1,2,"i",23),c.mc(),c.nc(15,"li",24),c.nc(16,"a",25),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleMapDem(n)})),c.bd(17,"Hillshade"),c.mc(),c.Zc(18,Xt,1,2,"i",23),c.mc(),c.nc(19,"li",26),c.nc(20,"a",27),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handlePointcloud(n)})),c.bd(21,"3D"),c.mc(),c.mc(),c.nc(22,"li",26),c.nc(23,"a",28),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc().handleGetInfo(n)})),c.bd(24,"Get Info"),c.mc(),c.mc(),c.nc(25,"li",26),c.nc(26,"a",29),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().handleDelete(i,n)})),c.bd(27,"Delete"),c.mc(),c.mc(),c.Zc(28,Kt,3,0,"li",30),c.Zc(29,Qt,3,0,"li",30),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("@fadeInOnEnter",void 0)("@fadeOutOnLeave",void 0),c.Ub(3),c.dd(" ",e.name," "),c.Ub(2),c.Ec("ngForOf",e.entities),c.Ub(2),c.Ec("ngIf",null!=n.thumbnails[e.id]),c.Ub(4),c.Xc(n.hasOrthoLayer(e)?"":"cursor:not-allowed;"),c.Ub(2),c.Ec("ngIf",e.orthoMapped),c.Ub(2),c.Xc(n.hasDemLayer(e)?"":"cursor:not-allowed;"),c.Ub(2),c.Ec("ngIf",e.demMapped),c.Ub(2),c.Xc(e.hasPointcloud?"":"cursor:not-allowed;"),c.Ub(8),c.Ec("ngIf",e.published),c.Ub(1),c.Ec("ngIf",!e.published)}}Bt.ɵfac=function(e){return new(e||Bt)(c.hc(Ct),c.hc(A),c.hc(j.a),c.hc(j.b))},Bt.ɵcmp=c.bc({type:Bt,selectors:[["product-modal"]],features:[c.Tb([Et])],decls:2,vars:2,consts:[["class","modal-body","style","padding-bottom: 0;",4,"ngIf"],[3,"initData",4,"ngIf"],[1,"modal-body",2,"padding-bottom","0"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],["class","",4,"ngIf"],[1,"col-md-6"],["class","table table-bordered",4,"ngIf"],["style","font-style:italic;",4,"ngIf"],[1,"row",2,"background-color","#ececec"],["id","image-list-container"],[1,"list-group","row"],["class","list-group-item col-xs-3","style","background:none;",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 20px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button","class","btn btn-secondary","style","margin-left: 5px;",3,"click",4,"ngIf"],[1,"btn","btn-primary",2,"margin-left","5px",3,"click"],[1,""],[1,"thumbnail","non-clickable"],["alt","Image",1,"",3,"src","error"],[1,"table","table-bordered"],["target","_blank",3,"routerLink"],[2,"font-style","italic"],[1,"list-group-item","col-xs-3",2,"background","none"],[1,"thumbnail",3,"click"],["alt","Image",3,"src","error"],[1,"caption"],[1,"media-heading"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"click"],[3,"initData"]],template:function(e,t){1&e&&(c.Zc(0,$t,4,2,"div",0),c.Zc(1,zt,1,1,"collection-modal",1)),2&e&&(c.Ec("ngIf",!t.showSite),c.Ub(1),c.Ec("ngIf",t.showSite))},directives:[i.t,i.s,h.c,a.e,Et],pipes:[He.a,h.b,L.a],encapsulation:2,data:{animation:[Object(Y.c)(),Object(Y.d)(),Object(Y.a)()]}});class tn{constructor(e,t,n){this.pService=e,this.mService=t,this.modalService=n,this.toggleMapOrtho=new c.t,this.toggleMapDem=new c.t,this.products=[],this.thumbnails={},this.fields=[{label:"Name",value:"name"},{label:"Sensor",value:"sensor"},{label:"Flight Number",value:"faaNumber"},{label:"Serial Number",value:"serialNumber"},{label:"Product Date",value:"lastUpdateDate"}],this.sortField="name",this.loading=!1,this.requestId=0}ngOnDestroy(){this.products.forEach(e=>{e.orthoMapped&&this.handleMapIt(e),e.demMapped&&this.handleMapDem(e)})}ngOnChanges(e){this.refreshProducts(e.id.currentValue)}refresh(){this.refreshProducts(this.id)}refreshProducts(e){this.products=[],this.thumbnails={},this.loading=!0;const t=++this.requestId;this.pService.getProducts(e,this.sortField,"ASC").then(e=>{t===this.requestId&&(this.products=e,this.loading=!1,this.products.forEach(e=>{this.getThumbnail(e)}))})}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.id]=n.result},!1),e&&n.readAsDataURL(e)}hasOrthoLayer(e){let t=e.layers.length;for(let n=0;n<t;++n)if("ORTHO"===e.layers[n].classification&&null!=e.layers[n].key&&e.layers[n].key.length>0)return!0;return!1}hasDemLayer(e){let t=e.layers.length;for(let n=0;n<t;++n)if(("DEM_DSM"===e.layers[n].classification||"DEM_DTM"===e.layers[n].classification)&&null!=e.layers[n].key&&e.layers[n].key.length>0)return!0;return!1}getThumbnail(e){if(null!=e.imageKey){const t=e.entities[e.entities.length-1].id,n=e.imageKey.substr(0,e.imageKey.lastIndexOf("/")),c=/[^/]*$/.exec(e.imageKey)[0],i=c.lastIndexOf("."),a=n+"/thumbnails/"+c.substr(0,i)+".png";this.mService.download(t,a,!1).subscribe(t=>{this.createImageFromBlob(t,e)},t=>{console.log(t),this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"})}else this.thumbnails[e.id]=acp+"/net/geoprism/images/thumbnail-default.png"}getDefaultImgURL(e){e.target.src=acp+"/net/geoprism/images/thumbnail-default.png"}handleMapIt(e){this.hasOrthoLayer(e)&&this.toggleMapOrtho.emit(e)}handleMapDem(e){this.hasDemLayer(e)&&this.toggleMapDem.emit(e)}handlePointcloud(e){if(e.hasPointcloud){let t=e.entities[e.entities.length-1].id;window.open(acp+"/pointcloud/"+t+"/potree")}}handleDelete(e,t){t.stopPropagation(),this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.pService.remove(e.id).then(t=>{this.products=this.products.filter(t=>t.id!==e.id)})}previewImage(e){if(null!=e.imageKey){e.entities[e.entities.length-1].id;this.bsModalRef=this.modalService.show(B,{animated:!0,backdrop:!0,ignoreBackdropClick:!1,class:"image-preview-modal"}),this.bsModalRef.content.init(e.id)}}handleGetInfo(e){this.pService.getDetail(e.id,1,20).then(e=>{this.bsModalRef=this.modalService.show(Bt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}),this.bsModalRef.content.init(e)})}handleTogglePublish(e){this.pService.togglePublish(e.id).then(t=>{const n=e.orthoMapped,c=e.demMapped;n&&this.toggleMapOrtho.emit(e),c&&this.toggleMapDem.emit(e),e.published=t.published,e.layers=t.layers,n&&this.toggleMapOrtho.emit(e),c&&this.toggleMapDem.emit(e)})}}function nn(e,t){if(1&e&&(c.nc(0,"div",10),c.nc(1,"div",11),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",12),c.nc(5,"div"),c.nc(6,"p",13),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function cn(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"h3"),c.bd(2),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(2),c.dd("Add new ",e.entity.type,"")}}function an(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"input",17),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("placeholder",e.label)("required",e.required)}}function on(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.cd(e.label)}}function sn(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"select",18),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.ic(4,"option"),c.Zc(5,on,2,2,"option",19),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required),c.Ub(2),c.Ec("ngForOf",e.options)}}function ln(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"label"),c.bd(2),c.mc(),c.nc(3,"textarea",21),c.vc("ngModelChange",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).entity[n.name]=t})),c.bd(4,"          "),c.mc(),c.mc()}if(2&e){const e=c.xc(2).$implicit,t=c.xc(2);c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngModel",t.entity[e.name])("name",e.name)("disabled",e.readonly)("required",e.required)}}function rn(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"map-attribute",22),c.vc("siteChange",(function(t){return c.Rc(e),c.xc(4).entity=t})),c.mc(),c.mc()}if(2&e){const e=c.xc(4);c.Ub(1),c.Ec("site",e.entity)("center",e.center)("zoom",e.zoom)}}function dn(e,t){if(1&e&&(c.nc(0,"div",15),c.Zc(1,an,4,6,"div",16),c.Zc(2,sn,6,6,"div",16),c.Zc(3,ln,5,5,"div",16),c.Zc(4,rn,2,3,"div",16),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngIf","text"===e.type),c.Ub(1),c.Ec("ngIf","list"===e.type),c.Ub(1),c.Ec("ngIf","text-area"===e.type),c.Ub(1),c.Ec("ngIf","point"===e.type)}}function pn(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,dn,5,4,"div",6),c.mc()),2&e){const e=t.$implicit,n=c.xc(2);c.Ub(1),c.Ec("ngIf",n.evaluate(e))}}function mn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",15),c.nc(1,"label"),c.bd(2,"Privilege "),c.mc(),c.nc(3,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).entity.privilegeType=t})),c.nc(4,"option",24),c.bd(5,"Owner"),c.mc(),c.nc(6,"option",25),c.bd(7,"Agency"),c.mc(),c.nc(8,"option",26),c.bd(9,"Public"),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(3),c.Ec("ngModel",e.entity.privilegeType)("required",!0)("disabled",!1===e.admin||e.entity.ownerName!==e.userName)}}function hn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",1),c.Zc(1,nn,8,1,"div",2),c.Zc(2,cn,3,1,"div",3),c.nc(3,"form",null,4),c.Zc(5,pn,2,1,"div",5),c.Zc(6,mn,10,3,"div",6),c.nc(7,"div",7),c.nc(8,"button",8),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(9,"Cancel"),c.mc(),c.nc(10,"button",9),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(11,"Apply"),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.Pc(4),t=c.xc();c.Ub(1),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",t.newInstance),c.Ub(3),c.Ec("ngForOf",t.attributes),c.Ub(1),c.Ec("ngIf","Collection"===t.entity.type&&!t.newInstance),c.Ub(4),c.Ec("disabled",!e.valid)}}tn.ɵfac=function(e){return new(e||tn)(c.hc(Ct),c.hc(A),c.hc(j.b))},tn.ɵcmp=c.bc({type:tn,selectors:[["product-panel"]],inputs:{id:"id"},outputs:{toggleMapOrtho:"toggleMapOrtho",toggleMapDem:"toggleMapDem"},features:[c.Sb],decls:13,vars:4,consts:[[1,"row"],[1,"col-sm-12"],[2,"padding","10px 15px"],["name","sortField",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[1,"list-group"],["style","padding: 10px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],[3,"value"],[2,"padding","10px","text-align","center","color","grey"],[4,"ngIf"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin"],[1,"list-group-item"],[1,"card","card-default"],[1,"card-body"],[1,"card-title",2,"color","#a0a0a0"],[1,"breadcrumb",2,"margin","5px 0 5px 0"],[4,"ngFor","ngForOf"],[1,"card-left",2,"width","calc(100% - 7.2em)","padding","0px"],[1,"card-right",2,"padding","0px","width","7.2em"],[2,"list-style","none","padding","0"],[2,"padding","3px 0 3px 0","min-width","6em"],["aria-hidden","true","title","View the Orthomosaic generated from the raw data using ODM.",1,"fa","fa-globe",3,"click"],["class","fas fa-check","style","color: #007276;float: right;vertical-align: middle;line-height: 20px;",4,"ngIf"],[2,"padding","3px 0 3px 0","min-width","7.2em"],["aria-hidden","true","title","View the DEM hillshade.",1,"fa","fa-industry",3,"click"],[2,"padding","3px 0 3px 0"],["aria-hidden","true","title","View the 3D pointcloud for this product using the Potree viewer.",1,"fa","fa-cube",3,"click"],["title","View more information about this product, including raw data.",1,"fa","fa-info-circle",3,"click"],["title","Deletes the product and all associated data and public map services.",1,"fa","fa-trash-alt",3,"click"],["style","padding: 3px 0 3px 0;",4,"ngIf"],[1,"thumbnail",3,"click"],["alt","Image",1,"",3,"src","error"],[1,"fas","fa-check",2,"color","#007276","float","right","vertical-align","middle","line-height","20px"],["title","Unpublishes the layer from the public mosaic. This layer will no longer be publicly accessible.",1,"fa","fa-arrow-alt-circle-down",3,"click"],["title","Publish the product to the publish mosaic. The aerial and hillshade services will be publicly accessible.",1,"fa","fa-arrow-alt-circle-up",3,"click"]],template:function(e,t){1&e&&(c.lc(0),c.nc(1,"div",0),c.nc(2,"div",1),c.nc(3,"div",2),c.nc(4,"label"),c.nc(5,"label"),c.bd(6,"Order available products"),c.mc(),c.mc(),c.nc(7,"select",3),c.vc("ngModelChange",(function(e){return t.sortField=e}))("change",(function(){return t.refresh()})),c.ic(8,"option"),c.Zc(9,Gt,2,2,"option",4),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(10,"div",5),c.Zc(11,Ht,4,3,"div",6),c.Zc(12,en,30,15,"div",7),c.mc(),c.kc()),2&e&&(c.Ub(7),c.Ec("ngModel",t.sortField),c.Ub(2),c.Ec("ngForOf",t.fields),c.Ub(2),c.Ec("ngIf",t.products.length<1),c.Ub(1),c.Ec("ngForOf",t.products))},directives:[o.w,o.k,o.n,o.p,o.y,i.s,i.t],pipes:[L.a],encapsulation:2,data:{animation:[Object(Y.c)(),Object(Y.d)(),Object(Y.a)(),Object(Y.b)()]}});class un{constructor(e,t){this.service=e,this.bsModalRef=t,this.userName="",this.admin=!1,this.newInstance=!1,this.message=null,this.center=null,this.zoom=null}ngOnInit(){this.onNodeChange=new G.b}init(e,t,n,c,i,a,o){this.newInstance=e,this.userName=t,this.admin=n,this.entity=c,this.attributes=i,this.center=a,this.zoom=o}handleOnSubmit(){this.message=null,"Site"!==this.entity.type||null!=this.entity.geometry?this.newInstance?this.service.applyWithParent(this.entity,this.parentId).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{this.error(e)}):this.service.update(this.entity).then(e=>{this.onNodeChange.next(e),this.bsModalRef.hide()}).catch(e=>{console.log(e),this.error(e)}):this.message="Sites require a location"}evaluate(e){return(!this.newInstance||!e.readonly)&&(null==e.condition||this.service.evaluate(e.condition,this.entity))}error(e){this.message=S.b.getMessageFromError(e)}}function gn(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",5),c.nc(5,"div"),c.nc(6,"p",6),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function bn(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.dd(" ",e.name,"")}}function fn(e,t){if(1&e){const e=c.oc();c.nc(0,"tr"),c.nc(1,"td",25),c.nc(2,"a",26),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(3).handleDownloadFile(n)})),c.mc(),c.nc(3,"a",27),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(3).handleDelete(n)})),c.mc(),c.mc(),c.nc(4,"td"),c.bd(5),c.mc(),c.nc(6,"td"),c.bd(7),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(5),c.cd(e.name),c.Ub(2),c.cd(e.lastModified)}}function vn(e,t){1&e&&(c.bd(0," Drag & Drop File "),c.nc(1,"button",28),c.vc("click",(function(){return(0,t.openFileSelector)()})),c.bd(2,"Browse Files"),c.mc())}un.ɵfac=function(e){return new(e||un)(c.hc(A),c.hc(j.a))},un.ɵcmp=c.bc({type:un,selectors:[["entity-modal"]],decls:1,vars:1,consts:[["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],["class","modal-title-container",4,"ngIf"],["ngForm","ngForm"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],[1,"btn-holder",2,"text-align","right"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"modal-title-container"],[1,"form-group"],[4,"ngIf"],["type","input",1,"form-control",3,"ngModel","name","disabled","placeholder","required","ngModelChange"],["type","input",3,"ngModel","name","disabled","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form-control",3,"ngModel","name","disabled","required","ngModelChange"],[3,"site","center","zoom","siteChange"],["name","collection-privilege","type","input",2,"padding","6px 10px","font-size","14px",3,"ngModel","required","disabled","ngModelChange"],["value","OWNER"],["value","AGENCY"],["value","PUBLIC"]],template:function(e,t){1&e&&c.Zc(0,hn,12,5,"div",0),2&e&&c.Ec("ngIf",null!=t.entity)},directives:[i.t,o.z,o.l,o.m,i.s,o.c,o.k,o.n,o.v,o.w,o.p,o.y,M],encapsulation:2});const yn=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function xn(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",17),c.vc("selectTab",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).onSelect(n)})),c.nc(1,"div",18),c.nc(2,"div",19),c.nc(3,"table",20),c.nc(4,"thead"),c.nc(5,"tr"),c.ic(6,"th",21),c.nc(7,"th",21),c.bd(8,"Name"),c.mc(),c.nc(9,"th",21),c.bd(10,"Date uploaded"),c.mc(),c.mc(),c.mc(),c.nc(11,"tbody",22),c.Zc(12,fn,8,2,"tr",10),c.yc(13,"paginate"),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",19),c.nc(16,"ngx-file-drop",23),c.vc("onFileDrop",(function(t){return c.Rc(e),c.xc(2).dropped(t)})),c.Zc(17,vn,3,0,"ng-template",24),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ec("heading",e.name),c.Ub(12),c.Ec("ngForOf",c.Ac(13,2,n.page.results,c.Kc(5,yn,n.page.pageSize,n.page.pageNumber,n.page.count)))}}function kn(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"div",7),c.nc(2,"div",8),c.nc(3,"h2"),c.bd(4),c.mc(),c.mc(),c.mc(),c.nc(5,"div",7),c.nc(6,"div",8),c.nc(7,"ul",9),c.Zc(8,bn,3,1,"li",10),c.mc(),c.mc(),c.mc(),c.nc(9,"div",7),c.nc(10,"tabset",11),c.Zc(11,xn,18,9,"tab",12),c.mc(),c.mc(),c.nc(12,"div",7),c.nc(13,"pagination-controls",13),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.nc(14,"div",7),c.nc(15,"div",14),c.nc(16,"button",15),c.vc("click",(function(){return c.Rc(e),c.xc().bsModalRef.hide()})),c.bd(17,"Close"),c.mc(),c.nc(18,"button",16),c.vc("click",(function(){return c.Rc(e),c.xc().handleDownload()})),c.bd(19,"Download all"),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(4),c.cd(e.entity.name),c.Ub(4),c.Ec("ngForOf",e.previous),c.Ub(3),c.Ec("ngForOf",e.folders)}}class En{constructor(e,t,n){this.service=e,this.modalService=t,this.bsModalRef=n,this.previous=[],this.folders=[],this.page=new V}ngOnInit(){this.page.count=0,this.page.pageNumber=1,this.page.pageSize=10,this.page.results=[]}init(e,t,n){this.entity=e,this.folders=t,this.previous=[...n],this.previous.length>0&&this.previous[this.previous.length-1].id!==this.entity.id&&this.previous.push(this.entity),this.folders.length>0&&this.onSelect(this.folders[0])}onPageChange(e){this.getData(this.folder.component,this.folder.name,e,this.page.pageSize)}onSelect(e){this.page.results=[],this.folder=e,this.getData(e.component,e.name,1,this.page.pageSize)}refresh(){this.page.results=[],this.getData(this.folder.component,this.folder.name,this.page.pageNumber,this.page.pageSize)}getData(e,t,n,c){this.service.getObjects(e,t,n,c).then(e=>{this.page=e})}handleDownload(){window.location.href=acp+"/project/download-all?id="+this.folder.component+"&key="+this.folder.name}handleDownloadFile(e){window.location.href=acp+"/project/download?id="+this.folder.component+"&key="+e.key}dropped(e){for(const t of e)if(t.fileEntry.isFile){t.fileEntry.file(e=>{this.service.upload(this.folder.component,this.folder.name,e).then(()=>{this.refresh()})})}else{const e=t.fileEntry;console.log(t.relativePath,e)}}handleDelete(e){let t=this.modalService.show(S.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0});t.content.message="Are you sure you want to delete the file ["+e.name+"]?",t.content.type="DANGER",t.content.submitText="Delete",t.content.onConfirm.subscribe(()=>{this.remove(e)})}remove(e){this.service.removeObject(e.component,e.key).then(()=>{this.refresh()})}error(e){this.message=S.b.getMessageFromError(e)}}En.ɵfac=function(e){return new(e||En)(c.hc(A),c.hc(j.b),c.hc(j.a))},En.ɵcmp=c.bc({type:En,selectors:[["accessible-support-modal"]],decls:4,vars:2,consts:[[1,"modal-body"],["class","error-container",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[1,"row"],[1,"col-md-12"],[1,"breadcrumb",2,"margin-bottom","10px"],[4,"ngFor","ngForOf"],[1,"nav-full-width"],[3,"heading","selectTab",4,"ngFor","ngForOf"],[3,"pageChange"],[1,"btn-holder",2,"text-align","right","margin","20px 20px 10px 20px"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-secondary",2,"margin-left","5px",3,"click"],[3,"heading","selectTab"],[1,"row","image-list-container"],[1,"col-sm-12"],[1,"table","table-striped"],["scope","col"],[1,"upload-name-style"],["dropZoneLabel","Drop files here",3,"onFileDrop"],["ngx-file-drop-content-tmp",""],[1,"button-column"],["title","Download",1,"fa","fa-download",3,"click"],["title","Remove",1,"fa","fa-trash-alt","ico-remove",2,"margin-left","5px",3,"click"],["type","button",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div"),c.Zc(2,gn,8,1,"div",1),c.Zc(3,kn,20,3,"div",2),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message),c.Ub(1),c.Ec("ngIf",null!=t.entity))},directives:[i.t,i.s,p.e,h.c,p.b,s.a,s.c],pipes:[h.b],encapsulation:2});var Cn=n(55);class wn{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/uav/page",{params:t}).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/uav/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/uav/apply",JSON.stringify({uav:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}search(e,t){let n=new y.g;return n=n.set("text",e),n=n.set("field",t),this.http.get(acp+"/uav/search",{params:n}).toPromise()}getMetadataOptions(e){let t=new y.g;return t=t.set("oid",e),this.http.get(acp+"/uav/get-metadata-options",{params:t}).toPromise()}}function Un(e,t){if(1&e){const e=c.oc();c.nc(0,"div",16),c.nc(1,"div",2),c.nc(2,"div",3),c.nc(3,"div",4),c.bd(4,"Point Of Contact"),c.mc(),c.nc(5,"div",5),c.nc(6,"div",6),c.nc(7,"label",17),c.bd(8,"Name"),c.mc(),c.nc(9,"input",18),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.pointOfContact.name=t}))("change",(function(){return c.Rc(e),c.xc().handlePageChange()})),c.mc(),c.mc(),c.nc(10,"div",6),c.nc(11,"label",19),c.bd(12,"Email"),c.mc(),c.nc(13,"input",20),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.pointOfContact.email=t}))("change",(function(){return c.Rc(e),c.xc().handlePageChange()})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngModel",e.page.selection.pointOfContact.name)("maxlength",100)("required",!1)("disabled",!1),c.Ub(4),c.Ec("ngModel",e.page.selection.pointOfContact.email)("maxlength",255)("required",!1)("disabled",!1)}}function In(e,t){if(1&e&&(c.lc(0),c.nc(1,"div",6),c.nc(2,"label",21),c.bd(3,"Name"),c.mc(),c.bd(4),c.mc(),c.nc(5,"div",6),c.nc(6,"label",21),c.bd(7,"Type"),c.mc(),c.bd(8),c.mc(),c.nc(9,"div",6),c.nc(10,"label",21),c.bd(11,"Serial Number"),c.mc(),c.bd(12),c.mc(),c.nc(13,"div",6),c.nc(14,"label",21),c.bd(15,"FAA Id Number"),c.mc(),c.bd(16),c.mc(),c.nc(17,"div",6),c.nc(18,"label",21),c.bd(19,"Bureau"),c.mc(),c.bd(20),c.mc(),c.kc()),2&e){const e=c.xc();c.Ub(4),c.dd(" ",e.uav.platform," "),c.Ub(4),c.dd(" ",e.uav.platformType," "),c.Ub(4),c.dd(" ",e.uav.serialNumber," "),c.Ub(4),c.dd(" ",e.uav.faaNumber," "),c.Ub(4),c.dd(" ",e.uav.bureau," ")}}function Mn(e,t){if(1&e&&(c.nc(0,"option",25),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.dd("",e.name," ")}}function On(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," ")}}function Sn(e,t){if(1&e&&(c.lc(0),c.nc(1,"div",6),c.nc(2,"label",21),c.bd(3,"Type"),c.mc(),c.bd(4),c.mc(),c.nc(5,"div",6),c.nc(6,"label",26),c.bd(7,"Wave Length"),c.mc(),c.nc(8,"ul"),c.Zc(9,On,2,1,"li",27),c.mc(),c.mc(),c.nc(10,"div",6),c.nc(11,"label",28),c.bd(12,"Sensor Width"),c.mc(),c.bd(13),c.mc(),c.nc(14,"div",6),c.nc(15,"label",28),c.bd(16,"Sensor Width Units"),c.mc(),c.bd(17," Millimeters "),c.mc(),c.nc(18,"div",6),c.nc(19,"label",29),c.bd(20,"Sensor Height"),c.mc(),c.bd(21),c.mc(),c.nc(22,"div",6),c.nc(23,"label",28),c.bd(24,"Sensor Height Units"),c.mc(),c.bd(25," Millimeters "),c.mc(),c.nc(26,"div",6),c.nc(27,"label",30),c.bd(28,"Pixel Size Width"),c.mc(),c.bd(29),c.mc(),c.nc(30,"div",6),c.nc(31,"label",31),c.bd(32,"Pixel Size Height"),c.mc(),c.bd(33),c.mc(),c.kc()),2&e){const e=c.xc(2);c.Ub(4),c.dd(" ",e.metaObject.sensor.sensorType," "),c.Ub(5),c.Ec("ngForOf",e.metaObject.sensor.wavelengths),c.Ub(4),c.dd(" ",e.metaObject.sensor.sensorWidth," "),c.Ub(8),c.dd(" ",e.metaObject.sensor.sensorHeight," "),c.Ub(8),c.dd(" ",e.metaObject.sensor.pixelSizeWidth," "),c.Ub(4),c.dd(" ",e.metaObject.sensor.pixelSizeHeight," ")}}function Rn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",1),c.nc(1,"div",2),c.nc(2,"div",3),c.nc(3,"div",4),c.bd(4,"Sensor"),c.mc(),c.nc(5,"div",5),c.nc(6,"div",6),c.nc(7,"label",22),c.bd(8,"Name"),c.mc(),c.nc(9,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().page.selection.sensor=t}))("change",(function(){return c.Rc(e),c.xc().onSensorChange()})),c.ic(10,"option"),c.Zc(11,Mn,2,2,"option",24),c.mc(),c.mc(),c.Zc(12,Sn,34,6,"ng-container",14),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngModel",e.page.selection.sensor),c.Ub(2),c.Ec("ngForOf",e.uav.sensors),c.Ub(1),c.Ec("ngIf",null!=e.metaObject)}}wn.ɵfac=function(e){return new(e||wn)(c.rc(y.c),c.rc(D.a),c.rc(N.a))},wn.ɵprov=c.dc({token:wn,factory:wn.ɵfac});const Tn=function(){return{standalone:!0}};class Pn{constructor(e,t){this.service=e,this.uavService=t,this.pageChange=new c.t,this.search="",this.field="serialNumber",this.uav=null,this.metaObject=null,this.dataSource=new v.a(e=>{this.uavService.search(this.search,this.field).then(t=>{e.next(t)})})}ngOnInit(){null==this.page.selection.pointOfContact&&this.service.getMetadataOptions(null).then(e=>{this.page.selection.pointOfContact={name:e.name,email:e.email}}),null!=this.page.selection.uav&&this.getUavInformation(this.page.selection.uav,!1),null!=this.page.selection.sensor&&this.onSensorChange()}handlePageChange(){this.pageChange.emit(this.page)}onSensorChange(){this.metaObject=null,this.service.getUAVMetadata(this.page.selection.uav,this.page.selection.sensor).then(e=>{this.metaObject={uav:e.uav,sensor:e.sensor}}).catch(e=>{}),this.handlePageChange()}handleUavClick(e){this.getUavInformation(e.item.oid,!0),this.pageChange.emit(this.page)}getUavInformation(e,t){this.uav=null,this.metaObject=null,t&&(this.page.selection.uav=null,this.page.selection.sensor=null),null!=e&&(this.page.selection.uav=e,this.uavService.getMetadataOptions(e).then(e=>{this.uav=e,t||(this.search=this.uav.serialNumber)}))}}function Fn(e,t){if(1&e&&(c.nc(0,"div",11),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",14),c.nc(4,"strong",15),c.bd(5,"Error"),c.mc(),c.mc(),c.nc(6,"div",16),c.nc(7,"div"),c.nc(8,"p",17),c.bd(9),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(10,"div",12),c.mc()),2&e){const e=c.xc();c.Ub(9),c.cd(e.message)}}function Dn(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.dd(" ",e,"")}}function Nn(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"ul",18),c.Zc(4,Dn,3,2,"li",19),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",e.labels)}}function Zn(e,t){if(1&e&&(c.nc(0,"option",26),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function An(e,t){if(1&e){const e=c.oc();c.nc(0,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(3).setIsNew(!0)})),c.bd(1," Add "),c.mc()}}function jn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",4),c.nc(1,"div",13),c.nc(2,"select",23),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).page.selection.value=t})),c.ic(3,"option"),c.Zc(4,Zn,2,2,"option",24),c.mc(),c.mc(),c.nc(5,"div",12),c.Zc(6,An,2,0,"button",25),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(2),c.Ec("name",e.page.selection.type)("ngModel",e.page.selection.value)("disabled",e.page.selection.isNew),c.Ub(2),c.Ec("ngForOf",e.page.options),c.Ub(2),c.Ec("ngIf",!e.page.selection.isNew)}}function Ln(e,t){if(1&e){const e=c.oc();c.nc(0,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(3).setIsNew(!1)})),c.bd(1," Cancel "),c.mc()}}function _n(e,t){if(1&e){const e=c.oc();c.nc(0,"div",4),c.nc(1,"div",13),c.nc(2,"label",30),c.bd(3,"Collection Date:"),c.mc(),c.nc(4,"input",31),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(3).page.selection.collectionDate=t})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(3);c.Ec("@fadeInOnEnter",void 0),c.Ub(4),c.Ec("ngModel",e.page.selection.collectionDate)}}function $n(e,t){if(1&e){const e=c.oc();c.nc(0,"metadata-page",32),c.vc("pageChange",(function(t){return c.Rc(e),c.xc(3).page=t})),c.mc()}if(2&e){const e=c.xc(3);c.Ec("page",e.page)}}function zn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",20),c.nc(1,"div",4),c.nc(2,"div",13),c.nc(3,"input",28),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).page.selection.label=t})),c.mc(),c.mc(),c.nc(4,"div",12),c.Zc(5,Ln,2,0,"button",25),c.mc(),c.mc(),c.Zc(6,_n,5,2,"div",2),c.Zc(7,$n,1,1,"metadata-page",29),c.mc()}if(2&e){const e=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngModel",e.page.selection.label)("placeholder",e.page.selection.type+" name..."),c.Ub(2),c.Ec("ngIf",!e.hasField("collectionDate")),c.Ub(1),c.Ec("ngIf",e.hasField("collectionDate")),c.Ub(1),c.Ec("ngIf",e.hasField("uav"))}}function Bn(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.nc(3,"div",20),c.nc(4,"label",21),c.bd(5),c.mc(),c.Zc(6,jn,7,5,"div",2),c.mc(),c.Zc(7,zn,8,6,"div",22),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("for",e.page.selection.type),c.Ub(1),c.dd("",e.page.selection.type,":"),c.Ub(1),c.Ec("ngIf",!e.page.selection.isNew),c.Ub(1),c.Ec("ngIf",e.page.selection.isNew)}}function Gn(e,t){if(1&e){const e=c.oc();c.nc(0,"div",20),c.nc(1,"label",21),c.bd(2),c.mc(),c.nc(3,"input",34),c.vc("ngModelChange",(function(n){return c.Rc(e),t.$implicit.label=n})),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("for",e.type),c.Ub(1),c.dd("",e.type,":"),c.Ub(1),c.Ec("ngModel",e.label)("name",e.type)}}function Vn(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"div",12),c.nc(2,"div",13),c.Zc(3,Gn,4,4,"div",33),c.mc(),c.mc()),2&e){const e=c.xc();c.Ec("@fadeInOnEnter",void 0),c.Ub(3),c.Ec("ngForOf",e.selections)}}function qn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",35),c.vc("click",(function(){return c.Rc(e),c.xc().handleBackPage()})),c.ic(1,"i",36),c.bd(2," Back "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",e.disabled)}}function Hn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc().handleNextPage()})),c.ic(1,"i",36),c.bd(2," Next "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}function Jn(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc().handleCreate()})),c.ic(1,"i",36),c.bd(2," Create "),c.mc()}if(2&e){const e=c.xc();c.Ec("disabled",!e.isPageValid(e.page)||e.disabled)}}Pn.ɵfac=function(e){return new(e||Pn)(c.hc(A),c.hc(wn))},Pn.ɵcmp=c.bc({type:Pn,selectors:[["metadata-page"]],inputs:{page:"page"},outputs:{pageChange:"pageChange"},decls:23,vars:14,consts:[["class","row","style","margin-top: 20px;",4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"panel","panel-default"],[1,"panel-heading"],[1,"panel-body"],[1,"form-group"],["for","platform.name"],["id","serialNumber","type","radio","value","serialNumber","name","field",2,"height","auto",3,"checked","ngModel","ngModelChange"],["for","serialNumber",2,"margin-left","5px"],[2,"margin-left","15px"],["id","faaNumber","type","radio","value","faaNumber","name","field",2,"height","auto",3,"checked","ngModel","ngModelChange"],["for","faaNumber",2,"margin-left","5px"],["type","text","placeholder","Search...","required","",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadOptionField","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"row",2,"margin-top","20px"],["for","pointOfContact.name"],["type","text","name","pointOfContact.name",3,"ngModel","maxlength","required","disabled","ngModelChange","change"],["for","pointOfContact.email"],["type","text","name","pointOfContact.email",3,"ngModel","maxlength","required","disabled","ngModelChange","change"],["for","sensor.type"],["for","sensor.name"],["name","sensor","required","",1,"form-control",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","sensor.wavelength"],[4,"ngFor","ngForOf"],["for","sensor.sensorWidth"],["for","sensor.sensorHeight"],["for","sensor.pixelSizeWidth"],["for","sensor.pixelSizeHeight"]],template:function(e,t){1&e&&(c.lc(0),c.Zc(1,Un,14,8,"div",0),c.nc(2,"div",1),c.nc(3,"div",2),c.nc(4,"div",3),c.nc(5,"div",4),c.bd(6,"Platform"),c.mc(),c.nc(7,"div",5),c.nc(8,"div",6),c.nc(9,"label",7),c.bd(10,"UAV"),c.mc(),c.nc(11,"div"),c.nc(12,"span"),c.nc(13,"input",8),c.vc("ngModelChange",(function(e){return t.field=e})),c.mc(),c.nc(14,"label",9),c.bd(15,"Serial Number"),c.mc(),c.mc(),c.nc(16,"span",10),c.nc(17,"input",11),c.vc("ngModelChange",(function(e){return t.field=e})),c.mc(),c.nc(18,"label",12),c.bd(19,"FAA Number"),c.mc(),c.mc(),c.mc(),c.nc(20,"input",13),c.vc("ngModelChange",(function(e){return t.search=e}))("typeaheadOnSelect",(function(e){return t.handleUavClick(e)}))("keydown.enter",(function(e){return e.preventDefault()})),c.mc(),c.mc(),c.Zc(21,In,21,5,"ng-container",14),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(22,Rn,13,3,"div",15),c.kc()),2&e&&(c.Ub(1),c.Ec("ngIf",null!=t.page.selection.pointOfContact),c.Ub(12),c.Ec("checked","serialNumber"===t.field)("ngModel",t.field),c.Ub(4),c.Ec("checked","faaNumber"===t.field)("ngModel",t.field),c.Ub(3),c.Ec("ngModel",t.search)("typeaheadAsync",!0)("typeahead",t.dataSource)("typeaheadOptionsLimit",10)("typeaheadOptionField",t.field)("ngModelOptions",c.Hc(13,Tn)),c.Ub(1),c.Ec("ngIf",null!=t.uav),c.Ub(1),c.Ec("ngIf",null!=t.uav))},directives:[i.t,o.s,o.c,o.k,o.n,o.v,r.b,o.f,o.w,o.p,o.y,i.s],encapsulation:2});class Wn{constructor(e,t,n,c){this.service=e,this.modalService=t,this.metadataService=n,this.bsModalRef=c,this.message="",this.disabled=!1,this.hierarchy=[],this.selections=[],this.labels=[],this.pages=[{index:0,selection:null,options:[],type:"FILE"}],this.hierarchyChange=!1,this.page=this.pages[0],this.sensors=[],this.platforms=[],this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]}}ngAfterViewInit(){}ngOnInit(){this.onCreateComplete=new G.b,this.onHierarchyChange=new G.b}ngOnDestroy(){this.onCreateComplete.unsubscribe(),this.onHierarchyChange.unsubscribe()}init(e){this.hierarchy=this.metadataService.getHierarchy(),this.selections=[],this.pages=[];for(let t=0;t<this.hierarchy.length;t++){const n=this.hierarchy[t],c=e.findIndex(e=>e.type===n);if(-1!==c){const i=e[c];this.selections.push({type:n,isNew:t===this.hierarchy.length-1,value:i.id,label:i.name})}else this.selections.push({type:n,isNew:t===this.hierarchy.length-1,value:null,label:""});t>0&&this.pages.push({index:this.pages.length,selection:this.selections[t],options:[],type:"CATEGORY"})}this.labels.push(this.selections[0].label),this.pages.push({index:this.pages.length,selection:null,options:[],type:"SUMMARY"}),this.page=this.pages[0],this.service.getChildren(this.selections[0].value).then(e=>{this.pages[0].options=e.filter(e=>e.type===this.pages[0].selection.type)}).catch(e=>{this.error(e)})}close(){this.hierarchyChange&&this.onHierarchyChange.next(!0),this.bsModalRef.hide()}isPageValid(e){return"CATEGORY"!==e.type||null==e.selection||(null!=e.selection.value&&e.selection.value.length>0||null!=e.selection.label&&e.selection.label.length>0&&((!this.hasField("uav")||null!=e.selection.uav&&0!==e.selection.uav.length)&&((!this.hasField("sensor")||null!=e.selection.sensor&&0!==e.selection.sensor.length)&&(!this.hasField("collectionDate")||null!=e.selection.collectionDate&&0!==e.selection.collectionDate.length))))}updateCurrentPageLabel(){this.page.options.forEach(e=>{e.id===this.page.selection.value&&(this.page.selection.label=e.name)})}setIsNew(e){this.page.selection.isNew=e,e?this.page.selection.value=null:this.page.selection.label=null}handleCreate(){this.service.createCollection(this.selections).then(e=>{this.onCreateComplete.next(e.oid),this.bsModalRef.hide()}).catch(e=>{this.error(e)})}handleNextPage(){if(this.page.index+1<this.pages.length){const e=this.pages[this.page.index+1];"CATEGORY"===this.page.type&&(this.updateCurrentPageLabel(),this.labels.push(this.page.selection.label)),"CATEGORY"===e.type?"FILE"===this.page.type?this.page=e:!this.page.selection.isNew&&null!=this.page.selection.value&&this.page.selection.value.length>0?this.service.getChildren(this.page.selection.value).then(t=>{e.options=t.filter(t=>t.type===e.selection.type),this.page=e}).catch(e=>{this.error(e)}):this.page=e:(this.page=e,this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!1},{label:"Final",active:!0,enabled:!1}]})}}handleBackPage(){if(this.page.index>0){const e=this.pages[this.page.index-1];"CATEGORY"===e.type&&(this.labels.splice(this.labels.length-1,1),this.modalStepConfig.steps.forEach(e=>{"category"===e.label.toLowerCase()&&!1===e.enabled&&(this.modalStepConfig={steps:[{label:"Category",active:!0,enabled:!0},{label:"Final",active:!0,enabled:!1}]})})),this.page=e}}hasField(e){return this.metadataService.hasExtraField(this.page.selection.type,e)}error(e){this.message=S.b.getMessageFromError(e)}}Wn.ɵfac=function(e){return new(e||Wn)(c.hc(A),c.hc(j.b),c.hc(te),c.hc(j.a))},Wn.ɵcmp=c.bc({type:Wn,selectors:[["create-collection-modal"]],decls:16,vars:9,consts:[["tabindex","-1","role","dialog",1,"modal-body"],["class","row error-container",4,"ngIf"],["class","row",4,"ngIf"],[1,"modal-footer"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"disabled","click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-secondary",3,"disabled","click",4,"ngIf"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"row","error-container"],[1,"col-md-2"],[1,"col-md-8"],[1,"label-holder"],[2,"color","#8c0000"],[1,"holder"],[1,"error-message"],[1,"breadcrumb"],[4,"ngFor","ngForOf"],[1,"form-group"],[3,"for"],["class","form-group",4,"ngIf"],["required","",3,"name","ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","button btn btn-primary","class","btn btn-primary",3,"click",4,"ngIf"],[3,"value"],["type","button btn btn-primary",1,"btn","btn-primary",3,"click"],["autofocus","","name","label","type","input","required","",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[3,"page","pageChange",4,"ngIf"],["for","platform",2,"margin-top","10px"],["name","collectionDate","type","date","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"page","pageChange"],["class","form-group",4,"ngFor","ngForOf"],["type","input","disabled","","required","",1,"form-control",3,"ngModel","name","ngModelChange"],["type","button btn btn-primary",1,"btn","btn-secondary",3,"disabled","click"],[1,"icon-upload","icon-white"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"div",0),c.Zc(2,Fn,11,1,"div",1),c.Zc(3,Nn,5,1,"div",2),c.Zc(4,Bn,8,4,"div",2),c.Zc(5,Vn,4,2,"div",2),c.mc(),c.nc(6,"div",3),c.nc(7,"div",4),c.nc(8,"div",5),c.nc(9,"div",6),c.nc(10,"button",7),c.vc("click",(function(){return t.close()})),c.nc(11,"span",8),c.bd(12,"Close"),c.mc(),c.mc(),c.Zc(13,qn,3,1,"button",9),c.Zc(14,Hn,3,1,"button",10),c.Zc(15,Jn,3,1,"button",10),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(2),c.Ec("ngIf",null!=t.message&&t.message.length>0),c.Ub(1),c.Ec("ngIf",t.labels.length>0),c.Ub(1),c.Ec("ngIf","CATEGORY"===t.page.type),c.Ub(1),c.Ec("ngIf","SUMMARY"===t.page.type),c.Ub(5),c.Ec("disabled",t.disabled)("disabled",t.disabled),c.Ub(3),c.Ec("ngIf",t.page.index>0),c.Ub(1),c.Ec("ngIf",t.page.index<t.pages.length-1),c.Ub(1),c.Ec("ngIf",t.page.index===t.pages.length-1))},directives:[i.t,i.s,o.w,o.v,o.k,o.n,o.p,o.y,o.c,Pn],styles:[".list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tdisplay: inline-block;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%] {\n\tmargin-bottom: 0;\n\tmargin-left: -4px;\n\tmargin-right: 0;\n\tborder-right-width: 0;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:first-child {\n\tborder-top-right-radius: 0;\n\tborder-bottom-left-radius: 4px;\n}\n\n.list-group-horizontal[_ngcontent-%COMP%]   .list-group-item[_ngcontent-%COMP%]:last-child {\n\tborder-top-right-radius: 4px;\n\tborder-bottom-left-radius: 0;\n\tborder-right-width: 1px;\n}\n\n.list-group-item-success[_ngcontent-%COMP%] {\n\tcolor: #155724;\n\tbackground-color: #c3e6cb;\n}"],data:{animation:[Object(Y.c)(),Object(Y.d)()]}});var Yn=n(324),Xn=n(325),Kn=n(65),Qn=n(59),ec=n(326);function tc(e,t){if(1&e&&(c.nc(0,"b"),c.bd(1),c.mc()),2&e){const e=t.match;c.Ub(1),c.ed("",e.item.label," - ",e.item.total,"")}}function nc(e,t){if(1&e){const e=c.oc();c.nc(0,"span",17),c.nc(1,"a",18),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return c.xc(2).handleRemove(t)})),c.mc(),c.mc()}}function cc(e,t){if(1&e&&(c.nc(0,"div",3),c.nc(1,"div",4),c.bd(2),c.Zc(3,nc,2,0,"span",16),c.mc(),c.mc()),2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ub(2),c.ed(" ",e.label," contains ",e.value," "),c.Ub(1),c.Ec("ngIf",!t.readonly)}}function ic(e,t){if(1&e&&(c.lc(0),c.Zc(1,cc,4,3,"div",15),c.kc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","datetime"!==e.field)}}function ac(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",3),c.nc(2,"div",9),c.nc(3,"label"),c.bd(4,"Layer Name"),c.mc(),c.nc(5,"input",10),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().layer.layerName=t})),c.mc(),c.mc(),c.mc(),c.nc(6,"div",3),c.nc(7,"div",9),c.nc(8,"label"),c.bd(9,"Start Date"),c.mc(),c.nc(10,"input",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().layer.startDate=t})),c.mc(),c.mc(),c.mc(),c.nc(11,"div",3),c.nc(12,"div",9),c.nc(13,"label"),c.bd(14,"End Date"),c.mc(),c.nc(15,"input",12),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().layer.endDate=t})),c.mc(),c.mc(),c.mc(),c.nc(16,"div",3),c.nc(17,"div",9),c.nc(18,"label"),c.bd(19,"Search"),c.mc(),c.nc(20,"input",13),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().search=t}))("typeaheadOnSelect",(function(t){return c.Rc(e),c.xc().handleClick(t)}))("keydown.enter",(function(t){return c.Rc(e),t.preventDefault()})),c.mc(),c.mc(),c.mc(),c.ic(21,"hr"),c.nc(22,"div",3),c.nc(23,"div",4),c.nc(24,"label"),c.bd(25,"Filters"),c.mc(),c.mc(),c.mc(),c.Zc(26,ic,2,1,"ng-container",14),c.kc()}if(2&e){const e=c.xc(),t=c.Pc(1);c.Ub(5),c.Ec("ngModel",e.layer.layerName)("disabled",e.readonly),c.Ub(5),c.Ec("ngModel",e.layer.startDate)("disabled",e.readonly),c.Ub(5),c.Ec("ngModel",e.layer.endDate)("disabled",e.readonly),c.Ub(5),c.Ec("ngModel",e.search)("typeaheadAsync",!0)("typeahead",e.dataSource)("typeaheadOptionsLimit",10)("typeaheadMinLength",2)("typeaheadItemTemplate",t)("disabled",e.readonly),c.Ub(6),c.Ec("ngForOf",e.layer.filters)}}function oc(e,t){if(1&e&&(c.nc(0,"option",36),c.bd(1),c.mc()),2&e){const e=c.xc().$implicit;c.Ec("value",e.key),c.Ub(1),c.dd(" ",e.key," ")}}function sc(e,t){if(1&e&&(c.lc(0),c.Zc(1,oc,2,2,"option",35),c.kc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","image/tiff; application=geotiff; profile=cloud-optimized"===e.value.type)}}function lc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"div",24),c.nc(2,"div",25),c.nc(3,"h5",26),c.bd(4),c.mc(),c.nc(5,"div"),c.bd(6,"Date: "),c.nc(7,"label"),c.bd(8),c.mc(),c.mc(),c.nc(9,"div",27),c.nc(10,"span",28),c.ic(11,"img",29),c.yc(12,"safeHtml"),c.mc(),c.mc(),c.nc(13,"div",30),c.nc(14,"ul",31),c.nc(15,"li",32),c.bd(16," Platform: "),c.nc(17,"label"),c.bd(18),c.mc(),c.mc(),c.nc(19,"li",32),c.bd(20," Sensor: "),c.nc(21,"label"),c.bd(22),c.mc(),c.mc(),c.nc(23,"li",32),c.bd(24," Asset "),c.nc(25,"select",33),c.vc("ngModelChange",(function(n){return c.Rc(e),t.$implicit.asset=n})),c.Zc(26,sc,2,1,"ng-container",14),c.yc(27,"keyvalue"),c.mc(),c.mc(),c.nc(28,"li",32),c.nc(29,"boolean-field",34),c.vc("valueChange",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleToggleItem(n)})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(2);c.Ub(4),c.dd(" ",e.properties.title," "),c.Ub(4),c.cd(e.properties.datetime),c.Ub(3),c.Ec("src",null!=n.thumbnails[e.id]?c.zc(12,9,n.thumbnails[e.id]):n.context+"/net/geoprism/images/thumbnail-default.png",c.Tc),c.Ub(7),c.cd(e.properties.platform),c.Ub(4),c.cd(e.properties.sensor),c.Ub(3),c.Ec("ngModel",e.asset)("name",e.id+"-asset"),c.Ub(1),c.Ec("ngForOf",c.zc(27,11,e.assets)),c.Ub(3),c.Ec("value",e.enabled)}}const rc=function(e,t,n){return{itemsPerPage:e,currentPage:t,totalItems:n}};function dc(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",3),c.nc(2,"div",19),c.nc(3,"div",20),c.Zc(4,lc,30,13,"div",21),c.yc(5,"paginate"),c.mc(),c.mc(),c.mc(),c.nc(6,"div",3),c.nc(7,"div",4),c.nc(8,"pagination-controls",22),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",c.Ac(5,1,e.page.resultSet,c.Kc(4,rc,e.page.pageSize,e.page.pageNumber,e.page.count)))}}function pc(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc().handleSubmit()})),c.ic(1,"i",38),c.bd(2," Search for products... "),c.mc()}if(2&e){c.xc();const e=c.Pc(3);c.Ec("disabled",e.invalid)}}function mc(e,t){if(1&e){const e=c.oc();c.nc(0,"button",37),c.vc("click",(function(){return c.Rc(e),c.xc().handleSubmit()})),c.ic(1,"i",38),c.bd(2),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(3);c.Ec("disabled",t.invalid||0===e.layer.items.length),c.Ub(2),c.dd(" ",e.readonly?"Modify layer":"Create layer"," ")}}class hc{constructor(e){this.service=e,this.search="",this.confirm=new c.t,this.cancel=new c.t,this.bounds=null,this.page=null,this.viewMode=0,this.thumbnails={},this.context=acp,this.dataSource=new v.a(e=>{const t=this.getFilters();this.service.getTotals(this.search,t).then(t=>{t.forEach(e=>e.text=this.search),e.next(t)})})}ngOnInit(){this.readonly=null!=this.layer,null==this.layer&&(this.layer={id:Object(ec.v4)(),layerName:"",startDate:"",endDate:"",filters:[],items:[],active:!0})}ngOnDestroy(){this.thumbnails={}}getFilters(){const e=[...this.layer.filters];if(this.layer.startDate.length>0||this.layer.endDate.length>0){const t={id:Object(ec.v4)(),label:"Date",field:"datetime"};this.layer.startDate.length>0&&(t.startDate=this.layer.startDate),this.layer.endDate.length>0&&(t.endDate=this.layer.endDate),e.push(t)}return e}handleClick(e){this.layer.filters.push({id:Object(ec.v4)(),label:e.item.label,field:e.item.key,value:e.item.text}),this.search=""}handleRemove(e){this.layer.filters=this.layer.filters.filter(t=>t.id!==e.id)}onPageChange(e){const t=this.getFilters(),n={};null!=t&&t.length>0&&(n.must=t),null!=this.bounds&&(n.should=[{field:"bounds",id:Object(ec.v4)(),label:"Bounds",value:this.bounds}]),this.service.getStacItems(n,20,e).then(e=>{this.thumbnails={},this.page=e,this.layer.items.forEach(e=>{const t=this.page.resultSet.findIndex(t=>e.id===t.id);-1!==t&&(this.page.resultSet[t]=e)}),this.page.resultSet.forEach(e=>{this.getThumbnail(e)}),this.page.resultSet.forEach(e=>{if(null==e.asset)if(null!=e.assets["odm_orthophoto.cog"])e.asset="odm_orthophoto.cog";else{Object.keys(e.assets).forEach(t=>{"image/tiff; application=geotiff; profile=cloud-optimized"===e.assets[t].type&&(e.asset=t)})}})})}handleToggleItem(e){e.enabled=!e.enabled;const t=this.layer.items.findIndex(t=>t.id===e.id);-1===t&&e.enabled?this.layer.items.push(e):-1===t||e.enabled||(this.layer.items=this.layer.items.filter(t=>t.id!==e.id))}handleSubmit(){0===this.viewMode?(this.onPageChange(1),this.viewMode=1):1===this.viewMode&&(this.confirm.emit(this.layer),this.close())}close(){this.cancel.emit()}getThumbnail(e){if(null!=e.assets.thumbnail){const t=e.assets.thumbnail.href;this.service.downloadFile(t,!1).then(t=>{this.createImageFromBlob(t,e)},e=>{console.log(e)})}}createImageFromBlob(e,t){let n=new FileReader;n.addEventListener("load",()=>{this.thumbnails[t.id]=n.result},!1),e&&n.readAsDataURL(e)}}hc.ɵfac=function(e){return new(e||hc)(c.hc(A))},hc.ɵcmp=c.bc({type:hc,selectors:[["layer-panel"]],inputs:{layer:"layer",bounds:"bounds"},outputs:{confirm:"confirm",cancel:"cancel"},decls:14,vars:4,consts:[["bsItemTemplate",""],["form","ngForm"],[4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"btn-holder",2,"text-align","right","padding","0 10px 10px 0"],["type","button","role","button","aria-disabled","false",1,"btn","btn-default",2,"padding","4px 18px",3,"click"],[1,"ui-button-text"],["type","button btn btn-primary","class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"col-md-12",2,"padding-top","10px"],["type","text","placeholder","Layer name...","name","layerName","required","",3,"ngModel","disabled","ngModelChange"],["type","date","name","startDate",2,"width","100%",3,"ngModel","disabled","ngModelChange"],["type","date","name","endDate",1,"form-element",2,"width","100%",3,"ngModel","disabled","ngModelChange"],["type","text","name","search","placeholder","Search for products...","autocomplete","off","typeaheadOptionField","text",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadMinLength","typeaheadItemTemplate","disabled","ngModelChange","typeaheadOnSelect","keydown.enter"],[4,"ngFor","ngForOf"],["class","row",4,"ngIf"],["class","float-right",4,"ngIf"],[1,"float-right"],["title","Remove filter",1,"fa","fa-trash-alt","ico-remove",3,"click"],[1,"col-md-12",2,"background","#f7f7f7","padding","0","height","100%"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],["maxSize","10",3,"pageChange"],[1,"list-group-item"],[1,"card","card-default"],[1,"card-body"],[1,"card-title",2,"color","#a0a0a0"],[1,"card-left",2,"width","calc(100% - 13em)","padding","0px"],[1,"thumbnail"],["alt","Image",2,"max-height","110px",3,"src"],[1,"card-right",2,"width","13em"],[2,"list-style","none","padding","0"],[2,"padding","3px 0 3px 0","min-width","6em"],[3,"ngModel","name","ngModelChange"],["label","Enabled",3,"value","valueChange"],[3,"value",4,"ngIf"],[3,"value"],["type","button btn btn-primary",1,"btn","btn-primary",3,"disabled","click"],[1,"icon-upload","icon-white"]],template:function(e,t){1&e&&(c.Zc(0,tc,2,2,"ng-template",null,0,c.ad),c.nc(2,"form",null,1),c.Zc(4,ac,27,14,"ng-container",2),c.Zc(5,dc,9,8,"ng-container",2),c.nc(6,"div",3),c.nc(7,"div",4),c.nc(8,"div",5),c.nc(9,"button",6),c.vc("click",(function(){return t.close()})),c.nc(10,"span",7),c.bd(11,"Close"),c.mc(),c.mc(),c.Zc(12,pc,3,1,"button",8),c.Zc(13,mc,3,2,"button",8),c.mc(),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(4),c.Ec("ngIf",0===t.viewMode),c.Ub(1),c.Ec("ngIf",null!=t.page),c.Ub(7),c.Ec("ngIf",0===t.viewMode),c.Ub(1),c.Ec("ngIf",0!==t.viewMode))},directives:[o.z,o.l,o.m,i.t,o.c,o.v,o.k,o.n,r.b,i.s,h.c,o.w,we.a,o.p,o.y],pipes:[h.b,L.a,i.l],encapsulation:2});const uc=["staticTabs"],gc=["confirmTemplate"];function bc(e,t){if(1&e&&(c.nc(0,"option",37),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.dd(" ",e.label," ")}}function fc(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",3),c.nc(2,"div",32),c.nc(3,"h3",33),c.bd(4,"IDM Sites"),c.mc(),c.mc(),c.mc(),c.nc(5,"div",3),c.nc(6,"div",34),c.nc(7,"label"),c.bd(8,"Bureau"),c.mc(),c.nc(9,"select",35),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).filter.value=t}))("change",(function(){return c.Rc(e),c.xc(2).refreshSites()})),c.ic(10,"option"),c.Zc(11,bc,2,2,"option",36),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc(2);c.Ub(9),c.Ec("ngModel",e.filter.value),c.Ub(2),c.Ec("ngForOf",e.bureaus)}}function vc(e,t){if(1&e){const e=c.oc();c.nc(0,"a",41),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(3).back(t)})),c.bd(1),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ub(1),c.dd(" ",e.name,"")}}function yc(e,t){if(1&e&&(c.nc(0,"span"),c.nc(1,"b"),c.bd(2),c.mc(),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(2),c.cd(e.name)}}const xc=function(e){return{active:e}};function kc(e,t){if(1&e&&(c.nc(0,"li",43),c.Zc(1,vc,2,1,"a",44),c.Zc(2,yc,3,1,"span",5),c.mc()),2&e){const e=t.last;c.Ec("ngClass",c.Ic(3,xc,e)),c.Ub(1),c.Ec("ngIf",!e),c.Ub(1),c.Ec("ngIf",e)}}function Ec(e,t){if(1&e){const e=c.oc();c.nc(0,"div",3),c.nc(1,"div",38),c.nc(2,"ul",39),c.nc(3,"li"),c.ic(4,"i",40),c.nc(5,"a",41),c.vc("click",(function(){return c.Rc(e),c.xc(2).back(null)})),c.bd(6,"IDM Sites"),c.mc(),c.mc(),c.Zc(7,kc,3,5,"li",42),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(7),c.Ec("ngForOf",e.breadcrumbs)}}function Cc(e,t){1&e&&(c.nc(0,"span"),c.nc(1,"h4"),c.ic(2,"i",46),c.bd(3," Loading Sites "),c.mc(),c.mc())}function wc(e,t){1&e&&(c.nc(0,"span"),c.nc(1,"h4"),c.bd(2,"No Sites in this area."),c.mc(),c.nc(3,"p"),c.bd(4," Zoom out to find sites in other areas of the map. "),c.mc(),c.mc())}function Uc(e,t){if(1&e&&(c.nc(0,"div",45),c.Zc(1,Cc,4,0,"span",5),c.Zc(2,wc,5,0,"span",5),c.mc()),2&e){const e=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(1),c.Ec("ngIf",e.loadingSites),c.Ub(1),c.Ec("ngIf",!e.loadingSites)}}function Ic(e,t){1&e&&(c.nc(0,"div",45),c.nc(1,"h4"),c.bd(2,"No data at this level."),c.mc(),c.nc(3,"p"),c.bd(4," Create data containers as part of the upload process. "),c.mc(),c.mc()),2&e&&c.Ec("@fadeInOnEnter",void 0)}function Mc(e,t){if(1&e){const e=c.oc();c.nc(0,"span",54),c.nc(1,"a",55),c.vc("click",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).handleEdit(n,t)})),c.mc(),c.nc(2,"a",56),c.vc("click",(function(t){c.Rc(e);const n=c.xc(2).$implicit;return c.xc(2).handleDelete(n,t)})),c.mc(),c.mc()}}function Oc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",50),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(2).select(n,null,t)}))("mouseenter",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(2).onListEntityHover(t,n)}))("mouseleave",(function(){return c.Rc(e),c.xc(3).onListEntityHoverOff()})),c.nc(1,"div",51),c.nc(2,"div"),c.nc(3,"h4",52),c.bd(4),c.mc(),c.nc(5,"span"),c.nc(6,"span"),c.nc(7,"b"),c.bd(8),c.mc(),c.bd(9),c.mc(),c.Zc(10,Mc,3,0,"span",53),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ec("@fadeInOnEnter",void 0)("ngClass",c.Ic(6,xc,t.hoverFeatureId===e.id)),c.Ub(4),c.dd(" ",e.name," "),c.Ub(4),c.cd(e.numberOfChildren),c.Ub(1),c.dd(" ",t.getMetadata(e).childLabel,""),c.Ub(1),c.Ec("ngIf","folder"!==e.type)}}function Sc(e,t){if(1&e){const e=c.oc();c.nc(0,"span",65),c.nc(1,"a",55),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(4).handleEdit(n,t)})),c.mc(),c.nc(2,"a",56),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(4).handleDelete(n,t)})),c.mc(),c.mc()}}function Rc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",63),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit,a=c.xc(2).$implicit;return c.xc(2).select(i,a,n)})),c.bd(1),c.Zc(2,Sc,3,0,"span",64),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.name," "),c.Ub(1),c.Ec("ngIf","folder"!==e.type)}}const Tc=function(e){return{"fa-rotate-270":e}};function Pc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",57),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(2).select(n,null,t)})),c.nc(1,"div",58),c.nc(2,"i",59),c.vc("click",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc(2).handleExpand(n,t)})),c.mc(),c.nc(3,"h4",60),c.bd(4),c.mc(),c.nc(5,"p"),c.nc(6,"b"),c.bd(7),c.mc(),c.bd(8),c.mc(),c.nc(9,"div",61),c.Zc(10,Rc,3,2,"div",62),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(2),c.Ec("ngClass",c.Ic(7,Tc,e.active)),c.Ub(2),c.cd(e.name),c.Ub(3),c.cd(e.numberOfChildren),c.Ub(1),c.dd(" ",t.getMetadata(e).childLabel,""),c.Ub(1),c.Ec("collapse",!e.active),c.Ub(1),c.Ec("ngForOf",e.children)}}function Fc(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,Oc,11,8,"div",48),c.Zc(2,Pc,11,9,"div",49),c.mc()),2&e){const e=t.$implicit,n=c.xc(2);c.Ec("@fadeInOnEnter",void 0),c.Ub(1),c.Ec("ngIf",n.getMetadata(e).root),c.Ub(1),c.Ec("ngIf",!n.getMetadata(e).root)}}function Dc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",47),c.nc(1,"div",66),c.nc(2,"div",58),c.nc(3,"h4",60),c.bd(4,"Supporting Data"),c.mc(),c.nc(5,"div",26),c.nc(6,"div",67),c.nc(7,"a",68),c.vc("click",(function(n){c.Rc(e);const i=t.$implicit;return c.xc(2).select(i,null,n)})),c.bd(8),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("@fadeInOnEnter",void 0),c.Ub(7),c.dd(" ",e.name," ")}}function Nc(e,t){if(1&e){const e=c.oc();c.nc(0,"tab",69),c.nc(1,"div",70),c.nc(2,"product-panel",71),c.vc("toggleMapOrtho",(function(t){return c.Rc(e),c.xc(2).handleMapOrtho(t)}))("toggleMapDem",(function(t){return c.Rc(e),c.xc(2).handleMapDem(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(2),c.Ec("id",e.current.id)}}function Zc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",72),c.nc(1,"div",73),c.nc(2,"button",74),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleCreateCollection()})),c.bd(3,"Create Collection"),c.mc(),c.mc(),c.mc()}}function Ac(e,t){if(1&e){const e=c.oc();c.nc(0,"div",72),c.nc(1,"div",73),c.nc(2,"button",74),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleCreate(null,null)})),c.bd(3,"Add new site"),c.mc(),c.mc(),c.mc()}}const jc=function(){return{standalone:!0}};function Lc(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",3),c.nc(2,"div",17),c.Zc(3,fc,12,2,"ng-container",5),c.Zc(4,Ec,8,1,"div",18),c.nc(5,"div",3),c.nc(6,"div",17),c.nc(7,"div",19),c.nc(8,"input",20),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().search=t}))("typeaheadOnSelect",(function(t){return c.Rc(e),c.xc().handleClick(t)}))("keydown.enter",(function(t){return c.Rc(e),t.preventDefault()})),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(9,"div",3),c.nc(10,"div",21),c.nc(11,"tabset",22,23),c.nc(13,"tab",24),c.nc(14,"div",25),c.nc(15,"div",26),c.Zc(16,Uc,3,3,"div",27),c.Zc(17,Ic,5,1,"div",27),c.Zc(18,Fc,3,3,"div",28),c.Zc(19,Dc,9,2,"div",28),c.mc(),c.mc(),c.mc(),c.Zc(20,Nc,3,1,"tab",29),c.mc(),c.mc(),c.mc(),c.nc(21,"footer",30),c.Zc(22,Zc,4,0,"div",31),c.Zc(23,Ac,4,0,"div",31),c.mc(),c.kc()}if(2&e){const e=c.xc(),t=c.Pc(19);c.Ub(3),c.Ec("ngIf",!e.current),c.Ub(1),c.Ec("ngIf",e.current),c.Ub(4),c.Ec("ngModel",e.search)("typeaheadAsync",!0)("typeahead",e.dataSource)("typeaheadOptionsLimit",10)("typeaheadItemTemplate",t)("ngModelOptions",c.Hc(17,jc)),c.Ub(6),c.Xc(null!=e.current?"height: calc(100vh - 296px);overflow-y: auto;overflow-x:hidden;":"height: calc(100vh - 360px);overflow-y: auto;overflow-x:hidden;"),c.Ub(2),c.Ec("ngIf",e.nodes.length<1&&0===e.breadcrumbs.length),c.Ub(1),c.Ec("ngIf",e.nodes.length<1&&e.breadcrumbs.length>0),c.Ub(1),c.Ec("ngForOf",e.nodes),c.Ub(1),c.Ec("ngForOf",e.supportingData),c.Ub(1),c.Ec("ngIf",null!=e.current),c.Ub(2),c.Ec("ngIf",null!=e.current),c.Ub(1),c.Ec("ngIf",null==e.current)}}function _c(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",75),c.nc(2,"layer-panel",76),c.vc("confirm",(function(t){return c.Rc(e),c.xc().handleStacConfirm(t)}))("cancel",(function(){return c.Rc(e),c.xc().handleStacCancel()})),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("layer",e.stacLayer)("bounds",e.bounds)}}function $c(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",77),c.nc(1,"strong"),c.bd(2,"Unfinished upload"),c.mc(),c.bd(3," detected on file "),c.nc(4,"strong"),c.bd(5),c.mc(),c.bd(6," for Collection "),c.nc(7,"strong"),c.bd(8),c.mc(),c.bd(9,". "),c.nc(10,"a",68),c.vc("click",(function(){return c.Rc(e),c.xc().handleExistingTask()})),c.bd(11,"Click to resolve"),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ec("dismissible",!1),c.Ub(5),c.cd(e.existingTask.filename),c.Ub(3),c.cd(e.existingTask.task.collectionLabel)}}function zc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",83),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",68),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().handleViewSite(t.collection)})),c.bd(5,"Goto the collection view"),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". ")}}function Bc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",84),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",85),c.bd(5,"task page"),c.mc(),c.bd(6," for more details. "),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". Task completed with warnings. See the ")}}function Gc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",86),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.nc(4,"a",85),c.bd(5,"task page"),c.mc(),c.bd(6," for more details. "),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". Task completed with errors. See the ")}}function Vc(e,t){if(1&e){const e=c.oc();c.nc(0,"alert",87),c.vc("onClosed",(function(){c.Rc(e);const t=c.xc().index;return c.xc().handleCloseToast(t)})),c.nc(1,"strong"),c.bd(2),c.mc(),c.bd(3),c.mc()}if(2&e){const e=c.xc().$implicit;c.Ec("dismissible",!0),c.Ub(2),c.dd("Upload ",e.status,""),c.Ub(1),c.dd(" for ",e.collectionLabel,". ")}}function qc(e,t){if(1&e&&(c.nc(0,"div",78),c.Zc(1,zc,6,3,"alert",79),c.Zc(2,Bc,7,3,"alert",80),c.Zc(3,Gc,7,3,"alert",81),c.Zc(4,Vc,4,3,"alert",82),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","Complete"===e.status&&0===e.actions.length),c.Ub(1),c.Ec("ngIf","Complete"===e.status&&0!==e.actions.length),c.Ub(1),c.Ec("ngIf","Failed"===e.status),c.Ub(1),c.Ec("ngIf","Failed"!==e.status&&"Complete"!==e.status)}}function Hc(e,t){1&e&&c.ic(0,"i",88)}function Jc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",95),c.nc(1,"boolean-field",96),c.vc("valueChange",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleToggleStacLayer(n)})),c.mc(),c.nc(2,"span",97),c.nc(3,"label",98),c.bd(4),c.mc(),c.nc(5,"span",54),c.nc(6,"a",99),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleStacLayer(n)})),c.mc(),c.nc(7,"a",100),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleRemoveStacLayer(n)})),c.mc(),c.nc(8,"a",101),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleStacZoom(n)})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("value",e.active)("inline",!0),c.Ub(3),c.cd(e.layerName),c.Ub(2),c.Ec("title","Edit "+e.layerName),c.Ub(1),c.Ec("title","Remove "+e.layerName),c.Ub(1),c.Ec("title","Zoom to "+e.layerName)}}function Wc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",90),c.nc(1,"input",102),c.vc("change",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleStyle(n)})),c.mc(),c.nc(2,"label",103),c.bd(3),c.mc(),c.mc()}if(2&e){const e=t.$implicit;c.Ub(1),c.Ec("value",e.id)("checked",e.selected),c.Ub(2),c.cd(e.label)}}function Yc(e,t){if(1&e){const e=c.oc();c.nc(0,"div",89),c.nc(1,"div",90),c.nc(2,"div",26),c.nc(3,"h4"),c.bd(4,"Layers"),c.mc(),c.Zc(5,Jc,9,6,"div",91),c.mc(),c.mc(),c.nc(6,"div",90),c.nc(7,"a",92),c.vc("click",(function(){return c.Rc(e),c.xc().handleStacLayer()})),c.bd(8," Create layer"),c.mc(),c.mc(),c.ic(9,"hr",93),c.nc(10,"h4"),c.bd(11,"Basemaps"),c.mc(),c.Zc(12,Wc,4,3,"div",94),c.mc()}if(2&e){const e=c.xc();c.Ub(5),c.Ec("ngForOf",e.stacLayers),c.Ub(7),c.Ec("ngForOf",e.baseLayers)}}function Xc(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",105),c.mc())}function Kc(e,t){1&e&&(c.nc(0,"span"),c.ic(1,"i",106),c.mc())}function Qc(e,t){if(1&e&&(c.nc(0,"span"),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.dd(" ",e.label," / ")}}function ei(e,t){if(1&e&&(c.Zc(0,Xc,2,0,"span",5),c.Zc(1,Kc,2,0,"span",5),c.nc(2,"span"),c.Zc(3,Qc,2,1,"span",104),c.mc(),c.nc(4,"b"),c.bd(5),c.mc()),2&e){const e=t.match;c.Ec("ngIf",null==e.item.filename),c.Ub(1),c.Ec("ngIf",null!=e.item.filename),c.Ub(2),c.Ec("ngForOf",e.item.hierarchy),c.Ub(2),c.cd(e.item.label)}}class ti{constructor(e,t,n,c,i,a,o){this.service=e,this.authService=t,this.mapService=n,this.modalService=c,this.metadataService=i,this.route=a,this.cookieService=o,this.userName="",this.search="",this.nodes=[],this.supportingData=[],this.breadcrumbs=[],this.admin=!1,this.worker=!1,this.active=!1,this.loadingSites=!0,this.baseLayers=[{label:"Outdoors",id:"outdoors-v11",selected:!0},{label:"Satellite",id:"satellite-v9"},{label:"Streets",id:"streets-v11"}],this.layers=[],this.baselayerIconHover=!1,this.tasks=[],this.existingTask=null,this.filter={field:"bureau",value:""},this.bureaus=[],this.bounds=null,this.sort="name",this.stacLayers=[],this.stacLayer=null,this.viewMode=0,this.subject=new G.b,this.subject.pipe(Object(T.a)(300),Object(P.a)()).subscribe(e=>this.handleExtentChange(e)),this.dataSource=new v.a(e=>{this.mapService.mbForwardGeocode(this.search).then(t=>{const n=t.features;this.service.searchEntites(this.search).then(t=>{n.forEach(e=>{let n={id:e.id,hierarchy:[],label:e.place_name,center:e.center,source:"MAPBOX"};t.push(n)}),e.next(t)})})})}ngOnInit(){this.admin=this.authService.isAdmin(),this.worker=this.authService.isWorker(),this.userName=this.service.getCurrentUser(),this.service.bureaus().then(e=>{this.bureaus=e});let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"UPLOAD_JOB_CHANGE"===e.type&&this.tasks.push(e.content)});const t=this.route.snapshot.params.oid,n=this.route.snapshot.params.action;null!=t&&null!=n&&"collection"===n&&this.handleViewSite(t);let c={debug:!1,autoUpload:!1,multiple:!1,request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,t){},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,t,n,c){},onComplete:function(e,t,n,c){},onCancel:function(e,t){},onError:function(e,t,n){}}};let i=new Yn.FineUploaderBasic(c).getResumableFilesData();if(i.length>0){const e=i[0];this.service.getUploadTask(e.uuid).then(t=>{this.existingTask={task:t,filename:e.name},console.log(this.existingTask)})}}ngOnDestroy(){null!=this.subject&&this.subject.unsubscribe(),this.map.remove(),this.notifier.complete()}ngAfterViewInit(){this.map=new g.Map({container:"map",style:"mapbox://styles/mapbox/outdoors-v11",zoom:2,attributionControl:!1,center:[-78.880453,42.897852]}),this.map.on("load",()=>{this.initMap()})}initMap(){this.map.on("style.load",()=>{this.addLayers(),this.refreshMapPoints(!1)}),this.addLayers(),this.refreshMapPoints(!0),this.map.addControl(new g.NavigationControl,"bottom-right"),this.map.addControl(new g.AttributionControl({compact:!0}),"bottom-left"),this.map.on("mousemove",e=>{let t=e.lngLat.wrap(),n="Lat: "+t.lat+" Long: "+t.lng;document.getElementById("mousemove-panel").textContent=n;let c=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(null==this.current)if(c.length>0){let e=c[0].properties.oid;this.map.setFilter("hover-points",["all",["==","oid",e]]),this.highlightListItem(e)}else this.map.setFilter("hover-points",["all",["==","oid","NONE"]]),this.clearHighlightListItem()}),this.map.on("zoomend",e=>{this.subject.next(e)}),this.map.on("moveend",e=>{this.subject.next(e)}),this.map.on("dblclick",e=>{let t=this.map.queryRenderedFeatures(e.point,{layers:["points"]});if(t.length>0){let e=t[0].properties.oid;this.handleViewSite(e)}}),document.getElementById("navigator-left-sidebar").addEventListener("mouseenter",(function(){document.getElementById("mousemove-panel").textContent=""})),Boolean(this.cookieService.get("acceptedDisclaimer"))||(this.bsModalRef=this.modalService.show(Cn.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.messageTitle="Disclaimer",this.bsModalRef.content.message=window.uasAppDisclaimer,this.bsModalRef.content.submitText="I Accept",this.bsModalRef.content.onConfirm.subscribe(e=>{this.cookieService.set("acceptedDisclaimer","true")}))}addLayers(){this.map.addSource("sites",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),this.map.addLayer({id:"points",type:"circle",source:"sites",paint:{"circle-radius":10,"circle-color":"#800000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"}}),this.map.addLayer({id:"hover-points",type:"circle",source:"sites",paint:{"circle-radius":13,"circle-color":"#cf0000","circle-stroke-width":2,"circle-stroke-color":"#FFFFFF"},filter:["all",["==","id","NONE"]]}),this.map.addLayer({id:"points-label",source:"sites",type:"symbol",paint:{"text-color":"black","text-halo-color":"#fff","text-halo-width":2},layout:{"text-field":"{name}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-offset":[0,.6],"text-anchor":"top","text-size":12}}),this.layers.forEach(e=>{e.isMapped&&this.addImageLayer(e)})}handleExtentChange(e){const t=this.map.getBounds();this.isValidBounds(t)&&(this.bounds=t),null==this.current&&this.refreshSites()}refreshSites(){const e=[];return null!=this.bounds&&e.push({field:"bounds",value:this.bounds}),null!=this.filter.value&&this.filter.value.length>0&&e.push(this.filter),this.refreshMapPoints(!1),this.loadingSites=!0,this.service.roots(null,e,this.sort).then(e=>{this.setNodes(e)}).finally(()=>{this.loadingSites=!1})}isValidBounds(e){const t=e.getNorthEast(),n=e.getSouthWest();return!(Math.abs(t.lng)>180||Math.abs(n.lng)>180)&&!(Math.abs(t.lat)>90||Math.abs(n.lat)>90)}refreshMapPoints(e){const t=[];null!=this.bounds&&t.push({field:"bounds",value:this.bounds}),null!=this.filter.value&&this.filter.value.length>0&&t.push(this.filter),this.mapService.features(t).then(t=>{this.map.getSource("sites").setData(t.features),e&&(this.allPointsBounds=new g.LngLatBounds([t.bbox[0],t.bbox[1]],[t.bbox[2],t.bbox[3]]),this.map.fitBounds(this.allPointsBounds,{padding:50}))})}isData(e){return"Site"!==e.data.type&&("Project"!==e.data.type&&("Mission"!==e.data.type&&("Collection"!==e.data.type&&"Imagery"!==e.data.type)))}handleOnUpdateData(){}handleCloseToast(e){this.tasks.splice(e,1)}handleCreateCollection(){this.bsModalRef=this.modalService.show(Wn,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(this.breadcrumbs),this.bsModalRef.content.onCreateComplete.subscribe(e=>{this.handleViewSite(e)})}handleCreate(e,t){let n=null!=e?e.id:null;this.service.newChild(n,t).then(t=>{this.bsModalRef=this.modalService.show(un,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(!0,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),null!=e&&(this.bsModalRef.content.parentId=e.id),this.bsModalRef.content.onNodeChange.subscribe(t=>{null!=e||(0==this.breadcrumbs.length&&this.nodes.push(t),this.refreshMapPoints(!1))})})}zoomToFeature(e){null!=e.geometry&&this.map.flyTo({center:e.geometry.coordinates})}handleExistingTask(){this.service.view(this.existingTask.task.collection).then(e=>{const t=this.modalService.show(Ee,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"});t.content.init(e.item,this.existingTask.task.uploadTarget),t.content.onUploadCancel.subscribe(()=>{this.existingTask=null}),t.content.onUploadComplete.subscribe(()=>{this.existingTask=null})})}handleEdit(e,t){t.stopPropagation(),this.service.edit(e.id).then(t=>{this.bsModalRef=this.modalService.show(un,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"edit-modal"}),this.bsModalRef.content.init(!1,this.userName,this.admin,t.item,t.attributes,this.map.getCenter(),this.map.getZoom()),this.bsModalRef.content.onNodeChange.subscribe(t=>{t.children=e.children,t.active=e.active,this.refreshEntity(t,this.nodes),this.refreshEntity(t,this.breadcrumbs),this.nodes.forEach(e=>{this.refreshEntity(t,e.children)}),this.metadataService.getMetadata(t).root&&this.refreshMapPoints(!1)})})}refreshEntity(e,t){if(null!=t){let n=t.findIndex(t=>t.id===e.id);-1!==n&&(t[n]=e)}}handleDownloadAll(e){window.location.href=acp+"/project/download-all?id="+e.component+"&key="+e.name}handleDelete(e,t){t.stopPropagation();let n="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files in Collections and Accessible Support";"Collection"===e.type&&(n="<b>IMPORTANT:</b> ["+e.name+"] will be deleted along with all underlying data including all files."),n+=" This can <b>NOT</b> be undone",this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.name+"]?",this.bsModalRef.content.subText=n,this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.remove(e)})}remove(e){this.service.remove(e.id).then(()=>{this.nodes=this.nodes.filter(t=>t.id!==e.id),this.nodes.forEach(t=>{null!=t.children&&(t.children=t.children.filter(t=>t.id!==e.id),t.numberOfChildren=t.children.length)}),"Site"===e.type&&this.refreshMapPoints(!1)})}handleDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleImageDownload(e){window.location.href=acp+"/project/download?id="+e.component+"&key="+e.key}handleStyle(e){this.baseLayers.forEach(e=>{e.selected=!1}),e.selected=!0,this.map.setStyle("mapbox://styles/mapbox/"+e.id)}highlightMapFeature(e){this.map.setFilter("hover-points",["all",["==","oid",e]])}clearHighlightMapFeature(){this.map.setFilter("hover-points",["all",["==","oid","NONE"]])}onListEntityHover(e,t){null==this.current&&this.highlightMapFeature(t.id)}onListEntityHoverOff(){this.clearHighlightMapFeature()}highlightListItem(e){this.nodes.forEach(t=>{t.id===e&&(this.hoverFeatureId=e)})}clearHighlightListItem(){this.hoverFeatureId&&this.nodes.forEach(e=>{e.id===this.hoverFeatureId&&(this.hoverFeatureId=null)})}handleClick(e){let t=e.item;if(t.center)this.map.flyTo({center:t.center,zoom:18});else{const e=t.hierarchy.length-1,n=t.hierarchy[e];this.handleViewSite(n.id)}}handleViewSite(e){this.service.view(e).then(e=>{const t=e.item,n=e.breadcrumbs;if(this.getMetadata(t).leaf)this.breadcrumbs=n,this.current=n[n.length-1],this.nodes=this.current.children,this.select(t,null,null);else{const e=n.length>0?n[n.length-1]:null;this.breadcrumbs=n,this.select(t,e,null)}})}handleMapOrtho(e){const t=this.getLayerByClassification("ORTHO",e);if(null!=t&&null!=t.key)if(null!=this.map.getLayer(t.key))this.map.removeLayer(t.key),this.map.removeSource(t.key),t.isMapped=!1,e.orthoMapped=!1;else if(this.addImageLayer(t),t.isMapped=!0,e.orthoMapped=!0,null!=e.boundingBox){let t=e.boundingBox,n=new g.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(n,{padding:50})}}getLayerByClassification(e,t){let n=t.layers.length;for(let c=0;c<n;++c){let n=t.layers[c];if(n.classification===e)return n}return null}handleMapDem(e){const t=this.getLayerByClassification("DEM_DSM",e);if(null!=t&&null!=t.key)if(null!=this.map.getLayer(t.key))this.map.removeLayer(t.key),this.map.removeSource(t.key),t.isMapped=!1,e.demMapped=!1;else if(this.addImageLayer(t),t.isMapped=!0,e.demMapped=!0,null!=e.boundingBox){let t=e.boundingBox,n=new g.LngLatBounds([t[0],t[2]],[t[1],t[3]]);this.map.fitBounds(n,{padding:50})}}addImageLayer(e){let t=e.url;""!==acp&&null!=acp&&(t=acp+"/"+t),t.startsWith("/")||(t="/"+t),this.map.addLayer({id:e.key,type:"raster",source:{type:"raster",url:t},paint:{}},"points"),this.layers.push(e)}removeImageLayer(e){this.map.removeLayer(e),this.map.removeSource(e),this.layers=this.layers.filter(t=>t.key!==e)}handleGoto(){var e=new g.LngLatBounds([-111.12439336274211,39.32066259372583,-111.12342302258116,39.32107716199166]);this.map.fitBounds(e)}getMetadata(e){return this.metadataService.getMetadata(e)}select(e,t,n){if(null!=n&&n.stopPropagation(),null!=e&&null!=e.geometry&&"Point"===e.geometry.type&&this.map.easeTo({center:e.geometry.coordinates,zoom:8}),this.metadataService.getMetadata(e).leaf){const n=[...this.breadcrumbs];null!=t&&n.push(t),this.metadataService.getTypeContainsFolders(e)?this.service.getItems(e.id,null).then(t=>{this.showLeafModal(e,t,n)}):this.showLeafModal(this.current,[e],n)}else"object"===e.type||this.service.getItems(e.id,null).then(n=>{this.current=e,null!=t&&this.addBreadcrumb(t),this.addBreadcrumb(e),this.setNodes(n)})}addBreadcrumb(e){0!=this.breadcrumbs.length&&this.breadcrumbs[this.breadcrumbs.length-1].id===e.id||this.breadcrumbs.push(e)}handleExpand(e,t){null!=t&&t.stopPropagation(),null==e.children||0==e.children.length?this.service.getItems(e.id,null).then(t=>{e.children=t,this.expand(e)}):(e.children=[],e.active=!1)}handleGotoSite(e){const t=e.entities[e.entities.length-1],n=e.entities;this.service.getItems(t.id,null).then(e=>{this.showLeafModal(t,e,n)})}back(e){null!=e?(null!=e.geometry&&"Point"===e.geometry.type&&this.map.easeTo({center:e.geometry.coordinates,zoom:8}),this.service.getItems(e.id,null).then(t=>{var n=this.breadcrumbs.findIndex(t=>t.id===e.id);this.current=e,this.breadcrumbs.splice(n+1),this.setNodes(t)})):this.breadcrumbs.length>0&&this.refreshSites().then(()=>{this.breadcrumbs=[],this.staticTabs.tabs[0].active=!0,this.map.fitBounds(this.allPointsBounds,{padding:50});let e=this;window.setTimeout((function(){e.current=null}),500)})}expand(e){e.active=!0,this.current=e}setNodes(e){this.nodes=[],this.supportingData=[],e.forEach(e=>{"folder"===e.type?this.supportingData.push(e):this.nodes.push(e)})}showLeafModal(e,t,n){"Mission"===e.type?(this.bsModalRef=this.modalService.show(En,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,n)):(this.bsModalRef=this.modalService.show(Et,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal modal-lg"}),this.bsModalRef.content.init(e,t,n))}handleStacLayer(e){this.viewMode=1,this.stacLayer=null!=e?JSON.parse(JSON.stringify(e)):null}handleRemoveStacLayer(e){e.active&&this.hideStacLayer(e),this.stacLayers=this.stacLayers.filter(t=>t.id!==e.id)}handleStacConfirm(e){const t=this.stacLayers.findIndex(t=>t.id===e.id);-1!==t?(this.stacLayers[t].active&&this.hideStacLayer(this.stacLayers[t]),this.stacLayers[t]=e):this.stacLayers.push(e),e.active&&(this.handleStacZoom(e),this.showStacLayer(e)),this.viewMode=0,this.stacLayer=null}handleStacZoom(e){const t=e.items.map(e=>Object(Xn.bboxPolygon)(e.bbox)),n=Object(Xn.featureCollection)(t),c=Object(Xn.envelope)(n),i=Object(Xn.bbox)(c);this.map.fitBounds(i)}handleStacCancel(){this.viewMode=0,this.stacLayer=null}handleToggleStacLayer(e){e.active=!e.active,e.active?this.showStacLayer(e):this.hideStacLayer(e)}showStacLayer(e){e.items.forEach(t=>{const n=t.links.findIndex(e=>"self"===e.rel),c=t.links[n];let i="/stac/tilejson.json";i+="?url="+encodeURIComponent(c.href),i+="&assets="+encodeURIComponent(t.asset),this.addImageLayer({classification:"ORTHO",key:e.id+"-"+t.id+"-"+t.asset,isMapped:e.active,public:!0,url:i})})}hideStacLayer(e){e.items.forEach(t=>{this.removeImageLayer(e.id+"-"+t.id+"-"+t.asset)})}}ti.ɵfac=function(e){return new(e||ti)(c.hc(A),c.hc(Z.a),c.hc(k),c.hc(j.b),c.hc(te),c.hc(a.a),c.hc(Kn.a))},ti.ɵcmp=c.bc({type:ti,selectors:[["projects"]],viewQuery:function(e,t){var n;(1&e&&(c.fd(uc,!0),c.fd(gc,!0)),2&e)&&(c.Oc(n=c.wc())&&(t.staticTabs=n.first),c.Oc(n=c.wc())&&(t.confirmTemplate=n.first))},decls:20,vars:7,consts:[["id","navigator-header-container"],[3,"title"],["id","app-container",1,"container-fluid",2,"background","#f7f7f7"],[1,"row"],["id","navigator-left-sidebar",1,"col-md-3","lw-inner-col"],[4,"ngIf"],["id","site-explorer-map",1,"col-md-9"],[2,"position","absolute","z-index","5","margin-left","100px","margin-top","10px"],["type","danger",3,"dismissible",4,"ngIf"],["class","idm-toast",4,"ngFor","ngForOf"],[1,"base-layer-panel"],[1,"layer-toggle",2,"cursor","pointer","background","#fff","padding","8px","border-radius","4px",3,"mouseenter","mouseleave"],["class","fas fa-layer-group","style","vertical-align:middle; font-size: 18px;",4,"ngIf"],["style","width: 200px;",4,"ngIf"],["id","mousemove-panel",1,"mapboxgl-ctrl-bottom-right",2,"background","rgba(255, 255, 255, .5)","right","0","padding","0 5px 0 5px","bottom","0px"],["id","map",1,"map-view-port"],["bsItemTemplate",""],[1,"col-md-12"],["class","row",4,"ngIf"],[1,"location-management-widget-section"],["type","text","placeholder","Search...","typeaheadOptionField","label",1,"form-control","search-input",3,"ngModel","typeaheadAsync","typeahead","typeaheadOptionsLimit","typeaheadItemTemplate","ngModelOptions","ngModelChange","typeaheadOnSelect","keydown.enter"],[1,"col-md-12",2,"background","#f7f7f7","padding","0","height","100%"],[1,"nav-full-width"],["staticTabs",""],["heading","Data"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container"],[1,"list-group"],["style","padding: 20px;text-align: center;color: grey;",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["heading","Products",4,"ngIf"],[1,"sidebar-footer"],["class","row","style","background:white;",4,"ngIf"],[1,"col-md-6",2,"height","64px"],[2,"font-weight","bold"],[1,"col-sm-12"],["name","filter",3,"ngModel","ngModelChange","change"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"col-md-12",2,"height","65px","overflow","auto"],[1,"breadcrumb",2,"background-color","white","vertical-align","middle","line-height","2"],["aria-hidden","true",1,"fa","fa-angle-left","breadcrumb-back-ico"],[2,"color","#007276",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["style","color: #007276;",3,"click",4,"ngIf"],[2,"padding","20px","text-align","center","color","grey"],["aria-hidden","true",1,"fa","fa-spinner","fa-spin"],[1,"list-group-item"],["style","border-left: solid 15px;","class","card card-default clickable",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","card card-default clickable",3,"click",4,"ngIf"],[1,"card","card-default","clickable",2,"border-left","solid 15px",3,"ngClass","click","mouseenter","mouseleave"],[1,"card-body","card-5-7"],[2,"word-break","break-all","border-bottom-color","rgba(195, 195, 195, 0.3)","border-bottom-style","inset","border-bottom-width","2px","margin-bottom","10px","padding-bottom","10px"],["class","pull-right",4,"ngIf"],[1,"pull-right"],["title","Edit",1,"fa","fa-pencil-alt","ico-edit",3,"click"],["title","Delete",1,"fa","fa-trash-alt","ico-remove",3,"click"],[1,"card","card-default","clickable",3,"click"],[1,"card-body"],["aria-hidden","true",1,"fa","fa-caret-left","expand-arrow-ico","pull-right",2,"font-size","25px","padding","0 5px",3,"ngClass","click"],[2,"word-break","break-all"],[1,"list-group",2,"margin-bottom","0",3,"collapse"],["class","list-group-item","style","background-color: #ececec;border: solid 1px lightgrey;border-radius: 0;",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0",3,"click"],["class","pull-right button-column",4,"ngIf"],[1,"pull-right","button-column"],[1,"card","card-default"],[1,"list-group-item",2,"background-color","#ececec","border","solid 1px lightgrey","border-radius","0"],[3,"click"],["heading","Products"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container",2,"height","calc(100vh - 296px)","overflow-y","auto","overflow-x","hidden"],[3,"id","toggleMapOrtho","toggleMapDem"],[1,"row",2,"background","white"],[1,"col-md-12",2,"text-align","center","padding","10px","border-top","1px solid lightgrey"],[1,"btn","btn-primary",3,"click"],["id","hierarchy-tree-container",1,"location-management-widget-section","location-management-list-container",2,"height","calc(100vh - 50px)","overflow-y","auto","overflow-x","hidden"],[3,"layer","bounds","confirm","cancel"],["type","danger",3,"dismissible"],[1,"idm-toast"],["type","success",3,"dismissible","onClosed",4,"ngIf"],["type","warning",3,"dismissible","onClosed",4,"ngIf"],["type","danger",3,"dismissible","onClosed",4,"ngIf"],["type","info",3,"dismissible","onClosed",4,"ngIf"],["type","success",3,"dismissible","onClosed"],["type","warning",3,"dismissible","onClosed"],["routerLink","/site/tasks"],["type","danger",3,"dismissible","onClosed"],["type","info",3,"dismissible","onClosed"],[1,"fas","fa-layer-group",2,"vertical-align","middle","font-size","18px"],[2,"width","200px"],[1,"row-form"],["class","list-group-item","style","padding:0;height:30px;",4,"ngFor","ngForOf"],["title","Create a layer",1,"fa","fa-plus",3,"click"],[2,"margin-top","10px","margin-bottom","10px"],["class","row-form",4,"ngFor","ngForOf"],[1,"list-group-item",2,"padding","0","height","30px"],["label","",3,"value","inline","valueChange"],[2,"padding-top","2px"],[2,"padding-left","5px"],[1,"fa","fa-pencil-alt","ico-edit",3,"title","click"],[1,"fa","fa-trash-alt","ico-remove",3,"title","click"],[1,"fa","fa-eye",3,"title","click"],["type","radio","name","rtoggle",1,"layer-toggle-input",3,"value","checked","change"],[1,"layer-toggle-label",2,"padding-left","5px"],[4,"ngFor","ngForOf"],[1,"fa","fa-folder-open"],[1,"fa","fa-file"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.ic(1,"uasdm-header",1),c.mc(),c.nc(2,"div",2),c.nc(3,"div",3),c.nc(4,"div",4),c.Zc(5,Lc,24,18,"ng-container",5),c.Zc(6,_c,3,2,"ng-container",5),c.mc(),c.nc(7,"div",6),c.nc(8,"div",3),c.nc(9,"article",7),c.Zc(10,$c,12,3,"alert",8),c.Zc(11,qc,5,4,"div",9),c.mc(),c.nc(12,"article",10),c.nc(13,"div",11),c.vc("mouseenter",(function(){return t.baselayerIconHover=!0}))("mouseleave",(function(){return t.baselayerIconHover=!1})),c.Zc(14,Hc,1,0,"i",12),c.Zc(15,Yc,13,2,"div",13),c.mc(),c.mc(),c.ic(16,"div",14),c.ic(17,"div",15),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(18,ei,6,4,"ng-template",null,16,c.ad)),2&e&&(c.Ub(1),c.Ec("title","Site Viewer"),c.Ub(4),c.Ec("ngIf",0===t.viewMode),c.Ub(1),c.Ec("ngIf",1===t.viewMode),c.Ub(4),c.Ec("ngIf",null!=t.existingTask),c.Ub(1),c.Ec("ngForOf",t.tasks),c.Ub(3),c.Ec("ngIf",!t.baselayerIconHover),c.Ub(1),c.Ec("ngIf",t.baselayerIconHover))},directives:[Qn.a,i.t,i.s,o.c,o.k,o.n,r.b,p.e,p.b,o.w,o.p,o.y,i.q,u.a,tn,hc,m.a,a.e,we.a],styles:["./projects.css"],data:{animation:[Object(Y.c)(),Object(Y.d)()]}});var ni=n(54);const ci=["uploader"];function ii(e,t){1&e&&(c.nc(0,"div",3),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"h4",6),c.bd(4," There are no Sites added to the system. Add a Site, Project, Mission, and Collection using the "),c.nc(5,"a",7),c.bd(6,"Site Viewer"),c.mc(),c.bd(7," before uploading data to. "),c.mc(),c.mc(),c.ic(8,"div",4),c.mc())}function ai(e,t){if(1&e){const e=c.oc();c.nc(0,"div",17),c.nc(1,"div",18),c.nc(2,"div",19),c.bd(3,"Partial Upload Detected"),c.mc(),c.nc(4,"div",20),c.nc(5,"h4"),c.bd(6,"A partial upload was detected. You can either cancel that partial upload or attempt to continue."),c.mc(),c.nc(7,"h4"),c.nc(8,"b"),c.bd(9,"To continue an upload"),c.mc(),c.bd(10," please click the Continue Upload button and re-upload your file and we will try our best to continue where you left off. "),c.mc(),c.ic(11,"hr"),c.nc(12,"button",21),c.vc("click",(function(t){return c.Rc(e),c.xc(2).removeUpload(t)})),c.ic(13,"i",16),c.bd(14," Cancel Upload "),c.mc(),c.nc(15,"button",22),c.vc("click",(function(){return c.Rc(e),c.xc(2).showUploadPanel()})),c.ic(16,"i",16),c.bd(17," Continue Upload "),c.mc(),c.mc(),c.mc(),c.mc()}}function oi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"div",19),c.bd(2," Upload Details "),c.nc(3,"i",24),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).closeTaskFinishedNotification(n.id)})),c.mc(),c.mc(),c.nc(4,"div",20),c.nc(5,"h4"),c.bd(6," Status: "),c.nc(7,"b"),c.bd(8," Upload successfully completed "),c.mc(),c.mc(),c.nc(9,"h4"),c.bd(10," Message: "),c.nc(11,"b"),c.bd(12," Your uploaded data is being processed into final image products. "),c.mc(),c.mc(),c.mc(),c.mc()}}function si(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function li(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function ri(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.cd(e.name)}}function di(e,t){if(1&e&&(c.nc(0,"option",38),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.id),c.Ub(1),c.dd("",e.name," ")}}function pi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.nc(1,"div",26),c.nc(2,"label",27),c.bd(3,"Site:"),c.mc(),c.nc(4,"select",28),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onSiteSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.site=t})),c.ic(5,"option"),c.Zc(6,si,2,2,"option",29),c.mc(),c.mc(),c.nc(7,"div",26),c.nc(8,"label",30),c.bd(9,"Project:"),c.mc(),c.nc(10,"select",31),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onProjectSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.project=t})),c.ic(11,"option"),c.Zc(12,li,2,2,"option",29),c.mc(),c.mc(),c.nc(13,"div",26),c.nc(14,"label",32),c.bd(15,"Mission:"),c.mc(),c.nc(16,"select",33),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onMissionSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.mission=t})),c.ic(17,"option"),c.Zc(18,ri,2,2,"option",29),c.mc(),c.mc(),c.nc(19,"div",26),c.nc(20,"label",34),c.bd(21,"Collection:"),c.mc(),c.nc(22,"select",35),c.vc("change",(function(t){return c.Rc(e),c.xc(2).onCollectionSelect(t.target.value)}))("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.collection=t})),c.ic(23,"option"),c.Zc(24,di,2,2,"option",29),c.mc(),c.mc(),c.nc(25,"div",26),c.nc(26,"label",36),c.bd(27,"Output Product Name Prefix"),c.mc(),c.nc(28,"input",37),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).values.outFileName=t})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc(2);c.Ub(4),c.Ec("ngModel",e.values.site),c.Ub(2),c.Ec("ngForOf",e.sites),c.Ub(4),c.Ec("ngModel",e.values.project),c.Vb("disabled",null==e.values.site?"":null),c.Ub(2),c.Ec("ngForOf",e.projects),c.Ub(4),c.Ec("ngModel",e.values.mission),c.Vb("disabled",null==e.values.project?"":null),c.Ub(2),c.Ec("ngForOf",e.missions),c.Ub(4),c.Ec("ngModel",e.values.collection),c.Vb("disabled",null==e.values.mission?"":null),c.Ub(2),c.Ec("ngForOf",e.collections),c.Ub(4),c.Ec("ngModel",e.values.outFileName)}}function mi(e,t){if(1&e&&(c.nc(0,"div",18),c.nc(1,"div",19),c.bd(2,"Upload Details"),c.mc(),c.nc(3,"div",20),c.nc(4,"h4"),c.bd(5," Status: "),c.nc(6,"b"),c.bd(7),c.mc(),c.mc(),c.nc(8,"h4"),c.bd(9," Message: "),c.nc(10,"b"),c.bd(11),c.mc(),c.mc(),c.nc(12,"h4"),c.bd(13," Upload Started On: "),c.nc(14,"b"),c.bd(15),c.yc(16,"idmdate"),c.mc(),c.mc(),c.nc(17,"h4"),c.bd(18," Last Updated: "),c.nc(19,"b"),c.bd(20),c.yc(21,"idmdate"),c.mc(),c.mc(),c.nc(22,"h4"),c.bd(23," Elapsed Time: "),c.nc(24,"b"),c.bd(25),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.dd(" ",e.currentTask.status," "),c.Ub(4),c.dd(" ",e.currentTask.message," "),c.Ub(4),c.dd(" ",c.zc(16,5,e.currentTask.createDate)," "),c.Ub(5),c.dd(" ",c.zc(21,7,e.currentTask.lastUpdateDate)," "),c.Ub(5),c.dd(" ",e.uploadCounter," ")}}function hi(e,t){1&e&&c.ic(0,"div",39,40)}function ui(e,t){if(1&e){const e=c.oc();c.nc(0,"div",3),c.ic(1,"div",4),c.nc(2,"div",5),c.nc(3,"form",null,8),c.Zc(5,ai,18,0,"div",9),c.Zc(6,oi,13,0,"div",10),c.Zc(7,pi,29,12,"div",11),c.nc(8,"div",12),c.Zc(9,mi,26,9,"div",13),c.Zc(10,hi,2,0,"div",14),c.nc(11,"button",15),c.vc("click",(function(){return c.Rc(e),c.xc().handleUpload()})),c.ic(12,"i",16),c.bd(13," Upload "),c.mc(),c.mc(),c.mc(),c.mc(),c.ic(14,"div",4),c.mc()}if(2&e){const e=c.Pc(4),t=c.xc();c.Ub(5),c.Ec("ngIf",t.existingTask&&!t.currentTask),c.Ub(1),c.Ec("ngForOf",t.taskFinishedNotifications),c.Ub(1),c.Ec("ngIf",!t.disabled&&!t.existingTask),c.Ub(1),c.Ec("hidden",!t.uploadVisible),c.Ub(1),c.Ec("ngIf",t.currentTask),c.Ub(1),c.Ec("ngIf",t.showFileSelectPanel),c.Ub(1),c.Ec("disabled",!e.valid||t.disabled)}}class gi{constructor(e,t,n){this.service=e,this.modalService=t,this.sites=[],this.projects=[],this.missions=[],this.collections=[],this.values={create:!1},this.uploader=null,this.disabled=!1,this.taskStatusMessages=[],this.currentTask=null,this.existingTask=!1,this.pollingIsSet=!1,this.uploadVisible=!0,this.selectedContinue=!1,this.uploadCounter="00:00:00",this.showFileSelectPanel=!1,this.taskFinishedNotifications=[],this.differ=n.find([]).create()}ngDoCheck(){if(this.uploader){this.differ.diff(this.uploader)&&this.setExistingTask()}}set content(e){const t=this;if(null!=e&&null==this.uploader){let n={debug:!1,autoUpload:!1,multiple:!1,element:e.nativeElement,template:"qq-template",request:{endpoint:acp+"/file/upload",forceMultipart:!0},resume:{enabled:!0,recordsExpireIn:1},chunking:{enabled:!0},retry:{enableAuto:!0},text:{defaultResponseError:"Upload failed"},failedUploadTextDisplay:{mode:"none"},validation:{allowedExtensions:["zip","tar.gz"]},showMessage:function(e){},callbacks:{onUpload:function(e,n){t.disabled=!0,t.countUpload(t)},onProgress:function(e,t,n,c){},onUploadChunk:function(e,t,n){},onUploadChunkSuccess:function(e,n,c,i){c.message&&c.message.currentTask&&!t.currentTask&&(t.currentTask=c.message.currentTask),t.currentTask&&!t.pollingIsSet&&(t.pollingIsSet=!0,t.taskPolling=Object(X.a)(2e3).pipe(Object(F.a)(()=>{if(t.currentTask)return t.service.task(t.currentTask.oid)})).pipe(Object(K.a)(e=>e)).subscribe(e=>{t.currentTask=e.task}))},onComplete:function(e,n,c,i){t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),this.clearStoredFiles(),clearInterval(t.uplodeCounterInterfal),t.taskFinishedNotifications.push({id:e})},onCancel:function(e,n){t.currentTask&&t.currentTask.uploadId&&t.service.removeTask(t.currentTask.uploadId).then(()=>{this.clearStoredFiles()}).catch(e=>{this.error(e)}),t.disabled=!1,t.currentTask=null,t.existingTask=!1,t.taskPolling&&(t.taskPolling.unsubscribe(),t.pollingIsSet=!1),clearInterval(t.uplodeCounterInterfal)},onError:function(e,n,c){t.error(c)}}};this.uploader=new Q.FineUploader(n)}}ngAfterViewInit(){}ngOnInit(){this.service.roots(null,null).then(e=>{this.sites=e})}closeTaskFinishedNotification(e){let t=this.taskFinishedNotifications.length;for(;t--;){e===this.taskFinishedNotifications[t].id&&this.taskFinishedNotifications.splice(t,1)}}setExistingTask(){this.uploader.getResumableFilesData().length>0&&(this.existingTask=!0,this.selectedContinue||this.hideUploadPanel())}onSiteSelect(e){this.values.site=e,null!=e&&e.length>0&&(this.projects=[],this.missions=[],this.collections=[],this.values.project=null,this.values.mission=null,this.values.collection=null,this.service.getChildren(this.values.site).then(e=>{this.projects=e}))}onProjectSelect(e){this.values.project=e,this.missions=[],this.collections=[],this.values.mission=null,this.values.collection=null,null!=e&&e.length>0&&this.service.getChildren(this.values.project).then(e=>{this.missions=e.filter(e=>"Mission"===e.type)})}onMissionSelect(e){this.values.mission=e,this.collections=[],this.values.collection=null,this.values.name=null,null!=e&&e.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}handleChange(){this.collections=[],this.values.collection=null,this.values.name=null,null!=this.values.mission&&this.values.mission.length>0&&!this.values.create&&this.service.getChildren(this.values.mission).then(e=>{this.collections=e})}onCollectionSelect(e){this.values.collection=e,this.values.uasComponentOid=e,e&&e.trim().length>0?this.showFileSelectPanel=!0:this.showFileSelectPanel=!1}handleUpload(){this.values.create||null!=this.values.collection||this.existingTask?!this.values.create||null!=this.values.mission&&null!=this.values.name&&0!=this.values.name.length||this.existingTask?(this.uploader.setParams(this.values),this.uploader.uploadStoredFiles()):(this.bsModalRef=this.modalService.show(ni.a,{backdrop:!0}),this.bsModalRef.content.message="Name is required"):(this.bsModalRef=this.modalService.show(ni.a,{backdrop:!0}),this.bsModalRef.content.message="A collection must first be selected before the file can be uploaded")}removeUpload(e){let t=this;this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to cancel the upload of ["+this.uploader.getResumableFilesData()[0].name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Cancel Upload",this.bsModalRef.content.onConfirm.subscribe(e=>{this.service.removeTask(this.uploader.getResumableFilesData()[0].uuid).then(()=>{localStorage.clear(),t.existingTask=!1,t.showUploadPanel()})})}hideUploadPanel(){this.uploadVisible=!1}showUploadPanel(){this.uploadVisible=!0,this.selectedContinue=!0}countUpload(e){let t=0;e.uplodeCounterInterfal=setInterval((function(){t+=1;let n=Math.floor(t/3600),c=Math.floor(t%3600/60),i=Math.floor(t%60),a=c<10?"0"+n:n,o=c<10?"0"+c:c,s=i<10?"0"+i:i;e.uploadCounter=a+":"+o+":"+s}),1e3)}canDeactivate(){return this.disabled}unloadNotification(e){this.disabled&&(e.returnValue="An upload is currently in progress. Are you sure you want to leave?")}error(e){null!==e&&(this.bsModalRef=this.modalService.show(ni.a,{backdrop:!0}),this.bsModalRef.content.message=e)}}function bi(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1,"Sensor: "),c.nc(2,"b"),c.bd(3),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(3),c.cd(e.sensorName)}}function fi(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return t.showError=!t.showError})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2).$implicit;c.Ub(1),c.dd("",e.showError?"Hide":"Show"," Messages")}}gi.ɵfac=function(e){return new(e||gi)(c.hc(A),c.hc(j.b),c.hc(c.E))},gi.ɵcmp=c.bc({type:gi,selectors:[["upload"]],viewQuery:function(e,t){var n;(1&e&&c.fd(ci,!0),2&e)&&(c.Oc(n=c.wc())&&(t.content=n.first))},hostBindings:function(e,t){1&e&&c.vc("beforeunload",(function(e){return t.unloadNotification(e)}),!1,c.Qc)},decls:4,vars:3,consts:[[3,"title"],["id","app-container",1,"container"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-2"],[1,"col-md-8"],[2,"margin-top","50px"],["routerlink","/viewer","routerlinkactive","active","href","#/viewer"],["ngForm","ngForm"],["class","",4,"ngIf"],["class","panel panel-success","style","margin: 30px 0 30px 0;",4,"ngFor","ngForOf"],["style","margin-top: 30px;","class","",4,"ngIf"],[1,"",3,"hidden"],["class","panel panel-warning","style","margin: 30px 0 30px 0;",4,"ngIf"],["class","uploader-container","style","margin-top: 20px;",4,"ngIf"],["type","button btn btn-primary",1,"btn","btn-primary",2,"margin-top","20px",3,"disabled","click"],[1,"icon-upload","icon-white"],[1,""],[1,"panel","panel-warning",2,"margin","30px 0 30px 0"],[1,"panel-heading",2,"font-size","20px"],[1,"panel-body"],["type","button",1,"btn","btn-danger",2,"margin-top","20px",3,"click"],["type","button",1,"btn","btn-primary",2,"margin-top","20px",3,"click"],[1,"panel","panel-success",2,"margin","30px 0 30px 0"],[1,"fa","fa-times","btn","btn-close","pull-right",2,"min-width","20px","padding","0","line-height","27px",3,"click"],[1,"",2,"margin-top","30px"],[1,"form-group"],["for","site"],["name","site","required","",3,"ngModel","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","project"],["name","project","required","",3,"ngModel","change","ngModelChange"],["for","mission"],["name","mission","required","",3,"ngModel","change","ngModelChange"],["for","collection"],["name","collection","required","",3,"ngModel","change","ngModelChange"],["for","outFileName"],["name","outFileName","type","input","placeholder","Output product name prefix...",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],[1,"uploader-container",2,"margin-top","20px"],["uploader",""]],template:function(e,t){1&e&&(c.ic(0,"uasdm-header",0),c.nc(1,"div",1),c.Zc(2,ii,9,0,"div",2),c.Zc(3,ui,15,7,"div",2),c.mc()),2&e&&(c.Ec("title","Data Upload"),c.Ub(2),c.Ec("ngIf",0===t.sites.length),c.Ub(1),c.Ec("ngIf",t.sites.length>0))},directives:[Qn.a,i.t,o.z,o.l,o.m,i.s,o.w,o.v,o.k,o.n,o.p,o.y,o.c],pipes:[He.a],encapsulation:2});const vi=function(e,t,n){return{success:e,pending:t,fail:n}};function yi(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"ul",12),c.nc(2,"li"),c.bd(3,"Status: "),c.nc(4,"b",6),c.bd(5),c.mc(),c.mc(),c.nc(6,"li"),c.bd(7,"Created on: "),c.nc(8,"b"),c.bd(9),c.yc(10,"idmdate"),c.mc(),c.mc(),c.nc(11,"li"),c.bd(12,"Last update: "),c.nc(13,"b"),c.bd(14),c.yc(15,"idmdate"),c.mc(),c.mc(),c.nc(16,"li",13),c.bd(17,"Message: "),c.nc(18,"b"),c.bd(19),c.mc(),c.mc(),c.Zc(20,bi,4,1,"li",10),c.mc(),c.nc(21,"div",14),c.nc(22,"div",15),c.nc(23,"div",16),c.Zc(24,fi,2,1,"button",17),c.nc(25,"button",18),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().removeTask(t)})),c.bd(26,"Delete Task"),c.mc(),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(4),c.Ec("ngClass",c.Kc(11,vi,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),c.Ub(1),c.cd(e.status),c.Ub(4),c.cd(c.zc(10,7,e.createDate)),c.Ub(5),c.cd(c.zc(15,9,e.lastUpdateDate)),c.Ub(5),c.cd(e.message),c.Ub(1),c.Ec("ngIf","Upload"==t.taskCategory),c.Ub(4),c.Ec("ngIf",e.actions.length>0)}}function xi(e,t){if(1&e&&(c.nc(0,"li"),c.bd(1,"Sensor: "),c.nc(2,"b"),c.bd(3),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(3),c.cd(e.sensorName)}}function ki(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(2).$implicit;return t.showError=!t.showError})),c.bd(1),c.mc()}if(2&e){const e=c.xc(2).$implicit;c.Ub(1),c.dd("",e.showError?"Hide":"Show"," Messages")}}function Ei(e,t){if(1&e){const e=c.oc();c.nc(0,"button",19),c.vc("click",(function(){c.Rc(e);const t=c.xc(3);return t.showODMOutput=!t.showODMOutput})),c.bd(1,"Show Detailed Log Output"),c.mc()}}function Ci(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"h4"),c.bd(3,"Output:"),c.mc(),c.ic(4,"textarea",20),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(4),c.Ec("innerHTML",e.odmOutput,c.Sc)}}function wi(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"ul",12),c.nc(2,"li"),c.bd(3,"Status: "),c.nc(4,"b",6),c.bd(5),c.mc(),c.mc(),c.nc(6,"li"),c.bd(7,"Message: "),c.nc(8,"b"),c.bd(9),c.mc(),c.mc(),c.nc(10,"li"),c.bd(11,"Created on: "),c.nc(12,"b"),c.bd(13),c.yc(14,"idmdate"),c.mc(),c.mc(),c.nc(15,"li"),c.bd(16,"Last update: "),c.nc(17,"b"),c.bd(18),c.yc(19,"idmdate"),c.mc(),c.mc(),c.Zc(20,xi,4,1,"li",10),c.mc(),c.nc(21,"div",14),c.nc(22,"div",15),c.nc(23,"div",16),c.Zc(24,ki,2,1,"button",17),c.Zc(25,Ei,2,0,"button",17),c.nc(26,"button",18),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc().removeTask(t)})),c.bd(27,"Delete Task"),c.mc(),c.mc(),c.mc(),c.mc(),c.Zc(28,Ci,5,1,"div",11),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ub(4),c.Ec("ngClass",c.Kc(13,vi,"Complete"===e.status,"Queued"===e.status||"Processing"===e.status,"Failed"===e.status)),c.Ub(1),c.dd(" ","Complete"===e.status&&e.actions.length>0?"Complete With Messages":e.status," "),c.Ub(4),c.cd(e.message),c.Ub(4),c.cd(c.zc(14,9,e.createDate)),c.Ub(5),c.cd(c.zc(19,11,e.lastUpdateDate)),c.Ub(2),c.Ec("ngIf","Upload"==t.taskCategory),c.Ub(4),c.Ec("ngIf",e.actions.length>0),c.Ub(1),c.Ec("ngIf",e.odmOutput),c.Ub(3),c.Ec("ngIf",e.odmOutput&&t.showODMOutput)}}function Ui(e,t){1&e&&(c.nc(0,"h4",23),c.bd(1,"There are no actions for this task."),c.mc())}function Ii(e,t){if(1&e&&(c.nc(0,"tr"),c.nc(1,"th",26),c.bd(2),c.mc(),c.nc(3,"td"),c.bd(4),c.mc(),c.nc(5,"td"),c.bd(6),c.yc(7,"idmdate"),c.mc(),c.nc(8,"td"),c.bd(9),c.yc(10,"idmdate"),c.mc(),c.mc()),2&e){const e=t.$implicit,n=t.index;c.Ub(2),c.cd(n+1),c.Ub(2),c.cd(e.description),c.Ub(2),c.cd(c.zc(7,4,e.createDate)),c.Ub(3),c.cd(c.zc(10,6,e.lastUpdateDate))}}function Mi(e,t){if(1&e&&(c.nc(0,"table",24),c.nc(1,"thead"),c.nc(2,"tr"),c.nc(3,"th"),c.bd(4,"#"),c.mc(),c.nc(5,"th"),c.bd(6,"Description"),c.mc(),c.nc(7,"th"),c.bd(8,"Creation Date"),c.mc(),c.nc(9,"th"),c.bd(10,"Last Updated"),c.mc(),c.mc(),c.mc(),c.nc(11,"tbody"),c.Zc(12,Ii,11,8,"tr",25),c.mc(),c.mc()),2&e){const e=c.xc(2).$implicit;c.Ub(12),c.Ec("ngForOf",e.actions)}}function Oi(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.Zc(2,Ui,2,0,"h4",21),c.Zc(3,Mi,13,1,"table",22),c.mc(),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(2),c.Ec("ngIf",0===e.actions.length),c.Ub(1),c.Ec("ngIf",e.actions.length>0)}}function Si(e,t){if(1&e&&(c.nc(0,"div",9),c.Zc(1,yi,27,15,"div",10),c.Zc(2,wi,29,17,"div",10),c.Zc(3,Oi,4,2,"div",11),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf","Complete"!==e.status&&"Failed"!==e.status&&"Error"!==e.status),c.Ub(1),c.Ec("ngIf","Complete"===e.status||"Failed"===e.status||"Error"===e.status),c.Ub(1),c.Ec("ngIf",e.showError)}}const Ri=function(e,t,n,c){return{success:e,warning:t,pending:n,fail:c}};class Ti{constructor(e,t){this.managementService=e,this.modalService=t,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.showODMOutput=!1,this.showError=!1,this.taskGroups=[]}ngOnInit(){if(null!=this.taskGroupType&&null!=this.taskGroupType.tasks)for(var e=0;e<this.taskGroupType.tasks.length;++e){let t=this.taskGroupType.tasks[e];t.actions.length>0&&(t.showError=!0)}}ngOnDestroy(){}removeTask(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let n=0;n<this.taskGroupType.tasks.length;n++){if(this.taskGroupType.tasks[n].uploadId===e.uploadId){t=n;break}}null!==t&&this.taskGroupType.tasks.splice(t,1)})}}function Pi(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function Fi(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",16),c.nc(2,"div"),c.ic(3,"span",25),c.bd(4),c.mc(),c.nc(5,"div",26),c.nc(6,"ul",27),c.Zc(7,Pi,4,1,"li",28),c.nc(8,"li",9),c.nc(9,"a",29),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleGoto(t.collectionId)})),c.bd(10),c.mc(),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(11,"div",30),c.nc(12,"div"),c.nc(13,"button",31),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleGoto(t.data.collectionId)})),c.bd(14," View Collection "),c.mc(),c.nc(15,"button",32),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleMessage(t)})),c.bd(16," Add Metadata "),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc().$implicit;c.Ub(4),c.dd(" ",e.message," "),c.Ub(3),c.Ec("ngForOf",e.data.ancestors),c.Ub(3),c.dd(" ",e.data.collectionName,"")}}function Di(e,t){if(1&e){const e=c.oc();c.lc(0),c.nc(1,"div",16),c.nc(2,"div"),c.ic(3,"span",25),c.bd(4),c.mc(),c.mc(),c.nc(5,"div",30),c.nc(6,"div"),c.nc(7,"button",31),c.vc("click",(function(){c.Rc(e);const t=c.xc().$implicit;return c.xc(2).handleGoto(t.data.component)})),c.bd(8," View Collection "),c.mc(),c.mc(),c.mc(),c.kc()}if(2&e){const e=c.xc().$implicit;c.Ub(4),c.dd(" ",e.message," ")}}function Ni(e,t){if(1&e&&(c.nc(0,"div",20),c.nc(1,"div",21),c.nc(2,"div",2),c.lc(3,22),c.Zc(4,Fi,17,3,"ng-container",23),c.Zc(5,Di,9,1,"ng-container",24),c.kc(),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.Ec("ngSwitch",e.type),c.Ub(1),c.Ec("ngSwitchCase","MissingMetadataMessage")}}Ti.ɵfac=function(e){return new(e||Ti)(c.hc(A),c.hc(j.b))},Ti.ɵcmp=c.bc({type:Ti,selectors:[["tasks-panel"]],inputs:{taskGroupType:"taskGroupType",groupTypeId:"groupTypeId",taskCategory:"taskCategory"},decls:13,vars:13,consts:[[1,"panel-group"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","panel-heading-light","clickable",2,"margin-top","20px"],[1,"panel-title"],["data-toggle","collapse",3,"click"],[1,"heading-status-label","pull-right"],[3,"ngClass"],[1,"panel-body",3,"id","isAnimated","collapse"],["class","task-container",4,"ngFor","ngForOf"],[1,"task-container"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"list-unstyled",2,"margin","0"],[2,"word-break","break-all"],[1,"row"],[1,"col-sm-12"],[1,"button-holder",2,"margin-top","30px"],["class","btn btn-default",3,"click",4,"ngIf"],[1,"btn","btn-default","caution",3,"click"],[1,"btn","btn-default",3,"click"],[2,"color","grey","width","500px","height","200px",3,"innerHTML"],["style","color:grey;",4,"ngIf"],["class","table table-bordered",4,"ngIf"],[2,"color","grey"],[1,"table","table-bordered"],[4,"ngFor","ngForOf"],["scope","row"]],template:function(e,t){1&e&&(c.nc(0,"div",0),c.nc(1,"div",1),c.nc(2,"div",2),c.nc(3,"h4",3),c.nc(4,"a",4),c.vc("click",(function(){return t.showProcess=!t.showProcess})),c.nc(5,"h4"),c.bd(6),c.mc(),c.mc(),c.mc(),c.nc(7,"span",5),c.bd(8,"Current status: "),c.nc(9,"span",6),c.bd(10),c.mc(),c.mc(),c.mc(),c.nc(11,"div",7),c.Zc(12,Si,4,3,"div",8),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(4),c.Wb("aria-controls","task-group-panel-",t.groupTypeId,""),c.Ub(2),c.cd(t.taskCategory),c.Ub(3),c.Ec("ngClass",c.Lc(8,Ri,"Complete"===t.taskGroupType.status,"Warning"===t.taskGroupType.status,"Queued"===t.taskGroupType.status||"Processing"===t.taskGroupType.status,"Failed"===t.taskGroupType.status)),c.Ub(1),c.cd(t.taskGroupType.status),c.Ub(1),c.Gc("id","task-group-panel-",t.groupTypeId,""),c.Ec("isAnimated",!1)("collapse",!t.showProcess),c.Ub(1),c.Ec("ngForOf",t.taskGroupType.tasks))},directives:[i.q,u.a,i.s,i.t],pipes:[He.a],styles:[".button-holder[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] {\n\tmargin-right: 10px;\n}\n.btn.btn-danger[_ngcontent-%COMP%] {\n    background-color: #d9534f !important;\n    border-color: #d43f3a !important;\n}\n.btn.btn-danger[_ngcontent-%COMP%]:hover {\n    background-color: #d2322d !important;\n    border-color: #ac2925 !important;\n}\n.btn.btn-default.caution[_ngcontent-%COMP%]:hover {\n\tborder-color: #ac2925 !important;\n\tcolor: #ac2925 !important;\n}\n\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%]{\n  background-color: #e9e9e9;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}\n\n\n.dot[_ngcontent-%COMP%] {\n  height: 20px;\n  width: 20px;\n  background-color: #bbb;\n  border-radius: 50%;\n  display: inline-block;\n  vertical-align: middle;\n  margin-right: 10px;\n}\n.dot.success[_ngcontent-%COMP%] {\n  background-color: #6CB46F;\n}\n.dot.pending[_ngcontent-%COMP%] {    \n  background-color: #FF8C42;\n}\n.dot.warning[_ngcontent-%COMP%] {\n  background-color: #2C88CB;\n}\n.dot.fail[_ngcontent-%COMP%] {\n  background-color:#BF1E1E;\n}\n.dot.pending.blink[_ngcontent-%COMP%] {\n   animation-duration: 400ms;\n   animation-name: blink;\n   animation-iteration-count: infinite;\n   animation-direction: alternate;\n}\n@keyframes blink {\n   from {\n      opacity: 1;\n   }\n   to {\n      opacity: .5;\n   }\n }"]});const Zi=function(e,t,n){return{id:"message-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:n}};function Ai(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Tasks"),c.mc(),c.nc(3,"div",15),c.nc(4,"div",2),c.nc(5,"h3",16),c.bd(6,"Issue"),c.mc(),c.nc(7,"h3",17),c.bd(8,"Actions"),c.mc(),c.mc(),c.Zc(9,Ni,6,2,"div",18),c.yc(10,"paginate"),c.nc(11,"div",2),c.nc(12,"pagination-controls",19),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onMessagePageChange(t)})),c.mc(),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(9),c.Ec("ngForOf",c.Ac(10,1,e.messages.resultSet,c.Kc(4,Zi,e.messages.pageSize,e.messages.pageNumber,e.messages.count)))}}function ji(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function Li(e,t){1&e&&c.ic(0,"i",45)}function _i(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function $i(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function zi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function Bi(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,_i,2,3,"div",6),c.Zc(2,$i,2,3,"div",6),c.Zc(3,zi,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function Gi(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,Bi,4,4,"div",46),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function Vi(e,t){if(1&e&&(c.nc(0,"span"),c.Zc(1,Gi,2,1,"div",28),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngForOf",e.groups)}}const qi=function(e,t,n,c){return{success:e,warning:t,"pending blink":n,fail:c}};function Hi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",37),c.nc(1,"div",38),c.nc(2,"h4",39),c.nc(3,"a",40),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",41),c.nc(7,"button",42),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",26),c.nc(10,"ul",27),c.Zc(11,ji,4,1,"li",28),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",43),c.Zc(15,Li,1,0,"i",44),c.Zc(16,Vi,2,1,"span",6),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(10,qi,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}const Ji=function(e,t,n){return{id:"tasks-pg-ctrl",itemsPerPage:e,currentPage:t,totalItems:n}};function Wi(e,t){if(1&e){const e=c.oc();c.nc(0,"div",33),c.nc(1,"div",34),c.Zc(2,Hi,17,15,"div",35),c.yc(3,"paginate"),c.nc(4,"pagination-controls",36),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,Ji,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function Yi(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function Xi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function Ki(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function Qi(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function ea(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,Xi,2,3,"div",6),c.Zc(2,Ki,2,3,"div",6),c.Zc(3,Qi,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function ta(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,ea,4,4,"div",46),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function na(e,t){if(1&e){const e=c.oc();c.nc(0,"div",37),c.nc(1,"div",38),c.nc(2,"h4",39),c.nc(3,"a",40),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",41),c.nc(7,"button",42),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",26),c.nc(10,"ul",27),c.Zc(11,Yi,4,1,"li",28),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",43),c.Zc(15,ta,2,1,"div",28),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(9,qi,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngForOf",e.groups)}}function ca(e,t){if(1&e){const e=c.oc();c.nc(0,"div",49),c.nc(1,"div",34),c.Zc(2,na,16,14,"div",35),c.yc(3,"paginate"),c.nc(4,"pagination-controls",36),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,Ji,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}function ia(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"span"),c.nc(2,"b"),c.bd(3),c.mc(),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(3),c.cd(e)}}function aa(e,t){1&e&&c.ic(0,"i",45)}function oa(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Upload")}}function sa(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Process")}}function la(e,t){if(1&e&&(c.nc(0,"div"),c.ic(1,"tasks-panel",48),c.mc()),2&e){const e=c.xc(2),t=e.$implicit,n=e.index;c.Ub(1),c.Ec("taskGroupType",t)("groupTypeId",n)("taskCategory","Store")}}function ra(e,t){if(1&e&&(c.nc(0,"div",47),c.Zc(1,oa,2,3,"div",6),c.Zc(2,sa,2,3,"div",6),c.Zc(3,la,2,3,"div",6),c.mc()),2&e){const e=c.xc(),t=e.index,n=e.$implicit;c.Ec("id","task"+t),c.Ub(1),c.Ec("ngIf","UPLOAD"===n.type),c.Ub(1),c.Ec("ngIf","PROCESS"===n.type),c.Ub(1),c.Ec("ngIf","STORE"===n.type)}}function da(e,t){if(1&e&&(c.nc(0,"div"),c.Zc(1,ra,4,4,"div",46),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("ngIf",e.tasks.length>0)}}function pa(e,t){if(1&e&&(c.nc(0,"span"),c.Zc(1,da,2,1,"div",28),c.mc()),2&e){const e=c.xc().$implicit;c.Ub(1),c.Ec("ngForOf",e.groups)}}function ma(e,t){if(1&e){const e=c.oc();c.nc(0,"div",37),c.nc(1,"div",38),c.nc(2,"h4",39),c.nc(3,"a",40),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).setVisibility(n)})),c.nc(4,"h4"),c.bd(5),c.mc(),c.mc(),c.mc(),c.ic(6,"span",41),c.nc(7,"button",42),c.vc("click",(function(){c.Rc(e);const n=t.$implicit;return c.xc(2).handleGoto(n.collectionId)})),c.bd(8,"View Collection"),c.mc(),c.nc(9,"div",26),c.nc(10,"ul",27),c.Zc(11,ia,4,1,"li",28),c.nc(12,"li",9),c.bd(13),c.mc(),c.mc(),c.mc(),c.mc(),c.nc(14,"div",43),c.Zc(15,aa,1,0,"i",44),c.Zc(16,pa,2,1,"span",6),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=t.index,i=c.xc(2);c.Ub(3),c.Vb("aria-expanded",!i.visible[e.collectionId])("aria-controls","taskGroup"+n),c.Ub(2),c.cd(e.label),c.Ub(1),c.Ec("ngClass",c.Lc(10,qi,"Complete"===e.status,"Warning"===e.status,"Processing"===e.status||"Running"===e.status||"Pending"===e.status||"Queued"===e.status,"Failed"===e.status)),c.Ub(5),c.Ec("ngForOf",e.ancestors),c.Ub(2),c.dd(" ",e.label," "),c.Ub(1),c.Ec("isAnimated",!1)("collapse",!i.visible[e.collectionId]),c.Ub(1),c.Ec("ngIf",e.loading),c.Ub(1),c.Ec("ngIf",!e.loading)}}function ha(e,t){if(1&e){const e=c.oc();c.nc(0,"div",50),c.nc(1,"div",34),c.Zc(2,ma,17,15,"div",35),c.yc(3,"paginate"),c.nc(4,"pagination-controls",36),c.vc("pageChange",(function(t){return c.Rc(e),c.xc().onPageChange(t)})),c.mc(),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(2),c.Ec("ngForOf",c.Ac(3,1,e.taskPage.resultSet,c.Kc(4,Ji,e.taskPage.pageSize,e.taskPage.pageNumber,e.taskPage.count)))}}class ua{constructor(e,t){this.managementService=e,this.modalService=t,this.userName="",this.totalTaskCount=0,this.activeTab="all",this.showSite=!1,this.showUploads=!1,this.showProcess=!1,this.showStore=!1,this.taskPage={count:0,pageSize:10,pageNumber:1,resultSet:[]},this.errorStatuses=["Failed","Processing"],this.completeStatuses=["Complete"],this.statuses=[],this.token=0,this.messages={count:0,pageSize:5,pageNumber:1,resultSet:[]}}ngOnInit(){this.userName=this.managementService.getCurrentUser(),this.managementService.tasks([],this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e)}),this.getMessages();let e="wss://"+window.location.hostname+(window.location.port?":"+window.location.port:"")+acp;this.notifier=Object(Ce.a)(e+"/websocket/notify"),this.notifier.subscribe(e=>{"JOB_CHANGE"===e.type&&(this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{e.token===this.token&&this.updateTaskData(e)}),this.getMessages())})}ngOnDestroy(){this.notifier.complete()}onPageChange(e){this.token++,this.managementService.tasks(this.statuses,this.taskPage.pageSize,e,this.token).then(e=>{this.setTaskData(e)})}onTabClick(e,t){if(this.activeTab=t,this.taskPage={count:0,pageSize:20,pageNumber:1,resultSet:[]},this.token++,"success"===t?this.statuses=this.completeStatuses:"action-required"===t?this.statuses=this.errorStatuses:"all"===t&&(this.statuses=[]),this.managementService.tasks(this.statuses,this.taskPage.pageSize,this.taskPage.pageNumber,this.token).then(e=>{this.setTaskData(e)}),!e.target.parentNode.classList.contains("active")){let t=e.target.parentNode.parentNode.getElementsByTagName("li");for(let e=0;e<t.length;e++){let n=t[e];n.classList.forEach(e=>{"active"===e&&n.classList.remove("active")})}e.target.parentNode.classList.add("active")}}setTaskData(e){this.taskPage=e,this.visible={},this.taskPage.resultSet.forEach(e=>{this.visible[e.collectionId]=!1})}setGroupTasks(e,t){e.groups=[],e.groups.push({tasks:[],status:null,type:"UPLOAD"}),e.groups.push({tasks:[],status:null,type:"PROCESS"}),e.groups.push({tasks:[],status:null,type:"STORE"});for(let n=0;n<t.length;n++){let c=t[n];if("gov.geoplatform.uasdm.bus.WorkflowTask"===c.type){let t=e.groups.findIndex(e=>"UPLOAD"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"UPLOAD"}):e.groups[t].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMProcessingTask"===c.type||"gov.geoplatform.uasdm.bus.OrthoProcessingTask"===c.type){let t=e.groups.findIndex(e=>"PROCESS"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"PROCESS"}):e.groups[t].tasks.push(c)}else if("gov.geoplatform.uasdm.odm.ODMUploadTask"===c.type){let t=e.groups.findIndex(e=>"STORE"===e.type);-1===t?e.groups.push({tasks:[c],status:c.status,type:"STORE"}):e.groups[t].tasks.push(c)}}this.setTaskGroupStatuses(e)}setTaskGroupStatuses(e){let t=null;e.groups.forEach(e=>{let n=!1;if(e.tasks.length>0){const c=e.tasks.sort((e,t)=>new Date(t.lastUpdateDate).getTime()-new Date(e.lastUpdateDate).getTime());e.status=c[0].status;const i=new Date(c[0].lastUpdateDate);n=null==t||t.getTime()-i.getTime()<=0,n&&(t=i),"Complete"===e.status&&c[0].actions.length>0&&(e.status="Warning")}})}updateTaskData(e){this.taskPage=e,this.taskPage.resultSet.forEach(e=>{this.visible[e.collectionId]&&this.managementService.getTasks(e.collectionId).then(t=>{this.setGroupTasks(e,t)})})}setVisibility(e){this.visible[e.collectionId]?this.visible[e.collectionId]=!1:(this.visible[e.collectionId]=!0,null!=e.groups||e.loading||(e.loading=!0,this.managementService.getTasks(e.collectionId).then(t=>{this.setGroupTasks(e,t),e.loading=!1})))}handleMessage(e){"MissingMetadataMessage"===e.type&&(this.bsModalRef=this.modalService.show(W,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"upload-modal"}),this.bsModalRef.content.init(e.data.collectionId),this.bsModalRef.content.onMetadataChange.subscribe(()=>{this.getMessages()}))}handleGoto(e){this.managementService.view(e).then(t=>{const n=t.item,c=t.breadcrumbs;this.managementService.getItems(e,null).then(e=>{this.bsModalRef=this.modalService.show(Et,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"leaf-modal"}),this.bsModalRef.content.init(n,e,c)})})}removeTask(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to delete ["+e.label+"?",this.bsModalRef.content.data=e,this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(e=>{this.deleteTask(e)})}deleteTask(e){this.managementService.removeTask(e.uploadId).then(()=>{let t=null;for(let n=0;n<this.tasks.resultSet.length;n++){if(this.tasks[n].uploadId===e.uploadId){t=n;break}}null!==t&&this.tasks.resultSet.splice(t,1),this.getMessages(),this.totalTaskCount=this.tasks.count})}getMessages(){this.onMessagePageChange(this.messages.pageNumber)}onMessagePageChange(e){this.managementService.getMessages(this.messages.pageSize,e).then(e=>{this.messages=e})}}ua.ɵfac=function(e){return new(e||ua)(c.hc(A),c.hc(j.b))},ua.ɵcmp=c.bc({type:ua,selectors:[["tasks"]],decls:25,vars:5,consts:[[3,"title"],["id","app-container",1,"container-fluid",2,"padding-top","20px"],[1,"row"],[1,"col-sm-1"],[1,"col-sm-10"],["id","tasks"],[4,"ngIf"],[1,"row",2,"margin-bottom","40px"],["role","tablist",1,"nav","nav-tabs"],[1,"active"],["role","tab","data-toggle","tab",3,"click"],[1,"tab-content"],["class","tab-pane active","id","action-required",4,"ngIf"],["class","tab-pane active","id","success",4,"ngIf"],["class","tab-pane active","id","all",4,"ngIf"],["id","tasks-container"],[1,"col-sm-7"],[1,"col-sm-5",2,"text-align","right","padding-right","8em"],["class","panel panel-default",4,"ngFor","ngForOf"],["id","message-pg-ctrl",3,"pageChange"],[1,"panel","panel-default"],[1,"panel-body"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"dot","pending",2,"margin-left","0"],[2,"margin-top","10px","margin-bottom","0","color","grey"],[1,"breadcrumb",2,"color","grey"],[4,"ngFor","ngForOf"],[2,"color","#007276",3,"click"],[1,"col-sm-5",2,"text-align","right"],[1,"btn","btn-default",3,"click"],[1,"btn","btn-primary",2,"margin-left","10px",3,"click"],["id","action-required",1,"tab-pane","active"],[1,"panel-group"],["class","panel panel-default","style","background: none;border: none;",4,"ngFor","ngForOf"],["id","tasks-pg-ctrl",3,"pageChange"],[1,"panel","panel-default",2,"background","none","border","none"],[1,"panel-heading","clickable"],[1,"panel-title",2,"display","inline-block","vertical-align","middle"],["data-toggle","collapse",3,"click"],[1,"dot",3,"ngClass"],[1,"btn","btn-default","pull-right",3,"click"],[1,"panel-body",3,"isAnimated","collapse"],["class","fa fa-spinner fa-spin task-group-loading",4,"ngIf"],[1,"fa","fa-spinner","fa-spin","task-group-loading"],[3,"id",4,"ngIf"],[3,"id"],[3,"taskGroupType","groupTypeId","taskCategory"],["id","success",1,"tab-pane","active"],["id","all",1,"tab-pane","active"]],template:function(e,t){1&e&&(c.ic(0,"uasdm-header",0),c.nc(1,"div",1),c.nc(2,"div",2),c.ic(3,"div",3),c.nc(4,"div",4),c.nc(5,"div",5),c.Zc(6,Ai,13,8,"div",6),c.mc(),c.mc(),c.ic(7,"div",3),c.mc(),c.nc(8,"div",7),c.ic(9,"div",3),c.nc(10,"div",4),c.nc(11,"h3"),c.bd(12,"Processing Jobs"),c.mc(),c.nc(13,"ul",8),c.nc(14,"li",9),c.nc(15,"a",10),c.vc("click",(function(e){return t.onTabClick(e,"all")})),c.bd(16,"All"),c.mc(),c.mc(),c.nc(17,"li"),c.nc(18,"a",10),c.vc("click",(function(e){return t.onTabClick(e,"action-required")})),c.bd(19,"Action Required"),c.mc(),c.mc(),c.mc(),c.nc(20,"div",11),c.Zc(21,Wi,5,8,"div",12),c.Zc(22,ca,5,8,"div",13),c.Zc(23,ha,5,8,"div",14),c.mc(),c.mc(),c.ic(24,"div",3),c.mc(),c.mc()),2&e&&(c.Ec("title","Tasks"),c.Ub(6),c.Ec("ngIf",t.messages&&t.messages.count>0),c.Ub(15),c.Ec("ngIf","action-required"===t.activeTab),c.Ub(1),c.Ec("ngIf","success"===t.activeTab),c.Ub(1),c.Ec("ngIf","all"===t.activeTab))},directives:[Qn.a,i.t,i.s,h.c,i.x,i.y,i.z,i.q,u.a,Ti],pipes:[h.b],styles:["#app-container[_ngcontent-%COMP%] {\n    background: #f7f7f7;\n}\n\n#tasks-container[_ngcontent-%COMP%] {\n    padding: 20px;\n    background: white;\n    border-radius: 6px;\n}\n\n#tasks[_ngcontent-%COMP%]   .panel-body[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n#tasks[_ngcontent-%COMP%]   .panel-footer[_ngcontent-%COMP%] {\n    background: #e9e9e9;\n}\n\n.task-container[_ngcontent-%COMP%]{\n    border-bottom: solid lightgrey 1px;\n    padding: 10px;\n    margin-bottom: 20px;\n}\n\n.panel-body[_ngcontent-%COMP%]{\n    background: white;\n}\n.panel-body.collapse[_ngcontent-%COMP%]{\n    padding: 0;\n}\n.panel-body.collapse.in.show[_ngcontent-%COMP%]{\n    padding: 20px;\n    max-height: fit-content;\n}\n\n.task-group-loading[_ngcontent-%COMP%] {\n}\n\n.panel-group[_ngcontent-%COMP%] {\n    margin-bottom: 0;\n}\n\n.panel-heading[_ngcontent-%COMP%] {\n  background-color: #e9e9e9;\n  margin-top: 20px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%] {\n  background: none;\n  border-bottom: 2px solid lightgrey;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .panel-title[_ngcontent-%COMP%] {\n    display: inline-block;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%] {\n    display: inline-block;\n    vertical-align: middle;\n    line-height: 40px;\n}\n\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%] {\n    color: #2C88CB;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\n.panel-heading.panel-heading-light[_ngcontent-%COMP%]   .heading-status-label[_ngcontent-%COMP%]   .fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\nb.success[_ngcontent-%COMP%] {\n    color: #6CB46F;\n}\nb.pending[_ngcontent-%COMP%] {\n    color: #FF8C42;\n}\nb.fail[_ngcontent-%COMP%] {\n    color: #BF1E1E;\n}\n\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: grey;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\n    color: #007276;\n}\n.nav-tabs[_ngcontent-%COMP%]    > li[_ngcontent-%COMP%]    > a[_ngcontent-%COMP%]:hover {\n  background-color: #e4e4e4;\n  cursor: pointer;\n  color: #007276;\n}"]});class ga{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/sensor/page",{params:t}).toPromise()}getAll(){let e=new y.g;return this.eventService.start(),this.http.get(acp+"/sensor/get-all",{params:e}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/sensor/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/sensor/apply",JSON.stringify({sensor:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}}ga.ɵfac=function(e){return new(e||ga)(c.rc(y.c),c.rc(D.a),c.rc(N.a))},ga.ɵprov=c.dc({token:ga,factory:ga.ɵfac});var ba,fa=n(95);function va(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}class ya{constructor(e,t,n){this.service=e,this.modalService=t,this.router=n,this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"Model",field:"model",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"Type",field:"sensorType",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"Sensor",sort:{field:"name",order:1}},this.refresh=new G.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the sensor ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/sensor",e.oid])}newInstance(){this.router.navigate(["/site/sensor","__NEW__"])}}ya.ɵfac=function(e){return new(e||ya)(c.hc(ga),c.hc(j.b),c.hc(a.b))},ya.ɵcmp=c.bc({type:ya,selectors:[["sensors"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Sensors"),c.mc(),c.Zc(3,va,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,fa.a],styles:["./sensors.css"]}),function(e){e.SENSOR_TYPE="/sensor-type",e.PLATFORM_TYPE="/platform-type",e.PLATFORM_MANUFACTURER="/platform-manufacturer",e.WAVE_LENGTH="/wave-length"}(ba||(ba={}));class xa{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e,t){let n=new y.g;return n=n.set("criteria",JSON.stringify(e)),this.http.get(acp+t+"/page",{params:n}).toPromise()}getAll(e){let t=new y.g;return this.eventService.start(),this.http.get(acp+e+"/get-all",{params:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}get(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/get",JSON.stringify({oid:t}),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/newInstance",JSON.stringify({}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}remove(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+e+"/remove",JSON.stringify({oid:t}),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}apply(e,t){let n=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+e+"/apply",JSON.stringify({classification:t}),{headers:n}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}}function ka(e,t){if(1&e&&(c.nc(0,"div",18),c.nc(1,"div",19),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",20),c.nc(5,"div"),c.nc(6,"p",21),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Ea(e,t){if(1&e&&(c.nc(0,"option",22),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function Ca(e,t){1&e&&(c.nc(0,"span",21),c.bd(1," A sensor requires at least one Wave Length "),c.mc())}function wa(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",23),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc().updateSelectedWaveLength(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc();c.Ub(1),c.Ec("value",n.sensor.wavelengths&&-1!==n.sensor.wavelengths.indexOf(e.oid))("label",e.name)("disabled","READ"===n.mode)}}xa.ɵfac=function(e){return new(e||xa)(c.rc(y.c),c.rc(D.a),c.rc(N.a))},xa.ɵprov=c.dc({token:xa,factory:xa.ɵfac});const Ua=function(e){return["/site/platform",e]};function Ia(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"a",24),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("routerLink",c.Ic(2,Ua,e.oid)),c.Ub(1),c.cd(e.name)}}function Ma(e,t){if(1&e&&(c.nc(0,"div",4),c.nc(1,"label"),c.bd(2,"Used on Platforms"),c.mc(),c.nc(3,"ul"),c.Zc(4,Ia,3,4,"li",15),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(4),c.Ec("ngForOf",e.sensor.platforms)}}function Oa(e,t){if(1&e){const e=c.oc();c.nc(0,"button",28),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function Sa(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.Zc(1,Oa,2,0,"button",26),c.nc(2,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(8);c.Ub(1),c.Ec("ngIf",!e.newInstance),c.Ub(1),c.Ec("disabled",!t.valid||0===e.sensor.wavelengths.length)}}function Ra(e,t){if(1&e){const e=c.oc();c.nc(0,"div",25),c.nc(1,"button",29),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}class Ta{constructor(e,t,n,c,i){this.service=e,this.classificationService=t,this.route=n,this.router=c,this.authService=i,this.isAdmin=!1,this.newInstance=!1,this.message=null,this.wavelengths=[],this.types=[],this.mode="READ",this.isAdmin=this.authService.isAdmin()}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.sensor=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.sensor=e,this.original=JSON.parse(JSON.stringify(this.sensor))}),this.classificationService.getAll(ba.WAVE_LENGTH).then(e=>{this.wavelengths=e}),this.classificationService.getAll(ba.SENSOR_TYPE).then(e=>{this.types=e})}handleOnSubmit(){this.message=null,this.service.apply(this.sensor).then(e=>{this.router.navigate(["/site/equipment"])}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.sensor=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}updateSelectedWaveLength(e,t){const n=this.sensor.wavelengths.findIndex(t=>e.oid===t);t?n<0&&this.sensor.wavelengths.push(e.oid):n>-1&&this.sensor.wavelengths.splice(n,1)}error(e){this.message=S.b.getMessageFromError(e)}}Ta.ɵfac=function(e){return new(e||Ta)(c.hc(ga),c.hc(xa),c.hc(a.a),c.hc(a.b),c.hc(Z.a))},Ta.ɵcmp=c.bc({type:Ta,selectors:[["sensor"]],decls:54,vars:23,consts:[["id","app-container",1,"container"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","model","type","input","placeholder","Model","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorType","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","pixelSizeWidth","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","pixelSizeHeight","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorWidth","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","sensorHeight","type","number","step","0","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","error-message",4,"ngIf"],[4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["class","btn-holder","style","text-align: right;margin-bottom: 40px;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],[3,"value","label","disabled","valueChange"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right","margin-bottom","40px"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,ka,8,1,"div",1),c.nc(4,"div",2),c.nc(5,"h3"),c.bd(6,"Sensor"),c.mc(),c.mc(),c.nc(7,"form",null,3),c.nc(9,"div",4),c.nc(10,"label"),c.bd(11,"Name"),c.mc(),c.nc(12,"input",5),c.vc("ngModelChange",(function(e){return t.sensor.name=e})),c.mc(),c.mc(),c.nc(13,"div",4),c.nc(14,"label"),c.bd(15,"Description"),c.mc(),c.nc(16,"textarea",6),c.vc("ngModelChange",(function(e){return t.sensor.description=e})),c.bd(17,"        "),c.mc(),c.mc(),c.nc(18,"div",4),c.nc(19,"label"),c.bd(20,"Model"),c.mc(),c.nc(21,"input",7),c.vc("ngModelChange",(function(e){return t.sensor.model=e})),c.mc(),c.mc(),c.nc(22,"div",4),c.nc(23,"label"),c.bd(24,"Type"),c.mc(),c.nc(25,"select",8),c.vc("ngModelChange",(function(e){return t.sensor.sensorTypeOid=e})),c.ic(26,"option"),c.Zc(27,Ea,2,2,"option",9),c.mc(),c.mc(),c.nc(28,"div",4),c.nc(29,"label"),c.bd(30,"Pixel Size Width"),c.mc(),c.nc(31,"input",10),c.vc("ngModelChange",(function(e){return t.sensor.pixelSizeWidth=e})),c.mc(),c.mc(),c.nc(32,"div",4),c.nc(33,"label"),c.bd(34,"Pixel Size Height"),c.mc(),c.nc(35,"input",11),c.vc("ngModelChange",(function(e){return t.sensor.pixelSizeHeight=e})),c.mc(),c.mc(),c.nc(36,"div",4),c.nc(37,"label"),c.bd(38,"Sensor Width"),c.mc(),c.bd(39," (millimeters) "),c.nc(40,"input",12),c.vc("ngModelChange",(function(e){return t.sensor.sensorWidth=e})),c.mc(),c.mc(),c.nc(41,"div",4),c.nc(42,"label"),c.bd(43,"Sensor Height"),c.mc(),c.bd(44," (millimeters) "),c.nc(45,"input",13),c.vc("ngModelChange",(function(e){return t.sensor.sensorHeight=e})),c.mc(),c.mc(),c.nc(46,"div",4),c.nc(47,"label"),c.bd(48,"Wave Length"),c.mc(),c.Zc(49,Ca,2,0,"span",14),c.Zc(50,wa,2,3,"div",15),c.mc(),c.Zc(51,Ma,5,1,"div",16),c.Zc(52,Sa,4,2,"div",17),c.Zc(53,Ra,3,0,"div",17),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.message),c.Ub(9),c.Ec("ngModel",t.sensor.name)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.description)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.model)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.sensorTypeOid)("disabled","READ"===t.mode),c.Ub(2),c.Ec("ngForOf",t.types),c.Ub(4),c.Ec("ngModel",t.sensor.pixelSizeWidth)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngModel",t.sensor.pixelSizeHeight)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.sensorWidth)("disabled","READ"===t.mode),c.Ub(5),c.Ec("ngModel",t.sensor.sensorHeight)("disabled","READ"===t.mode),c.Ub(4),c.Ec("ngIf",0===t.sensor.wavelengths.length),c.Ub(1),c.Ec("ngForOf",t.wavelengths),c.Ub(1),c.Ec("ngIf","READ"===t.mode&&null!=t.sensor.platforms&&t.sensor.platforms.length>0),c.Ub(1),c.Ec("ngIf",t.isAdmin&&"WRITE"===t.mode),c.Ub(1),c.Ec("ngIf",t.isAdmin&&"READ"===t.mode))},directives:[Qn.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,o.w,o.p,o.y,i.s,o.q,we.a,a.e],encapsulation:2});class Pa{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/platform/page",{params:t}).toPromise()}getAll(){let e=new y.g;return this.eventService.start(),this.http.get(acp+"/platform/get-all",{params:e}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}get(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/get",JSON.stringify({oid:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}newInstance(){let e=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/newInstance",JSON.stringify({}),{headers:e}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}remove(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.http.post(acp+"/platform/remove",JSON.stringify({oid:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}apply(e){let t=new y.f({"Content-Type":"application/json"});return this.eventService.start(),this.noErrorHttpClient.post(acp+"/platform/apply",JSON.stringify({platform:e}),{headers:t}).pipe(Object(R.a)(()=>{this.eventService.complete()})).toPromise()}}function Fa(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}Pa.ɵfac=function(e){return new(e||Pa)(c.rc(y.c),c.rc(D.a),c.rc(N.a))},Pa.ɵprov=c.dc({token:Pa,factory:Pa.ɵfac});class Da{constructor(e,t,n){this.service=e,this.router=t,this.modalService=n,this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"Platform",sort:{field:"name",order:1}},this.refresh=new G.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the platform ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/platform",e.oid])}newInstance(){this.router.navigate(["/site/platform","__NEW__"])}}function Na(e,t){if(1&e&&(c.nc(0,"div",14),c.nc(1,"div",15),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",16),c.nc(5,"div"),c.nc(6,"p",17),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function Za(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function Aa(e,t){if(1&e&&(c.nc(0,"option",18),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.dd("",e.name," ")}}function ja(e,t){1&e&&(c.nc(0,"span",17),c.bd(1," A platform requires at least one sensor "),c.mc())}function La(e,t){if(1&e){const e=c.oc();c.nc(0,"div"),c.nc(1,"boolean-field",21),c.vc("valueChange",(function(n){c.Rc(e);const i=t.$implicit;return c.xc(3).updateSelectedSensor(i,n)})),c.mc(),c.mc()}if(2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("value",n.platform.sensors&&-1!==n.platform.sensors.indexOf(e.oid))("label",e.name)}}function _a(e,t){if(1&e&&(c.nc(0,"div",6),c.nc(1,"label"),c.bd(2,"Sensors"),c.mc(),c.Zc(3,ja,2,0,"span",19),c.Zc(4,La,2,2,"div",20),c.mc()),2&e){const e=c.xc(2);c.Ub(3),c.Ec("ngIf",0===e.platform.sensors.length),c.Ub(1),c.Ec("ngForOf",e.sensors)}}Da.ɵfac=function(e){return new(e||Da)(c.hc(Pa),c.hc(a.b),c.hc(j.b))},Da.ɵcmp=c.bc({type:Da,selectors:[["platforms"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"Platforms"),c.mc(),c.Zc(3,Fa,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,fa.a],styles:["./platforms.css"]});const $a=function(e){return["/site/sensor",e]};function za(e,t){if(1&e&&(c.nc(0,"li"),c.nc(1,"a",22),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit,n=c.xc(3);c.Ub(1),c.Ec("routerLink",c.Ic(2,$a,e)),c.Ub(1),c.cd(n.getSensorName(e))}}function Ba(e,t){if(1&e&&(c.nc(0,"div",6),c.nc(1,"label"),c.bd(2,"Sensors"),c.mc(),c.nc(3,"ul"),c.Zc(4,za,3,4,"li",20),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(4),c.Ec("ngForOf",e.platform.sensors)}}function Ga(e,t){if(1&e){const e=c.oc();c.nc(0,"button",26),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function Va(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.Zc(1,Ga,2,0,"button",24),c.nc(2,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){c.xc();const e=c.Pc(6),t=c.xc();c.Ub(1),c.Ec("ngIf",!t.newInstance),c.Ub(1),c.Ec("disabled",!e.valid||0===t.platform.sensors.length)}}function qa(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}function Ha(e,t){if(1&e){const e=c.oc();c.nc(0,"div",2),c.Zc(1,Na,8,1,"div",3),c.nc(2,"div",4),c.nc(3,"h3"),c.bd(4,"Platform"),c.mc(),c.mc(),c.nc(5,"form",null,5),c.nc(7,"div",6),c.nc(8,"label"),c.bd(9,"Name"),c.mc(),c.nc(10,"input",7),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.name=t})),c.mc(),c.mc(),c.nc(11,"div",6),c.nc(12,"label"),c.bd(13,"Description"),c.mc(),c.nc(14,"textarea",8),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.description=t})),c.bd(15,"      "),c.mc(),c.mc(),c.nc(16,"div",6),c.nc(17,"label"),c.bd(18,"Type"),c.mc(),c.nc(19,"select",9),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.platformTypeOid=t})),c.ic(20,"option"),c.Zc(21,Za,2,2,"option",10),c.mc(),c.mc(),c.nc(22,"div",6),c.nc(23,"label"),c.bd(24,"Manufacturer"),c.mc(),c.nc(25,"select",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().platform.manufacturer=t})),c.ic(26,"option"),c.Zc(27,Aa,2,2,"option",10),c.mc(),c.mc(),c.Zc(28,_a,5,2,"div",12),c.Zc(29,Ba,5,1,"div",12),c.Zc(30,Va,4,2,"div",13),c.Zc(31,qa,3,0,"div",13),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf",null!=e.message),c.Ub(9),c.Ec("ngModel",e.platform.name)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.platform.description)("disabled","READ"===e.mode),c.Ub(5),c.Ec("ngModel",e.platform.platformTypeOid)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.types),c.Ub(4),c.Ec("ngModel",e.platform.manufacturer)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.manufacturers),c.Ub(1),c.Ec("ngIf","WRITE"===e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"WRITE"===e.mode),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"READ"===e.mode)}}class Ja{constructor(e,t,n,c,i,a){this.service=e,this.sensorService=t,this.classificationService=n,this.authService=c,this.route=i,this.router=a,this.isAdmin=!1,this.newInstance=!1,this.message=null,this.manufacturers=[],this.types=[],this.sensors=[],this.mode="READ",this.isAdmin=this.authService.isAdmin()}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.platform=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.platform=e,this.original=JSON.parse(JSON.stringify(this.platform))}),this.classificationService.getAll(ba.PLATFORM_MANUFACTURER).then(e=>{this.manufacturers=e}),this.classificationService.getAll(ba.PLATFORM_TYPE).then(e=>{this.types=e}),this.sensorService.getAll().then(e=>{this.sensors=e})}handleOnSubmit(){this.message=null,this.service.apply(this.platform).then(e=>{this.router.navigate(["/site/equipment"])}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.platform=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}updateSelectedSensor(e,t){const n=this.platform.sensors.findIndex(t=>e.oid===t);t?n<0&&this.platform.sensors.push(e.oid):n>-1&&this.platform.sensors.splice(n,1)}getSensorName(e){const t=this.sensors.findIndex(t=>t.oid===e);return-1!==t?this.sensors[t].name:""}error(e){this.message=S.b.getMessageFromError(e)}}function Wa(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)("baseUrl",e._metadata.baseUrl)}}Ja.ɵfac=function(e){return new(e||Ja)(c.hc(Pa),c.hc(ga),c.hc(xa),c.hc(Z.a),c.hc(a.a),c.hc(a.b))},Ja.ɵcmp=c.bc({type:Ja,selectors:[["platform"]],decls:4,vars:1,consts:[["id","app-container",1,"container"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","name","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","platformType","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","manufacturer","type","input","placeholder","Type","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngIf"],["class","btn-holder","style","text-align: right;margin-bottom: 40px;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value"],["class","error-message",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value","label","valueChange"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right","margin-bottom","40px"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,Ha,32,15,"div",1),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.platform))},directives:[Qn.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,o.w,o.p,o.y,i.s,we.a,a.e],encapsulation:2});class Ya{constructor(e,t,n){this.router=e,this.service=t,this.modalService=n,this._metadata={label:"",title:"",baseUrl:""},this.message=null,this.cols=[{header:"Name",field:"name",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}set metadata(e){this._metadata.title=e.title,this._metadata.label=e.label,this._metadata.baseUrl=e.baseUrl,this.config={service:this.service,remove:!0,view:!0,create:!0,label:e.label}}ngOnInit(){}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(this._metadata.baseUrl,e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the "+this._metadata.label+" ["+e.name+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/"+this._metadata.baseUrl,e.oid])}newInstance(){this.router.navigate(["/site/"+this._metadata.baseUrl,"__NEW__"])}}function Xa(e,t){if(1&e&&(c.nc(0,"div",8),c.nc(1,"div",9),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",10),c.nc(5,"div"),c.nc(6,"p",11),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc();c.Ub(7),c.cd(e.message)}}function Ka(e,t){if(1&e){const e=c.oc();c.nc(0,"boolean-field",13),c.vc("valueChange",(function(t){c.Rc(e);const n=c.xc().$implicit;return c.xc().classification[n.name]=t})),c.mc()}if(2&e){const e=c.xc().$implicit,t=c.xc();c.Ec("value",t.classification[e.name])("label",e.label)("disabled","READ"===t.mode)}}function Qa(e,t){if(1&e&&(c.nc(0,"div",4),c.ic(1,"label"),c.Zc(2,Ka,1,3,"boolean-field",12),c.mc()),2&e){const e=t.$implicit;c.Ub(2),c.Ec("ngIf","boolean"===e.type)}}function eo(e,t){if(1&e){const e=c.oc();c.nc(0,"button",17),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function to(e,t){if(1&e){const e=c.oc();c.nc(0,"div",14),c.Zc(1,eo,2,0,"button",15),c.nc(2,"button",16),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){const e=c.xc(),t=c.Pc(8);c.Ub(1),c.Ec("ngIf",!e.newInstance),c.Ub(1),c.Ec("disabled",!t.valid)}}function no(e,t){if(1&e){const e=c.oc();c.nc(0,"div",14),c.nc(1,"button",18),c.vc("click",(function(){return c.Rc(e),c.xc().handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}Ya.ɵfac=function(e){return new(e||Ya)(c.hc(a.b),c.hc(xa),c.hc(j.b))},Ya.ɵcmp=c.bc({type:Ya,selectors:[["classifications"]],inputs:{metadata:"metadata"},decls:4,vars:2,consts:[[3,"cols","config","refresh","baseUrl","click",4,"ngIf"],[3,"cols","config","refresh","baseUrl","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h4"),c.bd(2),c.mc(),c.Zc(3,Wa,1,4,"generic-table",0),c.mc()),2&e&&(c.Ub(2),c.cd(t._metadata.title),c.Ub(1),c.Ec("ngIf",null!=t.config))},directives:[i.t,fa.a],styles:["./classifications.css"]});class co{constructor(e,t,n){this.service=e,this.route=t,this.router=n,this.newInstance=!1,this.message=null,this.mode="READ"}ngOnInit(){this.route.data.subscribe(e=>{this.metadata=e;const t=this.route.snapshot.params.oid;"__NEW__"===t?this.service.newInstance(this.metadata.baseUrl).then(e=>{this.classification=e,this.newInstance=!0,this.mode="WRITE"}):this.service.get(this.metadata.baseUrl,t).then(e=>{this.classification=e,this.original=JSON.parse(JSON.stringify(this.classification))})})}handleOnSubmit(){this.message=null,this.service.apply(this.metadata.baseUrl,this.classification).then(e=>{this.classification=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/"+this.metadata.baseUrl,e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.classification=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}error(e){this.message=S.b.getMessageFromError(e)}}co.ɵfac=function(e){return new(e||co)(c.hc(xa),c.hc(a.a),c.hc(a.b))},co.ɵcmp=c.bc({type:co,selectors:[["classification"]],decls:16,vars:7,consts:[["id","app-container",1,"container"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","label","type","input","placeholder","Name","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["class","form-group",4,"ngFor","ngForOf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],[3,"value","label","disabled","valueChange",4,"ngIf"],[3,"value","label","disabled","valueChange"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,Xa,8,1,"div",1),c.nc(4,"div",2),c.nc(5,"h3"),c.bd(6),c.mc(),c.mc(),c.nc(7,"form",null,3),c.nc(9,"div",4),c.nc(10,"label"),c.bd(11,"Name"),c.mc(),c.nc(12,"input",5),c.vc("ngModelChange",(function(e){return t.classification.name=e})),c.mc(),c.mc(),c.Zc(13,Qa,3,1,"div",6),c.Zc(14,to,4,2,"div",7),c.Zc(15,no,3,0,"div",7),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.message),c.Ub(3),c.cd(t.metadata.title),c.Ub(6),c.Ec("ngModel",t.classification.name)("disabled","READ"===t.mode),c.Ub(1),c.Ec("ngForOf",t.metadata.columns),c.Ub(1),c.Ec("ngIf","WRITE"===t.mode),c.Ub(1),c.Ec("ngIf","READ"===t.mode))},directives:[Qn.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,i.s,we.a],encapsulation:2});const io=function(e,t){return{"fa-chevron-down":e,"fa-chevron-right":t}},ao=function(){return{title:"",label:"type",baseUrl:"/sensor-type"}},oo=function(){return{title:"",label:"wave length",baseUrl:"/wave-length"}},so=function(){return{title:"Platform Type",label:"type",baseUrl:"/platform-type"}},lo=function(){return{title:"Platform Manufacturer",label:"manufacturer",baseUrl:"/platform-manufacturer"}};class ro{constructor(e){this.modalService=e,this.isSensorTypeCollapsed=!0,this.isSensorWavelengthCollapsed=!0,this.isPlatformTypeCollapsed=!0,this.isPlatformManufacturerCollapsed=!0}ngOnInit(){}}ro.ɵfac=function(e){return new(e||ro)(c.hc(j.b))},ro.ɵcmp=c.bc({type:ro,selectors:[["equipment"]],decls:41,vars:28,consts:[["id","app-container",1,"container"],[2,"padding","20px","border","solid 1px lightgrey","background","#efefef"],[3,"click"],[1,"fa","fa-fw","collapsible-link",3,"ngClass"],["id","sensorTypeCollabseContainer",3,"collapse"],[3,"metadata"],["id","sensorWavelengthCollabseContainer",3,"collapse"],["id","platformTypeCollabseContainer",3,"collapse"],["id","platformManufacturerCollabseContainer",3,"collapse"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.nc(3,"h2"),c.bd(4,"Equipment Management"),c.mc(),c.nc(5,"h3"),c.bd(6,"Sensor Options"),c.mc(),c.nc(7,"section",1),c.nc(8,"a",2),c.vc("click",(function(){return t.isSensorTypeCollapsed=!t.isSensorTypeCollapsed})),c.nc(9,"h4"),c.ic(10,"i",3),c.bd(11,"Sensor Types"),c.mc(),c.mc(),c.nc(12,"div",4),c.ic(13,"classifications",5),c.mc(),c.nc(14,"a",2),c.vc("click",(function(){return t.isSensorWavelengthCollapsed=!t.isSensorWavelengthCollapsed})),c.nc(15,"h4"),c.ic(16,"i",3),c.bd(17,"Wave Lengths"),c.mc(),c.mc(),c.nc(18,"div",6),c.ic(19,"classifications",5),c.mc(),c.mc(),c.ic(20,"sensors"),c.ic(21,"br"),c.ic(22,"br"),c.nc(23,"h3"),c.bd(24,"Plaform Options"),c.mc(),c.nc(25,"section",1),c.nc(26,"a",2),c.vc("click",(function(){return t.isPlatformTypeCollapsed=!t.isPlatformTypeCollapsed})),c.nc(27,"h4"),c.ic(28,"i",3),c.bd(29,"Platform Types"),c.mc(),c.mc(),c.nc(30,"div",7),c.ic(31,"classifications",5),c.mc(),c.nc(32,"a",2),c.vc("click",(function(){return t.isPlatformManufacturerCollapsed=!t.isPlatformManufacturerCollapsed})),c.nc(33,"h4"),c.ic(34,"i",3),c.bd(35,"Platform Manufacturer"),c.mc(),c.mc(),c.nc(36,"div",8),c.ic(37,"classifications",5),c.mc(),c.mc(),c.ic(38,"platforms"),c.ic(39,"br"),c.ic(40,"br"),c.mc(),c.mc()),2&e&&(c.Ub(10),c.Ec("ngClass",c.Jc(12,io,!t.isSensorTypeCollapsed,t.isSensorTypeCollapsed)),c.Ub(2),c.Ec("collapse",t.isSensorTypeCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(15,ao)),c.Ub(3),c.Ec("ngClass",c.Jc(16,io,!t.isSensorWavelengthCollapsed,t.isSensorWavelengthCollapsed)),c.Ub(2),c.Ec("collapse",t.isSensorWavelengthCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(19,oo)),c.Ub(9),c.Ec("ngClass",c.Jc(20,io,!t.isPlatformTypeCollapsed,t.isPlatformTypeCollapsed)),c.Ub(2),c.Ec("collapse",t.isPlatformTypeCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(23,so)),c.Ub(3),c.Ec("ngClass",c.Jc(24,io,!t.isPlatformManufacturerCollapsed,t.isPlatformManufacturerCollapsed)),c.Ub(2),c.Ec("collapse",t.isPlatformManufacturerCollapsed),c.Ub(1),c.Ec("metadata",c.Hc(27,lo)))},directives:[Qn.a,i.q,u.a,Ya,ya,Da],styles:[".collapsible-link[_ngcontent-%COMP%] {\n  font-size: 15px;\n}"]});class po{validate(e){return(t=new RegExp(/[\W<>\-+=!@#$%^&*?/\\']/gm),e=>t.test(e.value)?{forbiddenName:{value:e.value}}:null)(e);var t}}po.ɵfac=function(e){return new(e||po)},po.ɵdir=c.cc({type:po,selectors:[["","forbiddenName",""]],features:[c.Tb([{provide:o.h,useExisting:po,multi:!0}])]});class mo{constructor(e){this.el=e}onKeyDown(e){let t=e;if(this.OnlyNumber){if(-1!==[46,8,9,27,13,110,190].indexOf(t.keyCode)||65==t.keyCode&&!0===t.ctrlKey||67==t.keyCode&&!0===t.ctrlKey||88==t.keyCode&&!0===t.ctrlKey||t.keyCode>=35&&t.keyCode<=39)return;(t.shiftKey||t.keyCode<48||t.keyCode>57)&&(t.keyCode<96||t.keyCode>105)&&t.preventDefault()}}}mo.ɵfac=function(e){return new(e||mo)(c.hc(c.r))},mo.ɵdir=c.cc({type:mo,selectors:[["","OnlyNumber",""]],hostBindings:function(e,t){1&e&&c.vc("keydown",(function(e){return t.onKeyDown(e)}))},inputs:{OnlyNumber:"OnlyNumber"}});class ho{canDeactivate(e){return!e.canDeactivate()||!!confirm("An upload is currently in progress. Are you sure you want to leave?")}}ho.ɵfac=function(e){return new(e||ho)},ho.ɵprov=c.dc({token:ho,factory:ho.ɵfac});var uo=n(133);function go(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",1),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)("refresh",e.refresh)}}class bo{constructor(e,t,n){this.service=e,this.router=t,this.modalService=n,this.message=null,this.cols=[{header:"Serial Number",field:"serialNumber",type:"TEXT",sortable:!0},{header:"FAA Id Number",field:"faaNumber",type:"TEXT",sortable:!0},{header:"Description",field:"description",type:"TEXT",sortable:!0},{header:"Bureau",field:"bureau",type:"TEXT",sortable:!0},{header:"Platform",field:"platform",type:"TEXT",sortable:!0},{header:"",type:"ACTIONS",sortable:!1}]}ngOnInit(){this.config={service:this.service,remove:!0,view:!0,create:!0,label:"UAV"},this.refresh=new G.b}onClick(e){"view"===e.type?this.onView(e.row):"remove"===e.type?this.onRemove(e.row):"create"===e.type&&this.newInstance()}remove(e){this.service.remove(e.oid).then(e=>{this.refresh.next()})}onRemove(e){this.bsModalRef=this.modalService.show(O.a,{animated:!0,backdrop:!0,ignoreBackdropClick:!0}),this.bsModalRef.content.message="Are you sure you want to remove the UAV ["+e.serialNumber+"]",this.bsModalRef.content.type="DANGER",this.bsModalRef.content.submitText="Delete",this.bsModalRef.content.onConfirm.subscribe(t=>{this.remove(e)})}onView(e){this.router.navigate(["/site/uav",e.oid])}newInstance(){this.router.navigate(["/site/uav","__NEW__"])}}bo.ɵfac=function(e){return new(e||bo)(c.hc(wn),c.hc(a.b),c.hc(j.b))},bo.ɵcmp=c.bc({type:bo,selectors:[["uavs"]],decls:4,vars:1,consts:[[3,"cols","config","refresh","click",4,"ngIf"],[3,"cols","config","refresh","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.nc(1,"h2"),c.bd(2,"UAVs"),c.mc(),c.Zc(3,go,1,3,"generic-table",0),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.config))},directives:[i.t,fa.a],styles:["./uavs.css"]});class fo{constructor(){}ngOnInit(){}}fo.ɵfac=function(e){return new(e||fo)},fo.ɵcmp=c.bc({type:fo,selectors:[["uavs-page"]],decls:4,vars:0,consts:[["id","app-container",1,"container"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.ic(3,"uavs"),c.mc(),c.mc())},directives:[Qn.a,bo],encapsulation:2});var vo=n(101);function yo(e,t){if(1&e&&(c.nc(0,"div",15),c.nc(1,"div",16),c.nc(2,"strong"),c.bd(3,"Error"),c.mc(),c.mc(),c.nc(4,"div",17),c.nc(5,"div"),c.nc(6,"p",18),c.bd(7),c.mc(),c.mc(),c.mc(),c.mc()),2&e){const e=c.xc(2);c.Ub(7),c.cd(e.message)}}function xo(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.oid),c.Ub(1),c.cd(e.name)}}function ko(e,t){if(1&e){const e=c.oc();c.nc(0,"select",19),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc(2).uav.platform=t})),c.ic(1,"option"),c.Zc(2,xo,2,2,"option",13),c.mc()}if(2&e){const e=c.xc(2);c.Ec("ngModel",e.uav.platform),c.Ub(2),c.Ec("ngForOf",e.platforms)}}const Eo=function(e){return["/site/platform",e]};function Co(e,t){if(1&e&&(c.nc(0,"div"),c.nc(1,"a",22),c.bd(2),c.mc(),c.mc()),2&e){const e=t.$implicit;c.Ub(1),c.Ec("routerLink",c.Ic(2,Eo,e.oid)),c.Ub(1),c.cd(e.name)}}function wo(e,t){if(1&e&&(c.lc(0),c.Zc(1,Co,3,4,"div",21),c.yc(2,"filter"),c.kc()),2&e){const e=c.xc(2);c.Ub(1),c.Ec("ngForOf",c.Bc(2,1,e.platforms,"oid",e.uav.platform))}}function Uo(e,t){if(1&e&&(c.nc(0,"option",20),c.bd(1),c.mc()),2&e){const e=t.$implicit;c.Ec("value",e.value),c.Ub(1),c.dd(" ",e.label," ")}}function Io(e,t){if(1&e){const e=c.oc();c.nc(0,"button",26),c.vc("click",(function(){return c.Rc(e),c.xc(3).handleOnCancel()})),c.bd(1,"Cancel"),c.mc()}}function Mo(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.Zc(1,Io,2,0,"button",24),c.nc(2,"button",25),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnSubmit()})),c.bd(3,"Apply"),c.mc(),c.mc()}if(2&e){c.xc();const e=c.Pc(6),t=c.xc();c.Ub(1),c.Ec("ngIf",!t.newInstance),c.Ub(1),c.Ec("disabled",!e.valid)}}function Oo(e,t){if(1&e){const e=c.oc();c.nc(0,"div",23),c.nc(1,"button",27),c.vc("click",(function(){return c.Rc(e),c.xc(2).handleOnEdit()})),c.bd(2,"Edit"),c.mc(),c.mc()}}function So(e,t){if(1&e){const e=c.oc();c.nc(0,"div",2),c.Zc(1,yo,8,1,"div",3),c.nc(2,"div",4),c.nc(3,"h3"),c.bd(4,"UAV"),c.mc(),c.mc(),c.nc(5,"form",null,5),c.nc(7,"div",6),c.nc(8,"label"),c.bd(9,"Platform"),c.mc(),c.Zc(10,ko,3,2,"select",7),c.Zc(11,wo,3,5,"ng-container",8),c.mc(),c.nc(12,"div",6),c.nc(13,"label"),c.bd(14,"Serial Number"),c.mc(),c.nc(15,"input",9),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.serialNumber=t})),c.mc(),c.mc(),c.nc(16,"div",6),c.nc(17,"label"),c.bd(18,"FAA Number"),c.mc(),c.nc(19,"input",10),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.faaNumber=t})),c.mc(),c.mc(),c.nc(20,"div",6),c.nc(21,"label"),c.bd(22,"Description"),c.mc(),c.nc(23,"textarea",11),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.description=t})),c.mc(),c.mc(),c.nc(24,"div",6),c.nc(25,"label"),c.bd(26,"Bureau"),c.mc(),c.nc(27,"select",12),c.vc("ngModelChange",(function(t){return c.Rc(e),c.xc().uav.bureau=t})),c.ic(28,"option"),c.Zc(29,Uo,2,2,"option",13),c.mc(),c.mc(),c.Zc(30,Mo,4,2,"div",14),c.Zc(31,Oo,3,0,"div",14),c.mc(),c.mc()}if(2&e){const e=c.xc();c.Ub(1),c.Ec("ngIf",null!=e.message),c.Ub(9),c.Ec("ngIf","READ"!==e.mode),c.Ub(1),c.Ec("ngIf","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.serialNumber)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.faaNumber)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.description)("disabled","READ"===e.mode),c.Ub(4),c.Ec("ngModel",e.uav.bureau)("disabled","READ"===e.mode),c.Ub(2),c.Ec("ngForOf",e.bureaus),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"WRITE"===e.mode),c.Ub(1),c.Ec("ngIf",e.isAdmin&&"READ"===e.mode)}}class Ro{constructor(e,t,n,c,i){this.service=e,this.platformService=t,this.authService=n,this.route=c,this.router=i,this.isAdmin=!1,this.newInstance=!1,this.message=null,this.bureaus=[],this.platforms=[],this.mode="READ",this.isAdmin=this.authService.isAdmin()}ngOnInit(){const e=this.route.snapshot.params.oid;"__NEW__"===e?this.service.newInstance().then(e=>{this.uav=e.uav,this.bureaus=e.bureaus,this.newInstance=!0,this.mode="WRITE"}):this.service.get(e).then(e=>{this.uav=e.uav,this.bureaus=e.bureaus,this.original=JSON.parse(JSON.stringify(this.uav))}),this.platformService.getAll().then(e=>{this.platforms=e})}handleOnSubmit(){this.message=null,this.service.apply(this.uav).then(e=>{this.uav=e,this.mode="READ",this.newInstance&&(this.router.navigate(["/site/uav",e.oid]),this.newInstance=!1,this.original=e)}).catch(e=>{this.error(e)})}handleOnCancel(){this.message=null,this.uav=JSON.parse(JSON.stringify(this.original)),this.mode="READ"}handleOnEdit(){this.mode="WRITE"}error(e){this.message=S.b.getMessageFromError(e)}}Ro.ɵfac=function(e){return new(e||Ro)(c.hc(wn),c.hc(Pa),c.hc(Z.a),c.hc(a.a),c.hc(a.b))},Ro.ɵcmp=c.bc({type:Ro,selectors:[["uav"]],decls:4,vars:1,consts:[["id","app-container",1,"container"],["class","modal-body",4,"ngIf"],[1,"modal-body"],["class","error-container",4,"ngIf"],[1,"modal-title-container"],["ngForm","ngForm"],[1,"form-group"],["name","platform","type","input","class","form-control","required","",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["name","serialNumber","type","input","placeholder","Serial Number","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","faaNumber","type","input","placeholder","FAA Number","required","","max","10","maxlength","10",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","description","type","input","placeholder","Description",1,"form-control",3,"ngModel","disabled","ngModelChange"],["name","bureau","type","input","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["class","btn-holder","style","text-align: right;",4,"ngIf"],[1,"error-container"],[1,"label-holder"],[1,"holder"],[1,"error-message"],["name","platform","type","input","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],[4,"ngFor","ngForOf"],[3,"routerLink"],[1,"btn-holder",2,"text-align","right"],["type","button","class","btn btn-default",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","button",1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.Zc(3,So,32,14,"div",1),c.mc(),c.mc()),2&e&&(c.Ub(3),c.Ec("ngIf",null!=t.uav))},directives:[Qn.a,i.t,o.z,o.l,o.m,o.c,o.v,o.k,o.n,o.f,o.w,o.p,o.y,i.s,a.e],pipes:[vo.a],encapsulation:2});class To{constructor(e,t,n){this.http=e,this.noErrorHttpClient=t,this.eventService=n}page(e){let t=new y.g;return t=t.set("criteria",JSON.stringify(e)),this.http.get(acp+"/collection-report/page",{params:t}).toPromise()}}To.ɵfac=function(e){return new(e||To)(c.rc(y.c),c.rc(D.a),c.rc(N.a))},To.ɵprov=c.dc({token:To,factory:To.ɵfac});var Po=n(327);function Fo(e,t){if(1&e){const e=c.oc();c.nc(0,"generic-table",4),c.vc("click",(function(t){return c.Rc(e),c.xc().onClick(t)})),c.mc()}if(2&e){const e=c.xc();c.Ec("cols",e.cols)("config",e.config)}}class Do{constructor(e,t,n){this.service=e,this.pService=t,this.modalService=n,this.message=null,this.cols=[{header:"Collection",field:"collectionName",baseUrl:"site/viewer/collection",urlField:"collection",type:"URL",sortable:!0,columnType:e=>e.exists?"URL":"TEXT"},{header:"Collection Owner",field:"userName",type:"TEXT",sortable:!0},{header:"Collection Date",field:"collectionDate",type:"DATE",sortable:!0},{header:"Mission",field:"missionName",type:"TEXT",sortable:!0},{header:"Project",field:"projectName",type:"TEXT",sortable:!0},{header:"Site",field:"siteName",type:"TEXT",sortable:!0},{header:"Latitude",field:"siteLatDecimalDegree",type:"NUMBER",sortable:!1,filter:!1},{header:"Longitude",field:"siteLongDecimalDegree",type:"NUMBER",sortable:!1,filter:!1},{header:"Bureau",field:"bureauName",type:"TEXT",sortable:!0},{header:"Platform",field:"platformName",type:"TEXT",sortable:!0},{header:"Sensor",field:"sensorName",type:"TEXT",sortable:!0},{header:"FAA Id Number",field:"faaIdNumber",type:"TEXT",sortable:!0},{header:"Serial Number",field:"serialNumber",type:"TEXT",sortable:!0},{header:"ODM Processing",field:"odmProcessing",type:"TEXT",sortable:!1},{header:"RAW Images Count",field:"rawImagesCount",type:"NUMBER",sortable:!1},{header:"EROS Metadata Complete",field:"erosMetadataComplete",type:"BOOLEAN",sortable:!1},{header:"Video",field:"video",type:"BOOLEAN",sortable:!1},{header:"Orthomosaic",field:"orthomosaic",type:"BOOLEAN",sortable:!1},{header:"Point Cloud",field:"pointCloud",type:"BOOLEAN",sortable:!1},{header:"Hillshade",field:"hillshade",type:"BOOLEAN",sortable:!1},{header:"Products Shared",field:"productsShared",type:"BOOLEAN",sortable:!1},{header:"Storage size",field:"allStorageSize",type:"NUMBER",sortable:!0,filter:!1},{header:"Number of Downloads",field:"downloadCounts",type:"NUMBER",sortable:!0,filter:!1},{header:"Date of Create",field:"createDate",type:"DATE",sortable:!0,filter:!1},{header:"Date of Delete",field:"deleteDate",type:"DATE",sortable:!0,filter:!1},{header:"Product",field:"product",text:"View Product",type:"CONSTANT",sortable:!1,columnType:e=>null==e.product||0===e.product.length?"NONE":"CONSTANT"},{header:"Map Services",field:"productURLs",type:"STRING-ARRAY",sortable:!1,columnType:e=>null==e.product||0===e.product.length?"NONE":"STRING-ARRAY"}]}ngOnInit(){this.config={service:this.service,remove:!1,view:!1,create:!1,label:"row"}}onExportCSV(){window.open(acp+"/collection-report/export-csv","_blank")}onClick(e){if("custom"===e.type&&"product"===e.col.field){const t=e.row.product;null!=t&&t.length>0&&this.pService.getDetail(t,1,20).then(e=>{this.modalService.show(Bt,{animated:!0,backdrop:!0,ignoreBackdropClick:!0,class:"product-info-modal"}).content.init(e)})}}}Do.ɵfac=function(e){return new(e||Do)(c.hc(To),c.hc(Ct),c.hc(Po.a))},Do.ɵcmp=c.bc({type:Do,selectors:[["reports"]],decls:9,vars:1,consts:[["id","app-container",1,"container-fluid"],[1,"row"],["type","submit","value","Export CSV",1,"btn","btn-primary","pull-right",2,"margin-bottom","10px","margin-right","10px",3,"click"],[3,"cols","config","click",4,"ngIf"],[3,"cols","config","click"]],template:function(e,t){1&e&&(c.nc(0,"div"),c.ic(1,"uasdm-header"),c.nc(2,"div",0),c.nc(3,"h2"),c.bd(4,"Report"),c.mc(),c.nc(5,"div",1),c.nc(6,"input",2),c.vc("click",(function(){return t.onExportCSV()})),c.mc(),c.mc(),c.nc(7,"div",1),c.Zc(8,Fo,1,2,"generic-table",3),c.mc(),c.mc(),c.mc()),2&e&&(c.Ub(8),c.Ec("ngIf",null!=t.config))},directives:[Qn.a,i.t,fa.a],styles:["./reports.css"]});const No=[{path:"",canActivate:[uo.b],component:ti},{path:"viewer",canActivate:[uo.b],component:ti},{path:"viewer/:action/:oid",canActivate:[uo.b],component:ti},{path:"upload",component:gi,canDeactivate:[ho]},{path:"tasks",canActivate:[uo.b],component:ua},{path:"report",canActivate:[uo.b],component:Do},{path:"sensor/:oid",canActivate:[uo.b],component:Ta},{path:"platform/:oid",canActivate:[uo.b],component:Ja},{path:"platform-manufacturer/:oid",canActivate:[uo.a],component:co,data:{title:"Platform Manufacturer",label:"manufacturer",baseUrl:ba.PLATFORM_MANUFACTURER}},{path:"platform-type/:oid",canActivate:[uo.a],component:co,data:{title:"Platform Type",label:"type",baseUrl:ba.PLATFORM_TYPE}},{path:"sensor-type/:oid",canActivate:[uo.a],component:co,data:{title:"Sensor Type",label:"type",baseUrl:ba.SENSOR_TYPE,columns:[{name:"isMultispectral",label:"Is Multispectral",type:"boolean"}]}},{path:"wave-length/:oid",canActivate:[uo.a],component:co,data:{title:"Wave Length",label:"wave length",baseUrl:ba.WAVE_LENGTH}},{path:"uavs",canActivate:[uo.a],component:fo},{path:"uav/:oid",canActivate:[uo.b],component:Ro},{path:"equipment",canActivate:[uo.a],component:ro,data:{}}];class Zo{}Zo.ɵmod=c.fc({type:Zo}),Zo.ɵinj=c.ec({factory:function(e){return new(e||Zo)},providers:[{provide:i.o,useClass:i.h}],imports:[[a.f.forChild(No)],a.f]}),("undefined"==typeof ngJitMode||ngJitMode)&&c.Vc(Zo,{imports:[a.f],exports:[a.f]});var Ao=n(102),jo=n(39),Lo=n(21),_o=n(103),$o=n(36),zo=n(63),Bo=n(99),Go=n(64),Vo=n(104),qo=n(28),Ho=n(105);class Jo{}Jo.ɵmod=c.fc({type:Jo}),Jo.ɵinj=c.ec({factory:function(e){return new(e||Jo)},providers:[ho,A,Ct,k,ga,Pa,te,xa,wn,To],imports:[[i.c,a.f,o.e,h.a,m.b,l.c,r.c,d.b,p.d.forRoot(),u.b.forRoot(),Ao.a,Zo,s.b]]}),("undefined"==typeof ngJitMode||ngJitMode)&&c.Vc(Jo,{declarations:[M,tn,un,W,B,Wn,Ee,Be,qe,Et,En,Bt,ti,gi,ua,po,mo,Ta,ya,Ja,Da,Ti,Ya,co,bo,fo,Ro,Pn,Do,ro,hc],imports:[i.c,a.f,o.e,h.a,m.b,l.c,r.c,d.b,p.d,u.b,Ao.a,Zo,s.b]}),c.Uc(W,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,a.g,a.c,a.e,a.d,a.h,o.z,o.p,o.y,o.c,o.q,o.t,o.a,o.w,o.x,o.s,o.k,o.l,o.v,o.g,o.f,o.r,o.b,o.d,o.n,o.o,o.m,h.c,h.d,m.a,l.b,l.d,l.a,r.a,r.b,d.a,d.c,p.b,p.e,p.c,p.a,u.a,Qn.a,jo.a,O.a,Cn.a,ni.a,we.a,Lo.a,_o.a,$o.a,zo.a,Bo.a,Go.a,fa.a,s.a,s.c,M,tn,un,W,B,Wn,Ee,Be,qe,Et,En,Bt,ti,gi,ua,po,mo,Ta,ya,Ja,Da,Ti,Ya,co,bo,fo,Ro,Pn,Do,ro,hc],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,h.b,Vo.a,qo.a,Ho.a,vo.a,L.a,He.a]),c.Uc(Ee,[i.q,i.r,i.s,i.t,i.A,i.w,i.x,i.y,i.z,i.u,i.v,a.g,a.c,a.e,a.d,a.h,o.z,o.p,o.y,o.c,o.q,o.t,o.a,o.w,o.x,o.s,o.k,o.l,o.v,o.g,o.f,o.r,o.b,o.d,o.n,o.o,o.m,h.c,h.d,m.a,l.b,l.d,l.a,r.a,r.b,d.a,d.c,p.b,p.e,p.c,p.a,u.a,Qn.a,jo.a,O.a,Cn.a,ni.a,we.a,Lo.a,_o.a,$o.a,zo.a,Bo.a,Go.a,fa.a,s.a,s.c,M,tn,un,W,B,Wn,Ee,Be,qe,Et,En,Bt,ti,gi,ua,po,mo,Ta,ya,Ja,Da,Ti,Ya,co,bo,fo,Ro,Pn,Do,ro,hc],[i.b,i.G,i.p,i.k,i.E,i.g,i.C,i.F,i.d,i.f,i.i,i.j,i.l,h.b,Vo.a,qo.a,Ho.a,vo.a,L.a,He.a])}}]);
//# sourceMappingURL=2.chunk.js.map